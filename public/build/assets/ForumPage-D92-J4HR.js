import{w as ee,l as te,b as se,u as he,d as z,c as ge,U as ae,A as n,M as h,f as s,F as w,Q as j,C as G,a as e,k as g,i as X,H as a,j as k,m as A,z as l,s as u,G as b,n as y,h as q,R as oe,O as re,_ as le,o as _e,$ as C,p as R,q as ye,r as ve,t as be,g as we,v as Y,N as ke,x as Se,y as Ce,S as I,B,D as Ie}from"./app-DQ8266SS.js";import{u as Te,t as Z}from"./forums-9OW5kv2b.js";import{s as E}from"./subtitles-DW7M559j.js";import{d as $e,s as xe,u as Le}from"./showDialog-CIaxRVxv.js";import{_ as ze}from"./loudspeaker-fCnvg7to.js";import{u as Me,S as Ne,L as Fe,a as Pe}from"./LoudspeakerComponent-Ci4auCLl.js";import{_ as Oe}from"./FInput.vue_vue_type_script_setup_true_lang-C8i50sDQ.js";import{N as Ue}from"./Ellipsis-C8oGpxce.js";import{N as We,a as qe}from"./Skeleton-BgefqZ_n.js";import{N as Re}from"./Tag-C8_pW6Ju.js";import"./Pagination-BMmJxOKO.js";import"./use-locale-BKZTEJ_B.js";import"./prop-DfVitj0l.js";import"./Input-Nv-VAIlA.js";import"./Select-Fwav5EqF.js";import"./Forward-CswnLcqR.js";import"./Spin-dnJO56Sh.js";import"./_createCompounder-B4xoQ4gz.js";import"./use-houdini-f9zyHQIs.js";const Be=m=>(oe("data-v-92d410c5"),m=m(),re(),m),Ee=Be(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),je={key:0},Ge=ee({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(m,{emit:T}){te(p=>({"4b1418b0":e(f).hoverColor,"284e4759":(e(c).isMobile,"0.875rem"),e1605438:e(f).textColor1}));const c=se(),f=he(),S=T,M=z(()=>({paddingBottom:c.isMobile?"6px":""})),v=Me({}).data,{loading:$,send:N,onSuccess:F}=ge(p=>$e(p),{immediate:!1});F(()=>{S("withdrawDelayThreadSuccess")});function x(p){xe({title:"要撤回延时主题吗？",onPositiveClick:()=>{N(p)}})}return(p,H)=>{const L=ae("router-link");return p.showThis?(n(),h(e(g),{key:0,vertical:"",size:2},{default:s(()=>[(n(!0),w(G,null,j(p.threadsListData,t=>(n(),h(e(X),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":M.value,hoverable:""},{default:s(()=>[a(e(g),{vertical:""},{default:s(()=>[k("div",{style:A({color:t.title_color&&!e(c).userCustom.monochromeMode?t.title_color:e(f).textColor1}),class:"thread-title"},[l(u(t.sub_title)+" "+u(t.vote_question_id?"🗳️":"")+" "+u(t.gamble_question_id?"🎲":"")+" "+u(t.crowd_id?"💰":"")+" "+u(t.hongbao_id?"🧧":"")+" ",1),a(L,{to:{name:"thread",params:{threadId:t.id}},style:A([{"font-size":"1.0rem"},{color:t.title_color&&!e(c).userCustom.monochromeMode?t.title_color:e(f).textColor1,pointerEvents:t.is_delay?"none":void 0}]),target:p.newWindowToPost?"_blank":!1},{default:s(()=>[l(u(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(n(),h(L,{key:0,style:{"font-size":"1.0rem"},to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:p.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+u(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):b("",!0),e(v)[t.id]?(n(),h(e(y),{key:1,size:"tiny",type:"primary",onClick:_=>p.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(v)[t.id].floor+1)/200)},hash:`#f_${e(v)[t.id].floor}`})},{default:s(()=>{var _;return[l(" ["+u((_=e(v)[t.id])==null?void 0:_.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):b("",!0),t.is_your_thread?(n(),h(e(y),{key:2,size:"tiny",type:"warning",disabled:e($),onClick:_=>x(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):b("",!0)],4),a(e(g),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+u(t.updated_at),1)]),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+u(t.nickname),1)]),Ee,l(" "+u(t.posts_num>1200?"🔥":"")+" ",1),t.locked_by_coin>0?(n(),w("span",je,"🔒"+u(t.locked_by_coin),1)):b("",!0),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+u(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(n(),h(e(g),{key:1,vertical:"",size:2},{default:s(()=>[(n(),w(G,null,j(50,t=>a(e(X),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Ae=le(Ge,[["__scopeId","data-v-92d410c5"]]),ne=m=>(oe("data-v-bf3278cc"),m=m(),re(),m),He={key:0,class:"carousel-box"},Qe={key:0,class:"carousel-box"},Ve=["src"],Ke=ne(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),De=ne(()=>k("div",{style:{height:"50px"}},null,-1)),Je=ee({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(m){var J;te(o=>({"95e5b876":e(c).bannerHeight}));const T=_e(),c=se(),f=Te(),S=we(),M=C(null);C(),Le();const r=m;document.title=((J=f.forumData(r.forumId))==null?void 0:J.name)??"小火锅";const v=R("banner_hiden",!1),$=R("new_window_to_post",!1);function N(){return I(g,{style:"padding:6px 8px",vertical:!0},()=>[I(B,{checked:v.value,"onUpdate:checked":o=>v.value=o,label:"隐藏版头"}),I(B,{checked:$.value,"onUpdate:checked":o=>$.value=o,label:"新窗口打开"})])}const F=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:N}],x=R("subtitles_included",E),p=z(()=>E.filter(o=>!x.value.includes(o)));function H(){return I(Ie,{value:x.value,"onUpdate:value":o=>x.value=o},()=>[I(g,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(E).map(o=>I(B,{value:o,label:o}))])])}const L=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:H}],t=C(r.search),_=C(!!r.search);function Q(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ie(){t.value=void 0,_.value=!1,S.push({name:"forum",params:{forumId:r.forumId,page:1}})}function ue(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=C(r.page);function de(o){S.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}ye(()=>r.page,o=>P.value=o);const V=z(()=>({forumId:r.forumId,binggan:T.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:p.value,searchTitle:r.search,delay:r.delay})),{loading:O,data:U,onSuccess:Xe}=ve(()=>Z(V.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,p],{initialData:[],immediate:!0}),K=C(!1),{fetching:Ye,onSuccess:ce,fetch:pe}=be();function D(o=!1){K.value=o,pe(Z(V.value))}ce(()=>{K.value&&window.$message.success("已刷新数据")});const me=z(()=>{if(O.value)return[];if(T.userData.binggan.use_pingbici){const o=c.userCustom.pingbiciIngnoreCase?"gi":"g";return U.value.threads_data.data.filter(i=>{for(let W of T.userData.pingbici.title_pingbici)if(new RegExp(W,o).test(i.title))return!1;return!0})}else return U.value.threads_data.data});return(o,i)=>{const W=ae("router-link");return n(),h(e(g),{vertical:""},{default:s(()=>[e(v)?b("",!0):(n(),w("div",He,[e(f).forumsDataLoading?(n(),w("div",Qe,[a(e(We),{class:"carousel-skeleton",sharp:""})])):b("",!0),e(f).forumsDataLoading?b("",!0):(n(),h(e(qe),{key:1,"show-arrow":"",trigger:e(c).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(n(!0),w(G,null,j((d=e(f).forumData(o.forumId))==null?void 0:d.banners,fe=>(n(),w("img",{src:fe,class:"carousel-img"},null,8,Ve))),256))]}),_:1},8,["trigger"]))])),a(e(g),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(Y),{trigger:e(c).isMobile?"click":"hover",options:F,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1},8,["trigger"]),a(e(Y),{trigger:e(c).isMobile?"click":"hover",options:L,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1},8,["trigger"]),a(e(ke),{size:e(c).isMobile?28:34},{default:s(()=>[a(e(Ne),{style:{cursor:"pointer"},onClick:i[0]||(i[0]=d=>_.value=!_.value)})]),_:1},8,["size"]),Ke,a(e(y),{type:"primary",onClick:i[1]||(i[1]=d=>o.$router.push({name:"loudspeaker"}))},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:i[2]||(i[2]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),_.value?(n(),h(e(g),{key:1,wrap:!1},{default:s(()=>[a(e(Oe),{value:t.value,"onUpdate:value":i[3]||(i[3]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":"",onKeyup:Se(Q,["enter"])},null,8,["value"]),a(e(y),{type:"primary",onClick:Q},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:ie},{default:s(()=>[l("清空")]),_:1})]),_:1})):b("",!0),a(Fe),a(Ae,{"threads-list-data":me.value,"new-window-to-post":e($),"show-this":!e(O),onWithdrawDelayThreadSuccess:D},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(g),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:ue},{default:s(()=>[l(u(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(ze,{page:P.value,"onUpdate:page":[i[4]||(i[4]=d=>P.value=d),de],"last-page":e(O)?1:e(U).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),De,(n(),h(Ce,{to:"#topbar-nav"},[a(W,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Ue),{style:A({maxWidth:e(c).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(u((d=e(f).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(Re),{round:"",class:"forum-tag",size:e(c).isMobile?"small":"medium"},{default:s(()=>[l(u(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(Pe,{mode:"forum",ref_key:"SidebarCom",ref:M,onRefresh:i[5]||(i[5]=d=>D(!0)),onNewThread:i[6]||(i[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),yt=le(Je,[["__scopeId","data-v-bf3278cc"]]);export{yt as default};
