import{b as A,e as ne,m as le,w as ue,n as ie,$ as p,o as $,d as L,p as de,q as pe,r as me,A as d,M as _,f as o,a as e,l as ce,g as fe,U as he,F as b,H as r,G as k,C as ge,Q as ve,t as G,v as m,z as l,N as ye,k as c,x as _e,s as F,y as be,B as ke,R as we,O as Ie,j as H,S as f,D as O,E as Se,_ as Ce}from"./app-BfTmtkkR.js";import{u as xe,t as W}from"./forums-nUb1a26Z.js";import{s as z}from"./subtitles-DW7M559j.js";import{_ as De}from"./loudspeaker-D2yZsHDi.js";import{S as Te,L as Ne,a as $e}from"./LoudspeakerComponent-DSDqAzaF.js";import{T as Le}from"./ThreadList-DlR4oauN.js";import{_ as Fe}from"./FInput.vue_vue_type_script_setup_true_lang-Bj8uTtER.js";import{N as Oe}from"./Ellipsis-Cj_va55S.js";import{N as ze,a as Me}from"./Skeleton-DfLmXZ5d.js";import{N as Ue}from"./Tag-COjQsRYJ.js";import"./Pagination-BC5oonbg.js";import"./use-locale-CFDb4tef.js";import"./prop-DfVitj0l.js";import"./Input-C5i_M3Sx.js";import"./Select-BbGpypib.js";import"./Forward-BBoKPO9i.js";import"./Spin-C-KLI5el.js";import"./showDialog-DL9mDBDS.js";import"./browseLogger-DKOoSk-M.js";import"./_createCompounder-CoPvQ65S.js";import"./use-houdini-9w7s9k9U.js";function Pe(){const u=A();ne(()=>{u.showTopbarNav=!1}),le(()=>{u.showTopbarNav=!0})}const Q=u=>(we("data-v-49edc6e6"),u=u(),Ie(),u),Re={key:0,class:"carousel-box"},je={key:0,class:"carousel-box"},qe=["src"],Ee=Q(()=>H("div",{style:{"margin-left":"auto"}},null,-1)),Be=Q(()=>H("div",{style:{height:"50px"}},null,-1)),Ge=ue({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(u){var E,B;ce(a=>({"7b4adc69":e(i).bannerHeight}));const w=ie(),i=A(),h=xe(),g=fe(),K=p(null);p();const M=p();Pe();const t=u;document.title=(B=(E=h.forumData(t.forumId))==null?void 0:E.name)!=null?B:"小火锅";const I=$("banner_hiden",!1),S=$("new_window_to_post",!1);function J(){return f(c,{style:"padding:6px 8px",vertical:!0},()=>[f(O,{checked:I.value,"onUpdate:checked":a=>I.value=a,label:"隐藏版头"}),f(O,{checked:S.value,"onUpdate:checked":a=>S.value=a,label:"新窗口打开"})])}const V=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:J}],C=$("subtitles_included",z),U=L(()=>z.filter(a=>!C.value.includes(a)));function X(){return f(Se,{value:C.value,"onUpdate:value":a=>C.value=a},()=>[f(c,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(z).map(a=>f(O,{value:a,label:a}))])])}const Y=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:X}],v=p(t.search),y=p(!!t.search);function P(){g.push({name:"forum",params:{forumId:t.forumId,page:1},query:{search:v.value||void 0}})}function Z(){v.value=void 0,y.value=!1,g.push({name:"forum",params:{forumId:t.forumId,page:1}})}function ee(){g.push({name:"forum",params:{forumId:t.forumId,page:1},query:{delay:t.delay?void 0:"true"}})}const x=p(t.page);function ae(a){g.push({name:"forum",params:{forumId:t.forumId,page:a},query:{search:t.search,delay:t.delay?"true":void 0}})}de(()=>t.page,a=>x.value=a);const R=L(()=>({forumId:t.forumId,binggan:w.binggan,page:t.page,threadsPerPage:50,subtitlesExcluded:U.value,searchTitle:t.search,delay:t.delay})),{loading:D,data:T,onSuccess:We}=pe(()=>W(R.value),[()=>t.forumId,()=>t.page,()=>t.search,()=>t.delay,U],{initialData:[],immediate:!0}),j=p(!1),{fetching:Ae,onSuccess:te,fetch:re}=me();function q(a=!1){var s;j.value=a,re(W(R.value)),(s=M.value)==null||s.reloadBrowseLogger()}te(()=>{j.value&&window.$message.success("已刷新数据")});const se=L(()=>{if(D.value)return[];if(w.userData.binggan.use_pingbici){const a=i.userCustom.pingbiciIngnoreCase?"gi":"g";return T.value.threads_data.data.filter(s=>{for(let N of w.userData.pingbici.title_pingbici)if(new RegExp(N,a).test(s.title))return!1;return!0})}else return T.value.threads_data.data});return(a,s)=>{const N=he("router-link");return d(),_(e(c),{vertical:""},{default:o(()=>[e(I)?k("",!0):(d(),b("div",Re,[e(h).forumsDataLoading?(d(),b("div",je,[r(e(ze),{class:"carousel-skeleton",sharp:""})])):k("",!0),e(h).forumsDataLoading?k("",!0):(d(),_(e(Me),{key:1,"show-arrow":"",trigger:e(i).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:o(()=>{var n;return[(d(!0),b(ge,null,ve((n=e(h).forumData(a.forumId))==null?void 0:n.banners,oe=>(d(),b("img",{src:oe,class:"carousel-img"},null,8,qe))),256))]}),_:1},8,["trigger"]))])),r(e(c),{style:{"margin-top":"8px"},size:"small"},{default:o(()=>[r(e(G),{trigger:e(i).isMobile?"click":"hover",options:V,placement:"bottom-start"},{default:o(()=>[r(e(m),null,{default:o(()=>[l("功能")]),_:1})]),_:1},8,["trigger"]),r(e(G),{trigger:e(i).isMobile?"click":"hover",options:Y,placement:"bottom-start"},{default:o(()=>[r(e(m),null,{default:o(()=>[l("筛选")]),_:1})]),_:1},8,["trigger"]),r(e(ye),{size:e(i).isMobile?28:34},{default:o(()=>[r(e(Te),{style:{cursor:"pointer"},onClick:s[0]||(s[0]=n=>y.value=!y.value)})]),_:1},8,["size"]),Ee,r(e(m),{type:"primary",onClick:s[1]||(s[1]=n=>a.$router.push({name:"loudspeaker"}))},{default:o(()=>[l("大喇叭")]),_:1}),r(e(m),{type:"primary",onClick:s[2]||(s[2]=n=>a.$router.push({name:"new-thread",params:{forumId:t.forumId}}))},{default:o(()=>[l("新主题")]),_:1})]),_:1}),y.value?(d(),_(e(c),{key:1,wrap:!1},{default:o(()=>[r(e(Fe),{value:v.value,"onUpdate:value":s[3]||(s[3]=n=>v.value=n),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":"",onKeyup:_e(P,["enter"])},null,8,["value"]),r(e(m),{type:"primary",onClick:P},{default:o(()=>[l("搜索")]),_:1}),r(e(m),{type:"default",onClick:Z},{default:o(()=>[l("清空")]),_:1})]),_:1})):k("",!0),r(Ne),r(Le,{ref_key:"ThreadListCom",ref:M,"threads-list-data":se.value,"new-window-to-post":e(S),"show-this":!e(D),onWithdrawDelayThreadSuccess:q},null,8,["threads-list-data","new-window-to-post","show-this"]),r(e(c),{align:"center"},{default:o(()=>[r(e(m),{type:t.delay?"default":"primary",onClick:ee},{default:o(()=>[l(F(t.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),r(De,{page:x.value,"onUpdate:page":[s[4]||(s[4]=n=>x.value=n),ae],"last-page":e(D)?1:e(T).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Be,(d(),_(be,{to:"#topbar-nav"},[r(N,{to:"/",class:"flex-item-center"},{default:o(()=>[r(e(Oe),{style:ke({maxWidth:e(i).isMobile?"120px":"900px"}),tooltip:!1},{default:o(()=>{var n;return[l(F((n=e(h).forumData(a.forumId))==null?void 0:n.name),1)]}),_:1},8,["style"]),r(e(Ue),{round:"",class:"forum-tag",size:e(i).isMobile?"small":"medium"},{default:o(()=>[l(F(a.forumId),1)]),_:1},8,["size"])]),_:1})])),r($e,{mode:"forum",ref_key:"SidebarCom",ref:K,onRefresh:s[5]||(s[5]=n=>q(!0)),onNewThread:s[6]||(s[6]=n=>a.$router.push({name:"new-thread",params:{forumId:t.forumId}}))},null,512)]),_:1})}}}),ca=Ce(Ge,[["__scopeId","data-v-49edc6e6"]]);export{ca as default};
