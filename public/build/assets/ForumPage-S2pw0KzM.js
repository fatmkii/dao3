import{b as W,e as oe,m as ne,w as le,n as ue,$ as p,o as $,d as L,p as ie,q as de,r as pe,A as d,M as _,f as o,a as e,l as me,g as ce,U as fe,F as b,H as r,G as k,C as he,Q as ge,t as B,v as m,z as l,N as ve,k as c,x as ye,s as F,y as _e,B as be,R as ke,O as we,j as A,S as f,D as O,E as Ie,_ as Se}from"./app-BFaYVfH7.js";import{u as Ce,t as G}from"./forums-DotqKT9P.js";import{s as z}from"./subtitles-DW7M559j.js";import{_ as xe}from"./loudspeaker-DptDFejG.js";import{S as De,L as Te,a as Ne}from"./LoudspeakerComponent-Cuo9_D6p.js";import{T as $e}from"./ThreadList-CZyRxoIn.js";import{_ as Le}from"./FInput.vue_vue_type_script_setup_true_lang-ILBdArVF.js";import{N as Fe}from"./Ellipsis-DBwg_3P4.js";import{N as Oe,a as ze}from"./Skeleton-BDeW17dT.js";import{N as Me}from"./Tag-BfTfB1JH.js";import"./Pagination-BvGBBUfa.js";import"./use-locale-C17arxJm.js";import"./prop-DfVitj0l.js";import"./Input-BltiRQhQ.js";import"./Select-dFTW69gA.js";import"./Forward-B3yujI_5.js";import"./Spin-DFE76daC.js";import"./showDialog-CJZGKknR.js";import"./browseLogger-ByKXR6JI.js";import"./_createCompounder-tJsxabxA.js";import"./use-houdini-C9xfGtiI.js";function Ue(){const u=W();oe(()=>{u.showTopbarNav=!1}),ne(()=>{u.showTopbarNav=!0})}const H=u=>(ke("data-v-49edc6e6"),u=u(),we(),u),Pe={key:0,class:"carousel-box"},Re={key:0,class:"carousel-box"},je=["src"],qe=H(()=>A("div",{style:{"margin-left":"auto"}},null,-1)),Ee=H(()=>A("div",{style:{height:"50px"}},null,-1)),Be=le({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(u){var E;me(a=>({"7b4adc69":e(i).bannerHeight}));const w=ue(),i=W(),h=Ce(),g=ce(),Q=p(null);p();const M=p();Ue();const t=u;document.title=((E=h.forumData(t.forumId))==null?void 0:E.name)??"小火锅";const I=$("banner_hiden",!1),S=$("new_window_to_post",!1);function K(){return f(c,{style:"padding:6px 8px",vertical:!0},()=>[f(O,{checked:I.value,"onUpdate:checked":a=>I.value=a,label:"隐藏版头"}),f(O,{checked:S.value,"onUpdate:checked":a=>S.value=a,label:"新窗口打开"})])}const J=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:K}],C=$("subtitles_included",z),U=L(()=>z.filter(a=>!C.value.includes(a)));function V(){return f(Ie,{value:C.value,"onUpdate:value":a=>C.value=a},()=>[f(c,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(z).map(a=>f(O,{value:a,label:a}))])])}const X=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:V}],v=p(t.search),y=p(!!t.search);function P(){g.push({name:"forum",params:{forumId:t.forumId,page:1},query:{search:v.value||void 0}})}function Y(){v.value=void 0,y.value=!1,g.push({name:"forum",params:{forumId:t.forumId,page:1}})}function Z(){g.push({name:"forum",params:{forumId:t.forumId,page:1},query:{delay:t.delay?void 0:"true"}})}const x=p(t.page);function ee(a){g.push({name:"forum",params:{forumId:t.forumId,page:a},query:{search:t.search,delay:t.delay?"true":void 0}})}ie(()=>t.page,a=>x.value=a);const R=L(()=>({forumId:t.forumId,binggan:w.binggan,page:t.page,threadsPerPage:50,subtitlesExcluded:U.value,searchTitle:t.search,delay:t.delay})),{loading:D,data:T,onSuccess:Ge}=de(()=>G(R.value),[()=>t.forumId,()=>t.page,()=>t.search,()=>t.delay,U],{initialData:[],immediate:!0}),j=p(!1),{fetching:We,onSuccess:ae,fetch:te}=pe();function q(a=!1){var s;j.value=a,te(G(R.value)),(s=M.value)==null||s.reloadBrowseLogger()}ae(()=>{j.value&&window.$message.success("已刷新数据")});const re=L(()=>{if(D.value)return[];if(w.userData.binggan.use_pingbici){const a=i.userCustom.pingbiciIngnoreCase?"gi":"g";return T.value.threads_data.data.filter(s=>{for(let N of w.userData.pingbici.title_pingbici)if(new RegExp(N,a).test(s.title))return!1;return!0})}else return T.value.threads_data.data});return(a,s)=>{const N=fe("router-link");return d(),_(e(c),{vertical:""},{default:o(()=>[e(I)?k("",!0):(d(),b("div",Pe,[e(h).forumsDataLoading?(d(),b("div",Re,[r(e(Oe),{class:"carousel-skeleton",sharp:""})])):k("",!0),e(h).forumsDataLoading?k("",!0):(d(),_(e(ze),{key:1,"show-arrow":"",trigger:e(i).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:o(()=>{var n;return[(d(!0),b(he,null,ge((n=e(h).forumData(a.forumId))==null?void 0:n.banners,se=>(d(),b("img",{src:se,class:"carousel-img"},null,8,je))),256))]}),_:1},8,["trigger"]))])),r(e(c),{style:{"margin-top":"8px"},size:"small"},{default:o(()=>[r(e(B),{trigger:e(i).isMobile?"click":"hover",options:J,placement:"bottom-start"},{default:o(()=>[r(e(m),null,{default:o(()=>[l("功能")]),_:1})]),_:1},8,["trigger"]),r(e(B),{trigger:e(i).isMobile?"click":"hover",options:X,placement:"bottom-start"},{default:o(()=>[r(e(m),null,{default:o(()=>[l("筛选")]),_:1})]),_:1},8,["trigger"]),r(e(ve),{size:e(i).isMobile?28:34},{default:o(()=>[r(e(De),{style:{cursor:"pointer"},onClick:s[0]||(s[0]=n=>y.value=!y.value)})]),_:1},8,["size"]),qe,r(e(m),{type:"primary",onClick:s[1]||(s[1]=n=>a.$router.push({name:"loudspeaker"}))},{default:o(()=>[l("大喇叭")]),_:1}),r(e(m),{type:"primary",onClick:s[2]||(s[2]=n=>a.$router.push({name:"new-thread",params:{forumId:t.forumId}}))},{default:o(()=>[l("新主题")]),_:1})]),_:1}),y.value?(d(),_(e(c),{key:1,wrap:!1},{default:o(()=>[r(e(Le),{value:v.value,"onUpdate:value":s[3]||(s[3]=n=>v.value=n),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":"",onKeyup:ye(P,["enter"])},null,8,["value"]),r(e(m),{type:"primary",onClick:P},{default:o(()=>[l("搜索")]),_:1}),r(e(m),{type:"default",onClick:Y},{default:o(()=>[l("清空")]),_:1})]),_:1})):k("",!0),r(Te),r($e,{ref_key:"ThreadListCom",ref:M,"threads-list-data":re.value,"new-window-to-post":e(S),"show-this":!e(D),onWithdrawDelayThreadSuccess:q},null,8,["threads-list-data","new-window-to-post","show-this"]),r(e(c),{align:"center"},{default:o(()=>[r(e(m),{type:t.delay?"default":"primary",onClick:Z},{default:o(()=>[l(F(t.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),r(xe,{page:x.value,"onUpdate:page":[s[4]||(s[4]=n=>x.value=n),ee],"last-page":e(D)?1:e(T).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Ee,(d(),_(_e,{to:"#topbar-nav"},[r(N,{to:"/",class:"flex-item-center"},{default:o(()=>[r(e(Fe),{style:be({maxWidth:e(i).isMobile?"120px":"900px"}),tooltip:!1},{default:o(()=>{var n;return[l(F((n=e(h).forumData(a.forumId))==null?void 0:n.name),1)]}),_:1},8,["style"]),r(e(Me),{round:"",class:"forum-tag",size:e(i).isMobile?"small":"medium"},{default:o(()=>[l(F(a.forumId),1)]),_:1},8,["size"])]),_:1})])),r(Ne,{mode:"forum",ref_key:"SidebarCom",ref:Q,onRefresh:s[5]||(s[5]=n=>q(!0)),onNewThread:s[6]||(s[6]=n=>a.$router.push({name:"new-thread",params:{forumId:t.forumId}}))},null,512)]),_:1})}}}),ma=Se(Be,[["__scopeId","data-v-49edc6e6"]]);export{ma as default};
