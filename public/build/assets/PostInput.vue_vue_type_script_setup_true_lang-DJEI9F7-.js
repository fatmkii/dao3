import{x as G,z as Y,A as M,V as j,aQ as Oe,q as X,b as p,w as me,F as V,t as e,Q as de,K as l,R as t,S as ue,T as J,U as O,a1 as Z,X as u,_ as oe,Y as N,at as we,an as Ke,W as te,Z as ce,i as De,aL as be,a7 as Ue,a8 as Be,r as We,aR as Ae,aS as Le,aH as Pe,aM as qe,aJ as Te,aA as Je,$ as re,J as ye,aO as Qe,aP as Se,C as he,G as Re,N as ne,P as Ze,u as et,a9 as je,a0 as ie,aK as tt,M as lt}from"./vendor-DamaS_bj.js";import{u as le,b as se,f as E,d as ee,c as F,k as Ne,w as at,l as Ve,m as nt,p as ot,a as st,r as Ee,e as _e}from"./app-CRZ7Digb.js";import{s as it}from"./showDialog-DfAZGtWi.js";import{b as ut,c as rt,d as He,e as dt,g as vt,f as pt,i as mt,_ as ct,D as ft}from"./emojiData-BZl9PvKN.js";import{i as Xe,a as Ye}from"./inputNumberFormat-BPxWRFt_.js";const gt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},ht=j("path",{d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",fill:"currentColor"},null,-1),wt=[ht],bt=G({name:"Minus",render:function(D,$){return M(),Y("svg",gt,wt)}}),yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},kt=j("path",{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",fill:"currentColor"},null,-1),Ct=[kt],xt=G({name:"Plus",render:function(D,$){return M(),Y("svg",yt,Ct)}}),_t={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Mt=j("g",{fill:"none"},[j("path",{d:"M8.066 18.943l6.5-14.5a.75.75 0 0 1 1.404.518l-.036.096l-6.5 14.5a.75.75 0 0 1-1.404-.518l.036-.096l6.5-14.5l-6.5 14.5zM2.22 11.47l4.25-4.25a.75.75 0 0 1 1.133.976l-.073.085L3.81 12l3.72 3.719a.75.75 0 0 1-.976 1.133l-.084-.073l-4.25-4.25a.75.75 0 0 1-.073-.976l.073-.084l4.25-4.25l-4.25 4.25zm14.25-4.25a.75.75 0 0 1 .976-.073l.084.073l4.25 4.25a.75.75 0 0 1 .073.976l-.073.085l-4.25 4.25a.75.75 0 0 1-1.133-.977l.073-.084L20.19 12l-3.72-3.72a.75.75 0 0 1 0-1.06z",fill:"currentColor"})],-1),It=[Mt],$t=G({name:"Code24Regular",render:function(D,$){return M(),Y("svg",_t,It)}}),zt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Tt=j("g",{fill:"none"},[j("path",{d:"M6.25 3A3.25 3.25 0 0 0 3 6.25v13.004a.75.75 0 0 0 1.5 0V6.25c0-.966.784-1.75 1.75-1.75h11.5c.967 0 1.75.784 1.75 1.75v4.982c.48-.19.994-.263 1.5-.22V6.25A3.25 3.25 0 0 0 17.75 3H6.25zm6.948 15.572L19.1 12.67a2.285 2.285 0 1 1 3.233 3.232l-5.903 5.902a2.684 2.684 0 0 1-1.247.707l-1.83.457c-.05.013-.1.022-.15.027c-.59.204-2.979.574-3.827-.088c-.574-.448-.46-1.334-.218-1.818c.04-.078-.02-.18-.105-.166c-.66.103-1.243.45-1.827.799c-.783.468-1.57.936-2.549.815c-.979-.122-1.468-.726-1.71-1.255c-.099-.216.18-.401.388-.287c.469.255 1.106.496 1.631.38c.375-.084.904-.458 1.496-.877c1.066-.753 2.337-1.653 3.292-1.268c.84.337 1.46 1.15 1.03 2.113c-.053.118 0 .264.127.293c.423.097.778.066 1.133-.105l.428-1.712c.118-.472.362-.903.706-1.247z",fill:"currentColor"})],-1),Ht=[Tt],At=G({name:"DrawShape24Regular",render:function(D,$){return M(),Y("svg",zt,Ht)}}),Lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Dt=j("g",{fill:"none"},[j("path",{d:"M15.87 2.669l4.969 4.968a2.25 2.25 0 0 1 0 3.182l-8.682 8.68l6.098.001a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.649.743l-.101.007l-8.41.001a2.244 2.244 0 0 1-1.715-.655l-4.968-4.969a2.25 2.25 0 0 1 0-3.182l9.526-9.526a2.25 2.25 0 0 1 3.182 0zM5.709 11.768l-1.487 1.488a.75.75 0 0 0 0 1.06l4.969 4.969c.146.146.338.22.53.22l.03-.005l.038.002a.747.747 0 0 0 .463-.217l1.486-1.487l-6.03-6.03zm8.04-8.039l-6.98 6.978l6.03 6.03l6.979-6.978a.75.75 0 0 0 0-1.061l-4.969-4.969a.75.75 0 0 0-1.06 0z",fill:"currentColor"})],-1),Ut=[Dt],Bt=G({name:"Eraser24Regular",render:function(D,$){return M(),Y("svg",Lt,Ut)}}),Pt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},St=j("path",{d:"M240 424v-96c116.4 0 159.39 33.76 208 96c0-119.23-39.57-240-208-240V88L64 256z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),Rt=[St],jt=G({name:"ArrowUndoOutline",render:function(D,$){return M(),Y("svg",Pt,Rt)}}),Nt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Et=Oe('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M448 341.37V170.61A32 32 0 0 0 432.11 143l-152-88.46a47.94 47.94 0 0 0-48.24 0L79.89 143A32 32 0 0 0 64 170.61v170.76A32 32 0 0 0 79.89 369l152 88.46a48 48 0 0 0 48.24 0l152-88.46A32 32 0 0 0 448 341.37z"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M69 153.99l187 110l187-110"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 463.99v-200"></path><ellipse cx="256" cy="152" rx="24" ry="16" fill="currentColor"></ellipse><ellipse cx="208" cy="296" rx="16" ry="24" fill="currentColor"></ellipse><ellipse cx="112" cy="328" rx="16" ry="24" fill="currentColor"></ellipse><ellipse cx="304" cy="296" rx="16" ry="24" fill="currentColor"></ellipse><ellipse cx="400" cy="240" rx="16" ry="24" fill="currentColor"></ellipse><ellipse cx="304" cy="384" rx="16" ry="24" fill="currentColor"></ellipse><ellipse cx="400" cy="328" rx="16" ry="24" fill="currentColor"></ellipse>',10),Ot=[Et],Wt=G({name:"DiceOutline",render:function(D,$){return M(),Y("svg",Nt,Ot)}}),Vt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xt=Oe('<path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 0 0 352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 0 0-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88c26 9 49.25-9.61 71.27-37c25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16c41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><circle cx="292" cy="224" r="20" fill="currentColor"></circle><path d="M336 288a20 20 0 1 1 20-19.95A20 20 0 0 1 336 288z" fill="currentColor"></path><circle cx="336" cy="180" r="20" fill="currentColor"></circle><circle cx="380" cy="224" r="20" fill="currentColor"></circle><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M208 224h-96"></path>',7),Yt=[Xt],Ft=G({name:"GameControllerOutline",render:function(D,$){return M(),Y("svg",Vt,Yt)}}),Gt=G({__name:"RollModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(R,{expose:D,emit:$}){const U=le(),i=se(),x=R,T=X(()=>{let m=[];if(v.value>0&&c.value>0){for(var s=0;s<v.value;s++)m[s]=Math.floor(Math.random()*c.value)+1;return m.join()}else return null}),A=p(),k=p(),v=p(1),c=p(100),H=p(!1);function _(){H.value=!0}D({show:_});const B=$,{loading:r,send:b,onSuccess:f}=me(m=>ut(m),{immediate:!1});function y(){if(!v.value){window.$message.error("请填写骰子数量");return}if(!c.value){window.$message.error("请填写骰子数量");return}const m={binggan:i.binggan,thread_id:x.threadId,forum_id:x.forumId,roll_name:A.value,roll_event:k.value,roll_num:v.value,roll_range:c.value};b(m)}return f(()=>{B("refreshPostsList"),H.value=!1}),(m,s)=>(M(),V(e(de),{show:H.value,"onUpdate:show":s[6]||(s[6]=g=>H.value=g),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e(U).modalMaxWidth}),title:"Roll点",closable:"",onClose:s[5]||(s[5]=g=>H.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:y,disabled:e(r)},{default:l(()=>[...s[12]||(s[12]=[u("Roll it!",-1)])]),_:1},8,["disabled"]),t(e(F),{onClick:s[4]||(s[4]=g=>H.value=!1)},{default:l(()=>[...s[13]||(s[13]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Z),null,{default:l(()=>[...s[7]||(s[7]=[u(" 输出参考： ",-1)])]),_:1}),t(e(Z),null,{default:l(()=>[u(oe(A.value?`「${A.value}」，`:"")+" "+oe(k.value?`「${k.value}」的结果：`:"")+" "+oe(`${v.value} d ${c.value} = 「${T.value}」`),1)]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...s[8]||(s[8]=[u("Roll点昵称",-1)])]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:A.value,"onUpdate:value":s[0]||(s[0]=g=>A.value=g)},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...s[9]||(s[9]=[u("Roll点事件",-1)])]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:k.value,"onUpdate:value":s[1]||(s[1]=g=>k.value=g)},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...s[10]||(s[10]=[u("骰子数量",-1)])]),_:1}),t(e(we),{max:100,min:1,placeholder:"必须填写",value:v.value,"onUpdate:value":s[2]||(s[2]=g=>v.value=g)},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...s[11]||(s[11]=[u("骰子大小",-1)])]),_:1}),t(e(we),{max:1e4,min:1,placeholder:"必须填写",value:c.value,"onUpdate:value":s[3]||(s[3]=g=>c.value=g)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Kt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},qt=j("defs",null,null,-1),Jt=j("path",{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92c-19.1.1-36.8-5.4-52-15l-54 55c29.1 22.4 65.9 36 106 36c93.8 0 170-75.1 170-168z",fill:"currentColor"},null,-1),Qt=j("path",{d:"M833 446h-60c-4.4 0-8 3.6-8 8c0 140.3-113.7 254-254 254c-63 0-120.7-23-165-61l-54 54c48.9 43.2 110.8 72.3 179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328c0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9c-3.1-3-8.1-3-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68c-10.5-27.9-16.3-58.2-16.2-89.8c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8c0 53 12.5 103 34.6 147.4l-137 137c-3.1 3.1-3.1 8.2 0 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92c46 0 84.1 32.3 92.3 74.7L417 401z",fill:"currentColor"},null,-1),Zt=[qt,Jt,Qt],el=G({name:"AudioMutedOutlined",render:function(D,$){return M(),Y("svg",Kt,Zt)}}),tl={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},ll=j("path",{d:"M911.5 700.7a8 8 0 0 0-10.3-4.8L840 718.2V180c0-37.6-30.4-68-68-68H252c-37.6 0-68 30.4-68 68v538.2l-61.3-22.3c-.9-.3-1.8-.5-2.7-.5c-4.4 0-8 3.6-8 8V763c0 3.3 2.1 6.3 5.3 7.5L501 910.1c7.1 2.6 14.8 2.6 21.9 0l383.8-139.5c3.2-1.2 5.3-4.2 5.3-7.5v-59.6c0-1-.2-1.9-.5-2.8zM512 837.5l-256-93.1V184h512v560.4l-256 93.1zM660.6 312h-54.5c-3 0-5.8 1.7-7.1 4.4l-84.7 168.8H511l-84.7-168.8a8 8 0 0 0-7.1-4.4h-55.7c-1.3 0-2.6.3-3.8 1c-3.9 2.1-5.3 7-3.2 10.8l103.9 191.6h-57c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76v39h-76c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76V704c0 4.4 3.6 8 8 8h49.9c4.4 0 8-3.6 8-8v-63.5h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8h-76.3v-39h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8H564l103.7-191.6c.6-1.2 1-2.5 1-3.8c-.1-4.3-3.7-7.9-8.1-7.9z",fill:"currentColor"},null,-1),al=[ll],nl=G({name:"MoneyCollectOutlined",render:function(D,$){return M(),Y("svg",tl,al)}}),ol=["src"],sl=G({__name:"CaptchaModal",emits:["waterUnlockOnSuccess"],setup(R,{expose:D,emit:$}){const U=le(),i=se(),x=p(),T=X(()=>c.value.captcha_key),A=p(!1);function k(){A.value=!0,_()}D({show:k});const v=$,{data:c,loading:H,send:_}=me(Ne,{immediate:!1}),{fetch:B}=Ke();function r(){B(Ne())}const{loading:b,send:f,onSuccess:y,onError:m}=me(g=>at(g),{immediate:!1});function s(){if(!x.value){window.$message.error("验证码不能为空");return}const g={binggan:i.binggan,captcha_code:x.value,captcha_key:T.value};f(g),y(()=>{x.value="",A.value=!1,v("waterUnlockOnSuccess")}),m(()=>{x.value="",r()})}return(g,n)=>(M(),V(e(de),{show:A.value,"onUpdate:show":n[3]||(n[3]=z=>A.value=z),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e(U).modalMaxWidth}),title:"验证码",closable:"",onClose:n[2]||(n[2]=z=>A.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:s,loading:e(b),disabled:e(b)},{default:l(()=>[...n[7]||(n[7]=[u("提交",-1)])]),_:1},8,["loading","disabled"]),t(e(F),{onClick:n[1]||(n[1]=z=>A.value=!1)},{default:l(()=>[...n[8]||(n[8]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Z),null,{default:l(()=>[...n[4]||(n[4]=[u(" 嗷……你可能刷太多了，休息一下吧。 ",-1)])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"},class:"round"},{default:l(()=>[...n[5]||(n[5]=[u("输入",-1)])]),_:1}),t(e(ee),{placeholder:"请输入验证码",maxlength:"4","show-count":"",value:x.value,"onUpdate:value":n[0]||(n[0]=z=>x.value=z),onKeyup:ce(s,["enter"])},null,8,["value"])]),_:1}),e(H)?te("",!0):(M(),Y("img",{key:0,src:"data:image/png;base64,"+e(c).captcha_img,style:{"max-width":"200px"},onClick:r},null,8,ol)),t(e(Z),null,{default:l(()=>[...n[6]||(n[6]=[u(" 点击可更换验证码。不区分大小写。 ",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),il=G({__name:"BattleModal",props:{threadId:{},forumId:{},randomHeadsGroup:{}},emits:["refreshPostsList"],setup(R,{expose:D,emit:$}){const U=le(),i=se(),x=p(null),T=R,A=X(()=>{const g=[{value:1,label:"共通",available:!0}];return rt.forEach(n=>{n.value===T.randomHeadsGroup&&g.push(n)}),g}),k=X(()=>{const g=He[c.value-1];if(c.value===1){const n=i.userData.my_battle_chara.filter(z=>!z.not_use).map((z,W)=>({value:W+240,label:z.name}));return g.concat(n)}else return g}),v=p(1),c=p(T.randomHeadsGroup),H=p(100);De(c,g=>{g===1?v.value=He[g-1][8].value:v.value=He[g-1][0].value},{immediate:!0});const{loading:_,send:B,onSuccess:r,onError:b}=me(g=>dt(g),{immediate:!1});function f(g){const{timestamp:n,newPostKey:z}=vt(g?.isTrusted??!0,T.threadId,i.binggan),W={binggan:i.binggan,forum_id:T.forumId,thread_id:T.threadId,battle_olo:H.value,chara_id:v.value>=240?v.value-240:v.value,is_custom_chara:v.value>=240,chara_group:c.value-1,new_post_key:z,timestamp:n};B(W)}r(()=>{s("refreshPostsList"),y.value=!1}),b(g=>{g.error.cause!==void 0&&g.error.cause.code===244291&&x.value?.show()});const y=p(!1);function m(){y.value=!0}D({show:m});const s=$;return(g,n)=>(M(),V(e(de),{show:y.value,"onUpdate:show":n[5]||(n[5]=z=>y.value=z),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e(U).modalMaxWidth}),title:"表情包大乱斗！",closable:"",onClose:n[4]||(n[4]=z=>y.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:f,loading:e(_)},{default:l(()=>[...n[10]||(n[10]=[u("提交",-1)])]),_:1},8,["loading"]),t(e(F),{onClick:n[3]||(n[3]=z=>y.value=!1)},{default:l(()=>[...n[11]||(n[11]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Z),null,{default:l(()=>[...n[6]||(n[6]=[u("小斗怡情，大斗伤身，强斗奥飞湮灭",-1)])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...n[7]||(n[7]=[u("主题",-1)])]),_:1}),t(e(be),{value:c.value,"onUpdate:value":n[0]||(n[0]=z=>c.value=z),options:A.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...n[8]||(n[8]=[u("角色",-1)])]),_:1}),t(e(be),{value:v.value,"onUpdate:value":n[1]||(n[1]=z=>v.value=z),options:k.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...n[9]||(n[9]=[u("下注",-1)])]),_:1}),t(e(we),{value:H.value,"onUpdate:value":n[2]||(n[2]=z=>H.value=z),max:1e6,min:1,step:100,parse:e(Ye),format:e(Xe),onKeyup:ce(f,["enter"])},null,8,["value","parse","format"])]),_:1})]),_:1}),t(sl,{ref_key:"CaptchaModalCom",ref:x,onWaterUnlockOnSuccess:f},null,512)]),_:1},8,["style"])]),_:1},8,["show"]))}}),ul=G({__name:"CodeModal",emits:["insertCode"],setup(R,{expose:D,emit:$}){const U=le(),i=p(0),x=p(),T=p(),A=[{value:0,label:"折叠内容"},{value:1,label:"超链接"},{value:2,label:"图片"},{value:3,label:"删除线"}],k=X(()=>[{prepend_1:"显示内容",prepend_2:"隐藏内容",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"显示内容",inputDefault_2:"隐藏内容",insertText:`<details><summary>${x.value}</summary>${T.value}</details>`},{prepend_1:"显示文字",prepend_2:"链接网址",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"点我跳转",inputDefault_2:"",insertText:`<a href="${T.value}">${x.value}</a>`},{prepend_1:"图片链接",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<img src="${x.value}">`},{prepend_1:"删除文字",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<del>${x.value}</del>`}]);De(i,()=>{x.value=k.value[i.value].inputDefault_1,T.value=k.value[i.value].inputDefault_2},{immediate:!0});function v(){_("insertCode",k.value[i.value].insertText),x.value=k.value[i.value].inputDefault_1,T.value=k.value[i.value].inputDefault_2,c.value=!1}const c=p(!1);function H(){c.value=!0}D({show:H});const _=$;return(B,r)=>(M(),V(e(de),{show:c.value,"onUpdate:show":r[5]||(r[5]=b=>c.value=b),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e(U).modalMaxWidth}),title:"快捷代码",closable:"",onClose:r[4]||(r[4]=b=>c.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:v},{default:l(()=>[...r[8]||(r[8]=[u("插入",-1)])]),_:1}),t(e(F),{onClick:r[3]||(r[3]=b=>c.value=!1)},{default:l(()=>[...r[9]||(r[9]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Z),null,{default:l(()=>[...r[6]||(r[6]=[u("代码预览：",-1)])]),_:1}),t(e(Z),null,{default:l(()=>[u(oe(k.value[i.value].insertText),1)]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...r[7]||(r[7]=[u("代码内容",-1)])]),_:1}),t(e(be),{value:i.value,"onUpdate:value":r[0]||(r[0]=b=>i.value=b),options:A},null,8,["value"])]),_:1}),Ue(t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[u(oe(k.value[i.value].prepend_1),1)]),_:1}),t(e(ee),{value:x.value,"onUpdate:value":r[1]||(r[1]=b=>x.value=b),onKeyup:ce(v,["enter"])},null,8,["value"])]),_:1},512),[[Be,k.value[i.value].inputEnable_1]]),Ue(t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[u(oe(k.value[i.value].prepend_2),1)]),_:1}),t(e(ee),{value:T.value,"onUpdate:value":r[2]||(r[2]=b=>T.value=b),onKeyup:ce(v,["enter"])},null,8,["value"])]),_:1},512),[[Be,k.value[i.value].inputEnable_2]])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),rl=["width","height"],dl=["width","height"],vl=["onClick"],pl=["title","innerHTML","onClick"],ml=G({__name:"DrawerModal",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(R,{expose:D,emit:$}){const U=se();le();const i=R,x=p(!1);function T(){x.value=!0}D({show:T});const A=$,k=p(),v=X(()=>k.value?.getContext("2d")),c=p(),H=X(()=>c.value?.getContext("2d")),_=new Image;let B=!1;const r={x:0,y:0,width:0,height:0},b=p([]),f=p([]),y=p([]),m=p({lineWidth:3,lineColor:"#111111",shadowBlur:1}),s=p(!1),g=p(!1);let n=0,z=0;const W=X(()=>window.innerWidth>836?796:window.innerWidth-36),Q=X(()=>window.innerHeight>580?400:window.innerHeight-212),K=X(()=>[{title:"上一步",action:"prev",className:b.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>'},{title:"下一步",action:"next",className:f.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>'},{title:"橡皮擦",action:"eraser",className:b.value.length||f.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/></svg>'},{title:"清除",action:"clear",className:b.value.length||f.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/></svg>'},{title:"拖动背景",action:"drag",className:g.value?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor"  viewBox="0 0 16 16"> <path d="M6.75 1a.75.75 0 0 1 .75.75V8a.5.5 0 0 0 1 0V5.467l.086-.004c.317-.012.637-.008.816.027.134.027.294.096.448.182.077.042.15.147.15.314V8a.5.5 0 1 0 1 0V6.435a4.9 4.9 0 0 1 .106-.01c.316-.024.584-.01.708.04.118.046.3.207.486.43.081.096.15.19.2.259V8.5a.5.5 0 0 0 1 0v-1h.342a1 1 0 0 1 .995 1.1l-.271 2.715a2.5 2.5 0 0 1-.317.991l-1.395 2.442a.5.5 0 0 1-.434.252H6.035a.5.5 0 0 1-.416-.223l-1.433-2.15a1.5 1.5 0 0 1-.243-.666l-.345-3.105a.5.5 0 0 1 .399-.546L5 8.11V9a.5.5 0 0 0 1 0V1.75A.75.75 0 0 1 6.75 1zM8.5 4.466V1.75a1.75 1.75 0 1 0-3.5 0v5.34l-1.2.24a1.5 1.5 0 0 0-1.196 1.636l.345 3.106a2.5 2.5 0 0 0 .405 1.11l1.433 2.15A1.5 1.5 0 0 0 6.035 16h6.385a1.5 1.5 0 0 0 1.302-.756l1.395-2.441a3.5 3.5 0 0 0 .444-1.389l.271-2.715a2 2 0 0 0-1.99-2.199h-.581a5.114 5.114 0 0 0-.195-.248c-.191-.229-.51-.568-.88-.716-.364-.146-.846-.132-1.158-.108l-.132.012a1.26 1.26 0 0 0-.56-.642 2.632 2.632 0 0 0-.738-.288c-.31-.062-.739-.058-1.05-.046l-.048.002zm2.094 2.025z"/></svg>'}]),q=[{lineWidth:3,innerHTML:"🖌️",font_size:12},{lineWidth:6,innerHTML:"🖌️",font_size:16},{lineWidth:12,innerHTML:"🖌️",font_size:20}];function d(){const w=new ImageData(W.value,Q.value);y.value.push(w)}We(()=>{d()});function P(){v.value.lineWidth=m.value.lineWidth,v.value.shadowBlur=m.value.shadowBlur,v.value.shadowColor=m.value.lineColor,v.value.strokeStyle=m.value.lineColor,v.value.lineCap="round",v.value.lineJoin="round"}function ve(w){if(B)if(g.value){const o=w.target;let C,I;w instanceof MouseEvent?(C=w.clientX-o.getBoundingClientRect().x,I=w.clientY-o.getBoundingClientRect().y):(C=w.changedTouches[0].clientX-o.getBoundingClientRect().x,I=w.changedTouches[0].clientY-o.getBoundingClientRect().y),c.value.height=c.value.height;let S={x:r.x+(C-n),y:r.y+(I-z),width:r.width,height:r.height};ae(_,S)}else{v.value.beginPath(),v.value.moveTo(n,z);const o=w.target;let C,I;w instanceof MouseEvent?(C=w.clientX-o.getBoundingClientRect().x,I=w.clientY-o.getBoundingClientRect().y):(C=w.changedTouches[0].clientX-o.getBoundingClientRect().x,I=w.changedTouches[0].clientY-o.getBoundingClientRect().y),v.value.globalCompositeOperation=s.value?"destination-out":"source-over",v.value.lineTo(C,I),[n,z]=[C,I],v.value.stroke()}}function ke(w){if(g.value){const o=w.target;let C,I;w instanceof MouseEvent?(C=w.clientX-o.getBoundingClientRect().x,I=w.clientY-o.getBoundingClientRect().y):(C=w.changedTouches[0].clientX-o.getBoundingClientRect().x,I=w.changedTouches[0].clientY-o.getBoundingClientRect().y),r.x+=C-n,r.y+=I-z,B=!1}else{const o=v.value.getImageData(0,0,k.value.width,k.value.height);f.value.length?(y.value=[],y.value=y.value.concat(b.value),y.value.push(o),f.value=[]):y.value.push(o),B=!1}}function Ce(w){if(g.value){const o=w.target;let C,I;w instanceof MouseEvent?(C=w.clientX-o.getBoundingClientRect().x,I=w.clientY-o.getBoundingClientRect().y):(C=w.changedTouches[0].clientX-o.getBoundingClientRect().x,I=w.changedTouches[0].clientY-o.getBoundingClientRect().y),n=C,z=I,B=!0}else{B=!0;const o=w.target;let C,I;w instanceof MouseEvent?(C=w.clientX-o.getBoundingClientRect().x,I=w.clientY-o.getBoundingClientRect().y):(C=w.changedTouches[0].clientX-o.getBoundingClientRect().x,I=w.changedTouches[0].clientY-o.getBoundingClientRect().y),P(),n=C,z=I;const S=v.value.getImageData(0,0,k.value.width,k.value.height);b.value.push(S)}}function Me(w){m.value.lineWidth=w,s.value=!1,g.value=!1}function fe(w){switch(w){case"prev":if(b.value.length){const o=b.value.pop(),C=y.value[b.value.length+1];f.value.push(C),v.value.putImageData(o,0,0)}break;case"next":if(f.value.length){const o=f.value.pop(),C=y.value[y.value.length-f.value.length-2];b.value.push(C),v.value.putImageData(o,0,0)}break;case"clear":v.value.clearRect(0,0,k.value.width,k.value.height),b.value=[],f.value=[],y.value=[y.value[0]];break;case"eraser":s.value=!0;break;case"drag":g.value=!0;break}}function Ie(w){if(w.file.file){var o=new FileReader;o.readAsDataURL(w.file.file),o.onload=C=>{_.src=C.target.result,_.onload=function(){var I=c,S=_;r.width=S.width,r.height=S.height,S.width/S.height>=I.value.width/I.value.height?S.width>I.value.width&&(r.width=I.value.width,r.height=S.height*I.value.width/S.width):S.height>I.value.height&&(r.width=S.width*I.value.height/S.height,r.height=I.value.height),ae(S,r)}}}}function ae(w,o){H.value.drawImage(w,o.x,o.y,o.width,o.height)}const pe=p(!1);function ge(){let w=new Image;w.src=k.value.toDataURL("image/png"),w.onload=()=>{H.value.drawImage(w,0,0),o(c.value)};function o(I){I.toBlob(S=>{S&&C(S)},"image/png")}function C(I){const S={binggan:U.binggan,file:I,mode:"draw",thread_id:i.threadId,forum_id:i.forumId};pe.value=!0,Ve(S).then(xe=>{A("insertImage",xe.file_url),pe.value=!1,x.value=!1}).catch(()=>{pe.value=!1})}}return(w,o)=>(M(),V(e(de),{show:x.value,"onUpdate:show":o[5]||(o[5]=C=>x.value=C),"display-directive":"show"},{default:l(()=>[t(e(ue),{style:J({maxWidth:W.value+4+"px"}),title:"涂鸦板",closable:"",onClose:o[4]||(o[4]=C=>x.value=!1),size:"small","content-style":{padding:"0px"}},{default:l(()=>[j("div",{id:"canvas-container",style:J({width:W.value+"px",height:Q.value+"px"})},[j("canvas",{id:"drawer-canvas-background",ref_key:"canvasBackground",ref:c,width:W.value,height:Q.value,onTouchmove:o[0]||(o[0]=Le(()=>{},["prevent"]))},null,40,rl),j("canvas",{id:"drawer-canvas",ref_key:"canvas",ref:k,class:Pe({painting:!g.value,dragging:g.value}),width:W.value,height:Q.value,onTouchmove:[o[1]||(o[1]=Le(()=>{},["prevent"])),ve],onMousedown:Ce,onMouseup:ke,onMousemove:ve,onTouchstart:Ce,onTouchend:ke},null,42,dl)],4),t(e(qe),{"x-gap":"6",cols:4},{default:l(()=>[t(e(Te),{span:"1"},{default:l(()=>[o[6]||(o[6]=j("div",null,"颜色",-1)),t(e(Je),{value:m.value.lineColor,"onUpdate:value":o[2]||(o[2]=C=>m.value.lineColor=C),modes:["hex"],"show-alpha":!1},null,8,["value"])]),_:1}),t(e(Te),{span:"1"},{default:l(()=>[o[7]||(o[7]=j("div",null,"画笔",-1)),t(e(O),{id:"canvas-brush",size:"small",align:"center"},{default:l(()=>[(M(),Y(re,null,ye(q,(C,I)=>j("span",{key:I,style:J({fontSize:C.font_size+"px"}),onClick:S=>Me(C.lineWidth)},oe(C.innerHTML),13,vl)),64))]),_:1})]),_:1}),t(e(Te),{span:"2"},{default:l(()=>[o[8]||(o[8]=j("div",null,"操作",-1)),t(e(O),{id:"canvas-control",size:"small"},{default:l(()=>[(M(!0),Y(re,null,ye(K.value,(C,I)=>(M(),Y("span",{key:I,title:C.title,class:Pe([C.className]),innerHTML:C.innerHTML,onClick:S=>fe(C.action)},null,10,pl))),128))]),_:1})]),_:1})]),_:1})]),action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Ae),{"default-upload":!1,onChange:Ie,"show-file-list":!1},{default:l(()=>[t(e(F),null,{default:l(()=>[...o[9]||(o[9]=[u("加载图片",-1)])]),_:1})]),_:1}),t(e(F),{type:"primary",onClick:ge,disabled:w.userIsLocked,loading:pe.value},{default:l(()=>[...o[10]||(o[10]=[u("上传",-1)])]),_:1},8,["disabled","loading"]),t(e(F),{onClick:o[3]||(o[3]=C=>x.value=!1)},{default:l(()=>[...o[11]||(o[11]=[u("关闭",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),cl=["onClick"],fl=["src"],gl=G({__name:"EmojiTab",props:{randomHeadsGroup:{default:1},autoHide:{type:Boolean,default:!0}},emits:["appendEmoji"],setup(R,{emit:D}){const $=se(),U=le(),i=R,x=X(()=>{let r=0,b=0;return U.isMobile&&(U.userCustom.sidebarLeft?r=20:b=20),{paddingLeft:r+"px",paddingRight:b+"px"}}),T=p(),A=X(()=>{const r=pt.filter(b=>!$.userData.emoji_excluded.includes(b.id)&&(b.headsId===0||b.headsId===i.randomHeadsGroup));return $.userData.my_emoji&&r.unshift({id:0,headsId:0,name:"自定义",emojis:$.userData.my_emoji}),r}),k=D;function v(r,b){k("appendEmoji",r,b==="自定义"),i.autoHide&&(T.value=-1)}let c=!1;function H(r,b){return he("span",{onClick:()=>_(b),innerHTML:r})}function _(r){r===T.value&&(c=!0,T.value=-1)}function B(r,b){return c?(c=!1,!1):!0}return(r,b)=>(M(),V(e(Qe),{type:"line","bar-width":0,animated:"",onBeforeLeave:B,size:e(U).isMobile?"small":"medium","default-value":-1,value:T.value,"onUpdate:value":b[0]||(b[0]=f=>T.value=f)},{default:l(()=>[(M(!0),Y(re,null,ye(A.value,(f,y,m)=>(M(),V(e(Se),{name:f.id,tab:H(f.name,f.id)},{default:l(()=>[t(e(O),{size:"small",class:"emoji-container",style:J(x.value)},{default:l(()=>[(M(!0),Y(re,null,ye(f.emojis,(s,g,n)=>(M(),Y("div",{class:"emoji-box",onClick:z=>v(s,f.name)},[j("img",{src:s,class:"emoji-in-box"},null,8,fl)],8,cl))),256))]),_:2},1032,["style"])]),_:2},1032,["name","tab"]))),256)),t(e(Se),{name:-1,tab:"隐藏"})]),_:1},8,["size","value"]))}}),hl=G({__name:"HongbaoModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(R,{expose:D,emit:$}){const U=le(),i=se(),x=R,T=[{value:1,label:"口令红包 直接公开口令"},{value:2,label:"抢答红包 回复答对才公开口令"},{value:3,label:"暗号红包 抢完红包才公开口令"}],A=[{value:1,label:"随机olo"},{value:2,label:"定额olo"}],k=p(3e3),v=p(10),c=p(1),H=p(1),_=p(),B=p(),r=p([]),b=p(!1),f=p(),y=p(1);function m(q){q===1&&y.value<5&&(y.value+=1),q===-1&&y.value>1&&(r.value.splice(y.value-1,1),y.value-=1)}const{loading:s,send:g,onSuccess:n}=me(q=>mt(q),{immediate:!1});function z(){function q(){const d={binggan:i.binggan,forum_id:x.forumId,thread_id:x.threadId,hongbao_olo:k.value,hongbao_num:v.value,type:c.value,key_word_type:H.value,hongbao_key_word:_.value,hongbao_question:B.value,hongbao_message_json:r.value,hongbao_olo_hide:b.value,pic_url:f.value};g(d)}if(_.value===void 0){window.$message.error("必须填写“红包口令”喔");return}if(B.value===void 0&&[2,3].includes(H.value)){window.$message.error("抢答红包或者暗号红包时，必须填写“口令提示”喔");return}if(c.value===2&&k.value%v.value!==0){const d={title:"提醒",closable:!1,content:"olo总额不是红包个数的整倍数，多出的余数olo将在最后一个红包发出。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{q()}};window.$dialog.warning(d);return}q()}n(()=>{K("refreshPostsList"),W.value=!1});const W=p(!1);function Q(){W.value=!0}D({show:Q});const K=$;return(q,d)=>(M(),V(e(de),{show:W.value,"onUpdate:show":d[12]||(d[12]=P=>W.value=P),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e(U).modalMaxWidth}),title:"发起红包",closable:"",onClose:d[11]||(d[11]=P=>W.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:z,disabled:e(s),loading:e(s)},{default:l(()=>[...d[26]||(d[26]=[u("提交",-1)])]),_:1},8,["disabled","loading"]),t(e(F),{onClick:d[10]||(d[10]=P=>W.value=!1)},{default:l(()=>[...d[27]||(d[27]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[j("div",null,[t(e(Z),{depth:3},{default:l(()=>[...d[13]||(d[13]=[u("温馨提示：",-1)])]),_:1}),d[14]||(d[14]=u("在红包总额以外，会追加扣除7%手续费。 ",-1))]),j("div",null,[t(e(Z),{depth:3},{default:l(()=>[...d[15]||(d[15]=[u("总共扣除：",-1)])]),_:1}),t(e(Z),{type:"warning"},{default:l(()=>[u(oe(Math.ceil(k.value*(e(U).isDouble11?1.02:1.07))),1)]),_:1}),d[16]||(d[16]=u("个奥利奥 ",-1))]),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[17]||(d[17]=[u("红包类型",-1)])]),_:1}),t(e(be),{value:H.value,"onUpdate:value":d[0]||(d[0]=P=>H.value=P),options:T},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[18]||(d[18]=[u("olo类型",-1)])]),_:1}),t(e(be),{value:c.value,"onUpdate:value":d[1]||(d[1]=P=>c.value=P),options:A},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[19]||(d[19]=[u("红包个数",-1)])]),_:1}),t(e(we),{value:v.value,"onUpdate:value":d[2]||(d[2]=P=>v.value=P),max:50,min:5,step:5},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[20]||(d[20]=[u("olo总额",-1)])]),_:1}),t(e(we),{value:k.value,"onUpdate:value":d[3]||(d[3]=P=>k.value=P),max:1e6,min:3e3,step:1e3,parse:e(Ye),format:e(Xe)},null,8,["value","parse","format"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[21]||(d[21]=[u("红包口令",-1)])]),_:1}),t(e(ee),{value:_.value,"onUpdate:value":d[4]||(d[4]=P=>_.value=P),placeholder:"必填"},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[22]||(d[22]=[u("红包封面",-1)])]),_:1}),t(e(ee),{value:f.value,"onUpdate:value":d[5]||(d[5]=P=>f.value=P),placeholder:"（可选）填写图片的完整网址"},null,8,["value"])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[23]||(d[23]=[u("口令提示",-1)])]),_:1}),t(e(ee),{value:B.value,"onUpdate:value":d[6]||(d[6]=P=>B.value=P),placeholder:"抢答红包或者暗号红包时，必填"},null,8,["value"])]),_:1}),(M(!0),Y(re,null,ye(y.value,P=>(M(),V(e(N),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...d[24]||(d[24]=[u("回复留言",-1)])]),_:1}),t(e(ee),{value:r.value[P-1],"onUpdate:value":ve=>r.value[P-1]=ve,placeholder:`#${P}（可选） 多个留言时随机抽取一个`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),t(e(O),{size:"small",align:"center"},{default:l(()=>[t(e(Z),{depth:3},{default:l(()=>[...d[25]||(d[25]=[u("留言数量",-1)])]),_:1}),t(e(Re),{size:"tiny",circle:"",disabled:y.value===5,onClick:d[7]||(d[7]=P=>m(1))},{icon:l(()=>[t(e(ne),null,{default:l(()=>[t(e(xt))]),_:1})]),_:1},8,["disabled"]),t(e(Re),{size:"tiny",circle:"",disabled:y.value===1,onClick:d[8]||(d[8]=P=>{m(-1)})},{icon:l(()=>[t(e(ne),null,{default:l(()=>[t(e(bt))]),_:1})]),_:1},8,["disabled"]),t(e(Ze),{checked:b.value,"onUpdate:checked":d[9]||(d[9]=P=>b.value=P),label:"隐藏olo总额",style:{"margin-left":"auto"}},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),wl=G({__name:"ImageUpload",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(R,{emit:D}){const $=le(),U=se(),i=p(null),x=R,T=D,A=["mjj","imgbb","freeimage","picgo","tutu"],k=["imge","imgtbl","imgimg","helloimg","picui","imgwang"],v=X(()=>x.forumId===419?0:A.includes($.userCustom.imgHost)?1:k.includes($.userCustom.imgHost)?2:1),c=p(!1),H=({file:f,data:y,headers:m,withCredentials:s,action:g,onFinish:n,onError:z,onProgress:W})=>{if(f.file!==null){if(f.file.size>1024e3){window.$message.error("图片大小不能超过10M喔"),i.value?.clear();return}const Q={binggan:U.binggan,file:f.file,mode:"img",thread_id:x.threadId,forum_id:x.forumId};c.value=!0,Ve(Q).then(K=>{T("insertImage",K.file_url),i.value?.clear(),c.value=!1}).catch(()=>{i.value?.clear(),c.value=!1})}};function _(f){var y=document.getElementsByTagName("body")[0],m=document.createElement("script");m.setAttribute("id","image-upload-js");var s=document.getElementById("upload-button");f=="mjj"&&(m.setAttribute("async","true"),m.setAttribute("data-mode","manual"),m.setAttribute("src","https://mjj.today/sdk/pup.js"),m.setAttribute("data-url","https://mjj.today/upload"),m.setAttribute("data-auto-insert","html-embed"),s?.setAttribute("data-chevereto-pup-trigger","")),f=="imgbb"&&(m.setAttribute("async","true"),m.setAttribute("data-mode","manual"),m.setAttribute("src","https://imgbb.com/upload.js"),m.setAttribute("data-url","https://imgbb.com/upload"),m.setAttribute("data-auto-insert","html-embed-medium"),s?.setAttribute("data-imgbb-trigger","")),f=="freeimage"&&(m.setAttribute("async","true"),m.setAttribute("data-mode","manual"),m.setAttribute("src","https://freeimage.host/sdk/pup.js"),m.setAttribute("data-url","https://freeimage.host/upload"),m.setAttribute("data-auto-insert","html-embed-medium"),s?.setAttribute("data-chevereto-pup-trigger","")),f=="picgo"&&(m.setAttribute("async","true"),m.setAttribute("data-mode","manual"),m.setAttribute("src","https://www.picgo.net/sdk/pup.js"),m.setAttribute("data-url","https://www.picgo.net/upload"),m.setAttribute("data-auto-insert","html-embed"),s?.setAttribute("data-chevereto-pup-trigger","")),y.appendChild(m)}const B=X(()=>({imge:"https://imge.cc/api/v1/upload",imgtbl:"https://imgtbl.com/api/v1/upload",imgimg:"https://imgimg.cc/api/v1/upload",helloimg:"https://www.helloimg.com/api/v1/upload",picui:"https://picui.cn/api/v1/upload",imgwang:"https://img.wang/api/v1/upload"})[$.userCustom.imgHost]||""),r=({file:f,data:y,headers:m,withCredentials:s,action:g,onFinish:n,onError:z,onProgress:W})=>{if(f.file!==null){const Q={file:f.file,url:B.value};c.value=!0,nt(Q).then(K=>{console.log(K.data),K.status===!0?T("insertImage",K.data.links.url):window.$message.error(K.message),i.value?.clear(),c.value=!1}).catch(()=>{i.value?.clear(),c.value=!1})}};function b(){document.getElementById("image-upload-js")?.remove()}return We(()=>{A.includes($.userCustom.imgHost)&&_($.userCustom.imgHost)}),et(()=>{b()}),(f,y)=>(M(),Y(re,null,[v.value===0?(M(),V(e(Ae),{key:0,accept:"image/*","custom-request":H,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:i},{default:l(()=>[t(e(F),{style:{"margin-right":"auto"},disabled:f.userIsLocked,loading:c.value},{default:l(()=>[...y[0]||(y[0]=[u("上传图片",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):te("",!0),v.value===1?(M(),V(e(F),{key:1,style:{"margin-right":"auto"},disabled:f.userIsLocked,"data-target":"#content-input",id:"upload-button"},{default:l(()=>[...y[1]||(y[1]=[u("上传图片",-1)])]),_:1},8,["disabled"])):te("",!0),v.value===2?(M(),V(e(Ae),{key:2,accept:"image/*","custom-request":r,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:i},{default:l(()=>[t(e(F),{style:{"margin-right":"auto"},disabled:f.userIsLocked,loading:c.value},{default:l(()=>[...y[2]||(y[2]=[u("上传图片",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):te("",!0)],64))}}),bl=G({__name:"PingbiciModal",setup(R,{expose:D}){const $=le(),U=se(),i=p(),{loading:x,send:T,onSuccess:A}=me(H=>ot(H),{immediate:!1});function k(){if(!i.value){window.$message.error("请填写屏蔽词");return}const H={binggan:U.binggan,content_pingbici:i.value};T(H)}A(()=>{U.refreshUserData(),v.value=!1});const v=p(!1);function c(){v.value=!0}return D({show:c}),(H,_)=>(M(),V(e(de),{show:v.value,"onUpdate:show":_[3]||(_[3]=B=>v.value=B),"display-directive":"if"},{default:l(()=>[t(e(ue),{style:J({maxWidth:e($).modalMaxWidth}),title:"追加屏蔽词",closable:"",onClose:_[2]||(_[2]=B=>v.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(F),{type:"primary",onClick:k,loading:e(x),disabled:!i.value||e(x)},{default:l(()=>[..._[6]||(_[6]=[u("提交",-1)])]),_:1},8,["loading","disabled"]),t(e(F),{onClick:_[1]||(_[1]=B=>v.value=!1)},{default:l(()=>[..._[7]||(_[7]=[u("关闭",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Z),null,{default:l(()=>[..._[4]||(_[4]=[u("暂时只做了“内容屏蔽词”的追加",-1)])]),_:1}),t(e(N),null,{default:l(()=>[t(e(E),{style:{width:"4.2rem"}},{default:l(()=>[..._[5]||(_[5]=[u("屏蔽词",-1)])]),_:1}),t(e(ee),{value:i.value,"onUpdate:value":_[0]||(_[0]=B=>i.value=B),maxlength:20,"show-count":"",onKeyup:ce(k,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Ml=G({__name:"PostInput",props:{mode:{},disabled:{type:Boolean},handling:{type:Boolean},forumId:{default:0},threadId:{default:0},randomHeadsGroup:{default:1}},emits:["contentCommit","refreshPostsList"],setup(R,{expose:D,emit:$}){const U=se(),i=le(),x=p(null),T=p(null),A=p(null),k=p(null),v=p(null),c=p(null),H=p(null),_=R,B=X(()=>({fontSize:i.userCustom.fontSizeInput+"px",borderRadius:"10px"})),r=X(()=>{const h=(s.value.match(/\r?\n|\r/g)||[]).length+2;return h<5?5:h>10?10:h}),b=X(()=>U.userData.binggan.locked_ttl>0?`你的饼干封禁中，将于${Math.floor(U.userData.binggan.locked_ttl/3600)+1}小时后解封`:"正文内容"),f=X(()=>U.userData.binggan.locked_ttl>0),y=p(U.userData.binggan.nickname||"= ="),m=p(""),s=p(""),g=p(!1),n=p(!1);function z(){y.value=U.userData.binggan.nickname||"= =",m.value="",s.value="",g.value=!1,n.value=!1}const W=X(()=>({id:0,created_at:"预览模式",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:s.value,nickname:y.value,is_your_post:!0,hongbao_data:null})),Q=X(()=>({class:{"nickname-input":!0,admin:n.value}})),K=p(!1),q=st("emoji_auto_hide",!1);function d(){let h=[he(_e,{checked:K.value,"onUpdate:checked":a=>K.value=a,label:"实时预览"}),he(_e,{checked:q.value,"onUpdate:checked":a=>q.value=a,label:"表情包自动收起"})];return U.userData.binggan.admin!==0&&U.checkAdminForums(_.forumId)&&h.push(he(_e,{checked:n.value,"onUpdate:checked":a=>n.value=a,label:"管理员"})),he(O,{style:"padding:6px 8px",vertical:!0},()=>h)}const P=[{key:"funcOption",type:"render",render:d}],ve=[{label:"涂鸦板",key:"draw",icon:Ee(At,{size:"1.5rem"})},{label:"屏蔽词",key:"mute",icon:Ee(el,{size:"1.5rem"})}];function ke(h){switch(h){case"mute":v.value?.show();break;case"draw":H.value?.show();break}}De(n,h=>y.value=h?"管理员":"= =");function Ce(h){return h.selectionStart!=null?h.selectionStart:0}function Me(h,a){const L=Ce(h),ze=h.value,Ge=ze.substring(0,L)+a+ze.substring(L);s.value=Ge,setTimeout(()=>{h.selectionStart=L+a.length,h.selectionEnd=L+a.length},0)}function fe(h){const a=document.getElementById("content-input");Me(a,h),ge(),a.focus()}function Ie(){it({title:"要清空内容吗？",onPositiveClick:()=>s.value=""})}const ae=p([""]);function pe(){ae.value.length>1&&(ae.value.pop(),s.value=ae.value.slice(-1)[0])}function ge(){ae.value.push(s.value??""),ae.value.length>20&&ae.value.shift()}function w(h,a){fe(`<img src='${h}' class='${a?"custom-emoji-img":"emoji-img"}'>`)}function o(h){fe(h)}function C(h){fe(`<img src='${h}' />`)}function I(h){s.value=h,ge(),x.value?.focus()}const S=$;function xe(h){if(!h.isTrusted){const L={title:"错误",closable:!1,content:"请不要用脚本回复喔，可能会被系统判断为脚本并碎饼干。",positiveText:"确定"};window.$dialog.warning(L);return}new Promise(function(L,ze){S("contentCommit",{contentInput:s.value,nicknameInput:y.value,postWithAdmin:n.value,titleInput:m.value,isDelay:g.value,ist:h.isTrusted},L)}).then(Fe)}function Fe(){m.value="",s.value="",g.value=!1}const $e=p(!1);return D({quoteHandle:I,isTyping:$e,resetInput:z}),(h,a)=>(M(),V(e(O),{vertical:""},{default:l(()=>[K.value?(M(),Y(re,{key:0},[h.mode==="thread"?(M(),V(e(ue),{class:"thread-title-container",size:"small",key:"title-card"},{default:l(()=>[j("span",{class:"thread-title",style:J({fontSize:e(i).userCustom.fontSizeThreadList+"px"})},oe(m.value||"标题预览")+" [0] ",5)]),_:1})):te("",!0),t(ct,{"post-data":W.value,"forum-id":0,"preview-mode":!0},null,8,["post-data"])],64)):te("",!0),t(e(O),{size:"small",wrap:!1,align:"center",style:J({paddingRight:e(i).isMobile?"24px":"0px"})},{default:l(()=>[t(e(N),{style:{"max-width":"300px"}},{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...a[15]||(a[15]=[u("昵称",-1)])]),_:1}),t(e(ee),{maxlength:30,value:y.value,"onUpdate:value":a[0]||(a[0]=L=>y.value=L),"show-count":"","input-props":Q.value},null,8,["value","input-props"])]),_:1}),t(e(je),{trigger:e(i).isMobile?"click":"hover",options:P,placement:"bottom-start"},{default:l(()=>[t(e(F),{size:"medium",style:{"flex-shrink":"0"},secondary:!1},{default:l(()=>[...a[16]||(a[16]=[u("功能",-1)])]),_:1})]),_:1},8,["trigger"])]),_:1},8,["style"]),h.mode==="thread"?(M(),V(e(N),{key:1},{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...a[17]||(a[17]=[u("标题",-1)])]),_:1}),t(e(ee),{maxlength:100,value:m.value,"onUpdate:value":a[1]||(a[1]=L=>m.value=L),"show-count":"",placeholder:"标题内容"},null,8,["value"])]),_:1})):te("",!0),t(gl,{"auto-hide":e(q),"random-heads-group":h.randomHeadsGroup,onAppendEmoji:w},null,8,["auto-hide","random-heads-group"]),t(e(O),{size:e(i).isMobile?"small":"medium",justify:"end",align:"center",style:J({paddingRight:e(i).isMobile?"24px":"0px"})},{default:l(()=>[t(e(je),{trigger:"click",options:ve,onSelect:ke,size:e(i).isMobile?"medium":"large"},{default:l(()=>[t(e(ne),{size:e(i).isMobile?20:24,style:{cursor:"pointer"}},{default:l(()=>[t(e(ft))]),_:1},8,["size"])]),_:1},8,["size"]),h.mode==="post"?(M(),V(e(ie),{key:0,placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e(nl),{style:{cursor:"pointer"},onClick:a[2]||(a[2]=L=>T.value?.show())})]),_:1},8,["size"])]),default:l(()=>[a[18]||(a[18]=u(" 发红包 ",-1))]),_:1},8,["trigger"])):te("",!0),h.mode==="post"?(M(),V(e(ie),{key:1,placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e(Ft),{style:{cursor:"pointer"},onClick:a[3]||(a[3]=L=>A.value?.show())})]),_:1},8,["size"])]),default:l(()=>[a[19]||(a[19]=u(" 大乱斗 ",-1))]),_:1},8,["trigger"])):te("",!0),h.mode==="post"?(M(),V(e(ie),{key:2,placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e(Wt),{style:{cursor:"pointer"},onClick:a[4]||(a[4]=L=>k.value?.show())})]),_:1},8,["size"])]),default:l(()=>[a[20]||(a[20]=u(" Roll点 ",-1))]),_:1},8,["trigger"])):te("",!0),t(e(ie),{placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e($t),{style:{cursor:"pointer"},onClick:a[5]||(a[5]=L=>c.value?.show())})]),_:1},8,["size"])]),default:l(()=>[a[21]||(a[21]=u(" 快捷代码 ",-1))]),_:1},8,["trigger"]),t(e(tt),{vertical:""}),t(e(ie),{placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e(jt),{style:{cursor:"pointer"},onClick:pe})]),_:1},8,["size"])]),default:l(()=>[a[22]||(a[22]=u(" 撤销 ",-1))]),_:1},8,["trigger"]),t(e(ie),{placement:"bottom-start",trigger:e(i).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ne),{size:e(i).isMobile?28:32},{default:l(()=>[t(e(Bt),{style:{cursor:"pointer"},onClick:Ie})]),_:1},8,["size"])]),default:l(()=>[a[23]||(a[23]=u(" 清空 ",-1))]),_:1},8,["trigger"])]),_:1},8,["size","style"]),t(e(lt),{value:s.value,"onUpdate:value":a[6]||(a[6]=L=>s.value=L),type:"textarea",placeholder:b.value,rows:r.value,ref_key:"contentInputDom",ref:x,style:J(B.value),"input-props":{id:"content-input"},disabled:f.value,onChange:ge,onKeyup:a[7]||(a[7]=ce(Le(L=>xe(L),["ctrl"]),["enter"])),onBlur:a[8]||(a[8]=L=>$e.value=!1),onFocus:a[9]||(a[9]=L=>$e.value=!0)},null,8,["value","placeholder","rows","style","disabled"]),t(e(O),{justify:"end",align:"center"},{default:l(()=>[t(wl,{"user-is-locked":f.value,"forum-id":h.forumId,"thread-id":h.threadId,onInsertImage:C},null,8,["user-is-locked","forum-id","thread-id"]),h.mode==="thread"?(M(),V(e(ie),{key:0,placement:"bottom-start",trigger:"hover",disabled:e(i).isMobile},{trigger:l(()=>[t(e(_e),{checked:g.value,"onUpdate:checked":a[10]||(a[10]=L=>g.value=L)},{default:l(()=>[...a[24]||(a[24]=[u("延时发送",-1)])]),_:1},8,["checked"])]),default:l(()=>[a[25]||(a[25]=u(" 第二天8点自动发出 ",-1))]),_:1},8,["disabled"])):te("",!0),t(e(ie),{placement:"bottom-start",trigger:"hover",disabled:e(i).isMobile},{trigger:l(()=>[t(e(F),{type:"primary",onClick:a[11]||(a[11]=L=>xe(L)),loading:h.handling,disabled:h.handling||f.value},{default:l(()=>[...a[26]||(a[26]=[u("提交",-1)])]),_:1},8,["loading","disabled"])]),default:l(()=>[a[27]||(a[27]=u(" 可以Ctrl+Enter ",-1))]),_:1},8,["disabled"])]),_:1}),t(hl,{ref_key:"HongbaoModalCom",ref:T,"thread-id":h.threadId,"forum-id":h.forumId,onRefreshPostsList:a[12]||(a[12]=L=>S("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(il,{ref_key:"BattleModalCom",ref:A,"thread-id":h.threadId,"forum-id":h.forumId,"random-heads-group":h.randomHeadsGroup,onRefreshPostsList:a[13]||(a[13]=L=>S("refreshPostsList"))},null,8,["thread-id","forum-id","random-heads-group"]),t(Gt,{ref_key:"RollModalCom",ref:k,"thread-id":h.threadId,"forum-id":h.forumId,onRefreshPostsList:a[14]||(a[14]=L=>S("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(bl,{ref_key:"PingbiciModalCom",ref:v},null,512),t(ul,{ref_key:"CodeModalCom",ref:c,onInsertCode:o},null,512),t(ml,{ref_key:"DrawerModalCom",ref:H,onInsertImage:C,"user-is-locked":f.value,"forum-id":h.forumId,"thread-id":h.threadId},null,8,["user-is-locked","forum-id","thread-id"])]),_:1}))}});export{bt as M,xt as P,Ml as _,sl as a};
