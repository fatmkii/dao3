import{w as Y,l as Z,b as D,u as me,d as B,c as fe,U as ee,A as n,M as m,f as s,F as b,Q as j,C as E,a as e,k as f,i as he,H as a,j as k,m as G,z as l,s as i,G as v,n as y,h as O,R as te,O as se,_ as ae,o as _e,$ as x,p as U,q as J,r as ye,t as ge,g as ve,v as K,N as we,x as be,S}from"./app-BYB32yAm.js";import{u as ke,t as X}from"./forums-DK5zcUOZ.js";import{u as Se,S as Ie,_ as Te,a as Ce,b as xe}from"./Sidebar-DwkY6PwE.js";import{d as $e,s as Le,u as Ne,_ as W}from"./showDialog-DZhBB07B.js";import{N as oe,a as ze}from"./Skeleton-aaLiIJBX.js";import{_ as Fe}from"./FInput.vue_vue_type_script_setup_true_lang-CsJqv-RY.js";import{s as q}from"./subtitles-DW7M559j.js";import{N as Pe}from"./Ellipsis-wYYb2U2o.js";import{N as Me}from"./Checkbox-Idy5uEl7.js";import{N as Re}from"./Tag-BnmF-oYL.js";import"./Pagination-w6_7Wy46.js";const Oe=p=>(te("data-v-e72bc6ac"),p=p(),se(),p),Ue=Oe(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),We={key:0},qe=Y({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(p,{emit:L}){Z(c=>({"5dba71ed":e(h).hoverColor,"024fccae":e(w).isMobile?"0.75rem":"0.875rem",bc13a1be:e(h).textColor1}));const w=D(),h=me(),I=L,N=B(()=>({paddingBottom:w.isMobile?"6px":""})),g=Se({}).data,{loading:T,send:z,onSuccess:F}=fe(c=>$e(c),{immediate:!1});F(()=>{I("withdrawDelayThreadSuccess")});function C(c){Le({title:"要撤回延时主题吗？",onPositiveClick:()=>{z(c)}})}return(c,A)=>{const $=ee("router-link");return c.showThis?(n(),m(e(f),{key:0,vertical:"",size:2},{default:s(()=>[(n(!0),b(E,null,j(c.threadsListData,t=>(n(),m(e(he),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":N.value,hoverable:""},{default:s(()=>[a(e(f),{vertical:""},{default:s(()=>[k("div",{style:G({color:t.title_color?t.title_color:e(h).textColor1}),class:"thread-title"},[l(i(t.sub_title)+" ",1),a($,{to:{name:"thread",params:{threadId:t.id}},style:G({color:t.title_color?t.title_color:e(h).textColor1,pointerEvents:t.is_delay?"none":void 0}),target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(i(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(n(),m($,{key:0,to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+i(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):v("",!0),e(g)[t.id]?(n(),m(e(y),{key:1,size:"tiny",type:"primary",onClick:_=>c.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(g)[t.id].floor+1)/200)},hash:"#f_"+e(g)[t.id].floor})},{default:s(()=>{var _;return[l(" ["+i((_=e(g)[t.id])==null?void 0:_.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):v("",!0),t.is_your_thread?(n(),m(e(y),{key:2,size:"tiny",type:"warning",disabled:e(T),onClick:_=>C(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):v("",!0)],4),a(e(f),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(O),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+i(t.updated_at),1)]),k("span",null,[a(e(O),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+i(t.nickname),1)]),Ue,l(" "+i(t.posts_num>1200?"🔥":"")+" "+i(t.vote_question_id?"🗳️":"")+" "+i(t.gamble_question_id?"🎲":"")+" "+i(t.crowd_id?"💰":"")+" "+i(t.hongbao_id?"🧧":"")+" ",1),t.locked_by_coin>0?(n(),b("span",We,"🔒"+i(t.locked_by_coin),1)):v("",!0),k("span",null,[a(e(O),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+i(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(n(),m(e(f),{key:1,vertical:"",size:2},{default:s(()=>[(n(),b(E,null,j(50,t=>a(e(oe),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Be=ae(qe,[["__scopeId","data-v-e72bc6ac"]]),re=p=>(te("data-v-c3dd76f5"),p=p(),se(),p),je={key:0,class:"carousel-box"},Ee={key:0,class:"carousel-box"},Ge=["src"],Ae=re(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),He=re(()=>k("div",{style:{height:"50px"}},null,-1)),Qe=Y({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(p){Z(o=>({"17c0faff":e(w).bannerHeight}));const L=_e(),w=D(),h=ke(),I=ve(),N=x(null);Ne();const r=p,g=U("banner_hiden",!1),T=U("new_window_to_post",!1);function z(){return S(f,{style:"padding:6px 8px",vertical:!0},()=>[S(W,{checked:g.value,"onUpdate:checked":o=>g.value=o,label:"隐藏版头"}),S(W,{checked:T.value,"onUpdate:checked":o=>T.value=o,label:"新窗口打开"})])}const F=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:z}],C=U("subtitles_included",q),c=B(()=>q.filter(o=>!C.value.includes(o)));function A(){return S(Me,{value:C.value,"onUpdate:value":o=>C.value=o},()=>[S(f,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(q).map(o=>S(W,{value:o,label:o}))])])}const $=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:A}],t=x(r.search),_=x(!!r.search);J(t,o=>{xe(()=>I.push({name:"forum",params:{forumId:r.forumId,page:r.page},query:{search:o||void 0}}))()});function le(){t.value=void 0,_.value=!1}function ne(){I.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=x(r.page);function ie(o){I.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}J(()=>r.page,o=>P.value=o);const H=B(()=>({forumId:r.forumId,binggan:L.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:c.value,searchTitle:r.search,delay:r.delay})),{loading:M,data:Q}=ye(()=>X(H.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,c],{initialData:[],immediate:!0}),V=x(!1),{fetching:Ve,onSuccess:ue,fetch:de}=ge();function R(o=!1){V.value=o,de(X(H.value))}return ue(()=>{V.value&&window.$message.success("已刷新数据")}),(o,u)=>{const ce=ee("router-link");return n(),m(e(f),{vertical:""},{default:s(()=>[e(g)?v("",!0):(n(),b("div",je,[e(h).forumsDataLoading?(n(),b("div",Ee,[a(e(oe),{class:"carousel-skeleton",sharp:""})])):v("",!0),e(h).forumsDataLoading?v("",!0):(n(),m(e(ze),{key:1,"show-arrow":"",trigger:"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(n(!0),b(E,null,j((d=e(h).forumData(o.forumId))==null?void 0:d.banners,pe=>(n(),b("img",{src:pe,class:"carousel-img"},null,8,Ge))),256))]}),_:1}))])),a(e(f),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(K),{trigger:"hover",options:F,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1}),a(e(K),{trigger:"hover",options:$,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1}),a(e(we),{size:e(w).isMobile?28:34},{default:s(()=>[a(e(Ie),{style:{cursor:"pointer"},onClick:u[0]||(u[0]=d=>_.value=!_.value)})]),_:1},8,["size"]),Ae,a(e(y),{type:"primary"},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:u[1]||(u[1]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),_.value?(n(),m(e(f),{key:1,wrap:!1},{default:s(()=>[a(e(Fe),{value:t.value,"onUpdate:value":u[2]||(u[2]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":""},null,8,["value"]),a(e(y),{type:"primary",onClick:u[3]||(u[3]=d=>R(!0))},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:le},{default:s(()=>[l("清空")]),_:1})]),_:1})):v("",!0),a(Be,{"threads-list-data":e(M)?[]:e(Q).threads_data.data,"new-window-to-post":e(T),"show-this":!e(M),onWithdrawDelayThreadSuccess:R},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(f),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:ne},{default:s(()=>[l(i(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Te,{page:P.value,"onUpdate:page":[u[4]||(u[4]=d=>P.value=d),ie],"last-page":e(M)?1:e(Q).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),He,(n(),m(be,{to:"#topbar-nav"},[a(ce,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Pe),{style:G({maxWidth:e(w).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(i((d=e(h).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(Re),{round:"",class:"forum-tag",size:e(w).isMobile?"small":"medium"},{default:s(()=>[l(i(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(Ce,{mode:"forum",ref_key:"SidebarCom",ref:N,onRefresh:u[5]||(u[5]=d=>R(!0)),onNewThread:u[6]||(u[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),rt=ae(Qe,[["__scopeId","data-v-c3dd76f5"]]);export{rt as default};
