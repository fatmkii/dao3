import{w as R,l as U,a,n as G,b as M,u as O,$ as v,e as P,d as S,p as Q,c as q,A as u,M as h,f as s,i as w,H as l,k as d,v as c,z as o,F as _,C as F,Q as N,j,G as A,h as k,_ as E}from"./app-BfTmtkkR.js";import{s as V}from"./admin-6I6o6vve.js";import{u as J}from"./forums-nUb1a26Z.js";import{N as K}from"./Input-C5i_M3Sx.js";import{N as L}from"./Select-BbGpypib.js";import"./use-locale-CFDb4tef.js";import"./Tag-COjQsRYJ.js";const W={class:"banner-box-sm"},X=["src"],Y=["src","onClick"],Z=R({__name:"TabBanners",setup(ee){U(t=>({"6a1c8eac":a($).textColor1}));const f=G();M();const b=J(),$=O(),i=v(0);P(()=>{g.value.length>0&&(i.value=g.value[0].value)});const g=S(()=>f.binggan===null||f.userData.binggan.admin_forums===void 0?[]:b.forumsData.reduce((t,e)=>(f.checkAdminForums(e.id)&&t.push({value:e.id,label:e.name,forumId:e.id}),t),[])),r=v([]);Q(i,t=>{var e,n;t===void 0?r.value=[]:r.value=[...(n=(e=b.forumData(t))==null?void 0:e.banners)!=null?n:[]]});const m=v(!1),p=v(),B=S(()=>{var t,e;return(e=(t=p.value)==null?void 0:t.split(/[\n,，]+/).filter(n=>n!=""))!=null?e:[]});function H(){m.value=!1,r.value=r.value.concat(B.value),p.value=void 0,z()}function D(t){var e;(e=r.value)==null||e.splice(t,1)}const{loading:C,send:T,onSuccess:I}=q(t=>V(t),{immediate:!1});I(()=>{b.getForumsData()});function z(){const t={binggan:f.binggan,forum_id:i.value,banners:r.value};T(t)}return(t,e)=>(u(),h(a(d),{vertical:""},{default:s(()=>[m.value?(u(),h(a(w),{key:0,title:"待追加的版头",size:"small",class:"dash-line"},{"header-extra":s(()=>[l(a(d),{size:"small"},{default:s(()=>[l(a(c),{type:"primary",onClick:H},{default:s(()=>[o("追加")]),_:1}),l(a(c),{type:"default",onClick:e[0]||(e[0]=n=>{m.value=!1,p.value=void 0})},{default:s(()=>[o("关闭")]),_:1})]),_:1})]),default:s(()=>[l(a(d),{size:"small"},{default:s(()=>[(u(!0),_(F,null,N(B.value,(n,y,x)=>(u(),_("div",W,[j("img",{src:n,style:{width:"100%"}},null,8,X)]))),256))]),_:1}),l(a(K),{type:"textarea",value:p.value,"onUpdate:value":e[1]||(e[1]=n=>p.value=n),placeholder:"在这里贴网址追加版头。可以一次多个，每行一个。",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})):A("",!0),l(a(w),{title:"版头设定",size:"small"},{"header-extra":s(()=>[l(a(d),{size:"small",align:"center",wrap:!0},{default:s(()=>[l(a(k),{depth:3},{default:s(()=>[o("选择小岛")]),_:1}),l(a(L),{value:i.value,"onUpdate:value":e[2]||(e[2]=n=>i.value=n),options:g.value,"consistent-menu-width":!1,style:{width:"100px"}},null,8,["value","options"]),m.value?A("",!0):(u(),h(a(c),{key:0,type:"primary",onClick:e[3]||(e[3]=n=>m.value=!0)},{default:s(()=>[o("追加")]),_:1}))]),_:1})]),default:s(()=>[l(a(k),{depth:3},{default:s(()=>[o("点击图片移除")]),_:1}),l(a(d),{wrap:!0,size:[4,4]},{default:s(()=>[(u(!0),_(F,null,N(r.value,(n,y)=>{var x;return u(),_("div",{key:y+((x=i.value)!=null?x:0)*1e3,class:"banner-box"},[j("img",{src:n,class:"banner-img",onClick:ae=>D(y)},null,8,Y)])}),128))]),_:1})]),_:1}),l(a(d),{align:"center",justify:"end"},{default:s(()=>[l(a(k),{depth:3,style:{"font-size":"0.875rem"}},{default:s(()=>[o("各个小岛的变更要分别提交喔")]),_:1}),l(a(c),{type:"primary",loading:a(C),disable:a(C),onClick:z},{default:s(()=>[o("提交")]),_:1},8,["loading","disable"])]),_:1})]),_:1}))}}),ie=E(Z,[["__scopeId","data-v-35893c7d"]]);export{ie as default};
