import{b as H,e as he,m as ge,w as te,l as se,u as _e,d as N,c as ye,U as ae,A as n,M as h,f as s,F as w,Q as j,C as G,a as e,k as g,i as Y,H as a,j as k,n as A,z as l,s as u,G as b,o as y,h as q,R as oe,O as re,_ as le,p as ve,$ as C,q as R,r as be,t as we,v as ke,g as Se,x as Z,N as Ce,y as Ie,B as Te,S as I,D as B,E as $e}from"./app-DNiDbruX.js";import{u as xe,t as ee}from"./forums-DNot3SDn.js";import{s as E}from"./subtitles-DW7M559j.js";import{_ as Le}from"./loudspeaker-ClJcq9bK.js";import{u as Ne,S as ze,L as Me,a as Fe}from"./LoudspeakerComponent-BIkxoQVW.js";import{d as Pe,s as Oe}from"./showDialog-DBfLHW48.js";import{_ as Ue}from"./FInput.vue_vue_type_script_setup_true_lang-OWp00g7X.js";import{N as We}from"./Ellipsis-Da1-F3JE.js";import{N as qe,a as Re}from"./Skeleton-CygKw9po.js";import{N as Be}from"./Tag-CfXSXn3u.js";import"./Pagination-COul0yIQ.js";import"./use-locale-Dk0lH-2-.js";import"./prop-DfVitj0l.js";import"./Input-DPs_spKr.js";import"./Select-DJR65rQm.js";import"./Forward-DR3bpUeV.js";import"./Spin-ByIo-jeU.js";import"./_createCompounder-CK7oMxPb.js";import"./use-houdini-CDMBHRy0.js";function Ee(){const c=H();he(()=>{c.showTopbarNav=!1}),ge(()=>{c.showTopbarNav=!0})}const je=c=>(oe("data-v-92d410c5"),c=c(),re(),c),Ge=je(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),Ae={key:0},He=te({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(c,{emit:T}){se(m=>({"4b1418b0":e(f).hoverColor,"284e4759":(e(p).isMobile,"0.875rem"),e1605438:e(f).textColor1}));const p=H(),f=_e(),S=T,z=N(()=>({paddingBottom:p.isMobile?"6px":""})),v=Ne({}).data,{loading:$,send:M,onSuccess:F}=ye(m=>Pe(m),{immediate:!1});F(()=>{S("withdrawDelayThreadSuccess")});function x(m){Oe({title:"要撤回延时主题吗？",onPositiveClick:()=>{M(m)}})}return(m,Q)=>{const L=ae("router-link");return m.showThis?(n(),h(e(g),{key:0,vertical:"",size:2},{default:s(()=>[(n(!0),w(G,null,j(m.threadsListData,t=>(n(),h(e(Y),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":z.value,hoverable:""},{default:s(()=>[a(e(g),{vertical:""},{default:s(()=>[k("div",{style:A({color:t.title_color&&!e(p).userCustom.monochromeMode?t.title_color:e(f).textColor1}),class:"thread-title"},[l(u(t.sub_title)+" "+u(t.vote_question_id?"🗳️":"")+" "+u(t.gamble_question_id?"🎲":"")+" "+u(t.crowd_id?"💰":"")+" "+u(t.hongbao_id?"🧧":"")+" ",1),a(L,{to:{name:"thread",params:{threadId:t.id}},style:A([{"font-size":"1.0rem"},{color:t.title_color&&!e(p).userCustom.monochromeMode?t.title_color:e(f).textColor1,pointerEvents:t.is_delay?"none":void 0}]),target:m.newWindowToPost?"_blank":!1},{default:s(()=>[l(u(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(n(),h(L,{key:0,style:{"font-size":"1.0rem"},to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:m.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+u(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):b("",!0),e(v)[t.id]?(n(),h(e(y),{key:1,size:"tiny",type:"primary",onClick:_=>m.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(v)[t.id].floor+1)/200)},hash:`#f_${e(v)[t.id].floor}`})},{default:s(()=>{var _;return[l(" ["+u((_=e(v)[t.id])==null?void 0:_.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):b("",!0),t.is_your_thread?(n(),h(e(y),{key:2,size:"tiny",type:"warning",disabled:e($),onClick:_=>x(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):b("",!0)],4),a(e(g),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+u(t.updated_at),1)]),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+u(t.nickname),1)]),Ge,l(" "+u(t.posts_num>1200?"🔥":"")+" ",1),t.locked_by_coin>0?(n(),w("span",Ae,"🔒"+u(t.locked_by_coin),1)):b("",!0),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+u(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(n(),h(e(g),{key:1,vertical:"",size:2},{default:s(()=>[(n(),w(G,null,j(50,t=>a(e(Y),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Qe=le(He,[["__scopeId","data-v-92d410c5"]]),ne=c=>(oe("data-v-bf3278cc"),c=c(),re(),c),Ve={key:0,class:"carousel-box"},Ke={key:0,class:"carousel-box"},De=["src"],Je=ne(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),Xe=ne(()=>k("div",{style:{height:"50px"}},null,-1)),Ye=te({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(c){var X;se(o=>({"95e5b876":e(p).bannerHeight}));const T=ve(),p=H(),f=xe(),S=Se(),z=C(null);C(),Ee();const r=c;document.title=((X=f.forumData(r.forumId))==null?void 0:X.name)??"小火锅";const v=R("banner_hiden",!1),$=R("new_window_to_post",!1);function M(){return I(g,{style:"padding:6px 8px",vertical:!0},()=>[I(B,{checked:v.value,"onUpdate:checked":o=>v.value=o,label:"隐藏版头"}),I(B,{checked:$.value,"onUpdate:checked":o=>$.value=o,label:"新窗口打开"})])}const F=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:M}],x=R("subtitles_included",E),m=N(()=>E.filter(o=>!x.value.includes(o)));function Q(){return I($e,{value:x.value,"onUpdate:value":o=>x.value=o},()=>[I(g,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(E).map(o=>I(B,{value:o,label:o}))])])}const L=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:Q}],t=C(r.search),_=C(!!r.search);function V(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ie(){t.value=void 0,_.value=!1,S.push({name:"forum",params:{forumId:r.forumId,page:1}})}function ue(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=C(r.page);function de(o){S.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}be(()=>r.page,o=>P.value=o);const K=N(()=>({forumId:r.forumId,binggan:T.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:m.value,searchTitle:r.search,delay:r.delay})),{loading:O,data:U,onSuccess:Ze}=we(()=>ee(K.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,m],{initialData:[],immediate:!0}),D=C(!1),{fetching:et,onSuccess:ce,fetch:pe}=ke();function J(o=!1){D.value=o,pe(ee(K.value))}ce(()=>{D.value&&window.$message.success("已刷新数据")});const me=N(()=>{if(O.value)return[];if(T.userData.binggan.use_pingbici){const o=p.userCustom.pingbiciIngnoreCase?"gi":"g";return U.value.threads_data.data.filter(i=>{for(let W of T.userData.pingbici.title_pingbici)if(new RegExp(W,o).test(i.title))return!1;return!0})}else return U.value.threads_data.data});return(o,i)=>{const W=ae("router-link");return n(),h(e(g),{vertical:""},{default:s(()=>[e(v)?b("",!0):(n(),w("div",Ve,[e(f).forumsDataLoading?(n(),w("div",Ke,[a(e(qe),{class:"carousel-skeleton",sharp:""})])):b("",!0),e(f).forumsDataLoading?b("",!0):(n(),h(e(Re),{key:1,"show-arrow":"",trigger:e(p).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(n(!0),w(G,null,j((d=e(f).forumData(o.forumId))==null?void 0:d.banners,fe=>(n(),w("img",{src:fe,class:"carousel-img"},null,8,De))),256))]}),_:1},8,["trigger"]))])),a(e(g),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(Z),{trigger:e(p).isMobile?"click":"hover",options:F,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1},8,["trigger"]),a(e(Z),{trigger:e(p).isMobile?"click":"hover",options:L,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1},8,["trigger"]),a(e(Ce),{size:e(p).isMobile?28:34},{default:s(()=>[a(e(ze),{style:{cursor:"pointer"},onClick:i[0]||(i[0]=d=>_.value=!_.value)})]),_:1},8,["size"]),Je,a(e(y),{type:"primary",onClick:i[1]||(i[1]=d=>o.$router.push({name:"loudspeaker"}))},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:i[2]||(i[2]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),_.value?(n(),h(e(g),{key:1,wrap:!1},{default:s(()=>[a(e(Ue),{value:t.value,"onUpdate:value":i[3]||(i[3]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":"",onKeyup:Ie(V,["enter"])},null,8,["value"]),a(e(y),{type:"primary",onClick:V},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:ie},{default:s(()=>[l("清空")]),_:1})]),_:1})):b("",!0),a(Me),a(Qe,{"threads-list-data":me.value,"new-window-to-post":e($),"show-this":!e(O),onWithdrawDelayThreadSuccess:J},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(g),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:ue},{default:s(()=>[l(u(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Le,{page:P.value,"onUpdate:page":[i[4]||(i[4]=d=>P.value=d),de],"last-page":e(O)?1:e(U).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Xe,(n(),h(Te,{to:"#topbar-nav"},[a(W,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(We),{style:A({maxWidth:e(p).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(u((d=e(f).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(Be),{round:"",class:"forum-tag",size:e(p).isMobile?"small":"medium"},{default:s(()=>[l(u(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(Fe,{mode:"forum",ref_key:"SidebarCom",ref:z,onRefresh:i[5]||(i[5]=d=>J(!0)),onNewThread:i[6]||(i[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),bt=le(Ye,[["__scopeId","data-v-bf3278cc"]]);export{bt as default};
