import{w as Y,l as Z,b as D,u as fe,d as W,c as he,U as ee,A as n,M as m,f as s,F as b,Q as B,C as j,a as e,k as f,i as _e,H as a,j as k,m as E,z as l,s as i,G as v,n as y,h as R,R as te,O as se,_ as ae,o as ye,$ as x,p as q,q as J,r as ge,t as ve,g as we,v as K,N as be,x as ke,S as I}from"./app-CKeLOz7-.js";import{u as Se,t as X}from"./forums-DGdXgkYv.js";import{u as Ie,S as Te,_ as Ce,a as xe,b as $e}from"./Sidebar-p70xNofK.js";import{d as Le,s as Ne,u as ze,_ as O}from"./showDialog-wazrIzMu.js";import{N as oe,a as Fe}from"./Skeleton-VpBtk4gV.js";import{_ as Pe}from"./FInput.vue_vue_type_script_setup_true_lang-DlTyJ0dN.js";import{s as U}from"./subtitles-DW7M559j.js";import{N as Me}from"./Ellipsis-DKv5hnV0.js";import{N as Re}from"./Checkbox-CQEqMbRf.js";import{N as qe}from"./Tag-BLPI_0a_.js";import"./Pagination-BA48k7gh.js";import"./use-locale-ma6yKE5D.js";import"./Input-imgOsV1O.js";import"./_createCompounder-QXOQu3qV.js";const Oe=p=>(te("data-v-e72bc6ac"),p=p(),se(),p),Ue=Oe(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),We={key:0},Be=Y({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(p,{emit:L}){Z(u=>({"5dba71ed":e(h).hoverColor,"024fccae":e(w).isMobile?"0.75rem":"0.875rem",bc13a1be:e(h).textColor1}));const w=D(),h=fe(),S=L,N=W(()=>({paddingBottom:w.isMobile?"6px":""})),g=Ie({}).data,{loading:T,send:z,onSuccess:F}=he(u=>Le(u),{immediate:!1});F(()=>{S("withdrawDelayThreadSuccess")});function C(u){Ne({title:"要撤回延时主题吗？",onPositiveClick:()=>{z(u)}})}return(u,G)=>{const $=ee("router-link");return u.showThis?(n(),m(e(f),{key:0,vertical:"",size:2},{default:s(()=>[(n(!0),b(j,null,B(u.threadsListData,t=>(n(),m(e(_e),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":N.value,hoverable:""},{default:s(()=>[a(e(f),{vertical:""},{default:s(()=>[k("div",{style:E({color:t.title_color?t.title_color:e(h).textColor1}),class:"thread-title"},[l(i(t.sub_title)+" ",1),a($,{to:{name:"thread",params:{threadId:t.id}},style:E({color:t.title_color?t.title_color:e(h).textColor1,pointerEvents:t.is_delay?"none":void 0}),target:u.newWindowToPost?"_blank":!1},{default:s(()=>[l(i(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(n(),m($,{key:0,to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:u.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+i(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):v("",!0),e(g)[t.id]?(n(),m(e(y),{key:1,size:"tiny",type:"primary",onClick:_=>u.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(g)[t.id].floor+1)/200)},hash:"#f_"+e(g)[t.id].floor})},{default:s(()=>{var _;return[l(" ["+i((_=e(g)[t.id])==null?void 0:_.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):v("",!0),t.is_your_thread?(n(),m(e(y),{key:2,size:"tiny",type:"warning",disabled:e(T),onClick:_=>C(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):v("",!0)],4),a(e(f),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(R),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+i(t.updated_at),1)]),k("span",null,[a(e(R),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+i(t.nickname),1)]),Ue,l(" "+i(t.posts_num>1200?"🔥":"")+" "+i(t.vote_question_id?"🗳️":"")+" "+i(t.gamble_question_id?"🎲":"")+" "+i(t.crowd_id?"💰":"")+" "+i(t.hongbao_id?"🧧":"")+" ",1),t.locked_by_coin>0?(n(),b("span",We,"🔒"+i(t.locked_by_coin),1)):v("",!0),k("span",null,[a(e(R),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+i(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(n(),m(e(f),{key:1,vertical:"",size:2},{default:s(()=>[(n(),b(j,null,B(50,t=>a(e(oe),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),je=ae(Be,[["__scopeId","data-v-e72bc6ac"]]),re=p=>(te("data-v-feaa08a5"),p=p(),se(),p),Ee={key:0,class:"carousel-box"},Ge={key:0,class:"carousel-box"},Ae=["src"],He=re(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),Qe=re(()=>k("div",{style:{height:"50px"}},null,-1)),Ve=Y({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(p){Z(o=>({"1b7f753c":e(w).bannerHeight}));const L=ye(),w=D(),h=Se(),S=we(),N=x(null);ze();const r=p,g=q("banner_hiden",!1),T=q("new_window_to_post",!1);function z(){return I(f,{style:"padding:6px 8px",vertical:!0},()=>[I(O,{checked:g.value,"onUpdate:checked":o=>g.value=o,label:"隐藏版头"}),I(O,{checked:T.value,"onUpdate:checked":o=>T.value=o,label:"新窗口打开"})])}const F=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:z}],C=q("subtitles_included",U),u=W(()=>U.filter(o=>!C.value.includes(o)));function G(){return I(Re,{value:C.value,"onUpdate:value":o=>C.value=o},()=>[I(f,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(U).map(o=>I(O,{value:o,label:o}))])])}const $=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:G}],t=x(r.search),_=x(!!r.search);J(t,o=>{$e(()=>S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:o||void 0}}))()});function le(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ne(){t.value=void 0,_.value=!1}function ie(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=x(r.page);function ue(o){S.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}J(()=>r.page,o=>P.value=o);const A=W(()=>({forumId:r.forumId,binggan:L.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:u.value,searchTitle:r.search,delay:r.delay})),{loading:M,data:H}=ge(()=>X(A.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,u],{initialData:[],immediate:!0}),Q=x(!1),{fetching:Je,onSuccess:de,fetch:ce}=ve();function V(o=!1){Q.value=o,ce(X(A.value))}return de(()=>{Q.value&&window.$message.success("已刷新数据")}),(o,d)=>{const pe=ee("router-link");return n(),m(e(f),{vertical:""},{default:s(()=>[e(g)?v("",!0):(n(),b("div",Ee,[e(h).forumsDataLoading?(n(),b("div",Ge,[a(e(oe),{class:"carousel-skeleton",sharp:""})])):v("",!0),e(h).forumsDataLoading?v("",!0):(n(),m(e(Fe),{key:1,"show-arrow":"",trigger:"hover",autoplay:"",interval:1e4},{default:s(()=>{var c;return[(n(!0),b(j,null,B((c=e(h).forumData(o.forumId))==null?void 0:c.banners,me=>(n(),b("img",{src:me,class:"carousel-img"},null,8,Ae))),256))]}),_:1}))])),a(e(f),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(K),{trigger:"hover",options:F,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1}),a(e(K),{trigger:"hover",options:$,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1}),a(e(be),{size:e(w).isMobile?28:34},{default:s(()=>[a(e(Te),{style:{cursor:"pointer"},onClick:d[0]||(d[0]=c=>_.value=!_.value)})]),_:1},8,["size"]),He,a(e(y),{type:"primary"},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:d[1]||(d[1]=c=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),_.value?(n(),m(e(f),{key:1,wrap:!1},{default:s(()=>[a(e(Pe),{value:t.value,"onUpdate:value":d[2]||(d[2]=c=>t.value=c),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":""},null,8,["value"]),a(e(y),{type:"primary",onClick:le},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:ne},{default:s(()=>[l("清空")]),_:1})]),_:1})):v("",!0),a(je,{"threads-list-data":e(M)?[]:e(H).threads_data.data,"new-window-to-post":e(T),"show-this":!e(M),onWithdrawDelayThreadSuccess:V},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(f),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:ie},{default:s(()=>[l(i(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Ce,{page:P.value,"onUpdate:page":[d[3]||(d[3]=c=>P.value=c),ue],"last-page":e(M)?1:e(H).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Qe,(n(),m(ke,{to:"#topbar-nav"},[a(pe,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Me),{style:E({maxWidth:e(w).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var c;return[l(i((c=e(h).forumData(o.forumId))==null?void 0:c.name),1)]}),_:1},8,["style"]),a(e(qe),{round:"",class:"forum-tag",size:e(w).isMobile?"small":"medium"},{default:s(()=>[l(i(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(xe,{mode:"forum",ref_key:"SidebarCom",ref:N,onRefresh:d[4]||(d[4]=c=>V(!0)),onNewThread:d[5]||(d[5]=c=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),ut=ae(Ve,[["__scopeId","data-v-feaa08a5"]]);export{ut as default};
