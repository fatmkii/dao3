import{w as Y,l as Z,b as D,u as fe,d as W,c as he,U as ee,A as n,M as m,f as s,F as b,Q as B,C as j,a as e,k as f,i as _e,H as a,j as k,m as E,z as l,s as u,G as w,n as g,h as q,R as te,O as se,_ as ae,o as ye,$ as I,p as O,q as J,r as ge,t as ve,g as we,v as K,N as be,x as ke,S as C,y as R,B as Se}from"./app-Cg7Vcqiz.js";import{u as Ie,t as X}from"./forums-BBaMkDBE.js";import{u as Ce,S as Te,_ as $e,a as xe,b as Le}from"./LoudspeakerComponent.vue_vue_type_style_index_0_lang-xM5ZL2t_.js";import{d as Ne,s as ze,u as Fe}from"./showDialog-CUSNmPRh.js";import{_ as Me}from"./loudspeaker-DhDiC4VB.js";import{N as oe,a as Pe}from"./Skeleton-CpTx4X1e.js";import{_ as qe}from"./FInput.vue_vue_type_script_setup_true_lang-DoxM4otI.js";import{s as U}from"./subtitles-DW7M559j.js";import{N as Oe}from"./Ellipsis-EBfKwMwD.js";import{N as Re}from"./Tag-dUWvBLPY.js";import"./Spin-BHiyOg1a.js";import"./Pagination-CVMy2g91.js";import"./use-locale-Bid7opkP.js";import"./Input-D_UZB_Pc.js";import"./Select-DvpmyBL-.js";import"./_createCompounder-iMEu2vEH.js";import"./use-houdini-DZ0yndYY.js";const Ue=p=>(te("data-v-9f1bc30a"),p=p(),se(),p),We=Ue(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),Be={key:0},je=Y({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(p,{emit:L}){Z(c=>({73130296:e(_).hoverColor,"46c230e6":e(h).isMobile?"0.75rem":"0.875rem","0ab23be9":e(_).textColor1}));const h=D(),_=fe(),S=L,N=W(()=>({paddingBottom:h.isMobile?"6px":""})),v=Ce({}).data,{loading:T,send:z,onSuccess:F}=he(c=>Ne(c),{immediate:!1});F(()=>{S("withdrawDelayThreadSuccess")});function $(c){ze({title:"要撤回延时主题吗？",onPositiveClick:()=>{z(c)}})}return(c,G)=>{const x=ee("router-link");return c.showThis?(n(),m(e(f),{key:0,vertical:"",size:2},{default:s(()=>[(n(!0),b(j,null,B(c.threadsListData,t=>(n(),m(e(_e),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":N.value,hoverable:""},{default:s(()=>[a(e(f),{vertical:""},{default:s(()=>[k("div",{style:E({color:t.title_color&&!e(h).userCustom.monochromeMode?t.title_color:e(_).textColor1}),class:"thread-title"},[l(u(t.sub_title)+" ",1),a(x,{to:{name:"thread",params:{threadId:t.id}},style:E({color:t.title_color&&!e(h).userCustom.monochromeMode?t.title_color:e(_).textColor1,pointerEvents:t.is_delay?"none":void 0}),target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(u(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(n(),m(x,{key:0,to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+u(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):w("",!0),e(v)[t.id]?(n(),m(e(g),{key:1,size:"tiny",type:"primary",onClick:y=>c.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(v)[t.id].floor+1)/200)},hash:"#f_"+e(v)[t.id].floor})},{default:s(()=>{var y;return[l(" ["+u((y=e(v)[t.id])==null?void 0:y.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):w("",!0),t.is_your_thread?(n(),m(e(g),{key:2,size:"tiny",type:"warning",disabled:e(T),onClick:y=>$(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):w("",!0)],4),a(e(f),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+u(t.updated_at),1)]),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+u(t.nickname),1)]),We,l(" "+u(t.posts_num>1200?"🔥":"")+" "+u(t.vote_question_id?"🗳️":"")+" "+u(t.gamble_question_id?"🎲":"")+" "+u(t.crowd_id?"💰":"")+" "+u(t.hongbao_id?"🧧":"")+" ",1),t.locked_by_coin>0?(n(),b("span",Be,"🔒"+u(t.locked_by_coin),1)):w("",!0),k("span",null,[a(e(q),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+u(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(n(),m(e(f),{key:1,vertical:"",size:2},{default:s(()=>[(n(),b(j,null,B(50,t=>a(e(oe),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Ee=ae(je,[["__scopeId","data-v-9f1bc30a"]]),re=p=>(te("data-v-4c5e4089"),p=p(),se(),p),Ge={key:0,class:"carousel-box"},Ae={key:0,class:"carousel-box"},He=["src"],Qe=re(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),Ve=re(()=>k("div",{style:{height:"50px"}},null,-1)),Je=Y({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(p){Z(o=>({c4fc0d46:e(h).bannerHeight}));const L=ye(),h=D(),_=Ie(),S=we(),N=I(null);I(),Fe();const r=p,v=O("banner_hiden",!1),T=O("new_window_to_post",!1);function z(){return C(f,{style:"padding:6px 8px",vertical:!0},()=>[C(R,{checked:v.value,"onUpdate:checked":o=>v.value=o,label:"隐藏版头"}),C(R,{checked:T.value,"onUpdate:checked":o=>T.value=o,label:"新窗口打开"})])}const F=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:z}],$=O("subtitles_included",U),c=W(()=>U.filter(o=>!$.value.includes(o)));function G(){return C(Se,{value:$.value,"onUpdate:value":o=>$.value=o},()=>[C(f,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(U).map(o=>C(R,{value:o,label:o}))])])}const x=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:G}],t=I(r.search),y=I(!!r.search);J(t,o=>{Le(()=>S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:o||void 0}}))()});function le(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ne(){t.value=void 0,y.value=!1}function ue(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const M=I(r.page);function ie(o){S.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}J(()=>r.page,o=>M.value=o);const A=W(()=>({forumId:r.forumId,binggan:L.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:c.value,searchTitle:r.search,delay:r.delay})),{loading:P,data:H}=ge(()=>X(A.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,c],{initialData:[],immediate:!0}),Q=I(!1),{fetching:Ke,onSuccess:de,fetch:ce}=ve();function V(o=!1){Q.value=o,ce(X(A.value))}return de(()=>{Q.value&&window.$message.success("已刷新数据")}),(o,i)=>{const pe=ee("router-link");return n(),m(e(f),{vertical:""},{default:s(()=>[e(v)?w("",!0):(n(),b("div",Ge,[e(_).forumsDataLoading?(n(),b("div",Ae,[a(e(oe),{class:"carousel-skeleton",sharp:""})])):w("",!0),e(_).forumsDataLoading?w("",!0):(n(),m(e(Pe),{key:1,"show-arrow":"",trigger:"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(n(!0),b(j,null,B((d=e(_).forumData(o.forumId))==null?void 0:d.banners,me=>(n(),b("img",{src:me,class:"carousel-img"},null,8,He))),256))]}),_:1}))])),a(e(f),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(K),{trigger:"hover",options:F,placement:"bottom-start"},{default:s(()=>[a(e(g),null,{default:s(()=>[l("功能")]),_:1})]),_:1}),a(e(K),{trigger:"hover",options:x,placement:"bottom-start"},{default:s(()=>[a(e(g),null,{default:s(()=>[l("筛选")]),_:1})]),_:1}),a(e(be),{size:e(h).isMobile?28:34},{default:s(()=>[a(e(Te),{style:{cursor:"pointer"},onClick:i[0]||(i[0]=d=>y.value=!y.value)})]),_:1},8,["size"]),Qe,a(e(g),{type:"primary",onClick:i[1]||(i[1]=d=>o.$router.push({name:"loudspeaker"}))},{default:s(()=>[l("大喇叭")]),_:1}),a(e(g),{type:"primary",onClick:i[2]||(i[2]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),y.value?(n(),m(e(f),{key:1,wrap:!1},{default:s(()=>[a(e(qe),{value:t.value,"onUpdate:value":i[3]||(i[3]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":""},null,8,["value"]),a(e(g),{type:"primary",onClick:le},{default:s(()=>[l("搜索")]),_:1}),a(e(g),{type:"default",onClick:ne},{default:s(()=>[l("清空")]),_:1})]),_:1})):w("",!0),a($e),a(Ee,{"threads-list-data":e(P)?[]:e(H).threads_data.data,"new-window-to-post":e(T),"show-this":!e(P),onWithdrawDelayThreadSuccess:V},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(f),{align:"center"},{default:s(()=>[a(e(g),{type:r.delay?"default":"primary",onClick:ue},{default:s(()=>[l(u(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Me,{page:M.value,"onUpdate:page":[i[4]||(i[4]=d=>M.value=d),ie],"last-page":e(P)?1:e(H).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Ve,(n(),m(ke,{to:"#topbar-nav"},[a(pe,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Oe),{style:E({maxWidth:e(h).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(u((d=e(_).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(Re),{round:"",class:"forum-tag",size:e(h).isMobile?"small":"medium"},{default:s(()=>[l(u(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(xe,{mode:"forum",ref_key:"SidebarCom",ref:N,onRefresh:i[5]||(i[5]=d=>V(!0)),onNewThread:i[6]||(i[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),mt=ae(Je,[["__scopeId","data-v-4c5e4089"]]);export{mt as default};
