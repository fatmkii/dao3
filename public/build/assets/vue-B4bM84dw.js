import{p as Q,q as da,s as O,v as r,w as ma,x as Dl,j as R,y as k,z as e,B as nt,A as Yt,C as yt,D as me,F as t,H as Jt,I as bt,J as pa,K as Ke,f as _,n as ue,d as ie,L as Se,M as l,O as oe,Q as ae,R as x,S,T as L,U as a,W as fe,X as Ue,Y as j,Z as ee,_ as Ee,$ as M,a0 as lt,a1 as Te,a2 as je,a3 as Ne,a4 as Ct,a5 as Bt,l as de,a6 as fa,a7 as ga,a8 as va,r as Ze,a9 as et,aa as tt,ab as qe,ac as ba,ad as ca,ae as ya,af as wa,ag as _a,ah as ha,ai as ut,aj as ka,ak as Ca,N as ye,k as Ae,al as Pl,am as dl,an as dt,ao as xa,ap as Sa,aq as ct,ar as za,as as mt,at as Ma,au as Ll,av as Mt,aw as $a,ax as Ul,ay as Ia,az as Ft,e as jl,aA as Ge,aB as Le,aC as Hl,aD as Kt,aE as Al,aF as qt,aG as it,aH as Xt,aI as he,aJ as hl,aK as Oe,aL as $t,aM as kl,aN as Cl,aO as xl,aP as Wt,aQ as Ta,aR as Da,aS as Pa,aT as It,aU as sl,aV as il,aW as kt,aX as Fe,aY as Qt,aZ as Pt,a_ as Je,a$ as Zt,b0 as el,b1 as La,b2 as Ua,b3 as ja,b4 as Ha,b5 as Pe,b6 as Aa,b7 as Ra,b8 as Ba,b9 as Oa,ba as Xe,bb as ne,bc as xe,bd as vt,be as ot,bf as Ea,bg as ml,bh as wt,bi as Rl,bj as Na,bk as Fa,bl as qa,bm as Wa,bn as Ga,bo as Va,bp as Ya,bq as rt,br as Lt,bs as Bl,bt as Ja,bu as ul,bv as Ka,bw as _t,bx as ol,by as Xa,bz as Sl,bA as Qa,bB as Za,bC as eo,u as Ol,t as El,bD as to}from"./vendor-B6OyIHrq.js";import{u as te,b as xt,a as re,c as Ve}from"./stores-BaTD8Svh.js";import{n as lo,c as ao,a as oo,b as no,d as Nl,h as so,e as io,l as Fl,t as zl,r as uo,g as Ml,i as ro,j as mo,m as po,k as fo,o as go,p as $l,w as vo,q as bo,s as ql,v as co,x as yo,y as wo,z as _o,A as ho,B as ko,C as Co,D as xo,E as So,F as zo,G as Mo,H as $o,I as Io,J as To,K as Do,L as Po,M as Lo,N as Uo,O as jo,P as Ho,Q as Ao,R as Ro,S as Bo,T as Oo,U as Eo,V as No,W as Fo,X as qo,Y as Il,Z as Wo,_ as Go,$ as Vo,a0 as Yo,a1 as Jo,a2 as Ko,a3 as Xo,a4 as Qo,a5 as Zo,a6 as en,a7 as tn,a8 as ln,a9 as an,aa as on,ab as nn,ac as sn,ad as un,ae as rn,af as dn,ag as mn,ah as Wl,ai as pn,aj as fn,ak as gn,al as vn,am as bn,an as cn,ao as yn,ap as wn,aq as _n,ar as hn,as as kn}from"./api-BmrQciZx.js";import{g as Cn,r as Ie,u as pl,s as fl,a as Gl,b as ht,c as xn,d as tl,i as pt,e as ft,f as Sn,h as zn,j as gl}from"./app-D04zqvBp.js";import{f as Tt,h as Mn,i as Dt,r as Vl,j as $n,k as rl,m as nl,n as Tl,o as In}from"./data-Chqh2Qd2.js";const Tn=Q({setup(){window.$dialog=da()}}),$e=(G,c)=>{const m=G.__vccOpts||G;for(const[w,n]of c)m[w]=n;return m};function Dn(G,c,m,w,n,p){return r(),O("div")}const Pn=$e(Tn,[["render",Dn]]),Ln=Q({setup(){window.$message=ma()}});function Un(G,c,m,w,n,p){return r(),O("div")}const jn=$e(Ln,[["render",Un]]),E=Q({__name:"FButton",setup(G){const c=te(),m=xt(),w=Dl(),n=R(()=>({...w,...m.buttonThemeAttr})),p=R(()=>c.isMobile?"small":"medium");return(v,g)=>(r(),k(e(nt),Yt({round:"",size:p.value},n.value),yt({_:2},[me(v.$slots,(o,i,f)=>({name:i,fn:t(()=>[Jt(v.$slots,i)])}))]),1040,["size"]))}}),ve=Q({__name:"FInput",props:{autoSize:{type:Boolean,default:!1}},setup(G){const c=te(),m=G,w=R(()=>m.autoSize&&c.isMobile?"small":"medium");return(n,p)=>(r(),k(e(bt),Yt({round:"",size:w.value},n.$attrs),yt({_:2},[me(n.$slots,(v,g,o)=>({name:g,fn:t(()=>[Jt(n.$slots,g)])}))]),1040,["size"]))}}),ge=Q({__name:"FInputGroupLabel",props:{round:{type:Boolean,default:!0},autoSize:{type:Boolean,default:!1}},setup(G){const c=te(),m=Dl(),w=G,n=w.round?{"border-bottom-left-radius":"17px","border-top-left-radius":"17px"}:void 0,p=R(()=>({...m,style:n})),v=R(()=>w.autoSize&&c.isMobile?"small":"medium");return(g,o)=>(r(),k(e(pa),Yt({size:v.value},p.value),yt({_:2},[me(g.$slots,(i,f,d)=>({name:f,fn:t(()=>[Jt(g.$slots,f)])}))]),1040,["size"]))}}),Qe=Q({__name:"FCheckbox",setup(G){const c=te(),m=R(()=>c.isMobile?"small":"medium");return(w,n)=>(r(),k(e(Ke),Yt({size:m.value},w.$attrs),yt({_:2},[me(w.$slots,(p,v,g)=>({name:v,fn:t(()=>[Jt(w.$slots,v)])}))]),1040,["size"]))}}),Hn=Q({__name:"LoginModal",emits:["submitRegister"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_(!1);c({show:()=>p.value=!0});const g=_(""),o=_(""),i=R(()=>d.value.enable?"领取饼干开放中！":"领取饼干尚未开放"),f=R(()=>ie(d.value.next_date*1e3).format("YYYY年M月D日")),{data:d}=ue(lo,{initialData:{enable:!1,next_date:0}}),{data:h}=ue(ao(),{initialData:{reg_record_TTL:-2}}),T=R(()=>{if(!(h.value?.reg_record_TTL<=0))return`在${Math.floor(h.value?.reg_record_TTL/3600)}小时后才能再次领取饼干。`}),D=()=>{y(g.value,o.value),o.value=""},{loading:$,onSuccess:s,data:u,send:y}=ue(oo,{immediate:!1});s(()=>{localStorage.Token=u.value.token,localStorage.Binggan=u.value.binggan,window.location.href="/"});const b=()=>{q(Cn())},{loading:z,onSuccess:C,onError:I,data:N,send:q}=ue(no,{immediate:!1});C(()=>{n.binggan=N.value.binggan,localStorage.Token=N.value.token,localStorage.Binggan=N.value.binggan,p.value=!1,U("submitRegister")}),I(B=>{window.$dialog.error({title:"申请饼干失败",content:B.error.message})});const U=m;return(B,P)=>(r(),k(e(Se),{show:p.value,"onUpdate:show":P[4]||(P[4]=A=>p.value=A),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"欢迎来到小火锅！",closable:"",onClose:P[3]||(P[3]=A=>p.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[e(h).reg_record_TTL>0?(r(),k(e(M),{key:0,style:{"margin-right":"auto"}},{default:t(()=>[a(j(T.value),1)]),_:1})):L("",!0),l(e(E),{onClick:P[2]||(P[2]=A=>p.value=!1)},{default:t(()=>[...P[11]||(P[11]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[P[10]||(P[10]=S("div",null,[a("这里是私人论坛小火锅，欢迎来玩！"),S("br"),a("QQ小火锅避难群：156840110 "),S("br"),a("使用前需要在下面领取或者导入饼干喔")],-1)),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...P[5]||(P[5]=[a("饼干",-1)])]),_:1}),l(e(ve),{value:g.value,"onUpdate:value":P[0]||(P[0]=A=>g.value=A),placeholder:"请输入饼干",maxlength:"16",onKeyup:Ue(D,["enter"])},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...P[6]||(P[6]=[a("密码",-1)])]),_:1}),l(e(ve),{type:"password",placeholder:"（可留空）请输入密码","show-password-on":"mousedown",value:o.value,"onUpdate:value":P[1]||(P[1]=A=>o.value=A),onKeyup:Ue(D,["enter"])},null,8,["value"])]),_:1}),l(e(x),null,{default:t(()=>[l(e(E),{type:"warning",disabled:e(z)||!e(d).enable||e(h).reg_record_TTL>0,onClick:b},{default:t(()=>[a(j(i.value),1)]),_:1},8,["disabled"]),l(e(E),{style:{"margin-left":"auto"},type:"primary",onClick:D,disabled:e($)},{default:t(()=>[...P[7]||(P[7]=[a("导入饼干",-1)])]),_:1},8,["disabled"])]),_:1}),e(d).enable?L("",!0):(r(),O(ee,{key:0},[l(e(Ee),{trigger:"hover"},{trigger:t(()=>[...P[8]||(P[8]=[S("span",null,"领取饼干为定期开放（点击查看开放时间）",-1)])]),default:t(()=>[P[9]||(P[9]=S("span",null,[a("开放时间为："),S("br"),a("每月第1日、春节(3天)、国庆(3天)、"),S("br"),a("端午、中秋、618和双十一")],-1))]),_:1}),S("div",null,"下次开放："+j(f.value),1)],64))]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),An=Q({__name:"RegisterHintModal",setup(G,{expose:c}){const m=re(),w=te(),n=_(!1);c({show:()=>n.value=!0});function v(){n.value=!1,window.location.href="/"}return(g,o)=>{const i=lt("router-link");return r(),k(e(Se),{show:n.value,"onUpdate:show":o[1]||(o[1]=f=>n.value=f),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"欢迎加入小火锅！",closable:"",onClose:o[0]||(o[0]=f=>n.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:v},{default:t(()=>[...o[11]||(o[11]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:"",size:"medium",style:{"word-wrap":"break-word"}},{default:t(()=>[S("div",null,[o[2]||(o[2]=a("你的饼干是：",-1)),l(e(M),{strong:"",type:"info",style:{"font-size":"1.5rem"}},{default:t(()=>[a(j(e(m).binggan),1)]),_:1}),o[3]||(o[3]=S("br",null,null,-1)),o[4]||(o[4]=a("（之后在个人中心也可以查看）",-1))]),l(e(M),{depth:"2"},{default:t(()=>[...o[5]||(o[5]=[a("① 饼干就是你的小火锅账号。请保存好，不要泄露喔！",-1)])]),_:1}),l(e(M),{depth:"2"},{default:t(()=>[o[7]||(o[7]=a("② 为了账号安全，",-1)),l(e(M),{strong:"",type:"error"},{default:t(()=>[...o[6]||(o[6]=[a("建议尽快在个人中心设定密码。",-1)])]),_:1})]),_:1}),l(e(M),{depth:"2"},{default:t(()=>[o[9]||(o[9]=a("③ 请务必遵守",-1)),l(i,{to:"/thread/13351"},{default:t(()=>[...o[8]||(o[8]=[a("小火锅版规",-1)])]),_:1}),o[10]||(o[10]=a("喔！",-1))]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])}}}),Rn=Q({__name:"TopBar",setup(G){Te(s=>({"51bb01be":e(o).textColor1,"241e0506":e(g).themeColor.topBarBackgroudColor,"8a612fe6":e(o).dividerColor}));const c=re(),m=te(),w=Ne(),n=Ct(),p=_(null),v=_(null),g=xt(),o=je(),i=[{label:"魔芋锅",key:"sfw",icon:Ie(Bt,{color:"#F9F9F9"})},{label:"白汤锅",key:"light",icon:Ie(Bt,{color:"#d9efd9"})},{label:"芝麻锅",key:"dark",icon:Ie(Bt,{color:"#101014"})},{label:"青菜锅",key:"green",icon:Ie(Bt,{color:"#53A551"})},{type:"render",key:"monochrome",render:f}];function f(){return de(x,{style:"padding:6px 8px",vertical:!0},()=>[de(Qe,{checked:m.userCustom.monochromeMode,"onUpdate:checked":s=>m.userCustom.monochromeMode=s,label:"单色模式"})])}function d(){return de(x,{vertical:!0},()=>[de("div",{style:"display: flex; align-items: center; padding: 4px 8px;"},[de("img",{style:"max-height: 40px;",src:"/ui/my-binggan.png"}),de("div",null,[de("div",null,[de(M,{depth:3},{default:()=>"我的饼干"})]),de("div",{style:"font-size: 1rem;"},[de(M,{depth:2},{default:()=>c.binggan})])])]),de("div",{style:"display: flex; align-items: center; padding: 4px 8px;"},[de("img",{style:"max-height: 40px;",src:"/ui/my-olo.png"}),de("div",null,[de("div",null,[de(M,{depth:3},{default:()=>"奥利奥"})]),de("div",{style:"font-size: 1rem;"},[de(M,{depth:2},{default:()=>c.userData.binggan.coin})])])])])}const h=R(()=>{const s=[{key:"header",type:"render",render:d},{key:"header-divider",type:"divider"},{label:"个人中心",key:"profile",icon:Ie(fa,{size:"1.25rem"}),props:{onClick:()=>w.push("/user-center")}},{label:"退出饼干",key:"logout",icon:Ie(ga,{size:"1.25rem"}),props:{onClick:T}}];return c.admin.isForumAdmin&&s.splice(3,0,{label:"管理中心",key:"admin",icon:Ie(va,{size:"1.25rem"}),props:{onClick:()=>w.push("/admin-center")}}),s});function T(){const s={title:"退出饼干",closable:!1,content:"确定要退出饼干吗？请务必先记下自己的饼干喔。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Nl(c.binggan).then(()=>{pl(),window.location.href="/"})}};window.$dialog.warning(s)}function D(){c.refreshUserData()}function $(){v.value?.show()}return Ze(()=>{!(localStorage.getItem("Binggan")&&localStorage.getItem("Token"))&&n.path=="/"&&p.value?.show()}),(s,u)=>{const y=lt("router-link");return r(),k(e(x),{class:"top-bar",align:"center",wrap:!1},{default:t(()=>[S("img",{src:"/favicon.png",alt:"",onClick:u[0]||(u[0]=b=>s.$router.push("/"))}),et(l(y,{to:"/"},{default:t(()=>[...u[1]||(u[1]=[a(" 小火锅 ",-1)])]),_:1},512),[[tt,e(m).showTopbarNav]]),u[4]||(u[4]=S("div",{id:"topbar-nav",style:{"flex-shrink":"1",overflow:"hidden"}},null,-1)),u[5]||(u[5]=S("div",{id:"topbar-func"},null,-1)),l(e(qe),{trigger:e(m).isMobile?"click":"hover",options:i,onSelect:e(g).themeChange},{default:t(()=>[...u[2]||(u[2]=[S("img",{src:"/ui/skin.png",style:{"margin-left":"auto"},class:"img-icon"},null,-1)])]),_:1},8,["trigger","onSelect"]),e(c).userLoginStatus?(r(),k(e(qe),{key:0,trigger:e(m).isMobile?"click":"hover",options:h.value},{default:t(()=>[S("img",{src:"/ui/user-center.png",onMouseenter:D,class:"img-icon"},null,32)]),_:1},8,["trigger","options"])):L("",!0),!e(c).userDataLoading&&!e(c).userLoginStatus?(r(),k(e(E),{key:1,type:"primary",onClick:p.value?.show},{default:t(()=>[...u[3]||(u[3]=[a(" 导入饼干 ",-1)])]),_:1},8,["onClick"])):L("",!0),!e(c).userDataLoading&&!e(c).userLoginStatus?(r(),O(ee,{key:2},[l(Hn,{ref_key:"LoginModalCom",ref:p,onSubmitRegister:$},null,512),l(An,{ref_key:"registerHintModalCom",ref:v},null,512)],64)):L("",!0)]),_:1})}}}),Bn={style:{"margin-left":"auto"}},On=Q({__name:"UnauthModal",setup(G){const c=te(),m=R(()=>c.requestErrorCode===401?"你未导入饼干，或者饼干的登录信息已失效。请申请或重新导入饼干。":c.requestErrorCode===21499?"嗷……你的饼干被碎了。请申请或重新导入饼干。":"");return(w,n)=>(r(),k(e(Se),{show:e(c).unauthModalShow,"onUpdate:show":n[2]||(n[2]=p=>e(c).unauthModalShow=p),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(c).modalMaxWidth}),closable:"",onClose:n[1]||(n[1]=p=>e(c).unauthModalShow=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:e(pl),type:"primary"},{default:t(()=>[...n[4]||(n[4]=[a("导入饼干",-1)])]),_:1},8,["onClick"]),l(e(E),{onClick:n[0]||(n[0]=p=>e(c).unauthModalShow=!1)},{default:t(()=>[...n[5]||(n[5]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[n[3]||(n[3]=S("img",{src:"https://wmimg.com/i/1547/2025/02/67adef97e42d8.png",alt:"需要饼干才能进入喔"},null,-1)),S("div",Bn,j(m.value),1)]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Yu=Q({__name:"App",setup(G){Te(p=>({"569fcae7":e(w).userCustom.fontSizeQuote+"px","4f154f2c":e(m).textColor3,"4c417994":e(m).warningColor,fbf9aa24:e(m).primaryColor,"34b79c30":e(m).errorColor,"175e64d6":e(c).themeColor.postFooterColor,"7d36bd43":n.value}));const c=xt(),m=je();re();const w=te(),n=R(()=>w.userCustom.emojiWhiteBack?"#FFFFFF":void 0);return(p,v)=>{const g=lt("router-view");return r(),k(e(ca),{theme:e(c).themeClass,"theme-overrides":e(c).themeOverrideClass,locale:e(ba)},{default:t(()=>[l(e(ya)),l(e(wa),null,{default:t(()=>[l(jn)]),_:1}),l(e(_a),null,{default:t(()=>[l(Pn)]),_:1}),l(Rn),l(g,null,{default:t(({Component:o})=>[(r(),k(ha,{include:"ThreadPage,NewThread"},[(r(),k(ut(o)))],1024))]),_:1}),l(On)]),_:1},8,["theme","theme-overrides","locale"])}}}),En=Q({__name:"ForumsStar",props:{isFavorite:{type:Boolean,default:!1},forumId:{default:0}},emits:["favorite-add","favorite-cancel"],setup(G,{emit:c}){const m=G,w=de(ye,{size:"1.5rem",onClick:p},()=>de(m.isFavorite?ka:Ca)),n=c;function p(){m.isFavorite?n("favorite-cancel",m.forumId):n("favorite-add",m.forumId)}return(v,g)=>(r(),k(e(w)))}}),Nn={key:0,class:"carousel-box"},Fn=["src"],qn=Q({__name:"Home",setup(G){Te(s=>({d56b22c4:e(m).hoverColor}));const c=Ve(),m=je(),w=te(),n=Ne(),{loading:p,data:v}=ue(so),g=R(()=>fl(v.value));document.title="小火锅";const o=Ae("banner_hiden",!1),i=R(()=>({paddingBottom:w.isMobile?"6px":"",paddingTop:w.isMobile?"6px":""})),f=R(()=>({paddingBottom:w.isMobile?"6px":""})),d=_([]);Ze(()=>{localStorage.forums_favorites===void 0?localStorage.forums_favorites=JSON.stringify([]):d.value=JSON.parse(localStorage.forums_favorites)});const h=R(()=>{const s=c.forumsData.filter(b=>d.value.includes(b.id)),u=c.forumsData.filter(b=>!d.value.includes(b.id));return s.concat(u)});function T(s){d.value.includes(s)||(d.value.push(s),localStorage.forums_favorites=JSON.stringify(d.value))}function D(s){const u=d.value.indexOf(s);u!=-1&&(d.value.splice(u,1),localStorage.forums_favorites=JSON.stringify(d.value))}function $(s,u){const y=u.target;["path","svg"].includes(y.nodeName)||n.push({name:"forum",params:{forumId:s}})}return(s,u)=>{const y=lt("router-link");return r(),k(e(x),{justify:"center",vertical:""},{default:t(()=>[e(o)?L("",!0):(r(),O("div",Nn,[e(p)?(r(),k(e(Pl),{key:0,class:"carousel-skeleton",sharp:""})):L("",!0),e(p)?L("",!0):(r(),k(e(dl),{key:1,"show-arrow":"",trigger:e(w).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:t(()=>[(r(!0),O(ee,null,me(g.value,b=>(r(),O("img",{src:b,class:"carousel-img"},null,8,Fn))),256))]),_:1},8,["trigger"]))])),l(e(oe),{title:"小火锅公告",size:"small"},{default:t(()=>[u[8]||(u[8]=S("div",null,"这里个人论坛“小火锅”，欢迎来玩~",-1)),S("div",null,[u[1]||(u[1]=a("QQ小火锅避难群：",-1)),l(e(M),{type:"info"},{default:t(()=>[...u[0]||(u[0]=[a("156840110",-1)])]),_:1})]),S("div",null,[u[3]||(u[3]=a("目前小火锅有5个网址：",-1)),l(e(M),{type:"info"},{default:t(()=>[...u[2]||(u[2]=[a("cpttmm.com, www.cpttmm.com, cpttmm.love, www.cpttmm.love, v2.cpttmm.com",-1)])]),_:1}),u[4]||(u[4]=a("(v2尽量不要用)",-1))]),S("div",null,[l(e(M),null,{default:t(()=>[u[6]||(u[6]=a("请务必遵守",-1)),l(y,{to:"/thread/143750",style:{"text-decoration":"underline"}},{default:t(()=>[...u[5]||(u[5]=[a("小火锅版规",-1)])]),_:1}),u[7]||(u[7]=a("喔！",-1))]),_:1})])]),_:1}),l(e(x),{justify:"center",vertical:"",size:1},{default:t(()=>[(r(!0),O(ee,null,me(h.value,b=>(r(),k(e(oe),{size:"small",bordered:!0,key:b.id,class:"forum-cards","header-style":i.value,"content-style":f.value,hoverable:"",onClick:z=>$(b.id,z)},{header:t(()=>[l(e(x),null,{default:t(()=>[l(En,{"is-favorite":d.value.includes(b.id),"forum-id":b.id,onFavoriteAdd:T,onFavoriteCancel:D},null,8,["is-favorite","forum-id"]),a(" "+j(b.name),1)]),_:2},1024)]),"header-extra":t(()=>[l(e(dt),{round:""},{default:t(()=>[a(j(b.id),1)]),_:2},1024)]),default:t(()=>[l(e(M),null,{default:t(()=>[a(j(b.description),1)]),_:2},1024)]),_:2},1032,["header-style","content-style","onClick"]))),128))]),_:1})]),_:1})}}}),Wn=$e(qn,[["__scopeId","data-v-d287aa61"]]),Ju=Object.freeze(Object.defineProperty({__proto__:null,default:Wn},Symbol.toStringTag,{value:"Module"})),Gn={};function Vn(G,c){return r(),O("div",null,[...c[0]||(c[0]=[a("嗷……页面被吃掉了！",-1),S("br",null,null,-1),a(" 404 Not Found.",-1)])])}const Yn=$e(Gn,[["render",Vn]]),Ku=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"})),Gt=Q({__name:"Pagination",props:xa({pageSizes:{default:50},lastPage:{}},{page:{},pageModifiers:{}}),emits:["update:page"],setup(G){const c=te(),m=Sa(G,"page");return(w,n)=>(r(),k(e(ct),{page:m.value,"onUpdate:page":n[2]||(n[2]=p=>m.value=p),"page-count":w.lastPage,size:"medium","show-quick-jumper":"","page-slot":6,simple:!!e(c).isMobile,"display-order":["quick-jumper","pages","size-picker"]},yt({goto:t(()=>[n[3]||(n[3]=a("跳 ",-1))]),_:2},[e(c).isMobile?{name:"prefix",fn:t(()=>[S("div",{class:mt(["n-pagination-item n-pagination-item--button",{"n-pagination-item--disabled":m.value==1}])},[l(e(ye),{size:14},{default:t(()=>[l(e(za),{onClick:n[0]||(n[0]=p=>m.value=1)})]),_:1})],2)]),key:"0"}:void 0,e(c).isMobile?{name:"suffix",fn:t(()=>[S("div",{class:mt(["n-pagination-item n-pagination-item--button",{"n-pagination-item--disabled":m.value==w.lastPage}])},[l(e(ye),{size:14},{default:t(()=>[l(e(Ma),{onClick:n[1]||(n[1]=p=>m.value=w.lastPage)})]),_:1})],2)]),key:"1"}:void 0]),1032,["page","page-count","simple"]))}}),Jn=Q({__name:"Sidebar",props:{mode:{}},emits:["refresh","showJumpModal","newThread"],setup(G,{emit:c}){Te(i=>({d6d6f33a:e(w).primaryColor}));const m=xt(),w=je(),n=_(!1),p=_(24),v=te(),g=c;function o(i){i==="up"&&window.scrollTo(0,0),i==="down"&&window.scrollTo(0,document.body.scrollHeight)}return(i,f)=>(r(),k(e(x),{vertical:"",size:[0,24],class:mt(["sidebar",[e(v).userCustom.sidebarLeft?"left":"right"]]),align:"center"},{default:t(()=>[l(Mt,{name:"slide-fade"},{default:t(()=>[n.value?(r(),k(e(ye),{key:0,size:p.value+2,class:"icon",onClick:f[0]||(f[0]=d=>o("up")),color:e(m).themeColor.sidebarColor},{default:t(()=>[l(e(Ll))]),_:1},8,["size","color"])):L("",!0)]),_:1}),l(Mt,{name:"slide-fade"},{default:t(()=>[n.value&&i.mode=="forum"?(r(),k(e(ye),{key:0,size:p.value,class:"icon",onClick:f[1]||(f[1]=d=>g("newThread")),color:e(m).themeColor.sidebarColor},{default:t(()=>[...f[6]||(f[6]=[S("svg",{viewBox:"0 0 16 16"},[S("path",{d:"M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"})],-1)])]),_:1},8,["size","color"])):L("",!0)]),_:1}),l(Mt,{name:"slide-fade"},{default:t(()=>[n.value?(r(),k(e(ye),{key:0,size:p.value,class:"icon",onClick:f[2]||(f[2]=d=>g("refresh")),color:e(m).themeColor.sidebarColor},{default:t(()=>[...f[7]||(f[7]=[S("svg",{viewBox:"0 0 512 512"},[S("path",{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"})],-1)])]),_:1},8,["size","color"])):L("",!0)]),_:1}),l(Mt,{name:"slide-fade"},{default:t(()=>[n.value&&i.mode=="thread"?(r(),k(e(ye),{key:0,size:p.value,class:"icon",color:e(m).themeColor.sidebarColor,onClick:f[3]||(f[3]=d=>g("showJumpModal"))},{default:t(()=>[l(e($a))]),_:1},8,["size","color"])):L("",!0)]),_:1}),l(Mt,{name:"slide-fade"},{default:t(()=>[n.value?(r(),k(e(ye),{key:0,size:p.value+2,class:"icon",onClick:f[4]||(f[4]=d=>o("down")),color:e(m).themeColor.sidebarColor},{default:t(()=>[l(e(Ul))]),_:1},8,["size","color"])):L("",!0)]),_:1}),l(e(ye),{size:p.value,class:"icon",onClick:f[5]||(f[5]=d=>n.value=!n.value),color:e(m).themeColor.sidebarColor},{default:t(()=>[l(e(Ia))]),_:1},8,["size","color"])]),_:1},8,["class"]))}}),Yl=$e(Jn,[["__scopeId","data-v-a449bb83"]]),Kn={key:0},Xn=Q({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(G,{expose:c,emit:m}){Te(s=>({"07aae8c0":e(n).hoverColor,"4be6a5f4":e(n).textColor1}));const w=te(),n=je(),p=Ne(),v=G,g=m,o=Gl(),i=o.data;function f(){o.reload()}c({reloadBrowseLogger:f});function d(s){const u={name:"thread",params:{threadId:s,page:Math.ceil((i.value[s].floor+1)/200)},hash:`#f_${i.value[s].floor}`};if(v.newWindowToPost){const y=p.resolve(u);window.open(y.href,"_blank")}else p.push(u)}const{loading:h,send:T,onSuccess:D}=ue(s=>io(s),{immediate:!1});D(()=>{g("withdrawDelayThreadSuccess")});function $(s){ht({title:"要撤回延时主题吗？",onPositiveClick:()=>{T(s)}})}return(s,u)=>{const y=lt("router-link");return s.showThis?(r(),k(e(x),{key:0,vertical:"",size:2},{default:t(()=>[(r(!0),O(ee,null,me(s.threadsListData,b=>(r(),k(e(oe),{size:"small",bordered:!0,key:b.id,class:"thread-cards","content-style":{padding:e(w).userCustom.threadListCardPadding+"px"},hoverable:""},{default:t(()=>[l(e(x),{vertical:"",size:[0,0]},{default:t(()=>[S("div",{style:ae({color:b.title_color&&!e(w).userCustom.monochromeMode?b.title_color:e(n).textColor1,fontSize:e(w).userCustom.fontSizeThreadList+"px",lineHeight:1.5}),class:"thread-title"},[a(j(b.sub_title)+" "+j(b.vote_question_id?"🗳️":"")+" "+j(b.gamble_question_id?"🎲":"")+" "+j(b.crowd_id?"💰":"")+" "+j(b.hongbao_id?"🧧":"")+" ",1),l(y,{to:{name:"thread",params:{threadId:b.id}},style:ae({color:b.title_color&&!e(w).userCustom.monochromeMode?b.title_color:e(n).textColor1,pointerEvents:b.is_delay?"none":void 0}),target:s.newWindowToPost?"_blank":!1},{default:t(()=>[a(j(b.title),1)]),_:2},1032,["to","style","target"]),b.posts_num>200?(r(),k(y,{key:0,to:{name:"thread",params:{threadId:b.id,page:Math.ceil((b.posts_num+1)/200)}},target:s.newWindowToPost?"_blank":!1},{default:t(()=>[a(" ["+j(Math.ceil((b.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):L("",!0),e(i)[b.id]?(r(),k(e(E),{key:1,size:"tiny",type:"primary",onClick:z=>d(b.id)},{default:t(()=>[a(" ["+j(e(i)[b.id]?.floor)+"楼] ",1)]),_:2},1032,["onClick"])):L("",!0),b.is_your_thread?(r(),k(e(E),{key:2,size:"tiny",type:"warning",disabled:e(h),onClick:z=>$(b.id)},{default:t(()=>[...u[0]||(u[0]=[a("撤回",-1)])]),_:1},8,["disabled","onClick"])):L("",!0)],4),l(e(x),{size:"small",class:"thread-title-secondary",style:ae({fontSize:e(w).userCustom.fontSizeThreadListFooter+"px",marginTop:e(w).userCustom.threadListInnerMargin+"px",lineHeight:1.5})},{default:t(()=>[S("span",null,[l(e(M),{depth:"3"},{default:t(()=>[...u[1]||(u[1]=[a("最新回复:",-1)])]),_:1}),a(" "+j(b.updated_at),1)]),S("span",null,[l(e(M),{depth:"3"},{default:t(()=>[...u[2]||(u[2]=[a("发帖人:",-1)])]),_:1}),a(" "+j(b.nickname),1)]),u[4]||(u[4]=S("span",{style:{"margin-left":"auto"}},null,-1)),a(" "+j(b.posts_num>1200?"🔥":"")+" ",1),b.locked_by_coin>0?(r(),O("span",Kn,"🔒"+j(b.locked_by_coin),1)):L("",!0),S("span",null,[l(e(M),{depth:"3"},{default:t(()=>[...u[3]||(u[3]=[a("Re:",-1)])]),_:1}),a(" "+j(b.posts_num),1)])]),_:2},1032,["style"])]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(r(),k(e(x),{key:1,vertical:"",size:2},{default:t(()=>[(r(),O(ee,null,me(50,b=>l(e(oe),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Jl=$e(Xn,[["__scopeId","data-v-3819a25a"]]),Qn=Q({__name:"LoudspeakerModal",props:{loudspeakerData:{}},setup(G,{expose:c}){Te(o=>({"0e072a93":e(w).textColor1}));const m=te(),w=je(),n=Ne(),p=_(!1);function v(){p.value=!0}c({show:v});function g(){n.push("/loudspeaker"),p.value=!1}return(o,i)=>(r(),k(e(Se),{show:p.value,"onUpdate:show":i[2]||(i[2]=f=>p.value=f),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"大喇叭列表",closable:"",onClose:i[1]||(i[1]=f=>p.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:g},{default:t(()=>[...i[3]||(i[3]=[a("去发大喇叭",-1)])]),_:1}),l(e(E),{onClick:i[0]||(i[0]=f=>p.value=!1)},{default:t(()=>[...i[4]||(i[4]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:"",size:[0,12],class:"loudspeaker-content",style:{"max-height":"75vh","overflow-y":"auto"}},{default:t(()=>[(r(!0),O(ee,null,me(o.loudspeakerData,(f,d)=>(r(),k(ut(f.thread_id?"router-link":"span"),{key:f.id,style:ae([{color:e(m).userCustom.monochromeMode?e(w).textColor1:f.color},{"white-space":"pre-wrap"}]),to:f.thread_id!==null?`/thread/${f.thread_id}/1`:void 0},{default:t(()=>[a(j(d)+". "+j(f.content),1)]),_:2},1032,["style","to"]))),128))]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Zn=$e(Qn,[["__scopeId","data-v-2a682b08"]]),es={class:"loudspeaker-container loudspeaker_container"},ts={key:1},ls=Q({__name:"LoudspeakerComponent",setup(G){Te(h=>({"59eb691c":e(n).textColor1}));const c=re(),m=te(),w=_(),n=je(),p=R(()=>!g&&o.value.length===0),v={binggan:c.binggan,mode:"effective"},{loading:g,data:o,send:i,onSuccess:f}=ue(h=>Fl(h),{immediate:!1,initialData:[]});c.binggan&&i(v),f(()=>{Ft(()=>{setTimeout(()=>d(),1e3)})});function d(){const h=document.getElementsByClassName("loudspeaker-content")[0];if(h===void 0)return;const T=h.offsetHeight,D=document.createElement("style");D.id="loudspeaker-keyframe";const $=`@keyframes loudspeaker-move {
                /* 原理 height值的变化 移动一个容器的高度 */
                from {
                    top: 0;
                }
                to {
                    top: -DOM_HEIGHTpx;
                }
            }
            @-webkit-keyframes loudspeaker-move {
                /* 原理 height值的变化 移动一个容器的高度 */
                from {
                    top: 0;
                }
                to {
                    top: -DOM_HEIGHTpx;
                }
            }

            .loudspeaker-content {
                animation: SPEEDs loudspeaker-move infinite linear;
                -webkit-animation: SPEEDs loudspeaker-move infinite linear;
            }`;D.innerHTML=$.replace(/DOM_HEIGHT/g,String(Math.floor(T/2))).replace(/SPEED/g,String(Math.floor(T/20))),document.getElementsByTagName("head")[0].appendChild(D)}return jl(()=>{document.getElementById("loudspeaker-keyframe")?.remove()}),(h,T)=>{const D=lt("router-link");return r(),k(e(x),{wrap:!1,style:{"margin-top":"8px"}},{default:t(()=>[S("img",{style:{height:"2.5rem",cursor:"pointer"},src:"/ui/miku-loudspeaker.png",onClick:T[0]||(T[0]=$=>w.value?.show())}),S("div",es,[e(g)?(r(),k(e(Ge),{key:0,size:"small"})):L("",!0),p.value?(r(),O("div",ts,[l(D,{to:"/loudspeaker"},{default:t(()=>[...T[1]||(T[1]=[a(" 目前没有大喇叭，要发一个吗？ ",-1)])]),_:1})])):L("",!0),p.value?L("",!0):(r(),k(e(x),{key:2,vertical:"",size:[0,4],class:"loudspeaker-content"},{default:t(()=>[(r(!0),O(ee,null,me(e(o),($,s)=>(r(),k(ut($.thread_id?"router-link":"span"),{key:s,style:ae([{color:e(m).userCustom.monochromeMode?e(n).textColor1:$.color},{"white-space":"pre-wrap"}]),to:$.thread_id!==null?`/thread/${$.thread_id}/1`:void 0},{default:t(()=>[a(j($.content),1)]),_:2},1032,["style","to"]))),128)),(r(!0),O(ee,null,me(e(o),($,s)=>(r(),k(ut($.thread_id?"router-link":"span"),{key:s+e(o).length,style:ae([{color:e(m).userCustom.monochromeMode?e(n).textColor1:$.color},{"white-space":"pre-wrap"}]),to:$.thread_id!==null?`/thread/${$.thread_id}/1`:void 0},{default:t(()=>[a(j($.content),1)]),_:2},1032,["style","to"]))),128))]),_:1}))]),l(Zn,{"loudspeaker-data":e(o),ref_key:"LoudspeakerModalCom",ref:w},null,8,["loudspeaker-data"])]),_:1})}}}),Nt=$e(ls,[["__scopeId","data-v-cd135ec8"]]),as={key:0,class:"carousel-box"},os={key:0,class:"carousel-box"},ns=["src"],ss=Q({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(G){Te(ce=>({"366ac772":e(m).bannerHeight}));const c=re(),m=te(),w=Ve(),n=Ne(),p=_(null);_();const v=_();xn();const g=G,o=R(()=>fl(w.forumData(g.forumId)?.banners).slice(0,5));document.title=w.forumData(g.forumId)?.name??"小火锅";const i=Ae("banner_hiden",!1),f=Ae("new_window_to_post",!1);function d(){return de(x,{style:"padding:6px 8px",vertical:!0},()=>[de(Qe,{checked:i.value,"onUpdate:checked":ce=>i.value=ce,label:"隐藏版头"}),de(Qe,{checked:f.value,"onUpdate:checked":ce=>f.value=ce,label:"新窗口打开"})])}const h=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:d}],T=Ae("subtitles_included",Tt),D=R(()=>Tt.filter(ce=>!T.value.includes(ce)));function $(){return de(Xt,{value:T.value,"onUpdate:value":ce=>T.value=ce},()=>[de(x,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(Tt).map(ce=>de(Qe,{value:ce,label:ce}))])])}const s=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:$}],u=_(g.search),y=_(!!g.search);function b(){n.push({name:"forum",params:{forumId:g.forumId,page:1},query:{search:u.value||void 0}})}function z(){u.value=void 0,y.value=!1,n.push({name:"forum",params:{forumId:g.forumId,page:1}})}function C(){n.push({name:"forum",params:{forumId:g.forumId,page:1},query:{delay:g.delay?void 0:"true"}})}const I=_(g.page);function N(ce){n.push({name:"forum",params:{forumId:g.forumId,page:ce},query:{search:g.search,delay:g.delay?"true":void 0}})}Le(()=>g.page,ce=>I.value=ce);const q=R(()=>({forumId:g.forumId,binggan:c.binggan,page:g.page,threadsPerPage:50,subtitlesExcluded:D.value,searchTitle:g.search,delay:g.delay})),{loading:U,data:B,onSuccess:P}=Hl(()=>zl(q.value),[()=>g.forumId,()=>g.page,()=>g.search,()=>g.delay,D],{initialData:[],immediate:!0}),A=_(!1),{onSuccess:W,fetch:J}=Kt();function pe(ce=!1){A.value=ce,J(zl(q.value)),v.value?.reloadBrowseLogger()}W(()=>{A.value&&!m.userCustom.lessToast&&window.$message.success("已刷新数据")});const Re=R(()=>{if(U.value)return[];if(c.userData.binggan.use_pingbici){const ce=m.userCustom.pingbiciIngnoreCase?"gi":"g";return B.value.threads_data.data.filter(be=>{for(let ze of c.userData.pingbici.title_pingbici)if(new RegExp(ze,ce).test(be.title))return!1;return!0})}else return B.value.threads_data.data});return(ce,be)=>{const ze=lt("router-link");return r(),k(e(x),{vertical:""},{default:t(()=>[e(i)?L("",!0):(r(),O("div",as,[e(w).forumsDataLoading?(r(),O("div",os,[l(e(Pl),{class:"carousel-skeleton",sharp:""})])):L("",!0),e(w).forumsDataLoading?L("",!0):(r(),k(e(dl),{key:1,"show-arrow":"",trigger:e(m).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:t(()=>[(r(!0),O(ee,null,me(o.value,Ce=>(r(),O("img",{src:Ce,class:"carousel-img"},null,8,ns))),256))]),_:1},8,["trigger"]))])),l(e(x),{style:{"margin-top":"8px"},size:"small"},{default:t(()=>[l(e(qe),{trigger:e(m).isMobile?"click":"hover",options:h,placement:"bottom-start"},{default:t(()=>[l(e(E),null,{default:t(()=>[...be[7]||(be[7]=[a("功能",-1)])]),_:1})]),_:1},8,["trigger"]),l(e(qe),{trigger:e(m).isMobile?"click":"hover",options:s,placement:"bottom-start"},{default:t(()=>[l(e(E),null,{default:t(()=>[...be[8]||(be[8]=[a("筛选",-1)])]),_:1})]),_:1},8,["trigger"]),l(e(ye),{size:e(m).isMobile?28:34},{default:t(()=>[l(e(Al),{style:{cursor:"pointer"},onClick:be[0]||(be[0]=Ce=>y.value=!y.value)})]),_:1},8,["size"]),l(e(E),{type:"primary",style:{"margin-left":"auto"},onClick:be[1]||(be[1]=Ce=>ce.$router.push({name:"loudspeaker"}))},{default:t(()=>[...be[9]||(be[9]=[a("大喇叭",-1)])]),_:1}),l(e(E),{type:"primary",onClick:be[2]||(be[2]=Ce=>ce.$router.push({name:"new-thread",params:{forumId:g.forumId}}))},{default:t(()=>[...be[10]||(be[10]=[a("新主题",-1)])]),_:1})]),_:1}),y.value?(r(),k(e(x),{key:1,wrap:!1},{default:t(()=>[l(e(ve),{value:u.value,"onUpdate:value":be[3]||(be[3]=Ce=>u.value=Ce),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":"",onKeyup:Ue(b,["enter"])},null,8,["value"]),l(e(E),{type:"primary",onClick:b},{default:t(()=>[...be[11]||(be[11]=[a("搜索",-1)])]),_:1}),l(e(E),{type:"default",onClick:z},{default:t(()=>[...be[12]||(be[12]=[a("清空",-1)])]),_:1})]),_:1})):L("",!0),l(Nt),l(Jl,{ref_key:"ThreadListCom",ref:v,"threads-list-data":Re.value,"new-window-to-post":e(f),"show-this":!e(U),onWithdrawDelayThreadSuccess:pe},null,8,["threads-list-data","new-window-to-post","show-this"]),l(e(x),{align:"center"},{default:t(()=>[l(e(E),{type:g.delay?"default":"primary",onClick:C},{default:t(()=>[a(j(g.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),l(Gt,{page:I.value,"onUpdate:page":[be[4]||(be[4]=Ce=>I.value=Ce),N],"last-page":e(U)?1:e(B).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),be[13]||(be[13]=S("div",{style:{height:"50px"}},null,-1)),(r(),k(qt,{to:"#topbar-nav"},[l(ze,{to:"/",class:"flex-item-center"},{default:t(()=>[l(e(it),{tooltip:!1},{default:t(()=>[a(j(e(w).forumData(ce.forumId)?.name),1)]),_:1}),l(e(dt),{round:"",class:"forum-tag",size:e(m).isMobile?"small":"medium"},{default:t(()=>[a(j(ce.forumId),1)]),_:1},8,["size"])]),_:1})])),l(Yl,{mode:"forum",ref_key:"SidebarCom",ref:p,onRefresh:be[5]||(be[5]=Ce=>pe(!0)),onNewThread:be[6]||(be[6]=Ce=>ce.$router.push({name:"new-thread",params:{forumId:g.forumId}}))},null,512)]),_:1})}}}),is=$e(ss,[["__scopeId","data-v-e58df8a9"]]),Xu=Object.freeze(Object.defineProperty({__proto__:null,default:is},Symbol.toStringTag,{value:"Module"})),us=["src"],rs=Q({__name:"ForbiddenModal",setup(G,{expose:c}){const m=_(0),w=_(""),n=te(),p=_(!1);function v(g){m.value=g.errorCode,w.value=g.message,p.value=!0}return c({show:v}),(g,o)=>(r(),k(e(Se),{show:p.value,"onUpdate:show":o[2]||(o[2]=i=>p.value=i),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(n).modalMaxWidth}),closable:"",onClose:o[1]||(o[1]=i=>p.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:o[0]||(o[0]=i=>p.value=!1)},{default:t(()=>[...o[3]||(o[3]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[S("img",{style:{width:"100%"},src:e(Mn)[m.value].ImgSrc},null,8,us),l(e(M),null,{default:t(()=>[a(j(w.value),1)]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),ds=Q({__name:"RollModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=G,v=R(()=>{let y=[];if(i.value>0&&f.value>0){for(var b=0;b<i.value;b++)y[b]=Math.floor(Math.random()*f.value)+1;return y.join()}else return null}),g=_(),o=_(),i=_(1),f=_(100),d=_(!1);function h(){d.value=!0}c({show:h});const T=m,{loading:D,send:$,onSuccess:s}=ue(y=>uo(y),{immediate:!1});function u(){if(!i.value){window.$message.error("请填写骰子数量");return}if(!f.value){window.$message.error("请填写骰子数量");return}const y={binggan:n.binggan,thread_id:p.threadId,forum_id:p.forumId,roll_name:g.value,roll_event:o.value,roll_num:i.value,roll_range:f.value};$(y)}return s(()=>{T("refreshPostsList"),d.value=!1}),(y,b)=>(r(),k(e(Se),{show:d.value,"onUpdate:show":b[6]||(b[6]=z=>d.value=z),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"Roll点",closable:"",onClose:b[5]||(b[5]=z=>d.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:u,disabled:e(D)},{default:t(()=>[...b[12]||(b[12]=[a("Roll it!",-1)])]),_:1},8,["disabled"]),l(e(E),{onClick:b[4]||(b[4]=z=>d.value=!1)},{default:t(()=>[...b[13]||(b[13]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...b[7]||(b[7]=[a(" 输出参考： ",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(g.value?`「${g.value}」，`:"")+" "+j(o.value?`「${o.value}」的结果：`:"")+" "+j(`${i.value} d ${f.value} = 「${v.value}」`),1)]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"},class:"round"},{default:t(()=>[...b[8]||(b[8]=[a("Roll点昵称",-1)])]),_:1}),l(e(ve),{placeholder:"可留空",maxlength:100,value:g.value,"onUpdate:value":b[0]||(b[0]=z=>g.value=z)},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"},class:"round"},{default:t(()=>[...b[9]||(b[9]=[a("Roll点事件",-1)])]),_:1}),l(e(ve),{placeholder:"可留空",maxlength:100,value:o.value,"onUpdate:value":b[1]||(b[1]=z=>o.value=z)},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"},class:"round"},{default:t(()=>[...b[10]||(b[10]=[a("骰子数量",-1)])]),_:1}),l(e(he),{max:100,min:1,placeholder:"必须填写",value:i.value,"onUpdate:value":b[2]||(b[2]=z=>i.value=z)},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"},class:"round"},{default:t(()=>[...b[11]||(b[11]=[a("骰子大小",-1)])]),_:1}),l(e(he),{max:1e4,min:1,placeholder:"必须填写",value:f.value,"onUpdate:value":b[3]||(b[3]=z=>f.value=z)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),ms=["src"],ps=["innerHTML"],fs=Q({__name:"Battle",props:{battleId:{}},setup(G,{expose:c}){Te(q=>({"30a92dbb":e(n).warningColor,ee2e7862:e(n).errorColor}));const m=re(),w=te();Ve(),Ne();const n=je(),p=G,v=[{"flex-direction":"row","justify-content":"center"},{"flex-direction":"row","justify-content":"start"},{"flex-direction":"row-reverse","justify-content":"end"}],g=R(()=>h.value.battle_messages.map((q,U)=>U===0?{...q,message:q.message.replace(/\d+(,\d+)*/g,B=>{const P=+B.replace(/,/g,"");return P>=1e4?`<span class="big-number-2">${B}</span>`:P>=1e3?`<span class="big-number-1">${B}</span>`:B})}:q)),o=R(()=>{const q=Dt[h.value.battle.chara_group];if(h.value.battle.chara_group===0){const U=m.userData.my_battle_chara.filter(B=>!B.not_use).map((B,P)=>({value:P+240,label:B.name}));return q.concat(U)}else return q}),i=R(()=>h.value.battle.is_your_battle||h.value.battle.you_are_challenger),f=R(()=>{const q=h.value.battle;if(!i.value)return"";const U=q.result===1&&q.is_your_battle===!0||q.result===2&&q.you_are_challenger===!0||q.result===3,B=w.isDouble11?1.98:1.96,P=Math.floor(U?q.battle_olo*B:q.battle_olo).toLocaleString("en-us");return`你${U?"赢得":"输掉"}了${P}个奥利奥`}),d=_(8),{data:h,loading:T,onSuccess:D}=ue(Ml(p.battleId));D(q=>{q.data.battle.progress===0&&hl(`battleDataGetter-${q.data.battle.id}`),q.data.battle.chara_group>0&&(d.value=Dt[q.data.battle.chara_group][0].value)});const{fetch:$,fetching:s,onSuccess:u}=Kt();function y(){$(Ml(p.battleId))}u(q=>{q.data.battle.progress===0&&hl(`battleDataGetter-${q.data.battle.id}`)}),c({refreshBattleDataHandle:y});const{loading:b,onSuccess:z,onError:C,send:I}=ue(q=>ro(q),{immediate:!1});z(()=>{y()}),C(()=>{y()});function N(){const q={title:"加入战斗！",closable:!1,content:`将押注：${h.value.battle.battle_olo.toLocaleString("en-us")}个奥利奥`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{const U={binggan:m.binggan,battle_id:p.battleId,chara_id:d.value>=240?d.value-240:d.value,is_custom_chara:d.value>=240};I(U)}};window.$dialog.warning(q)}return(q,U)=>(r(),k(e(oe),{size:"small",bordered:!0,embedded:"",class:"battle-card"},{default:t(()=>[l(e(Ge),{show:e(T)||e(s)},{default:t(()=>[e(h)!==void 0?(r(),k(e(x),{key:0,vertical:"",size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(g.value,B=>(r(),k(e(x),{align:"center",wrap:!1,style:ae(v[B.message_type])},{default:t(()=>[S("img",{class:"emoji-img",src:B.chara_url},null,8,ms),B.message_type!==0?(r(),O("span",{key:0,innerHTML:B.message},null,8,ps)):(r(),k(e(dt),{key:1,round:""},{default:t(()=>[a(j(B.message),1)]),_:2},1024))]),_:2},1032,["style"]))),256)),l(e(x),{style:ae(v[0])},{default:t(()=>[e(h).battle.progress===0?(r(),k(e(dt),{key:0,round:""},{default:t(()=>[...U[1]||(U[1]=[a("正在等待挑战者",-1)])]),_:1})):L("",!0),e(h).battle.progress===2&&i.value?(r(),k(e(dt),{key:1,round:""},{default:t(()=>[a(j(f.value),1)]),_:1})):L("",!0)]),_:1},8,["style"]),e(h).battle.progress===0&&e(h).battle.is_your_battle===!1?(r(),k(e(x),{key:0,size:"small",wrap:!1,align:"center",justify:"center",style:{"margin-top":"6px"}},{default:t(()=>[l(e(fe),{style:{"max-width":"15.2rem"}},{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...U[2]||(U[2]=[a("角色",-1)])]),_:1}),l(e(Oe),{value:d.value,"onUpdate:value":U[0]||(U[0]=B=>d.value=B),options:o.value},null,8,["value","options"])]),_:1}),l(e(E),{type:"primary",onClick:N,disabled:e(b),loading:e(b)},{default:t(()=>[...U[3]||(U[3]=[a("挑战",-1)])]),_:1},8,["disabled","loading"])]),_:1})):L("",!0)]),_:1})):L("",!0)]),_:1},8,["show"])]),_:1}))}}),gs={key:0},vs=Q({__name:"HongbaoPost",props:{hongbaoData:{},threadId:{},forumId:{},noHongbaoPicMode:{type:Boolean,default:!1}},emits:["refreshPostsList"],setup(G,{emit:c}){const m=re(),w=te(),n=G,p=R(()=>({1:"随机olo",2:"定额olo"})[n.hongbaoData.type]),v=R(()=>({1:"口令红包",2:"抢答红包",3:"暗号红包"})[n.hongbaoData.key_word_type]),g=R(()=>n.hongbaoData.pic_url&&!n.noHongbaoPicMode),o=R(()=>g.value?{backgroundImage:`linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)), url(${n.hongbaoData.pic_url})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{}),i=_(n.hongbaoData.key_word_type===1?n.hongbaoData.key_word:""),f=c,{loading:d,send:h,onSuccess:T,onError:D}=ue(s=>mo(s),{immediate:!1});function $(s){if(!s.isTrusted){const z={title:"错误",closable:!1,content:"请不要用脚本抢红包喔",positiveText:"确定"};window.$dialog.warning(z);return}const{timestamp:u,newPostKey:y}=tl(s.isTrusted,n.threadId,m.binggan),b={binggan:m.binggan,forum_id:n.forumId,thread_id:n.threadId,content:"--红包口令: "+i.value,nickname:"= =",post_with_admin:!1,new_post_key:y,timestamp:u,hongbao_post_id:n.hongbaoData.id,hongbao_key_word:i.value};h(b)}return T(()=>{i.value="",f("refreshPostsList")}),D(()=>{i.value="",f("refreshPostsList")}),(s,u)=>(r(),k(e(x),{size:"small",vertical:""},{default:t(()=>[l(e(oe),{size:"small",bordered:!0,embedded:"",class:"hongbao-post-card",style:ae(o.value)},{default:t(()=>[l(e(x),{vertical:"",align:"center"},{default:t(()=>[l(e(x),{align:"center",size:"small"},{default:t(()=>[l(e(M),{style:{"font-size":"1rem"}},{default:t(()=>[a(j(v.value),1)]),_:1}),g.value?L("",!0):(r(),O("img",{key:0,src:"/hongbao.svg",style:ae({height:e(w).isMobile?"30px":"36px"})},null,4))]),_:1}),S("div",null,[s.hongbaoData.question?(r(),k(e(M),{key:0,depth:3},{default:t(()=>[...u[1]||(u[1]=[a("提示：",-1)])]),_:1})):L("",!0),l(e(M),null,{default:t(()=>[a(j(s.hongbaoData.question),1)]),_:1})]),S("div",null,[s.hongbaoData.key_word?(r(),k(e(M),{key:0,depth:3},{default:t(()=>[...u[2]||(u[2]=[a("口令：",-1)])]),_:1})):L("",!0),l(e(M),null,{default:t(()=>[a(j(s.hongbaoData.key_word),1)]),_:1})]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...u[3]||(u[3]=[a("数量：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(s.hongbaoData.num_remains)+" /"+j(s.hongbaoData.num_total)+" （"+j(p.value)+"）",1)]),_:1})]),s.hongbaoData.olo_hide?L("",!0):(r(),O("div",gs,[l(e(M),{depth:3},{default:t(()=>[...u[4]||(u[4]=[a("总额：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(s.hongbaoData.olo_total?.toLocaleString("en-us"))+" olo ",1)]),_:1})]))]),_:1})]),_:1},8,["style"]),l(e(x),{size:"small",wrap:!1},{default:t(()=>[s.hongbaoData.hongbao_user===null?(r(),k(e(ve),{key:0,value:i.value,"onUpdate:value":u[0]||(u[0]=y=>i.value=y),maxlength:255,onKeyup:Ue($,["enter"]),style:{"max-width":"328px"},placeholder:s.hongbaoData.num_remains===0?"已经抢光啦":"请输入口令","auto-size":"",disabled:s.hongbaoData.hongbao_user!==null||s.hongbaoData.num_remains===0},null,8,["value","placeholder","disabled"])):(r(),k(e(ve),{key:1,value:`你抢到了${s.hongbaoData.hongbao_user?.olo.toLocaleString("en-us")}个olo`,maxlength:255,style:{"max-width":"328px"},"auto-size":"",disabled:""},null,8,["value"])),l(e(E),{type:"primary",onClick:$,disabled:s.hongbaoData.hongbao_user!==null||e(d)||s.hongbaoData.num_remains===0},{default:t(()=>[...u[5]||(u[5]=[a("抢！",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}))}}),bs=$e(vs,[["__scopeId","data-v-e0a759ba"]]),cs={key:0,class:"random-head-container"},ys=["src"],ws=["innerHTML"],_s={class:"post-created-at"},hs={key:0,class:"post-anti-jingfen"},ks={key:1},Vt=Q({__name:"PostItem",props:{forumId:{},postData:{},yourPostsList:{default:()=>[]},randomHeadGroupIndex:{default:1},antiJingfen:{type:Boolean,default:!1},noImageMode:{type:Boolean,default:!1},noEmojiMode:{type:Boolean,default:!1},noCustomEmojiMode:{type:Boolean,default:!1},noHeadMode:{type:Boolean,default:!1},noVideoMode:{type:Boolean,default:!1},noMentionMode:{type:Boolean,default:!1},useUrlMode:{type:Boolean,default:!1},previewMode:{type:Boolean,default:!1},superAdminMode:{type:Boolean,default:!1},adminMode:{type:Boolean,default:!1},noHongbaoPicMode:{type:Boolean}},emits:["showRewardModal","quoteClick","refreshPostsList","adminHandle"],setup(G,{expose:c,emit:m}){const w=_(!1),n=re(),p=te(),v=xt(),g=_(null),o=_(null),i=_(null),f=G,d=R(()=>p.userCustom.postLegacyMode?{paddingTop:"6px",paddingBottom:"6px",borderBottom:"1px solid",borderColor:v.themeColor.postItemBorderColor}:void 0),h=R(()=>p.userCustom.postLegacyMode?void 0:{padding:p.userCustom.postCardPadding+"px"}),T=R(()=>{let H=0;return p.isMobile&&!p.userCustom.sidebarLeft&&(H=p.userCustom.postLegacyMode?20:20-p.userCustom.postCardPadding),{paddingRight:H+"px"}}),D=R(()=>{let H=0,Y=0;return p.isMobile&&(p.userCustom.sidebarLeft?H=p.userCustom.postLegacyMode?20:20-p.userCustom.postCardPadding:Y=p.userCustom.postLegacyMode?20:20-p.userCustom.postCardPadding),{maxHeight:ze.value===void 0?void 0:ze.value+"px",marginTop:p.userCustom.postInnerMargin+"px",lineHeight:p.userCustom.lineHeightPost+"px",paddingLeft:H+"px",paddingRight:Y+"px"}}),$=R(()=>({top:Ce.value===void 0?void 0:Ce.value+"px",fontSize:p.userCustom.fontSizePost+"px"})),s=R(()=>({marginTop:p.userCustom.postInnerMargin+"px",fontSize:p.userCustom.fontSizeFooter+"px",lineHeight:p.userCustom.fontSizeFooter+"px"})),u=m,y=R(()=>{const H=[{label:"提示",key:"hint",icon:Ie(Ta,{size:"1.5rem"})},{label:"碎饼",key:"ban",icon:Ie(Da,{size:"1.5rem"})},{label:"封禁",key:"lock",icon:Ie(Pa,{size:"1.5rem"})},{label:"删全",key:"deleteAll",icon:Ie($t,{size:"1.5rem"})}];return f.postData.is_deleted===0?H.push({label:"删帖",key:"delete",icon:Ie($t,{size:"1.5rem"})}):H.push({label:"恢复",key:"recovery",icon:Ie(kl,{size:"1.5rem"})}),H});function b(){u("showRewardModal",{floor:f.postData.floor,forumId:f.forumId,threadId:f.postData.thread_id,postId:f.postData.id,postFloorMessage:P.value})}function z(){function H(){const Y={binggan:n.binggan,thread_id:f.postData.thread_id,post_id:f.postData.id};fo(Y).then(()=>u("refreshPostsList"))}ht({title:"要删除这个回复吗？",content:"会消费300olo喔",onPositiveClick:()=>{f.postData.hongbao_id!==null?ht({title:"注意",content:"这个回帖有红包。删除后红包将消失，并且olo不退回。是否确认？",onPositiveClick:()=>{H()}}):H()}})}function C(){function H(){const Y={binggan:n.binggan,thread_id:f.postData.thread_id,post_id:f.postData.id};go(Y).then(()=>u("refreshPostsList"))}ht({title:"要恢复这个已删除的回复吗？",content:"会消费300olo喔",onPositiveClick:()=>{H()}})}function I(H){u("adminHandle",{action:H,postId:f.postData.id})}const N=_(!1),q=_();function U(H){return H.search(/class='emoji[-_]img'/g)!=-1?f.noEmojiMode?"":H:H.search(/class='custom[-_]emoji[-_]img'/g)!=-1?f.noCustomEmojiMode?"":H:f.noImageMode?H.replace(/src/i,"origin-src").replace(/<img /i,'<img src="/img_svg.svg" class="img-svg"'):H}const B=R(()=>{let H;if(H=f.postData.content.replace(/<img[^>]*>/gi,U).replace(/<script/gi,"<**禁止使用script**").replace(/<base/gi,"<**禁止使用base标签**").replace(/\n/g,"<br>"),(f.superAdminMode||f.adminMode)&&(H=H.replace(/<style/gi,"<**停止解析style")),n.userData?.binggan.use_pingbici){const Y=p.userCustom.pingbiciIngnoreCase?"gi":"g";p.userCustom.hidePingbiciFloor||n.userData.pingbici.content_pingbici?.forEach(ke=>{new RegExp(ke,Y).test(H)&&(N.value=!0,q.value="屏蔽词折叠（点击展开）")}),f.antiJingfen&&!p.userCustom.hidePingbiciFloor&&n.userData.pingbici.fjf_pingbici?.forEach(ke=>{new RegExp(ke,"g").test(f.postData.created_binggan_hash.slice(0,5))&&(N.value=!0,q.value="小尾巴黑名单（点击展开）")}),p.userCustom.hidePingbiciFloor||n.userData.pingbici.fjf_pingbici?.forEach(ke=>{new RegExp(ke,Y).test(f.postData.nickname)&&(N.value=!0,q.value="固马黑名单（点击展开）")})}if(f.noVideoMode&&new RegExp(/<video|<audio|<embed|<iframe/,"g").test(H)&&(N.value=!0,q.value="音视频折叠（点击展开）"),f.yourPostsList.length>0&&!f.noMentionMode&&(H=H.replace(/@№[0-9]+/g,Y=>{const se=Number(Y.slice(2));return f.yourPostsList.includes(se)?`<span class="highlight">${Y}</span>`:Y})),f.useUrlMode){let Y=function(ke){return new RegExp(/.*(png|jpe?g|webp|gif)$/,"i").test(ke)?ke:`<a href="${ke}" target="_blank">${ke}</a>`};const se=new RegExp(/(https?:\/\/|www\.)[a-zA-Z_0-9\-@]+(\.\w[a-zA-Z_0-9\-:]+)+(\/[\(\)~#&\-=?\+\%/\:.\w]+)?/,"gi");H=H.replace(se,Y)}return H}),P=R(()=>f.antiJingfen?`№${f.postData.floor} ${f.postData.nickname} ${f.postData.created_at} →${f.postData.created_binggan_hash?.slice(0,5)}`:`№${f.postData.floor} ${f.postData.nickname} ${f.postData.created_at}`);function A(){const H=p.userCustom.quoteMax;let Y=g.value.getElementsByTagName("details");for(let Be of Y)Be.open=!1;let se=g.value.innerText.split(`
`),ke=[];se.forEach((Be,le)=>{Be.indexOf("@№")>-1&&ke.push(le)}),ke.length>=H&&(se=se.slice(ke[ke.length-H]+1,se.length));const at="<span class='quote-content'>"+se.join(`
`)+`
@`+P.value+`</span>
`;u("quoteClick",at)}const W=_();function J(){g.value.querySelectorAll("img").forEach(Y=>{Y.getAttribute("class")!=="img-svg"&&Y.addEventListener("click",se=>{W.value=Y,window.$message.success("要添加至自定义表情包吗？",{render:pe,closable:!0})})})}const pe=H=>{const{type:Y}=H;return de(It,{closable:!1,type:Y==="loading"?"default":Y,showIcon:!1,style:{boxShadow:"var(--n-box-shadow)",maxWidth:"calc(100vw - 64px)",width:"250px"}},()=>[de("span",{innerText:H.content}),de(E,{size:"tiny",type:"success",onClick:Re},{default:()=>"确定"})])};function Re(){const H=n.userData.my_emoji,Y=W.value?.getAttribute("src");if(H!==null&&H.includes(Y))window.$message.error("已经添加过该表情包了");else{const se={binggan:n.binggan,my_emoji:Y};po(se).then(()=>n.refreshUserData())}}Ze(()=>{J()});function ce(){g.value.querySelectorAll(".img-svg").forEach(Y=>{Y.addEventListener("click",se=>{const ke=Y.getAttribute("src");Y.setAttribute("src",""),Y.setAttribute("src",Y.getAttribute("origin-src")),Y.setAttribute("origin-src",ke)})})}Ze(()=>{ce()});const be=_(!1),ze=_(),Ce=_();function Ye(){const H=window.getComputedStyle(o.value),Y=parseInt(H.lineHeight),se=parseInt(H.height),ke=Y*16;se>ke&&(be.value=!0,Ce.value=ke-se,ze.value=ke)}function X(){be.value=!1,Ce.value=void 0,ze.value=void 0}Ze(()=>{f.postData.floor!==0&&Ye()});function F(){i.value?.refreshBattleDataHandle()}return c({refreshBattleData:F}),(H,Y)=>(r(),k(ut(e(p).userCustom.postLegacyMode?"div":e(oe)),{class:mt([{card:!e(p).userCustom.postLegacyMode},"post-item"]),id:"f_"+H.postData.floor,floor:H.postData.floor,style:ae(d.value),"content-style":h.value},{default:t(()=>[l(e(x),{size:"small",style:ae(T.value)},{default:t(()=>[H.noHeadMode?L("",!0):(r(),O("div",cs,[S("img",{src:e(Vl)[H.randomHeadGroupIndex-1].random_heads[H.postData.random_head],class:mt("head_"+H.postData.random_head)},null,10,ys)])),q.value!==void 0?(r(),k(e(nt),{key:1,text:"",onClick:Y[0]||(Y[0]=se=>N.value=!N.value)},{default:t(()=>[a(j(q.value),1)]),_:1})):L("",!0),H.previewMode?(r(),O(ee,{key:3},[Y[5]||(Y[5]=S("div",{style:{"margin-left":"auto"}},null,-1)),l(e(ye),{size:24,style:{cursor:"pointer"}},{default:t(()=>[l(e(Cl))]),_:1}),l(e(ye),{size:24,style:{cursor:"pointer"}},{default:t(()=>[l(e(xl))]),_:1})],64)):(r(),O(ee,{key:2},[Y[4]||(Y[4]=S("div",{style:{"margin-left":"auto"}},null,-1)),H.postData.is_your_post&&H.postData.is_deleted===0?(r(),k(e(ye),{key:0,size:24,style:{cursor:"pointer"},onClick:z},{default:t(()=>[l(e($t))]),_:1})):L("",!0),H.postData.is_your_post&&H.postData.is_deleted===1?(r(),k(e(ye),{key:1,size:24,style:{cursor:"pointer"},onClick:C},{default:t(()=>[l(e(kl))]),_:1})):L("",!0),H.postData.is_your_post?L("",!0):(r(),k(e(ye),{key:2,size:24,style:{cursor:"pointer"},onClick:b},{default:t(()=>[l(e(Cl))]),_:1})),l(e(ye),{size:24,style:{cursor:"pointer"},onClick:A},{default:t(()=>[l(e(xl))]),_:1}),!w.value&&e(n).checkAdminForums(f.forumId)?(r(),k(e(ye),{key:3,size:24,style:{cursor:"pointer"},onClick:Y[1]||(Y[1]=se=>w.value=!0)},{default:t(()=>[l(e(Wt))]),_:1})):L("",!0),w.value&&e(n).checkAdminForums(f.forumId)?(r(),k(e(qe),{key:4,trigger:"click",options:y.value,onSelect:I,show:w.value,size:e(p).isMobile?"medium":"large",onClickoutside:Y[2]||(Y[2]=se=>w.value=!1)},{default:t(()=>[l(e(ye),{size:24,style:{cursor:"pointer"}},{default:t(()=>[l(e(Wt))]),_:1})]),_:1},8,["options","show","size"])):L("",!0)],64))]),_:1},8,["style"]),N.value?L("",!0):(r(),O(ee,{key:0},[S("div",{class:"post-content",ref_key:"postContentContainerDom",ref:o,style:ae(D.value)},[S("span",{innerHTML:B.value,class:"post-span",ref_key:"postContentDom",ref:g,style:ae($.value)},null,12,ws)],4),H.postData.hongbao_data!==null?(r(),k(bs,{key:0,"hongbao-data":H.postData.hongbao_data,"forum-id":H.forumId,"thread-id":H.postData.thread_id,"no-hongbao-pic-mode":H.noHongbaoPicMode,onRefreshPostsList:Y[3]||(Y[3]=se=>u("refreshPostsList"))},null,8,["hongbao-data","forum-id","thread-id","no-hongbao-pic-mode"])):L("",!0),H.postData.battle_id!==null?(r(),k(fs,{key:1,"battle-id":H.postData.battle_id,ref_key:"BattleCom",ref:i},null,8,["battle-id"])):L("",!0),l(e(x),{size:[4,0],class:mt(["post-footer",{"system-post":H.postData.created_by_admin===2,"admin-post":H.postData.created_by_admin===1}]),style:ae(s.value)},{default:t(()=>[S("span",{depth:3,class:"post-footer-text",onClick:A,style:{cursor:"pointer"}},j("№"+H.postData.floor),1),S("span",{class:"post-nick-name",onClick:A,style:{cursor:"pointer"}},j(H.postData.nickname)+" "+j(e(p).isOctober?"🇨🇳":""),1),S("span",_s,j(H.postData.created_at),1),H.antiJingfen?(r(),O("span",hs," →"+j(H.postData.created_binggan_hash?.slice(0,5)),1)):L("",!0),H.superAdminMode?(r(),O("span",ks,j(H.postData.created_binggan),1)):L("",!0),be.value?(r(),k(e(E),{key:2,size:"tiny",onClick:X},{default:t(()=>[...Y[6]||(Y[6]=[a("展开限高",-1)])]),_:1})):L("",!0)]),_:1},8,["style","class"])],64))]),_:1},8,["class","id","floor","style","content-style"]))}}),Cs=["src"],Kl=Q({__name:"CaptchaModal",emits:["waterUnlockOnSuccess"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_(),v=R(()=>f.value.captcha_key),g=_(!1);function o(){g.value=!0,h()}c({show:o});const i=m,{data:f,loading:d,send:h}=ue($l,{immediate:!1}),{fetch:T}=Kt();function D(){T($l())}const{loading:$,send:s,onSuccess:u,onError:y}=ue(z=>vo(z),{immediate:!1});function b(){if(!p.value){window.$message.error("验证码不能为空");return}const z={binggan:n.binggan,captcha_code:p.value,captcha_key:v.value};s(z),u(()=>{p.value="",g.value=!1,i("waterUnlockOnSuccess")}),y(()=>{p.value="",D()})}return(z,C)=>(r(),k(e(Se),{show:g.value,"onUpdate:show":C[3]||(C[3]=I=>g.value=I),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"验证码",closable:"",onClose:C[2]||(C[2]=I=>g.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:b,loading:e($),disabled:e($)},{default:t(()=>[...C[7]||(C[7]=[a("提交",-1)])]),_:1},8,["loading","disabled"]),l(e(E),{onClick:C[1]||(C[1]=I=>g.value=!1)},{default:t(()=>[...C[8]||(C[8]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...C[4]||(C[4]=[a(" 嗷……你可能刷太多了，休息一下吧。 ",-1)])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...C[5]||(C[5]=[a("输入",-1)])]),_:1}),l(e(ve),{placeholder:"请输入验证码",maxlength:"4","show-count":"",value:p.value,"onUpdate:value":C[0]||(C[0]=I=>p.value=I),onKeyup:Ue(b,["enter"])},null,8,["value"])]),_:1}),e(d)?L("",!0):(r(),O("img",{key:0,src:"data:image/png;base64,"+e(f).captcha_img,style:{"max-width":"200px"},onClick:D},null,8,Cs)),l(e(M),null,{default:t(()=>[...C[6]||(C[6]=[a(" 点击可更换验证码。不区分大小写。 ",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),xs=Q({__name:"BattleModal",props:{threadId:{},forumId:{},randomHeadsGroup:{}},emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_(null),v=G,g=R(()=>{const z=[{value:1,label:"共通",available:!0}];return $n.forEach(C=>{C.value===v.randomHeadsGroup&&z.push(C)}),z}),o=R(()=>{const z=Dt[f.value-1];if(f.value===1){const C=n.userData.my_battle_chara.filter(I=>!I.not_use).map((I,N)=>({value:N+240,label:I.name}));return z.concat(C)}else return z}),i=_(1),f=_(v.randomHeadsGroup),d=_(100);Le(f,z=>{z===1?i.value=Dt[z-1][8].value:i.value=Dt[z-1][0].value},{immediate:!0});const{loading:h,send:T,onSuccess:D,onError:$}=ue(z=>bo(z),{immediate:!1});function s(z){const{timestamp:C,newPostKey:I}=tl(z?.isTrusted??!0,v.threadId,n.binggan),N={binggan:n.binggan,forum_id:v.forumId,thread_id:v.threadId,battle_olo:d.value,chara_id:i.value>=240?i.value-240:i.value,is_custom_chara:i.value>=240,chara_group:f.value-1,new_post_key:I,timestamp:C};T(N)}D(()=>{b("refreshPostsList"),u.value=!1}),$(z=>{z.error.cause!==void 0&&z.error.cause.code===244291&&p.value?.show()});const u=_(!1);function y(){u.value=!0}c({show:y});const b=m;return(z,C)=>(r(),k(e(Se),{show:u.value,"onUpdate:show":C[5]||(C[5]=I=>u.value=I),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"表情包大乱斗！",closable:"",onClose:C[4]||(C[4]=I=>u.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:s,loading:e(h)},{default:t(()=>[...C[10]||(C[10]=[a("提交",-1)])]),_:1},8,["loading"]),l(e(E),{onClick:C[3]||(C[3]=I=>u.value=!1)},{default:t(()=>[...C[11]||(C[11]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...C[6]||(C[6]=[a("小斗怡情，大斗伤身，强斗奥飞湮灭",-1)])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...C[7]||(C[7]=[a("主题",-1)])]),_:1}),l(e(Oe),{value:f.value,"onUpdate:value":C[0]||(C[0]=I=>f.value=I),options:g.value},null,8,["value","options"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...C[8]||(C[8]=[a("角色",-1)])]),_:1}),l(e(Oe),{value:i.value,"onUpdate:value":C[1]||(C[1]=I=>i.value=I),options:o.value},null,8,["value","options"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...C[9]||(C[9]=[a("下注",-1)])]),_:1}),l(e(he),{value:d.value,"onUpdate:value":C[2]||(C[2]=I=>d.value=I),max:1e6,min:1,step:100,parse:e(ft),format:e(pt),onKeyup:Ue(s,["enter"])},null,8,["value","parse","format"])]),_:1})]),_:1}),l(Kl,{ref_key:"CaptchaModalCom",ref:p,onWaterUnlockOnSuccess:s},null,512)]),_:1},8,["style"])]),_:1},8,["show"]))}}),Ss=Q({__name:"CodeModal",emits:["insertCode"],setup(G,{expose:c,emit:m}){const w=te(),n=_(0),p=_(),v=_(),g=[{value:0,label:"折叠内容"},{value:1,label:"超链接"},{value:2,label:"图片"},{value:3,label:"删除线"}],o=R(()=>[{prepend_1:"显示内容",prepend_2:"隐藏内容",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"显示内容",inputDefault_2:"隐藏内容",insertText:`<details><summary>${p.value}</summary>${v.value}</details>`},{prepend_1:"显示文字",prepend_2:"链接网址",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"点我跳转",inputDefault_2:"",insertText:`<a href="${v.value}">${p.value}</a>`},{prepend_1:"图片链接",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<img src="${p.value}">`},{prepend_1:"删除文字",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<del>${p.value}</del>`}]);Le(n,()=>{p.value=o.value[n.value].inputDefault_1,v.value=o.value[n.value].inputDefault_2},{immediate:!0});function i(){h("insertCode",o.value[n.value].insertText),p.value=o.value[n.value].inputDefault_1,v.value=o.value[n.value].inputDefault_2,f.value=!1}const f=_(!1);function d(){f.value=!0}c({show:d});const h=m;return(T,D)=>(r(),k(e(Se),{show:f.value,"onUpdate:show":D[5]||(D[5]=$=>f.value=$),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"快捷代码",closable:"",onClose:D[4]||(D[4]=$=>f.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:i},{default:t(()=>[...D[8]||(D[8]=[a("插入",-1)])]),_:1}),l(e(E),{onClick:D[3]||(D[3]=$=>f.value=!1)},{default:t(()=>[...D[9]||(D[9]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...D[6]||(D[6]=[a("代码预览：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(o.value[n.value].insertText),1)]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...D[7]||(D[7]=[a("代码内容",-1)])]),_:1}),l(e(Oe),{value:n.value,"onUpdate:value":D[0]||(D[0]=$=>n.value=$),options:g},null,8,["value"])]),_:1}),et(l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[a(j(o.value[n.value].prepend_1),1)]),_:1}),l(e(ve),{value:p.value,"onUpdate:value":D[1]||(D[1]=$=>p.value=$),onKeyup:Ue(i,["enter"])},null,8,["value"])]),_:1},512),[[tt,o.value[n.value].inputEnable_1]]),et(l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[a(j(o.value[n.value].prepend_2),1)]),_:1}),l(e(ve),{value:v.value,"onUpdate:value":D[2]||(D[2]=$=>v.value=$),onKeyup:Ue(i,["enter"])},null,8,["value"])]),_:1},512),[[tt,o.value[n.value].inputEnable_2]])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),zs=["width","height"],Ms=["width","height"],$s=["onClick"],Is=["title","innerHTML","onClick"],Ts=Q({__name:"DrawerModal",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(G,{expose:c,emit:m}){const w=re();te();const n=G,p=_(!1);function v(){p.value=!0}c({show:v});const g=m,o=_(),i=R(()=>o.value?.getContext("2d")),f=_(),d=R(()=>f.value?.getContext("2d")),h=new Image;let T=!1;const D={x:0,y:0,width:0,height:0},$=_([]),s=_([]),u=_([]),y=_({lineWidth:3,lineColor:"#111111",shadowBlur:1}),b=_(!1),z=_(!1);let C=0,I=0;const N=R(()=>window.innerWidth>836?796:window.innerWidth-36),q=R(()=>window.innerHeight>580?400:window.innerHeight-212),U=R(()=>[{title:"上一步",action:"prev",className:$.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>'},{title:"下一步",action:"next",className:s.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>'},{title:"橡皮擦",action:"eraser",className:$.value.length||s.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/></svg>'},{title:"清除",action:"clear",className:$.value.length||s.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/></svg>'},{title:"拖动背景",action:"drag",className:z.value?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor"  viewBox="0 0 16 16"> <path d="M6.75 1a.75.75 0 0 1 .75.75V8a.5.5 0 0 0 1 0V5.467l.086-.004c.317-.012.637-.008.816.027.134.027.294.096.448.182.077.042.15.147.15.314V8a.5.5 0 1 0 1 0V6.435a4.9 4.9 0 0 1 .106-.01c.316-.024.584-.01.708.04.118.046.3.207.486.43.081.096.15.19.2.259V8.5a.5.5 0 0 0 1 0v-1h.342a1 1 0 0 1 .995 1.1l-.271 2.715a2.5 2.5 0 0 1-.317.991l-1.395 2.442a.5.5 0 0 1-.434.252H6.035a.5.5 0 0 1-.416-.223l-1.433-2.15a1.5 1.5 0 0 1-.243-.666l-.345-3.105a.5.5 0 0 1 .399-.546L5 8.11V9a.5.5 0 0 0 1 0V1.75A.75.75 0 0 1 6.75 1zM8.5 4.466V1.75a1.75 1.75 0 1 0-3.5 0v5.34l-1.2.24a1.5 1.5 0 0 0-1.196 1.636l.345 3.106a2.5 2.5 0 0 0 .405 1.11l1.433 2.15A1.5 1.5 0 0 0 6.035 16h6.385a1.5 1.5 0 0 0 1.302-.756l1.395-2.441a3.5 3.5 0 0 0 .444-1.389l.271-2.715a2 2 0 0 0-1.99-2.199h-.581a5.114 5.114 0 0 0-.195-.248c-.191-.229-.51-.568-.88-.716-.364-.146-.846-.132-1.158-.108l-.132.012a1.26 1.26 0 0 0-.56-.642 2.632 2.632 0 0 0-.738-.288c-.31-.062-.739-.058-1.05-.046l-.048.002zm2.094 2.025z"/></svg>'}]),B=[{lineWidth:3,innerHTML:"🖌️",font_size:12},{lineWidth:6,innerHTML:"🖌️",font_size:16},{lineWidth:12,innerHTML:"🖌️",font_size:20}];function P(){const X=new ImageData(N.value,q.value);u.value.push(X)}Ze(()=>{P()});function A(){i.value.lineWidth=y.value.lineWidth,i.value.shadowBlur=y.value.shadowBlur,i.value.shadowColor=y.value.lineColor,i.value.strokeStyle=y.value.lineColor,i.value.lineCap="round",i.value.lineJoin="round"}function W(X){if(T)if(z.value){const F=X.target;let H,Y;X instanceof MouseEvent?(H=X.clientX-F.getBoundingClientRect().x,Y=X.clientY-F.getBoundingClientRect().y):(H=X.changedTouches[0].clientX-F.getBoundingClientRect().x,Y=X.changedTouches[0].clientY-F.getBoundingClientRect().y),f.value.height=f.value.height;let se={x:D.x+(H-C),y:D.y+(Y-I),width:D.width,height:D.height};ze(h,se)}else{i.value.beginPath(),i.value.moveTo(C,I);const F=X.target;let H,Y;X instanceof MouseEvent?(H=X.clientX-F.getBoundingClientRect().x,Y=X.clientY-F.getBoundingClientRect().y):(H=X.changedTouches[0].clientX-F.getBoundingClientRect().x,Y=X.changedTouches[0].clientY-F.getBoundingClientRect().y),i.value.globalCompositeOperation=b.value?"destination-out":"source-over",i.value.lineTo(H,Y),[C,I]=[H,Y],i.value.stroke()}}function J(X){if(z.value){const F=X.target;let H,Y;X instanceof MouseEvent?(H=X.clientX-F.getBoundingClientRect().x,Y=X.clientY-F.getBoundingClientRect().y):(H=X.changedTouches[0].clientX-F.getBoundingClientRect().x,Y=X.changedTouches[0].clientY-F.getBoundingClientRect().y),D.x+=H-C,D.y+=Y-I,T=!1}else{const F=i.value.getImageData(0,0,o.value.width,o.value.height);s.value.length?(u.value=[],u.value=u.value.concat($.value),u.value.push(F),s.value=[]):u.value.push(F),T=!1}}function pe(X){if(z.value){const F=X.target;let H,Y;X instanceof MouseEvent?(H=X.clientX-F.getBoundingClientRect().x,Y=X.clientY-F.getBoundingClientRect().y):(H=X.changedTouches[0].clientX-F.getBoundingClientRect().x,Y=X.changedTouches[0].clientY-F.getBoundingClientRect().y),C=H,I=Y,T=!0}else{T=!0;const F=X.target;let H,Y;X instanceof MouseEvent?(H=X.clientX-F.getBoundingClientRect().x,Y=X.clientY-F.getBoundingClientRect().y):(H=X.changedTouches[0].clientX-F.getBoundingClientRect().x,Y=X.changedTouches[0].clientY-F.getBoundingClientRect().y),A(),C=H,I=Y;const se=i.value.getImageData(0,0,o.value.width,o.value.height);$.value.push(se)}}function Re(X){y.value.lineWidth=X,b.value=!1,z.value=!1}function ce(X){switch(X){case"prev":if($.value.length){const F=$.value.pop(),H=u.value[$.value.length+1];s.value.push(H),i.value.putImageData(F,0,0)}break;case"next":if(s.value.length){const F=s.value.pop(),H=u.value[u.value.length-s.value.length-2];$.value.push(H),i.value.putImageData(F,0,0)}break;case"clear":i.value.clearRect(0,0,o.value.width,o.value.height),$.value=[],s.value=[],u.value=[u.value[0]];break;case"eraser":b.value=!0;break;case"drag":z.value=!0;break}}function be(X){if(X.file.file){var F=new FileReader;F.readAsDataURL(X.file.file),F.onload=H=>{h.src=H.target.result,h.onload=function(){var Y=f,se=h;D.width=se.width,D.height=se.height,se.width/se.height>=Y.value.width/Y.value.height?se.width>Y.value.width&&(D.width=Y.value.width,D.height=se.height*Y.value.width/se.width):se.height>Y.value.height&&(D.width=se.width*Y.value.height/se.height,D.height=Y.value.height),ze(se,D)}}}}function ze(X,F){d.value.drawImage(X,F.x,F.y,F.width,F.height)}const Ce=_(!1);function Ye(){let X=new Image;X.src=o.value.toDataURL("image/png"),X.onload=()=>{d.value.drawImage(X,0,0),F(f.value)};function F(Y){Y.toBlob(se=>{se&&H(se)},"image/png")}function H(Y){const se={binggan:w.binggan,file:Y,mode:"draw",thread_id:n.threadId,forum_id:n.forumId};Ce.value=!0,ql(se).then(ke=>{g("insertImage",ke.file_url),Ce.value=!1,p.value=!1}).catch(()=>{Ce.value=!1})}}return(X,F)=>(r(),k(e(Se),{show:p.value,"onUpdate:show":F[5]||(F[5]=H=>p.value=H),"display-directive":"show"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:N.value+4+"px"}),title:"涂鸦板",closable:"",onClose:F[4]||(F[4]=H=>p.value=!1),size:"small","content-style":{padding:"0px"}},{default:t(()=>[S("div",{id:"canvas-container",style:ae({width:N.value+"px",height:q.value+"px"})},[S("canvas",{id:"drawer-canvas-background",ref_key:"canvasBackground",ref:f,width:N.value,height:q.value,onTouchmove:F[0]||(F[0]=il(()=>{},["prevent"]))},null,40,zs),S("canvas",{id:"drawer-canvas",ref_key:"canvas",ref:o,class:mt({painting:!z.value,dragging:z.value}),width:N.value,height:q.value,onTouchmove:[F[1]||(F[1]=il(()=>{},["prevent"])),W],onMousedown:pe,onMouseup:J,onMousemove:W,onTouchstart:pe,onTouchend:J},null,42,Ms)],4),l(e(kt),{"x-gap":"6",cols:4},{default:t(()=>[l(e(Fe),{span:"1"},{default:t(()=>[F[6]||(F[6]=S("div",null,"颜色",-1)),l(e(Qt),{value:y.value.lineColor,"onUpdate:value":F[2]||(F[2]=H=>y.value.lineColor=H),modes:["hex"],"show-alpha":!1},null,8,["value"])]),_:1}),l(e(Fe),{span:"1"},{default:t(()=>[F[7]||(F[7]=S("div",null,"画笔",-1)),l(e(x),{id:"canvas-brush",size:"small",align:"center"},{default:t(()=>[(r(),O(ee,null,me(B,(H,Y)=>S("span",{key:Y,style:ae({fontSize:H.font_size+"px"}),onClick:se=>Re(H.lineWidth)},j(H.innerHTML),13,$s)),64))]),_:1})]),_:1}),l(e(Fe),{span:"2"},{default:t(()=>[F[8]||(F[8]=S("div",null,"操作",-1)),l(e(x),{id:"canvas-control",size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(U.value,(H,Y)=>(r(),O("span",{key:Y,title:H.title,class:mt([H.className]),innerHTML:H.innerHTML,onClick:se=>ce(H.action)},null,10,Is))),128))]),_:1})]),_:1})]),_:1})]),action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(sl),{"default-upload":!1,onChange:be,"show-file-list":!1},{default:t(()=>[l(e(E),null,{default:t(()=>[...F[9]||(F[9]=[a("加载图片",-1)])]),_:1})]),_:1}),l(e(E),{type:"primary",onClick:Ye,disabled:X.userIsLocked,loading:Ce.value},{default:t(()=>[...F[10]||(F[10]=[a("上传",-1)])]),_:1},8,["disabled","loading"]),l(e(E),{onClick:F[3]||(F[3]=H=>p.value=!1)},{default:t(()=>[...F[11]||(F[11]=[a("关闭",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Ds=["onClick"],Ps=["src"],Ls=Q({__name:"EmojiTab",props:{randomHeadsGroup:{default:1},autoHide:{type:Boolean,default:!0}},emits:["appendEmoji"],setup(G,{emit:c}){const m=re(),w=te(),n=G,p=R(()=>{let D=0,$=0;return w.isMobile&&(w.userCustom.sidebarLeft?D=20:$=20),{paddingLeft:D+"px",paddingRight:$+"px"}}),v=_(),g=R(()=>{const D=rl.filter($=>!m.userData.emoji_excluded.includes($.id)&&($.headsId===0||$.headsId===n.randomHeadsGroup));return m.userData.my_emoji&&D.unshift({id:0,headsId:0,name:"自定义",emojis:m.userData.my_emoji}),D}),o=c;function i(D,$){o("appendEmoji",D,$==="自定义"),n.autoHide&&(v.value=-1)}let f=!1;function d(D,$){return de("span",{onClick:()=>h($),innerHTML:D})}function h(D){D===v.value&&(f=!0,v.value=-1)}function T(D,$){return f?(f=!1,!1):!0}return(D,$)=>(r(),k(e(Pt),{type:"line","bar-width":0,animated:"",onBeforeLeave:T,size:e(w).isMobile?"small":"medium","default-value":-1,value:v.value,"onUpdate:value":$[0]||($[0]=s=>v.value=s)},{default:t(()=>[(r(!0),O(ee,null,me(g.value,(s,u,y)=>(r(),k(e(Je),{name:s.id,tab:d(s.name,s.id)},{default:t(()=>[l(e(x),{size:"small",class:"emoji-container",style:ae(p.value)},{default:t(()=>[(r(!0),O(ee,null,me(s.emojis,(b,z,C)=>(r(),O("div",{class:"emoji-box",onClick:I=>i(b,s.name)},[S("img",{src:b,class:"emoji-in-box"},null,8,Ps)],8,Ds))),256))]),_:2},1032,["style"])]),_:2},1032,["name","tab"]))),256)),l(e(Je),{name:-1,tab:"隐藏"})]),_:1},8,["size","value"]))}}),Us=Q({__name:"HongbaoModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=G,v=[{value:1,label:"口令红包 直接公开口令"},{value:2,label:"抢答红包 回复答对才公开口令"},{value:3,label:"暗号红包 抢完红包才公开口令"}],g=[{value:1,label:"随机olo"},{value:2,label:"定额olo"}],o=_(3e3),i=_(10),f=_(1),d=_(1),h=_(),T=_(),D=_([]),$=_(!1),s=_(),u=_(1);function y(B){B===1&&u.value<5&&(u.value+=1),B===-1&&u.value>1&&(D.value.splice(u.value-1,1),u.value-=1)}const{loading:b,send:z,onSuccess:C}=ue(B=>co(B),{immediate:!1});function I(){function B(){const P={binggan:n.binggan,forum_id:p.forumId,thread_id:p.threadId,hongbao_olo:o.value,hongbao_num:i.value,type:f.value,key_word_type:d.value,hongbao_key_word:h.value,hongbao_question:T.value,hongbao_message_json:D.value,hongbao_olo_hide:$.value,pic_url:s.value};z(P)}if(h.value===void 0){window.$message.error("必须填写“红包口令”喔");return}if(T.value===void 0&&[2,3].includes(d.value)){window.$message.error("抢答红包或者暗号红包时，必须填写“口令提示”喔");return}if(f.value===2&&o.value%i.value!==0){const P={title:"提醒",closable:!1,content:"olo总额不是红包个数的整倍数，多出的余数olo将在最后一个红包发出。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{B()}};window.$dialog.warning(P);return}B()}C(()=>{U("refreshPostsList"),N.value=!1});const N=_(!1);function q(){N.value=!0}c({show:q});const U=m;return(B,P)=>(r(),k(e(Se),{show:N.value,"onUpdate:show":P[12]||(P[12]=A=>N.value=A),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"发起红包",closable:"",onClose:P[11]||(P[11]=A=>N.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:I,disabled:e(b),loading:e(b)},{default:t(()=>[...P[26]||(P[26]=[a("提交",-1)])]),_:1},8,["disabled","loading"]),l(e(E),{onClick:P[10]||(P[10]=A=>N.value=!1)},{default:t(()=>[...P[27]||(P[27]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...P[13]||(P[13]=[a("温馨提示：",-1)])]),_:1}),P[14]||(P[14]=a("在红包总额以外，会追加扣除7%手续费。 ",-1))]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...P[15]||(P[15]=[a("总共扣除：",-1)])]),_:1}),l(e(M),{type:"warning"},{default:t(()=>[a(j(Math.ceil(o.value*(e(w).isDouble11?1.02:1.07))),1)]),_:1}),P[16]||(P[16]=a("个奥利奥 ",-1))]),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[17]||(P[17]=[a("红包类型",-1)])]),_:1}),l(e(Oe),{value:d.value,"onUpdate:value":P[0]||(P[0]=A=>d.value=A),options:v},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[18]||(P[18]=[a("olo类型",-1)])]),_:1}),l(e(Oe),{value:f.value,"onUpdate:value":P[1]||(P[1]=A=>f.value=A),options:g},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[19]||(P[19]=[a("红包个数",-1)])]),_:1}),l(e(he),{value:i.value,"onUpdate:value":P[2]||(P[2]=A=>i.value=A),max:50,min:5,step:5},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[20]||(P[20]=[a("olo总额",-1)])]),_:1}),l(e(he),{value:o.value,"onUpdate:value":P[3]||(P[3]=A=>o.value=A),max:1e6,min:3e3,step:1e3,parse:e(ft),format:e(pt)},null,8,["value","parse","format"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[21]||(P[21]=[a("红包口令",-1)])]),_:1}),l(e(ve),{value:h.value,"onUpdate:value":P[4]||(P[4]=A=>h.value=A),placeholder:"必填"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[22]||(P[22]=[a("红包封面",-1)])]),_:1}),l(e(ve),{value:s.value,"onUpdate:value":P[5]||(P[5]=A=>s.value=A),placeholder:"（可选）填写图片的完整网址"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[23]||(P[23]=[a("口令提示",-1)])]),_:1}),l(e(ve),{value:T.value,"onUpdate:value":P[6]||(P[6]=A=>T.value=A),placeholder:"抢答红包或者暗号红包时，必填"},null,8,["value"])]),_:1}),(r(!0),O(ee,null,me(u.value,A=>(r(),k(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...P[24]||(P[24]=[a("回复留言",-1)])]),_:1}),l(e(ve),{value:D.value[A-1],"onUpdate:value":W=>D.value[A-1]=W,placeholder:`#${A}（可选） 多个留言时随机抽取一个`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...P[25]||(P[25]=[a("留言数量",-1)])]),_:1}),l(e(nt),{size:"tiny",circle:"",disabled:u.value===5,onClick:P[7]||(P[7]=A=>y(1))},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(Zt))]),_:1})]),_:1},8,["disabled"]),l(e(nt),{size:"tiny",circle:"",disabled:u.value===1,onClick:P[8]||(P[8]=A=>{y(-1)})},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(el))]),_:1})]),_:1},8,["disabled"]),l(e(Ke),{checked:$.value,"onUpdate:checked":P[9]||(P[9]=A=>$.value=A),label:"隐藏olo总额",style:{"margin-left":"auto"}},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),js=Q({__name:"ImageUpload",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(G,{emit:c}){const m=te(),w=re(),n=_(null),p=G,v=c,g=["mjj","imgbb","freeimage","picgo","tutu"],o=["imge","imgtbl","imgimg","helloimg","picui","imgwang"],i=R(()=>p.forumId===419?0:g.includes(m.userCustom.imgHost)?1:o.includes(m.userCustom.imgHost)?2:1),f=_(!1),d=({file:s,data:u,headers:y,withCredentials:b,action:z,onFinish:C,onError:I,onProgress:N})=>{if(s.file!==null){if(s.file.size>1024e3){window.$message.error("图片大小不能超过10M喔"),n.value?.clear();return}const q={binggan:w.binggan,file:s.file,mode:"img",thread_id:p.threadId,forum_id:p.forumId};f.value=!0,ql(q).then(U=>{v("insertImage",U.file_url),n.value?.clear(),f.value=!1}).catch(()=>{n.value?.clear(),f.value=!1})}};function h(s){var u=document.getElementsByTagName("body")[0],y=document.createElement("script");y.setAttribute("id","image-upload-js");var b=document.getElementById("upload-button");s=="mjj"&&(y.setAttribute("async","true"),y.setAttribute("data-mode","manual"),y.setAttribute("src","https://mjj.today/sdk/pup.js"),y.setAttribute("data-url","https://mjj.today/upload"),y.setAttribute("data-auto-insert","html-embed"),b?.setAttribute("data-chevereto-pup-trigger","")),s=="imgbb"&&(y.setAttribute("async","true"),y.setAttribute("data-mode","manual"),y.setAttribute("src","https://imgbb.com/upload.js"),y.setAttribute("data-url","https://imgbb.com/upload"),y.setAttribute("data-auto-insert","html-embed-medium"),b?.setAttribute("data-imgbb-trigger","")),s=="freeimage"&&(y.setAttribute("async","true"),y.setAttribute("data-mode","manual"),y.setAttribute("src","https://freeimage.host/sdk/pup.js"),y.setAttribute("data-url","https://freeimage.host/upload"),y.setAttribute("data-auto-insert","html-embed-medium"),b?.setAttribute("data-chevereto-pup-trigger","")),s=="picgo"&&(y.setAttribute("async","true"),y.setAttribute("data-mode","manual"),y.setAttribute("src","https://www.picgo.net/sdk/pup.js"),y.setAttribute("data-url","https://www.picgo.net/upload"),y.setAttribute("data-auto-insert","html-embed"),b?.setAttribute("data-chevereto-pup-trigger","")),u.appendChild(y)}const T=R(()=>({imge:"https://imge.cc/api/v1/upload",imgtbl:"https://imgtbl.com/api/v1/upload",imgimg:"https://imgimg.cc/api/v1/upload",helloimg:"https://www.helloimg.com/api/v1/upload",picui:"https://picui.cn/api/v1/upload",imgwang:"https://img.wang/api/v1/upload"})[m.userCustom.imgHost]||""),D=({file:s,data:u,headers:y,withCredentials:b,action:z,onFinish:C,onError:I,onProgress:N})=>{if(s.file!==null){const q={file:s.file,url:T.value};f.value=!0,yo(q).then(U=>{console.log(U.data),U.status===!0?v("insertImage",U.data.links.url):window.$message.error(U.message),n.value?.clear(),f.value=!1}).catch(()=>{n.value?.clear(),f.value=!1})}};function $(){document.getElementById("image-upload-js")?.remove()}return Ze(()=>{g.includes(m.userCustom.imgHost)&&h(m.userCustom.imgHost)}),jl(()=>{$()}),(s,u)=>(r(),O(ee,null,[i.value===0?(r(),k(e(sl),{key:0,accept:"image/*","custom-request":d,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:n},{default:t(()=>[l(e(E),{style:{"margin-right":"auto"},disabled:s.userIsLocked,loading:f.value},{default:t(()=>[...u[0]||(u[0]=[a("上传图片",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):L("",!0),i.value===1?(r(),k(e(E),{key:1,style:{"margin-right":"auto"},disabled:s.userIsLocked,"data-target":"#content-input",id:"upload-button"},{default:t(()=>[...u[1]||(u[1]=[a("上传图片",-1)])]),_:1},8,["disabled"])):L("",!0),i.value===2?(r(),k(e(sl),{key:2,accept:"image/*","custom-request":D,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:n},{default:t(()=>[l(e(E),{style:{"margin-right":"auto"},disabled:s.userIsLocked,loading:f.value},{default:t(()=>[...u[2]||(u[2]=[a("上传图片",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):L("",!0)],64))}}),Hs=Q({__name:"PingbiciModal",setup(G,{expose:c}){const m=te(),w=re(),n=_(),{loading:p,send:v,onSuccess:g}=ue(d=>wo(d),{immediate:!1});function o(){if(!n.value){window.$message.error("请填写屏蔽词");return}const d={binggan:w.binggan,content_pingbici:n.value};v(d)}g(()=>{w.refreshUserData(),i.value=!1});const i=_(!1);function f(){i.value=!0}return c({show:f}),(d,h)=>(r(),k(e(Se),{show:i.value,"onUpdate:show":h[3]||(h[3]=T=>i.value=T),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"追加屏蔽词",closable:"",onClose:h[2]||(h[2]=T=>i.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:o,loading:e(p),disabled:!n.value||e(p)},{default:t(()=>[...h[6]||(h[6]=[a("提交",-1)])]),_:1},8,["loading","disabled"]),l(e(E),{onClick:h[1]||(h[1]=T=>i.value=!1)},{default:t(()=>[...h[7]||(h[7]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...h[4]||(h[4]=[a("暂时只做了“内容屏蔽词”的追加",-1)])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"4.2rem"}},{default:t(()=>[...h[5]||(h[5]=[a("屏蔽词",-1)])]),_:1}),l(e(ve),{value:n.value,"onUpdate:value":h[0]||(h[0]=T=>n.value=T),maxlength:20,"show-count":"",onKeyup:Ue(o,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Xl=Q({__name:"PostInput",props:{mode:{},disabled:{type:Boolean},handling:{type:Boolean},forumId:{default:0},threadId:{default:0},randomHeadsGroup:{default:1}},emits:["contentCommit","refreshPostsList"],setup(G,{expose:c,emit:m}){const w=re(),n=te(),p=_(null),v=_(null),g=_(null),o=_(null),i=_(null),f=_(null),d=_(null),h=G,T=R(()=>({fontSize:n.userCustom.fontSizeInput+"px",borderRadius:"10px"})),D=R(()=>{const le=(b.value.match(/\r?\n|\r/g)||[]).length+2;return le<5?5:le>10?10:le}),$=R(()=>w.userData.binggan.locked_ttl>0?`你的饼干封禁中，将于${Math.floor(w.userData.binggan.locked_ttl/3600)+1}小时后解封`:"正文内容"),s=R(()=>w.userData.binggan.locked_ttl>0),u=_(w.userData.binggan.nickname||"= ="),y=_(""),b=_(""),z=_(!1),C=_(!1);function I(){u.value=w.userData.binggan.nickname||"= =",y.value="",b.value="",z.value=!1,C.value=!1}const N=R(()=>({id:0,created_at:"预览模式",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:b.value,nickname:u.value,is_your_post:!0,hongbao_data:null})),q=R(()=>({class:{"nickname-input":!0,admin:C.value}})),U=_(!1),B=Ae("emoji_auto_hide",!1);function P(){let le=[de(Qe,{checked:U.value,"onUpdate:checked":Z=>U.value=Z,label:"实时预览"}),de(Qe,{checked:B.value,"onUpdate:checked":Z=>B.value=Z,label:"表情包自动收起"})];return w.userData.binggan.admin!==0&&w.checkAdminForums(h.forumId)&&le.push(de(Qe,{checked:C.value,"onUpdate:checked":Z=>C.value=Z,label:"管理员"})),de(x,{style:"padding:6px 8px",vertical:!0},()=>le)}const A=[{key:"funcOption",type:"render",render:P}],W=[{label:"涂鸦板",key:"draw",icon:Ie(Ba,{size:"1.5rem"})},{label:"屏蔽词",key:"mute",icon:Ie(Oa,{size:"1.5rem"})}];function J(le){switch(le){case"mute":i.value?.show();break;case"draw":d.value?.show();break}}Le(C,le=>u.value=le?"管理员":"= =");function pe(le){return le.selectionStart!=null?le.selectionStart:0}function Re(le,Z){const _e=pe(le),St=le.value,Ut=St.substring(0,_e)+Z+St.substring(_e);b.value=Ut,setTimeout(()=>{le.selectionStart=_e+Z.length,le.selectionEnd=_e+Z.length},0)}function ce(le){const Z=document.getElementById("content-input");Re(Z,le),Ye(),Z.focus()}function be(){ht({title:"要清空内容吗？",onPositiveClick:()=>b.value=""})}const ze=_([""]);function Ce(){ze.value.length>1&&(ze.value.pop(),b.value=ze.value.slice(-1)[0])}function Ye(){ze.value.push(b.value??""),ze.value.length>20&&ze.value.shift()}function X(le,Z){ce(`<img src='${le}' class='${Z?"custom-emoji-img":"emoji-img"}'>`)}function F(le){ce(le)}function H(le){ce(`<img src='${le}' />`)}function Y(le){b.value=le,Ye(),p.value?.focus()}const se=m;function ke(le){if(!le.isTrusted){const _e={title:"错误",closable:!1,content:"请不要用脚本回复喔，可能会被系统判断为脚本并碎饼干。",positiveText:"确定"};window.$dialog.warning(_e);return}new Promise(function(_e,St){se("contentCommit",{contentInput:b.value,nicknameInput:u.value,postWithAdmin:C.value,titleInput:y.value,isDelay:z.value,ist:le.isTrusted},_e)}).then(at)}function at(){y.value="",b.value="",z.value=!1}const Be=_(!1);return c({quoteHandle:Y,isTyping:Be,resetInput:I}),(le,Z)=>(r(),k(e(x),{vertical:""},{default:t(()=>[U.value?(r(),O(ee,{key:0},[le.mode==="thread"?(r(),k(e(oe),{class:"thread-title-container",size:"small",key:"title-card"},{default:t(()=>[S("span",{class:"thread-title",style:ae({fontSize:e(n).userCustom.fontSizeThreadList+"px"})},j(y.value||"标题预览")+" [0] ",5)]),_:1})):L("",!0),l(Vt,{"post-data":N.value,"forum-id":0,"preview-mode":!0},null,8,["post-data"])],64)):L("",!0),l(e(x),{size:"small",wrap:!1,align:"center",style:ae({paddingRight:e(n).isMobile?"24px":"0px"})},{default:t(()=>[l(e(fe),{style:{"max-width":"300px"}},{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...Z[15]||(Z[15]=[a("昵称",-1)])]),_:1}),l(e(ve),{maxlength:30,value:u.value,"onUpdate:value":Z[0]||(Z[0]=_e=>u.value=_e),"show-count":"","input-props":q.value},null,8,["value","input-props"])]),_:1}),l(e(qe),{trigger:e(n).isMobile?"click":"hover",options:A,placement:"bottom-start"},{default:t(()=>[l(e(E),{size:"medium",style:{"flex-shrink":"0"},secondary:!1},{default:t(()=>[...Z[16]||(Z[16]=[a("功能",-1)])]),_:1})]),_:1},8,["trigger"])]),_:1},8,["style"]),le.mode==="thread"?(r(),k(e(fe),{key:1},{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...Z[17]||(Z[17]=[a("标题",-1)])]),_:1}),l(e(ve),{maxlength:100,value:y.value,"onUpdate:value":Z[1]||(Z[1]=_e=>y.value=_e),"show-count":"",placeholder:"标题内容"},null,8,["value"])]),_:1})):L("",!0),l(Ls,{"auto-hide":e(B),"random-heads-group":le.randomHeadsGroup,onAppendEmoji:X},null,8,["auto-hide","random-heads-group"]),l(e(x),{size:e(n).isMobile?"small":"medium",justify:"end",align:"center",style:ae({paddingRight:e(n).isMobile?"24px":"0px"})},{default:t(()=>[l(e(qe),{trigger:"click",options:W,onSelect:J,size:e(n).isMobile?"medium":"large"},{default:t(()=>[l(e(ye),{size:e(n).isMobile?20:24,style:{cursor:"pointer"}},{default:t(()=>[l(e(Wt))]),_:1},8,["size"])]),_:1},8,["size"]),le.mode==="post"?(r(),k(e(Ee),{key:0,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(La),{style:{cursor:"pointer"},onClick:Z[2]||(Z[2]=_e=>v.value?.show())})]),_:1},8,["size"])]),default:t(()=>[Z[18]||(Z[18]=a(" 发红包 ",-1))]),_:1},8,["trigger"])):L("",!0),le.mode==="post"?(r(),k(e(Ee),{key:1,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(Ua),{style:{cursor:"pointer"},onClick:Z[3]||(Z[3]=_e=>g.value?.show())})]),_:1},8,["size"])]),default:t(()=>[Z[19]||(Z[19]=a(" 大乱斗 ",-1))]),_:1},8,["trigger"])):L("",!0),le.mode==="post"?(r(),k(e(Ee),{key:2,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(ja),{style:{cursor:"pointer"},onClick:Z[4]||(Z[4]=_e=>o.value?.show())})]),_:1},8,["size"])]),default:t(()=>[Z[20]||(Z[20]=a(" Roll点 ",-1))]),_:1},8,["trigger"])):L("",!0),l(e(Ee),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(Ha),{style:{cursor:"pointer"},onClick:Z[5]||(Z[5]=_e=>f.value?.show())})]),_:1},8,["size"])]),default:t(()=>[Z[21]||(Z[21]=a(" 快捷代码 ",-1))]),_:1},8,["trigger"]),l(e(Pe),{vertical:""}),l(e(Ee),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(Aa),{style:{cursor:"pointer"},onClick:Ce})]),_:1},8,["size"])]),default:t(()=>[Z[22]||(Z[22]=a(" 撤销 ",-1))]),_:1},8,["trigger"]),l(e(Ee),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:t(()=>[l(e(ye),{size:e(n).isMobile?28:32},{default:t(()=>[l(e(Ra),{style:{cursor:"pointer"},onClick:be})]),_:1},8,["size"])]),default:t(()=>[Z[23]||(Z[23]=a(" 清空 ",-1))]),_:1},8,["trigger"])]),_:1},8,["size","style"]),l(e(bt),{value:b.value,"onUpdate:value":Z[6]||(Z[6]=_e=>b.value=_e),type:"textarea",placeholder:$.value,rows:D.value,ref_key:"contentInputDom",ref:p,style:ae(T.value),"input-props":{id:"content-input"},disabled:s.value,onChange:Ye,onKeyup:Z[7]||(Z[7]=Ue(il(_e=>ke(_e),["ctrl"]),["enter"])),onBlur:Z[8]||(Z[8]=_e=>Be.value=!1),onFocus:Z[9]||(Z[9]=_e=>Be.value=!0)},null,8,["value","placeholder","rows","style","disabled"]),l(e(x),{justify:"end",align:"center"},{default:t(()=>[l(js,{"user-is-locked":s.value,"forum-id":le.forumId,"thread-id":le.threadId,onInsertImage:H},null,8,["user-is-locked","forum-id","thread-id"]),le.mode==="thread"?(r(),k(e(Ee),{key:0,placement:"bottom-start",trigger:"hover",disabled:e(n).isMobile},{trigger:t(()=>[l(e(Qe),{checked:z.value,"onUpdate:checked":Z[10]||(Z[10]=_e=>z.value=_e)},{default:t(()=>[...Z[24]||(Z[24]=[a("延时发送",-1)])]),_:1},8,["checked"])]),default:t(()=>[Z[25]||(Z[25]=a(" 第二天8点自动发出 ",-1))]),_:1},8,["disabled"])):L("",!0),l(e(Ee),{placement:"bottom-start",trigger:"hover",disabled:e(n).isMobile},{trigger:t(()=>[l(e(E),{type:"primary",onClick:Z[11]||(Z[11]=_e=>ke(_e)),loading:le.handling,disabled:le.handling||s.value},{default:t(()=>[...Z[26]||(Z[26]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[Z[27]||(Z[27]=a(" 可以Ctrl+Enter ",-1))]),_:1},8,["disabled"])]),_:1}),l(Us,{ref_key:"HongbaoModalCom",ref:v,"thread-id":le.threadId,"forum-id":le.forumId,onRefreshPostsList:Z[12]||(Z[12]=_e=>se("refreshPostsList"))},null,8,["thread-id","forum-id"]),l(xs,{ref_key:"BattleModalCom",ref:g,"thread-id":le.threadId,"forum-id":le.forumId,"random-heads-group":le.randomHeadsGroup,onRefreshPostsList:Z[13]||(Z[13]=_e=>se("refreshPostsList"))},null,8,["thread-id","forum-id","random-heads-group"]),l(ds,{ref_key:"RollModalCom",ref:o,"thread-id":le.threadId,"forum-id":le.forumId,onRefreshPostsList:Z[14]||(Z[14]=_e=>se("refreshPostsList"))},null,8,["thread-id","forum-id"]),l(Hs,{ref_key:"PingbiciModalCom",ref:i},null,512),l(Ss,{ref_key:"CodeModalCom",ref:f,onInsertCode:F},null,512),l(Ts,{ref_key:"DrawerModalCom",ref:d,onInsertImage:H,"user-is-locked":s.value,"forum-id":le.forumId,"thread-id":le.threadId},null,8,["user-is-locked","forum-id","thread-id"])]),_:1}))}}),As=Q({__name:"JumpModal",props:{threadId:{},postsNum:{},page:{}},setup(G,{expose:c}){const m=te(),w=Ne(),n=G,p=_(),v=_(!1);function g(){v.value=!0}c({show:g});function o(){if(p.value!==void 0){const i=Math.ceil((p.value+1)/200),f="#f_"+p.value;if(w.push({name:"thread",params:{threadId:n.threadId,page:i},hash:f}),i===n.page){const d=document.querySelector(f);d?.scrollIntoView({block:"center",behavior:"auto"}),d?.classList.add("on-focus")}v.value=!1}}return(i,f)=>(r(),k(e(Se),{show:v.value,"onUpdate:show":f[3]||(f[3]=d=>v.value=d),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"跳楼机",closable:"",onClose:f[2]||(f[2]=d=>v.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:o,disabled:!p.value},{default:t(()=>[...f[5]||(f[5]=[a("Jump!",-1)])]),_:1},8,["disabled"]),l(e(E),{onClick:f[1]||(f[1]=d=>v.value=!1)},{default:t(()=>[...f[6]||(f[6]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[a(" 最大高度："+j(i.postsNum)+"楼 ",1)]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...f[4]||(f[4]=[a("跳楼",-1)])]),_:1}),l(e(he),{placeholder:"请输入楼层号",max:i.postsNum,value:p.value,"onUpdate:value":f[0]||(f[0]=d=>p.value=d),onKeyup:Ue(o,["enter"])},null,8,["max","value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Rs=Q({__name:"AdminActionModal",props:{threadId:{},forumId:{default:0}},emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=Ne(),v=_(null),g=G,o=_({contentInput:void 0,switchInput:!1}),i=_("hint"),f=_(!0),d=_();let h;const T=R(()=>({contentInput:{required:$.value.requireContent,message:"请填写理由"},switchInput:{required:!1}})),D={hint:{requireContent:!1,contentMessage:!1,requireSwitch:!1},ban:{requireContent:!0,contentMessage:"你要永久粉碎这个饼干吗？",requireSwitch:!1},lock:{requireContent:!0,contentMessage:`要封禁这个饼干吗？
第1次3天、2次6天、3次9天、4次碎饼`,requireSwitch:!1},deleteAll:{requireContent:!0,contentMessage:`要用管理员权限删除该饼干全部回复吗？
此功能请谨慎使用，仅在有恶意刷屏时。`,requireSwitch:!0},delete:{requireContent:!0,contentMessage:"要用管理员权限删除这个回复吗？",requireSwitch:!0},recovery:{requireContent:!0,contentMessage:"要用管理员权限恢复这个回复吗？",requireSwitch:!1},deleteThread:{requireContent:!0,contentMessage:"要用管理员权限删除这个主题吗？",requireSwitch:!1},setTop:{requireContent:!1,contentMessage:"要设为置顶吗？",requireSwitch:!1},cancelTop:{requireContent:!1,contentMessage:"要取消置顶吗？",requireSwitch:!1}},$=R(()=>D[i.value]),s=_(!1);function u(z){i.value=z.action,h=z.postId??0,d.value=void 0,s.value=!0,z.action==="hint"?(f.value=!1,b("hint")):f.value=!0}c({show:u});const y=m;function b(z){if(z==="hint"){d.value="查询中……";const C={binggan:n.binggan,thread_id:g.threadId,post_id:h};_o(C).then(I=>{d.value=`此饼干状态：${I.user_status}。已被锁定过${I.locked_count}次。`});return}v.value?.validate(C=>{if(C){window.$message.error("请确认信息填写完整");return}else switch(z){case"ban":const I={binggan:n.binggan,thread_id:g.threadId,post_id:h,content:o.value.contentInput};$o(I).then(()=>{s.value=!1,y("refreshPostsList")});break;case"lock":const N={binggan:n.binggan,thread_id:g.threadId,post_id:h,content:o.value.contentInput};Mo(N).then(()=>{s.value=!1,y("refreshPostsList")});break;case"deleteAll":const q={binggan:n.binggan,thread_id:g.threadId,post_id:h,content:o.value.contentInput,reduce_olo:o.value.switchInput};zo(q).then(()=>{s.value=!1,y("refreshPostsList")});break;case"delete":const U={binggan:n.binggan,thread_id:g.threadId,post_id:h,content:o.value.contentInput,reduce_olo:o.value.switchInput};So(U).then(()=>{s.value=!1,y("refreshPostsList")});break;case"recovery":const B={binggan:n.binggan,thread_id:g.threadId,post_id:h,content:o.value.contentInput};xo(B).then(()=>{s.value=!1,y("refreshPostsList")});break;case"deleteThread":const P={binggan:n.binggan,thread_id:g.threadId,content:o.value.contentInput};Co(P).then(()=>{s.value=!1,p.push({name:"forum",params:{forumId:g.forumId,page:1}})});break;case"setTop":const A={binggan:n.binggan,thread_id:g.threadId};ko(A).then(()=>{s.value=!1,y("refreshPostsList")});break;case"cancelTop":const W={binggan:n.binggan,thread_id:g.threadId};ho(W).then(()=>{s.value=!1,y("refreshPostsList")});break}})}return(z,C)=>(r(),k(e(Se),{show:s.value,"onUpdate:show":C[5]||(C[5]=I=>s.value=I),"display-directive":"if",size:"small"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"管理员操作",closable:"",onClose:C[4]||(C[4]=I=>s.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[f.value?(r(),k(e(E),{key:0,type:"warning",onClick:C[2]||(C[2]=I=>b(i.value))},{default:t(()=>[...C[7]||(C[7]=[a("提交",-1)])]),_:1})):L("",!0),l(e(E),{onClick:C[3]||(C[3]=I=>s.value=!1)},{default:t(()=>[...C[8]||(C[8]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[$.value.contentMessage?(r(),k(e(M),{key:0,style:{"white-space":"pre-wrap"}},{default:t(()=>[a(j($.value.contentMessage),1)]),_:1})):L("",!0),d.value?(r(),k(e(M),{key:1},{default:t(()=>[a(j(d.value),1)]),_:1})):L("",!0),l(e(Xe),{ref_key:"formRef",ref:v,model:o.value,"label-placement":"left","label-width":"auto",rules:T.value,size:e(w).isMobile?"small":"medium",style:{"margin-top":"10px"}},{default:t(()=>[$.value.requireContent?(r(),k(e(ne),{key:0,label:"理由",path:"contentInput"},{default:t(()=>[l(e(ve),{placeholder:"必填",value:o.value.contentInput,"onUpdate:value":C[0]||(C[0]=I=>o.value.contentInput=I)},null,8,["value"])]),_:1})):L("",!0),$.value.requireSwitch?(r(),k(e(ne),{key:1,label:"罚款olo",path:"switchInput"},{default:t(()=>[l(e(xe),{value:o.value.switchInput,"onUpdate:value":C[1]||(C[1]=I=>o.value.switchInput=I)},null,8,["value"]),l(e(M),{style:{"margin-left":"6px"}},{default:t(()=>[...C[6]||(C[6]=[a("每个帖子罚款500，封顶5000个olo",-1)])]),_:1})]),_:1})):L("",!0)]),_:1},8,["model","rules","size"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Bs=Q({__name:"RewardModal",emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_(100),v=_(),g=_(!1),o=_();function i($){o.value=$,g.value=!0}c({show:i});const f=m;function d(){const $={binggan:n.binggan,post_floor_message:"@"+o.value.postFloorMessage,forum_id:o.value.forumId,thread_id:o.value.threadId,post_id:o.value.postId,coin:p.value,content:v.value};T($)}const{loading:h,send:T,onSuccess:D}=ue($=>Io($),{immediate:!1});return D(()=>{g.value=!1,f("refreshPostsList")}),($,s)=>(r(),k(e(Se),{show:g.value,"onUpdate:show":s[4]||(s[4]=u=>g.value=u),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:`打赏给№${o.value?.floor}`,closable:"",onClose:s[3]||(s[3]=u=>g.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:d,loading:e(h)},{default:t(()=>[...s[12]||(s[12]=[a("打赏",-1)])]),_:1},8,["loading"]),l(e(E),{onClick:s[2]||(s[2]=u=>g.value=!1)},{default:t(()=>[...s[13]||(s[13]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[S("div",null,[e(w).isDouble11?(r(),k(e(M),{key:1},{default:t(()=>[...s[6]||(s[6]=[S("del",null,"友情提示：在打赏额以外，会追加扣除7%手续费。",-1),S("br",null,null,-1),a(" 活动期间限时手续费2%！ ",-1)])]),_:1})):(r(),k(e(M),{key:0},{default:t(()=>[...s[5]||(s[5]=[a(" 友情提示：在打赏额以外，会追加扣除7%手续费。",-1)])]),_:1})),s[9]||(s[9]=S("br",null,null,-1)),l(e(M),null,{default:t(()=>[...s[7]||(s[7]=[a("总共扣除：",-1)])]),_:1}),l(e(M),{type:"error"},{default:t(()=>[a(j(Math.ceil(p.value*(e(w).isDouble11?1.02:1.07))),1)]),_:1}),l(e(M),null,{default:t(()=>[...s[8]||(s[8]=[a("块奥利奥。",-1)])]),_:1})]),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"}},{default:t(()=>[...s[10]||(s[10]=[a("打赏",-1)])]),_:1}),l(e(he),{type:"password",placeholder:"olo数量","show-password-on":"mousedown",clearable:"",value:p.value,"onUpdate:value":s[0]||(s[0]=u=>p.value=u),onKeyup:Ue(d,["enter"]),max:1e6,min:1,step:1e3,parse:e(ft),format:e(pt)},null,8,["value","parse","format"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...s[11]||(s[11]=[a("留言",-1)])]),_:1}),l(e(ve),{value:v.value,"onUpdate:value":s[1]||(s[1]=u=>v.value=u),placeholder:"（可留空）",onKeyup:Ue(d,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style","title"])]),_:1},8,["show"]))}}),Os=Q({__name:"BrowseLogger",props:{postsListLoading:{type:Boolean},disableScroll:{type:Boolean,default:!1},isSearch:{type:Boolean},threadId:{},page:{}},setup(G){const c=G,m=_(!1),w=Ct(),n=Gl();function p(){function g(){const i=window.innerWidth/2;return document.elementsFromPoint(i,100)}Sn(()=>{const i=g(),f=n.get(c.threadId);i.forEach(d=>{const h=Number(d.getAttribute("floor"));h&&h>f.floor&&n.log(c.threadId,h)})},100)()}function v(){if(!w.hash&&n.get(c.threadId)){const g=n.get(c.threadId),o=Math.ceil((g.floor+1)/200);if(o===c.page&&g.floor!==0){const i=document.getElementById("f_"+g.floor);i!==null&&(i.scrollIntoView({behavior:"auto",block:"center"}),window.$message.success(`已自动滚到上次浏览进度${g.floor}楼`))}o>c.page&&(m.value=!0)}}return Le(()=>c.postsListLoading,g=>{g===!1&&!c.disableScroll&&Ft(()=>v())}),vt(()=>{n.initThread(c.threadId),window.addEventListener("scroll",p)}),ot(()=>{m.value=!1,window.removeEventListener("scroll",p)}),(g,o)=>{const i=lt("router-link");return m.value&&!g.isSearch?(r(),k(e(It),{key:0,type:"success",closable:"",style:{"border-radius":"10px"}},{default:t(()=>[a(" 你上次已经浏览到"+j(e(n).get(g.threadId).floor)+"楼， ",1),l(i,{onClick:o[0]||(o[0]=f=>m.value=!1),to:{name:"thread",params:{threadId:g.threadId,page:Math.ceil((e(n).get(g.threadId).floor+1)/200)}}},{default:t(()=>[...o[1]||(o[1]=[a(" 点击这里 ",-1)])]),_:1},8,["to"]),o[2]||(o[2]=a(" 跳转 ",-1))]),_:1})):L("",!0)}}}),Es=Q({__name:"ChangeColorModal",props:{threadId:{}},emits:["refreshPostsList"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=G,v=_(),g=["#b65954","#c78878","#9b7e70","#de7562","#fca44b","#f1c727","#f6da79","#fbda97","#9fc778","#78c79f","#8ab185","#98c0d9","#8691db","#7878c7","#566b7c","#9678c7","#9f78c7","#ca95e9","#ecacc6","#a86fa2","#7e3749"],o=_(!1);function i(){o.value=!0}c({show:i});const{loading:f,send:d,onSuccess:h}=ue(D=>To(D),{immediate:!1});function T(){if(!v.value){window.$message.error("颜色输入不能为空");return}const D={binggan:n.binggan,thread_id:p.threadId,color:v.value};d(D),h(()=>o.value=!1)}return(D,$)=>(r(),k(e(Se),{show:o.value,"onUpdate:show":$[3]||($[3]=s=>o.value=s),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"标题改色",closable:"",onClose:$[2]||($[2]=s=>o.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",onClick:T,disabled:e(f),loading:e(f)},{default:t(()=>[...$[5]||($[5]=[a("提交",-1)])]),_:1},8,["disabled","loading"]),l(e(E),{onClick:$[1]||($[1]=s=>o.value=!1)},{default:t(()=>[...$[6]||($[6]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...$[4]||($[4]=[a(" 要更换标题颜色吗？每次收费500个olo喔 ",-1)])]),_:1}),l(e(Qt),{value:v.value,"onUpdate:value":$[0]||($[0]=s=>v.value=s),modes:["hex"],"show-alpha":!1,style:{"max-width":"8.2rem"},swatches:g},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Ns={style:{"text-align":"center"}},Fs={key:0},qs={key:1},Ws={key:2},Gs={key:3},Vs=Q({__name:"CrowdComponent",props:{crowdId:{},forumId:{}},setup(G){Te(U=>({"02a8d6e9":e(n).dividerColor}));const c=G,m=re(),w=te(),n=je(),p=_(1e3),v=R(()=>{const U=ie.tz(u.value.end_date),B=ie(),P=U.diff(B,"hour");return P>=1?`${P}小时后`:`${U.diff(B,"minute")}分钟后`}),g=R(()=>ie.tz(u.value.end_date).format("YY年M月D日 HH:mm")),o=R(()=>ie().isAfter(ie.tz(u.value.end_date))),i=[{label:"中止",key:"repeal",icon:Ie(Rl,{size:"1.5rem"})}];function f(U){switch(U){case"repeal":q();break}}const d=[{title:"我支持的olo",key:"olo",resizable:!0},{title:"参与时间",key:"created_at",resizable:!0}],{data:h,loading:T,send:D,onSuccess:$}=ue(Do(c.crowdId),{immediate:!1});function s(){D({binggan:m.binggan})}m.binggan&&s();const u=R(()=>h.value?.crowd),y=R(()=>h.value?.crowd_record??[]),b=R(()=>Math.round(u.value.olo_total/u.value.olo_target*100)),{loading:z,send:C,onSuccess:I}=ue(U=>Po(U),{immediate:!1});I(()=>{s()});function N(){if(!p.value){window.$message.error("请输入众筹金额喔");return}const U={binggan:m.binggan,crowd_olo:p.value,crowd_id:c.crowdId},B={title:"参加众筹",closable:!1,content:`确定要参加众筹吗？将消耗${p.value}个olo`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{C(U)}};window.$dialog.warning(B)}function q(){const U={binggan:m.binggan,crowd_id:c.crowdId},B={title:"中止众筹",closable:!1,content:"确定要中止众筹吗？已投注的olo将会退回",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Lo(U).then(()=>{s()})}};window.$dialog.warning(B)}return(U,B)=>(r(),k(e(oe),{size:"small",bordered:!0},{default:t(()=>[l(e(Ge),{show:e(T)},{default:t(()=>[u.value!==void 0?(r(),k(e(x),{key:0,vertical:""},{default:t(()=>[l(e(x),{size:"small",align:"center",class:"crowd-title"},{default:t(()=>[l(e(ye),{size:e(w).isMobile?24:32},{default:t(()=>[l(e(Ea))]),_:1},8,["size"]),S("span",null,j(u.value.title),1)]),_:1}),l(e(x),{vertical:"",align:"center"},{default:t(()=>[l(e(ml),{type:"dashboard",status:"success",percentage:b.value},{default:t(()=>[S("span",Ns,"进度"+j(b.value)+"% ",1)]),_:1},8,["percentage"]),o.value&&u.value.is_closed===0?(r(),O("span",Fs,"众筹已经过期了")):L("",!0),u.value.is_closed===1?(r(),O("span",qs,"众筹已达成目标！谢谢各位参与~")):L("",!0),u.value.is_closed===2?(r(),O("span",Ws,"众筹已经被管理员中止，olo已退回")):L("",!0),!o.value&&u.value.is_closed===0?(r(),O("div",Gs,[l(e(M),{depth:3},{default:t(()=>[...B[1]||(B[1]=[a("结束时间：",-1)])]),_:1}),S("span",null,j(g.value)+" ("+j(v.value)+")",1)])):L("",!0),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...B[2]||(B[2]=[a("众筹目标：",-1)])]),_:1}),S("span",null,j(`${u.value.olo_target.toLocaleString("en-us")} 个olo`),1)]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...B[3]||(B[3]=[a("已众筹到：",-1)])]),_:1}),S("span",null,j(`${u.value.olo_total.toLocaleString("en-us")} 个olo`),1)]),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(he),{max:1e6,min:1,step:1e3,placeholder:"投入额",disabled:o.value||u.value.is_closed!==0,value:p.value,"onUpdate:value":B[0]||(B[0]=P=>p.value=P)},null,8,["disabled","value"]),l(e(E),{type:"primary",onClick:N,loading:e(z),disabled:e(z)||o.value||u.value.is_closed!==0},{default:t(()=>[...B[4]||(B[4]=[a("投入",-1)])]),_:1},8,["loading","disabled"]),e(m).checkAdminForums(U.forumId)&&u.value.is_closed===0?(r(),k(e(qe),{key:0,trigger:e(w).isMobile?"click":"hover",options:i,onSelect:f,placement:"bottom-start"},{default:t(()=>[l(e(E),{type:"warning"},{default:t(()=>[...B[5]||(B[5]=[a("管理",-1)])]),_:1})]),_:1},8,["trigger"])):L("",!0)]),_:1})]),_:1}),y.value.length>0?(r(),k(e(wt),{key:0,columns:d,data:y.value,bordered:!1},null,8,["data"])):L("",!0)]),_:1})):L("",!0)]),_:1},8,["show"])]),_:1}))}}),Ys=$e(Vs,[["__scopeId","data-v-c8ea6852"]]),Js={key:0},Ks={key:1},Xs={key:2},Qs={key:3},Zs={class:"gamble-item"},ei={style:{"margin-left":"auto"}},ti=Q({__name:"GambleComponent",props:{gambleId:{},forumId:{}},setup(G){Te(A=>({"8196b06e":e(n).dividerColor}));const c=G,m=re(),w=te(),n=je(),p=_(),v=_(1e3),g=R(()=>{const A=ie.tz(y.value.end_date),W=ie(),J=A.diff(W,"hour");return J>=1?`${J}小时后`:`${A.diff(W,"minute")}分钟后`}),o=R(()=>ie.tz(y.value.end_date).format("YY年M月D日 HH:mm")),i=R(()=>ie().isAfter(ie.tz(y.value.end_date))),f=[{label:"开奖",key:"close",icon:Ie(qa,{size:"1.5rem"})},{label:"中止",key:"repeal",icon:Ie(Rl,{size:"1.5rem"})}];function d(A){switch(A){case"close":B();break;case"repeal":P();break}}const h=[{title:"我的投注",key:"option_text",resizable:!0},{title:"投注额",key:"betting_olo",resizable:!0},{title:"赔率",key:"odds",render:A=>A.odds?.toFixed(2)??"（开奖时确定）",resizable:!0},{title:"奖金",key:"win_olo",resizable:!0}],{data:T,loading:D,send:$,onSuccess:s}=ue(Uo(c.gambleId),{immediate:!1});function u(){$({binggan:m.binggan})}m.binggan&&u();const y=R(()=>T.value.gamble_question),b=R(()=>T.value.gamble_options),z=R(()=>T.value.user_choices?.map(A=>({...A,option_text:b.value.find(W=>W.id===A.option_id)?.option_text}))??[]),C=R(()=>b.value.find(A=>A.id===y.value.result_option_id)?.option_text),{loading:I,send:N,onSuccess:q}=ue(A=>jo(A),{immediate:!1});q(()=>{u()});function U(){if(!p.value||!v.value){window.$message.error("请选择选项和输入投注额喔");return}const A={binggan:m.binggan,gamble_question_id:c.gambleId,bet_option:p.value,betting_olo:v.value},W={title:"参加菠菜",closable:!1,content:`确定要参加菠菜吗？将消耗${v.value}个olo`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{N(A)}};window.$dialog.warning(W)}function B(){if(!p.value){window.$message.error("请选择选项喔");return}const A={binggan:m.binggan,gamble_question_id:c.gambleId,result_option:p.value},W={title:"开奖菠菜",closable:!1,content:`确定要开奖吗？开奖选项是：${b.value.find(J=>J.id===p.value)?.option_text}`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Ho(A).then(()=>{u()})}};window.$dialog.warning(W)}function P(){const A={binggan:m.binggan,gamble_question_id:c.gambleId},W={title:"中止菠菜",closable:!1,content:"确定要中止菠菜吗？已投注的olo将会退回",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Ao(A).then(()=>{u()})}};window.$dialog.warning(W)}return(A,W)=>(r(),k(e(oe),{size:"small",bordered:!0},{default:t(()=>[l(e(Ge),{show:e(D)},{default:t(()=>[e(T)!==void 0?(r(),k(e(x),{key:0,vertical:""},{default:t(()=>[l(e(x),{size:"small",align:"center",class:"gamble-title"},{default:t(()=>[l(e(ye),{size:e(w).isMobile?24:32},{default:t(()=>[l(e(Na))]),_:1},8,["size"]),S("span",null,j(y.value.title),1)]),_:1}),l(e(Fa),{value:p.value,"onUpdate:value":W[0]||(W[0]=J=>p.value=J)},{default:t(()=>[l(e(x),{vertical:"",size:"large"},{default:t(()=>[(r(!0),O(ee,null,me(b.value,(J,pe)=>(r(),O("div",{key:J.id},[l(e(Wa),{value:J.id,label:`（当前赔率 ${J.odds.toFixed(2)}）： ${J.id==y.value.result_option_id?"⭐":""} ${J.option_text}`},null,8,["value","label"]),l(e(ml),{status:"success",type:"line",height:e(w).isMobile?20:24,percentage:Math.floor(J.olo_total/y.value.olo_total*100),"indicator-placement":"inside"},{default:t(()=>[a(j(J.olo_total),1)]),_:2},1032,["height","percentage"])]))),128))]),_:1})]),_:1},8,["value"]),i.value&&y.value.is_closed===0?(r(),O("span",Js,"菠菜已经关闭投注")):L("",!0),y.value.is_closed===1?(r(),O("span",Ks,j(`菠菜已开奖，奖金已发放。中奖项是：${C.value}`),1)):L("",!0),y.value.is_closed===2?(r(),O("span",Xs,"菠菜已经被管理员中止，投注olo已退回")):L("",!0),!i.value&&y.value.is_closed===0?(r(),O("div",Qs,[l(e(M),{depth:3},{default:t(()=>[...W[2]||(W[2]=[a("结束时间：",-1)])]),_:1}),S("span",null,j(o.value)+" ("+j(g.value)+")",1)])):L("",!0),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(he),{max:1e6,min:1,step:1e3,placeholder:"投注额",disabled:i.value||y.value.is_closed!==0,value:v.value,"onUpdate:value":W[1]||(W[1]=J=>v.value=J)},null,8,["disabled","value"]),l(e(E),{type:"primary",onClick:U,loading:e(I),disabled:e(I)||i.value||y.value.is_closed!==0},{default:t(()=>[...W[3]||(W[3]=[a("投注",-1)])]),_:1},8,["loading","disabled"]),e(m).checkAdminForums(A.forumId)&&y.value.is_closed===0?(r(),k(e(qe),{key:0,trigger:e(w).isMobile?"click":"hover",options:f,onSelect:d,placement:"bottom-start"},{default:t(()=>[l(e(E),{type:"warning"},{default:t(()=>[...W[4]||(W[4]=[a("管理",-1)])]),_:1})]),_:1},8,["trigger"])):L("",!0)]),_:1}),!e(w).isMobile&&z.value.length>0?(r(),k(e(wt),{key:4,columns:h,data:z.value,bordered:!1},null,8,["data"])):L("",!0),e(w).isMobile?(r(),O(ee,{key:5},[z.value.length>0?(r(),k(e(x),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(z.value,J=>(r(),O("div",Zs,[l(e(x),{style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...W[5]||(W[5]=[a("我的投注：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(J.option_text),1)]),_:2},1024)])]),_:2},1024),l(e(x),{style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...W[6]||(W[6]=[a("投注额：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(J.betting_olo),1)]),_:2},1024)])]),_:2},1024),J.win_olo?(r(),k(e(x),{key:0,style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...W[7]||(W[7]=[a("赔率：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(J.odds?.toFixed(2)),1)]),_:2},1024)]),S("div",ei,[l(e(M),{depth:3},{default:t(()=>[...W[8]||(W[8]=[a("奖金：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(J.win_olo),1)]),_:2},1024)])]),_:2},1024)):L("",!0)]))),256))]),_:1})):L("",!0)],64)):L("",!0)]),_:1})):L("",!0)]),_:1},8,["show"])]),_:1}))}}),li=$e(ti,[["__scopeId","data-v-d08fb987"]]),ai={key:0},oi=Q({__name:"HongbaoComponent",props:{hongbaoId:{},threadId:{},forumId:{},noHongbaoPicMode:{type:Boolean}},emits:["refreshPostsList"],setup(G,{emit:c}){const m=re(),w=te(),n=G,p=R(()=>i.value.pic_url&&!n.noHongbaoPicMode),v=R(()=>p.value?{backgroundImage:`linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)), url(${i.value.pic_url})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{}),g=_(),o=R(()=>({1:"随机olo",2:"定额olo"})[i.value.type]),{data:i,loading:f,send:d,onSuccess:h}=ue(Ro(n.hongbaoId),{immediate:!1,initialData:{}});h(b=>{g.value=b.data.key_word});function T(){d({binggan:m.binggan})}m.binggan&&T();const{loading:D,send:$,onSuccess:s}=ue(b=>Bo(b),{immediate:!1});s(()=>{y("refreshPostsList")});function u(b){if(!b.isTrusted){const N={title:"错误",closable:!1,content:"请不要用脚本抢红包喔",positiveText:"确定"};window.$dialog.warning(N);return}const{timestamp:z,newPostKey:C}=tl(b.isTrusted,n.threadId,m.binggan),I={binggan:m.binggan,forum_id:n.forumId,thread_id:n.threadId,content:"--红包口令: "+g.value,nickname:"= =",post_with_admin:!1,new_post_key:C,timestamp:z,hongbao_id:n.hongbaoId,hongbao_key_word:g.value};$(I).then(()=>{T()})}const y=c;return(b,z)=>(r(),k(e(oe),{size:"small",bordered:!0,class:"hongbao-card",style:ae(v.value)},{default:t(()=>[l(e(Ge),{show:e(f)},{default:t(()=>[l(e(x),{vertical:"",align:"center"},{default:t(()=>[l(e(x),{align:"center",size:"small"},{default:t(()=>[l(e(M),{style:{"font-size":"1rem"}},{default:t(()=>[...z[1]||(z[1]=[a("口令红包",-1)])]),_:1}),p.value?L("",!0):(r(),O("img",{key:0,src:"/hongbao.svg",style:ae({height:e(w).isMobile?"30px":"36px"})},null,4))]),_:1}),S("div",null,[e(i).key_word?(r(),k(e(M),{key:0,depth:3},{default:t(()=>[...z[2]||(z[2]=[a("口令：",-1)])]),_:1})):L("",!0),l(e(M),null,{default:t(()=>[a(j(e(i).key_word),1)]),_:1})]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...z[3]||(z[3]=[a("数量：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(e(i).num_remains)+" /"+j(e(i).num_total)+" （"+j(o.value)+"）",1)]),_:1})]),e(i).olo_hide?L("",!0):(r(),O("div",ai,[l(e(M),{depth:3},{default:t(()=>[...z[4]||(z[4]=[a("总额：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(e(i).olo_total?.toLocaleString("en-us"))+" olo ",1)]),_:1})])),l(e(x),{size:"small",wrap:!1},{default:t(()=>[e(i).hongbao_user===null?(r(),k(e(ve),{key:0,value:g.value,"onUpdate:value":z[0]||(z[0]=C=>g.value=C),maxlength:255,onKeyup:Ue(u,["enter"]),style:{"max-width":"328px"},placeholder:e(i).num_remains===0?"已经抢光啦":"请输入口令","auto-size":"",disabled:e(i).hongbao_user!==null||e(i).num_remains===0},null,8,["value","placeholder","disabled"])):(r(),k(e(ve),{key:1,value:`你抢到了${e(i).hongbao_user?.olo.toLocaleString("en-us")}个olo`,maxlength:255,style:{"max-width":"328px"},"auto-size":"",disabled:""},null,8,["value"])),l(e(E),{type:"primary",onClick:u,disabled:e(i).hongbao_user!==null||e(D)||e(i).num_remains===0},{default:t(()=>[...z[5]||(z[5]=[a("抢！",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["style"]))}}),ni=$e(oi,[["__scopeId","data-v-d0fedc06"]]),si={key:0},ii=Q({__name:"VoteComponent",props:{voteId:{}},setup(G){const c=G,m=re(),w=te(),n=_([]);Le(n,(C,I)=>{C.length>T.value.max_choices&&(window.$message.error(`最多只能选择${T.value.max_choices}个选项喔`),n.value=I)});const p=R(()=>{const C=ie.tz(T.value.end_date),I=ie(),N=C.diff(I,"hour");return N>=1?`${N}小时后`:`${C.diff(I,"minute")}分钟后`}),v=R(()=>ie.tz(T.value.end_date).format("YY年M月D日 HH:mm")),g=R(()=>ie().isAfter(ie.tz(T.value.end_date))),{data:o,loading:i,send:f,onSuccess:d}=ue(Oo(c.voteId),{immediate:!1});d(C=>{C.data.user_choices&&(n.value=C.data.user_choices.options_id)});function h(){f({binggan:m.binggan})}m.binggan&&h();const T=R(()=>o.value.vote_question),D=R(()=>o.value.vote_options),$=R(()=>o.value.user_choices),s=R(()=>$.value!==null),{loading:u,send:y,onSuccess:b}=ue(C=>Eo(C),{immediate:!1});b(()=>{h()});function z(){const C={binggan:m.binggan,vote_question_id:c.voteId,vote_options:n.value};y(C)}return(C,I)=>(r(),k(e(oe),{size:"small",bordered:!0},{default:t(()=>[l(e(Ge),{show:e(i)},{default:t(()=>[e(o)!==void 0?(r(),k(e(x),{key:0,vertical:""},{default:t(()=>[l(e(x),{size:"small",align:"center",class:"vote-title"},{default:t(()=>[l(e(ye),{size:e(w).isMobile?24:32},{default:t(()=>[l(e(Ga))]),_:1},8,["size"]),S("span",null,j(e(o).vote_question.title),1)]),_:1}),l(e(Xt),{value:n.value,"onUpdate:value":I[0]||(I[0]=N=>n.value=N),disabled:s.value},{default:t(()=>[l(e(x),{vertical:"",size:"large"},{default:t(()=>[(r(!0),O(ee,null,me(D.value,(N,q)=>(r(),O("div",{key:N.id},[l(e(Ke),{value:N.id,label:`${q+1}. ${N.option_text}`},null,8,["value","label"]),l(e(ml),{status:"success",type:"line",height:e(w).isMobile?20:24,percentage:Math.floor(N.vote_total/T.value.vote_total*100),"indicator-placement":"inside"},{default:t(()=>[a(j(N.vote_total)+"票 ",1)]),_:2},1032,["height","percentage"])]))),128))]),_:1})]),_:1},8,["value","disabled"]),g.value?(r(),O("span",si,"投票已经结束了")):(r(),O(ee,{key:1},[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...I[1]||(I[1]=[a("最多选择：",-1)])]),_:1}),S("span",null,j(T.value.max_choices)+"个选项",1)]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...I[2]||(I[2]=[a("结束时间：",-1)])]),_:1}),S("span",null,j(v.value)+" ("+j(p.value)+")",1)])],64)),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(E),{type:"primary",onClick:z,loading:e(u),disabled:e(u)||s.value||g.value},{default:t(()=>[...I[3]||(I[3]=[a("投票",-1)])]),_:1},8,["loading","disabled"]),s.value?(r(),k(e(M),{key:0,depth:3},{default:t(()=>[...I[4]||(I[4]=[a("你已经投过票了，谢谢参与！",-1)])]),_:1})):L("",!0)]),_:1})]),_:1})):L("",!0)]),_:1},8,["show"])]),_:1}))}}),ui=$e(ii,[["__scopeId","data-v-467006fa"]]),ri=Q({__name:"PoolComponent",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(G,{emit:c}){const m=G,w=re(),n=te(),p=ie.tz("2025-1-29 00:00"),v=ie.tz("2025-2-1 00:00"),g=R(()=>{const C=ie.tz();return C<p?0:C>v?2:1}),o=R(()=>({0:`活动将于 ${p.format("M月D日H点")} 开始`,1:`请投入你的祝福~~，活动将于${v.format("M月D日H点")}结束。（${i.value}）`,2:"祝福池已关闭，请等待开奖。"})[g.value]),i=R(()=>{const C=ie.tz(),I=v.diff(C,"hour"),N=v.diff(C,"minute")-60*I;return`剩余${I}小时${N}分钟`}),f=_(),{data:d,loading:h,send:T,onSuccess:D}=ue(No(),{immediate:!1,initialData:{}});function $(){T()}w.binggan&&$();const{loading:s,send:u,onSuccess:y}=ue(C=>Fo(C),{immediate:!1});function b(C){if(f.value===void 0){const N={title:"错误",closable:!1,content:"请输入祝福语喔",positiveText:"确定"};window.$dialog.warning(N);return}const I={binggan:w.binggan,forum_id:m.forumId,thread_id:m.threadId,message:f.value,olo:C?3e5:1e3,admin:C};u(I).then(()=>{$(),z("refreshPostsList")})}const z=c;return(C,I)=>(r(),k(e(oe),{size:"small",bordered:!0},{default:t(()=>[l(e(Ge),{show:e(h)},{default:t(()=>[l(e(x),{vertical:"",align:"center"},{default:t(()=>[l(e(x),{align:"center",size:"small"},{default:t(()=>[l(e(M),{style:{"font-size":"1rem"}},{default:t(()=>[...I[4]||(I[4]=[a("祝福池",-1)])]),_:1}),S("img",{src:"/hongbao.svg",style:ae({height:e(n).isMobile?"30px":"36px"})},null,4)]),_:1}),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...I[5]||(I[5]=[a("祝福池总额：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(e(d).olo_total?.toLocaleString("en-us"))+" olo ",1)]),_:1})]),l(e(x),{size:"small",wrap:!1},{default:t(()=>[l(e(ve),{value:f.value,"onUpdate:value":I[0]||(I[0]=N=>f.value=N),maxlength:255,onKeyup:I[1]||(I[1]=Ue(N=>b(!1),["enter"])),style:{"max-width":"328px"},placeholder:e(d).user_pool===null?"请留下祝福语":"已经投过祝福啦","auto-size":"",disabled:e(d).user_pool!==null},null,8,["value","placeholder","disabled"]),l(e(E),{type:"primary",onClick:I[2]||(I[2]=N=>b(!1)),disabled:e(d).user_pool!==null||e(s)||g.value!==1},{default:t(()=>[...I[6]||(I[6]=[a("投入祝福",-1)])]),_:1},8,["disabled"]),e(w).admin.isSuperAdmin?(r(),k(e(E),{key:0,type:"warning",onClick:I[3]||(I[3]=N=>b(!0))},{default:t(()=>[...I[7]||(I[7]=[a("投入30w",-1)])]),_:1})):L("",!0)]),_:1}),l(e(x),{align:"center",size:"small"},{default:t(()=>[S("span",null,j(o.value),1)]),_:1})]),_:1})]),_:1},8,["show"])]),_:1}))}}),di={bordered:!0,class:"post-item-skeleton"},mi=Q({__name:"ThreadPage",props:{threadId:{},page:{},search:{}},setup(G){const c=re(),m=te(),w=Ct(),n=Ne(),p=_(null),v=_([]),g=_(null),o=_(null),i=_(null),f=_(null),d=_(null);vt(()=>{m.showTopbarNav=!1}),ot(()=>{m.showTopbarNav=!0});const h=G,T=_(null),D=_(null),$=_(null),s=_(null),u=_(null),y=_(null),b=_(!0),z=_(!1);vt(()=>{z.value=!0}),ot(()=>{z.value=!1});const C=R(()=>{const K=ie.tz(Me.value.nissin_date),V=ie(),De=K.diff(V,"hour"),we=K.diff(V,"minute")-60*De;return`${De}小时${we}分钟后`}),I=_(!1),N=_(!1),q=Ae("no_video_mode",!1),U=Ae("no_image_mode",!1),B=Ae("no_emoji_mode",!1),P=Ae("no_custom_emoji_mode",!1),A=Ae("no_head_mode",!1),W=Ae("no_battle_mode",!1),J=Ae("no_roll_mode",!1),pe=Ae("no_reward_mode",!1),Re=Ae("no_hongbao_mode",!1),ce=Ae("no_hongbao_pic_mode",!1),be=Ae("no_mention_mode",!1),ze=Ae("use_url_mode",!1),Ce=Ae("no_pailou_mode",!1),Ye=R(()=>{const K=[{ref:q,label:"音频视频"},{ref:U,label:"图片"},{ref:B,label:"一般表情包"},{ref:P,label:"自定义表情包"},{ref:A,label:"头像"},{ref:W,label:"大乱斗"},{ref:J,label:"roll点"},{ref:pe,label:"打赏"},{ref:Re,label:"红包结果"},{ref:ce,label:"红包封面"},{ref:be,label:"关闭@标注"},{ref:Ce,label:"无内容排楼"}];return c.admin.isSuperAdmin?K.unshift({ref:I,label:"超管模式启动！"}):c.admin.isNormalAdmin&&K.unshift({ref:N,label:"让代码失效"}),K});function X(){return de(x,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(Ye.value).map(K=>de(Qe,{checked:K.ref.value,"onUpdate:checked":V=>K.ref.value=V,label:K.label})),de(Ya,{keepAliveOnHover:!1,placement:"bottom",style:{width:"max-content"}},{trigger:()=>de(Qe,{checked:ze.value,"onUpdate:checked":K=>ze.value=K,label:"自动转换超链接"}),default:()=>"实验性功能，可能会导致回复显示出错"})])}const F=[{type:"group",key:"header",label:"屏蔽"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:X}],H=R(()=>{const K=[{label:"删除主题",key:"deleteThread",icon:Ie($t,{size:"1.5rem"})}];return Me.value.sub_id===0?K.push({label:"设为置顶",key:"setTop",icon:Ie(Ll,{size:"1.5rem"})}):K.push({label:"取消置顶",key:"cancelTop",icon:Ie(Ul,{size:"1.5rem"})}),K});function Y(K){y.value?.show({action:K})}const se=_(h.page);function ke(K){n.push({name:"thread",params:{threadId:h.threadId,page:K},query:{search:h.search}})}Le(()=>h.page,K=>se.value=K);const at=R(()=>({threadId:h.threadId,binggan:c.binggan,page:h.page,searchContent:h.search,noMentionMode:be.value})),{loading:Be,data:le,onSuccess:Z,onError:_e,send:St}=Hl(()=>Il(at.value),[()=>h.threadId,()=>h.page,()=>h.search],{initialData:{},immediate:!0});Z(K=>{document.title=K.data.thread_data.title,Ft(()=>{if(w.hash){const V=document.querySelector(w.hash);V?.scrollIntoView({block:"center",behavior:"auto"}),V?.classList.add("on-focus")}})}),_e(K=>{b.value=!1,K.error.cause!==void 0&&K.error.cause.code!==401&&s.value?.show({errorCode:K.error.cause.code,message:K.error.message})}),vt(()=>{St(),b.value=!0}),ot(()=>{Be.value=!0,p.value?.resetInput()});const Ut=_(!1),{fetching:ll,onSuccess:Ql,onError:Zl,fetch:ea}=Kt();function We(K=!1){ll.value!==!0&&(Ut.value=K,ea(Il(at.value)))}Ql(()=>{v.value.forEach(K=>{K.refreshBattleData()}),Ut.value&&!m.userCustom.lessToast&&window.$message.success("已刷新数据")}),Zl(K=>{b.value=!1,K.error.cause!==void 0&&s.value?.show({errorCode:K.error.cause.code,message:K.error.message})});const ta=R(()=>le.value.posts_data.data),Me=R(()=>le.value.thread_data),He=R(()=>le.value.forum_data),jt=R(()=>le.value.your_post_floors),vl=R(()=>{let K;return K=ta.value.filter(V=>{if(W.value===!0&&V.battle_id!==null||J.value===!0&&V.created_by_admin===2&&V.nickname==="Roll点系统")return!1;if(pe.value===!0&&V.created_by_admin===2&&V.nickname==="奥利奥打赏系统"&&!V.is_your_post){if(jt.value.length>0){const De=V.content.match(/@№[0-9]+/g);if(De===null)return!1;const we=Number(De[0].slice(2));if(jt.value.includes(we))return!0}return!1}if(Re.value===!0){const De=V.created_by_admin==2&&V.nickname=="红包结果"&&!V.is_your_post,we=/^--红包口令: /.test(V.content)&&!V.is_your_post;if(De||we)return!1}if(Ce.value===!0&&!V.is_your_post&&/^<span(.*?)<\/span>$/s.test(V.content))return!1;if(c.userData?.binggan.use_pingbici&&m.userCustom.hidePingbiciFloor){const De=m.userCustom.pingbiciIngnoreCase?"gi":"g";for(let we of c.userData.pingbici.content_pingbici)if(new RegExp(we,De).test(V.content))return!1;if(Me.value.anti_jingfen){for(let we of c.userData.pingbici.fjf_pingbici)if(new RegExp(we,"g").test(V.created_binggan_hash.slice(0,5)))return!1}for(let we of c.userData.pingbici.fjf_pingbici)if(new RegExp(we,De).test(V.nickname))return!1}return!0}),K}),Ht=_(h.search),At=_(!!h.search);function bl(){n.push({name:"thread",params:{threadId:h.threadId,page:1},query:{search:Ht.value||void 0}})}function la(){Ht.value=void 0,At.value=!1,n.push({name:"thread",params:{threadId:h.threadId,page:1}})}const st=_(!1),Rt=_(!1),cl=R(()=>h.page===(Be.value?h.page:le.value.posts_data.lastPage)),zt=zn();function aa(K){K.post_floor>=h.page*200?(st.value=!1,Rt.value=!0):le.value.posts_data.data.find(De=>De.id===K.post_id)||oa(K.thread_id,K.post_id)}function oa(K,V){const De={binggan:c.binggan,post_id:V,thread_id:K};Wo(De).then(we=>{le.value.posts_data.data.push(we),m.userCustom.hongbaoThenStop&&we.hongbao_id!==null&&(window.$message.info("有红包！停止涮锅！（个人中心开启了红包自动停止涮锅）"),st.value=!1);const gt=document.body.clientHeight-document.documentElement.scrollTop;Ft(()=>{(p.value?.isTyping||m.userCustom.holdPageWhenListening)&&(document.documentElement.scrollTop=document.body.clientHeight-gt)})})}Le(st,K=>{if(K===!0)try{We(!1),zt.connect(),zt.channel("thread_"+h.threadId).listen("NewPost",V=>aa(V)),zt.pusher?.connection.bind("state_change",V=>{V.current==="unavailable"&&(window.$message.error("嗷……服务器的自动涮锅服务好像出问题了，暂时不能使用"),st.value=!1)})}catch{window.$message.error("嗷……服务器的自动涮锅服务好像出问题了，暂时不能使用"),st.value=!1}else zt.isConnected&&zt.disconnect()}),ot(()=>{st.value=!1}),Le([()=>h.threadId,()=>h.page,()=>h.search],()=>{st.value=!1,Rt.value=!1});let yl,al;function wl(K,V){const{timestamp:De,newPostKey:we}=tl(K.ist,Me.value.id,c.binggan),gt={binggan:c.binggan,forum_id:He.value.id,thread_id:Me.value.id,content:K.contentInput,nickname:K.nicknameInput,post_with_admin:K.postWithAdmin,new_post_key:we,timestamp:De};al=V,yl=K,ia(gt)}function na(){wl(yl,al)}const{loading:sa,send:ia,onSuccess:ua,onError:ra}=ue(K=>qo(K),{immediate:!1});ua(()=>{al("success"),We(!1)}),ra(K=>{K.error.cause!==void 0&&K.error.cause.code===244291&&D.value?.show()});function _l(K){K.ctrlKey&&K.key==="x"&&We(!0)}return vt(()=>{window.addEventListener("keyup",_l)}),ot(()=>{window.removeEventListener("keyup",_l)}),(K,V)=>{const De=lt("router-link");return r(),O(ee,null,[l(e(x),{vertical:""},{default:t(()=>[b.value?(r(),O(ee,{key:0},[l(e(x),{align:"center",style:{"margin-top":"8px"}},{default:t(()=>[l(e(ye),{size:e(m).isMobile?28:34},{default:t(()=>[l(e(Al),{style:{cursor:"pointer"},onClick:V[0]||(V[0]=we=>At.value=!At.value)})]),_:1},8,["size"]),l(Gt,{page:se.value,"onUpdate:page":[V[1]||(V[1]=we=>se.value=we),ke],"last-page":e(Be)?1:e(le).posts_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),At.value?(r(),k(e(x),{key:0,wrap:!1},{default:t(()=>[l(e(ve),{value:Ht.value,"onUpdate:value":V[2]||(V[2]=we=>Ht.value=we),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索回复内容","auto-size":"",onKeyup:Ue(bl,["enter"])},null,8,["value"]),l(e(E),{type:"primary",onClick:bl},{default:t(()=>[...V[15]||(V[15]=[a("搜索",-1)])]),_:1}),l(e(E),{type:"default",onClick:la},{default:t(()=>[...V[16]||(V[16]=[a("清空",-1)])]),_:1})]),_:1})):L("",!0),e(m).userCustom.loudspeakerPosition==="top"?(r(),k(Nt,{key:1})):L("",!0),l(Os,{page:K.page,"thread-id":K.threadId,"posts-list-loading":e(Be),"disable-scroll":!!K.search,"is-search":!!K.search},null,8,["page","thread-id","posts-list-loading","disable-scroll","is-search"])],64)):L("",!0),!e(Be)&&b.value?(r(),O(ee,{key:1},[l(e(oe),{class:"thread-title-container",size:"small",key:"title-card"},{default:t(()=>[S("span",{class:"thread-title",style:ae({fontSize:e(m).userCustom.fontSizeThreadList+"px"})},j(Me.value?.title)+" ["+j(Me.value?.posts_num)+"] ",5),e(c).checkAdminForums(He.value?.id)?(r(),k(e(qe),{key:0,trigger:"click",options:H.value,onSelect:Y,size:e(m).isMobile?"medium":"large"},{default:t(()=>[l(e(ye),{size:e(m).isMobile?20:24,style:{cursor:"pointer",float:"right","margin-left":"0.5rem"}},{default:t(()=>[l(e(Wt))]),_:1},8,["size"])]),_:1},8,["options","size"])):L("",!0),Me.value?.is_your_thread?(r(),k(e(E),{key:1,size:"small",type:"primary",style:{float:"right","margin-left":"0.5rem"},onClick:V[3]||(V[3]=we=>T.value?.show())},{default:t(()=>[...V[17]||(V[17]=[a(" 变色 ",-1)])]),_:1})):L("",!0)]),_:1}),l(e(x),{vertical:"",size:2},{default:t(()=>[l(Vt,{"post-data":vl.value[0],"your-posts-list":jt.value,"anti-jingfen":Me.value?.anti_jingfen,"forum-id":He.value.id,"no-custom-emoji-mode":e(P),"no-emoji-mode":e(B),"no-head-mode":e(A),"no-image-mode":e(U),"no-video-mode":e(q),"use-url-mode":e(ze),"random-head-group-index":Me.value.random_heads_group,"super-admin-mode":I.value,"no-mention-mode":e(be),onShowRewardModal:u.value?.show,"no-hongbao-pic-mode":e(ce),onQuoteClick:p.value?.quoteHandle,onRefreshPostsList:V[4]||(V[4]=we=>We(!1)),onAdminHandle:y.value?.show},null,8,["post-data","your-posts-list","anti-jingfen","forum-id","no-custom-emoji-mode","no-emoji-mode","no-head-mode","no-image-mode","no-video-mode","use-url-mode","random-head-group-index","super-admin-mode","no-mention-mode","onShowRewardModal","no-hongbao-pic-mode","onQuoteClick","onAdminHandle"]),Me.value.vote_question_id!==null?(r(),k(ui,{key:0,ref_key:"VoteComponentCom",ref:g,"vote-id":Me.value.vote_question_id},null,8,["vote-id"])):L("",!0),Me.value.gamble_question_id!==null?(r(),k(li,{key:1,ref_key:"GambleComponentCom",ref:o,"gamble-id":Me.value.gamble_question_id,"forum-id":He.value?.id},null,8,["gamble-id","forum-id"])):L("",!0),Me.value.crowd_id!==null?(r(),k(Ys,{key:2,ref_key:"CrowdComponentCom",ref:i,"crowd-id":Me.value.crowd_id,"forum-id":He.value?.id},null,8,["crowd-id","forum-id"])):L("",!0),Me.value.hongbao_id!==null?(r(),k(ni,{key:3,ref_key:"HongbaoComponentCom",ref:f,"hongbao-id":Me.value.hongbao_id,"thread-id":K.threadId,"forum-id":He.value?.id,"no-hongbao-pic-mode":e(ce),onRefreshPostsList:V[5]||(V[5]=we=>We(!1))},null,8,["hongbao-id","thread-id","forum-id","no-hongbao-pic-mode"])):L("",!0),K.threadId===138549?(r(),k(ri,{key:4,ref_key:"PoolComponentCom",ref:d,"thread-id":K.threadId,"forum-id":He.value?.id,onRefreshPostsList:V[6]||(V[6]=we=>We(!1))},null,8,["thread-id","forum-id"])):L("",!0),(r(!0),O(ee,null,me(vl.value.slice(1),we=>(r(),k(Vt,{key:we.id,"post-data":we,"your-posts-list":jt.value,"anti-jingfen":Me.value?.anti_jingfen,"forum-id":He.value.id,"no-custom-emoji-mode":e(P),"no-emoji-mode":e(B),"no-head-mode":e(A),"no-image-mode":e(U),"no-video-mode":e(q),"use-url-mode":e(ze),"random-head-group-index":Me.value.random_heads_group,"super-admin-mode":I.value,"admin-mode":N.value,"no-mention-mode":e(be),onShowRewardModal:u.value?.show,"no-hongbao-pic-mode":e(ce),onQuoteClick:p.value?.quoteHandle,onRefreshPostsList:V[7]||(V[7]=gt=>We(!1)),onAdminHandle:y.value?.show,ref_for:!0,ref_key:"PostItemComs",ref:v},null,8,["post-data","your-posts-list","anti-jingfen","forum-id","no-custom-emoji-mode","no-emoji-mode","no-head-mode","no-image-mode","no-video-mode","use-url-mode","random-head-group-index","super-admin-mode","admin-mode","no-mention-mode","onShowRewardModal","no-hongbao-pic-mode","onQuoteClick","onAdminHandle"]))),128))]),_:1}),l(e(x),{align:"center",style:{"margin-top":"8px"}},{default:t(()=>[l(e(E),{type:"primary",loading:e(ll),disabled:e(ll),onClick:V[8]||(V[8]=we=>We(!0))},{default:t(()=>[...V[18]||(V[18]=[a("刷新",-1)])]),_:1},8,["loading","disabled"]),l(e(xe),{value:st.value,"onUpdate:value":V[9]||(V[9]=we=>st.value=we),disabled:!cl.value||Rt.value},{checked:t(()=>[...V[19]||(V[19]=[a(" 涮锅中 ",-1)])]),unchecked:t(()=>[...V[20]||(V[20]=[a(" 自动涮锅 ",-1)])]),_:1},8,["value","disabled"]),Rt.value?(r(),k(De,{key:0,to:{name:"thread",params:{threadId:K.threadId,page:K.page+1}}},{default:t(()=>[...V[21]||(V[21]=[a("回帖已经翻页、点击前往 ",-1)])]),_:1},8,["to"])):L("",!0),cl.value?L("",!0):(r(),k(e(M),{key:1},{default:t(()=>[...V[22]||(V[22]=[a("在最新一页才能自动涮锅",-1)])]),_:1}))]),_:1}),l(e(x),{align:"center",style:ae([{"margin-top":"8px"},{paddingRight:e(m).isMobile?"24px":"0px"}])},{default:t(()=>[l(e(Ee),{placement:"bottom-start",trigger:"hover"},{trigger:t(()=>[l(e(ye),{size:34},{default:t(()=>[l(e(Va),{onClick:V[10]||(V[10]=we=>e(n).push({name:"forum",params:{forumId:He.value?.id}})),style:{cursor:"pointer"}})]),_:1})]),default:t(()=>[l(e(M),null,{default:t(()=>[...V[23]||(V[23]=[a("返回小岛",-1)])]),_:1})]),_:1}),l(Gt,{page:se.value,"onUpdate:page":[V[11]||(V[11]=we=>se.value=we),ke],"last-page":e(Be)?1:e(le).posts_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1},8,["style"]),e(m).userCustom.loudspeakerPosition==="center"?(r(),k(Nt,{key:0})):L("",!0)],64)):(r(),k(e(x),{key:2,vertical:"",size:2},{default:t(()=>[(r(),O(ee,null,me(200,we=>S("div",di)),64))]),_:1})),et(l(Xl,{ref_key:"postInputCom",ref:p,mode:"post","forum-id":He.value?.id,"thread-id":K.threadId,disabled:!1,handling:e(sa),"random-heads-group":Me.value?.random_heads_group,onContentCommit:wl,onRefreshPostsList:We},null,8,["forum-id","thread-id","handling","random-heads-group"]),[[tt,!e(Be)&&b.value]]),!e(Be)&&b.value?(r(),O(ee,{key:3},[l(e(x),{justify:"end"},{default:t(()=>[He.value.is_nissin===2&&Me.value.sub_id===0?(r(),k(e(M),{key:0},{default:t(()=>[V[24]||(V[24]=a(" 本贴将于 ",-1)),l(e(M),{type:"error"},{default:t(()=>[a(j(C.value),1)]),_:1}),V[25]||(V[25]=a(" 日清，请及时更换帖子喔 ",-1))]),_:1})):L("",!0),He.value.is_nissin===1&&Me.value.sub_id===0?(r(),k(e(M),{key:1},{default:t(()=>[V[27]||(V[27]=a(" 本小岛 ",-1)),l(e(M),{type:"error"},{default:t(()=>[...V[26]||(V[26]=[a(" 每日早上8:00 ",-1)])]),_:1}),V[28]||(V[28]=a(" 日清，请及时更换帖子喔 ",-1))]),_:1})):L("",!0)]),_:1}),l(e(x),null,{default:t(()=>[l(e(E),{type:"primary",onClick:V[12]||(V[12]=we=>e(n).push({name:"forum",params:{forumId:He.value?.id}}))},{default:t(()=>[...V[29]||(V[29]=[a("返回小岛",-1)])]),_:1})]),_:1}),e(m).userCustom.loudspeakerPosition==="bottom"?(r(),k(Nt,{key:0})):L("",!0),V[31]||(V[31]=S("div",{style:{height:"50px"}},null,-1)),z.value?(r(),O(ee,{key:1},[(r(),k(qt,{to:"#topbar-nav"},[l(De,{to:{name:"forum",params:{forumId:He.value?.id}},class:"flex-item-center"},{default:t(()=>[l(e(it),{tooltip:!1},{default:t(()=>[a(j(He.value?.name),1)]),_:1}),l(e(dt),{round:"",class:"forum-tag",size:e(m).isMobile?"small":"medium"},{default:t(()=>[a(j(He.value?.id),1)]),_:1},8,["size"])]),_:1},8,["to"])])),(r(),k(qt,{to:"#topbar-func"},[l(e(qe),{trigger:e(m).isMobile?"click":"hover",options:F,placement:"bottom-start"},{default:t(()=>[l(e(E),null,{default:t(()=>[...V[30]||(V[30]=[a("屏蔽",-1)])]),_:1})]),_:1},8,["trigger"])]))],64)):L("",!0),l(Es,{ref_key:"ChangeColorModalCom",ref:T,"thread-id":K.threadId},null,8,["thread-id"]),l(Kl,{ref_key:"CaptchaModalCom",ref:D,onWaterUnlockOnSuccess:na},null,512),l(As,{ref_key:"JumpModalCom",ref:$,"thread-id":K.threadId,"posts-num":Me.value.posts_num,page:K.page},null,8,["thread-id","posts-num","page"]),l(Bs,{ref_key:"RewardModalCom",ref:u,onRefreshPostsList:We},null,512)],64)):L("",!0),l(Yl,{mode:"thread",onRefresh:V[13]||(V[13]=we=>We(!0)),onShowJumpModal:V[14]||(V[14]=we=>$.value.show())})]),_:1}),et(l(e(Ge),{size:"large",class:"spin"},null,512),[[tt,e(Be)]]),l(rs,{ref_key:"ForbiddenModalCom",ref:s},null,512),e(c).checkAdminForums(He.value?.id)?(r(),k(Rs,{key:0,ref_key:"AdminActionModalCom",ref:y,onRefreshPostsList:We,"thread-id":K.threadId,"forum-id":He.value?.id},null,8,["thread-id","forum-id"])):L("",!0)],64)}}}),pi=$e(mi,[["__scopeId","data-v-31ce79c6"]]),Qu=Object.freeze(Object.defineProperty({__proto__:null,default:pi},Symbol.toStringTag,{value:"Module"})),fi=Q({__name:"TabCommon",props:{forumId:{}},setup(G,{expose:c}){const m=re(),w=te(),n=Ve();xt(),Ne();const p=G,v={subtitle:"[闲聊]",nissinTime:1,antiJingfen:!1,randomHeadsGroup:1,canBattle:!0,titleColor:"#212529",lockedByCoin:null,isPrivate:!1,subId:10},g=_({...v}),o=R(()=>m.checkAdminForums(p.forumId)?Tt.filter(u=>!["[私密]"].includes(u)):Tt.filter(u=>!["[公告]","[私密]"].includes(u))),i=R(()=>o.value.map(u=>({value:u,label:u})));Le(()=>g.value.isPrivate,u=>{u?g.value.subtitle="[私密]":g.value.subtitle="[闲聊]"});const f=R(()=>{switch(n.forumData(p.forumId)?.is_nissin){case 0:return[{value:1,label:"本小岛不日清"}];case 1:return[{value:1,label:"本小岛固定8点日清"}];case 2:return[{value:1,label:"24小时"},{value:2,label:"48小时"},{value:3,label:"72小时"},{value:7,label:"一周"},{value:1095,label:"长期"}];default:return[]}}),d=R(()=>{switch(n.forumData(p.forumId)?.is_nissin){case 0:return!0;case 1:return!0;case 2:return!1;default:return!0}}),h=R(()=>Vl.map(u=>({value:u.id,label:u.name})));Le(()=>n.forumsDataLoading,u=>{if(u===!1){const y=n.forumData(p.forumId);y!==void 0&&(g.value.randomHeadsGroup=y.default_heads)}},{immediate:!0});const T=_(!1),D=["#b65954","#c78878","#9b7e70","#de7562","#fca44b","#f1c727","#f6da79","#fbda97","#9fc778","#78c79f","#8ab185","#98c0d9","#8691db","#7878c7","#566b7c","#9678c7","#9f78c7","#ca95e9","#ecacc6","#a86fa2","#7e3749"],$=R(()=>{let u=0;return T.value&&(u+=500),(g.value.lockedByCoin??!1)&&(u+=500),g.value.isPrivate&&(u+=500),u}),s=R(()=>({...g.value,titleColor:T.value?g.value.titleColor:null,subId:g.value.subtitle==="[公告]"?g.value.subId:0}));return c({tabNormalInput:s}),ot(()=>{g.value={...v}}),(u,y)=>(r(),k(e(Xe),{ref:"formRef",model:g.value,"label-placement":"left","label-width":"auto",size:e(w).isMobile?"small":"medium"},{default:t(()=>[l(e(kt),{cols:"1 600:2","x-gap":12},{default:t(()=>[l(e(Fe),{style:{"max-width":"18rem"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...y[10]||(y[10]=[a("常规选项",-1)])]),_:1})]),_:1}),l(e(ne),{label:"副标题",path:"subtitle"},{default:t(()=>[l(e(Oe),{value:g.value.subtitle,"onUpdate:value":y[0]||(y[0]=b=>g.value.subtitle=b),options:i.value,disabled:g.value.isPrivate,"menu-props":{style:{borderRadius:"10px"}}},null,8,["value","options","disabled"])]),_:1}),g.value.subtitle==="[公告]"?(r(),k(e(ne),{key:0,label:"全岛公告",path:"subId"},{default:t(()=>[l(e(xe),{value:g.value.subId,"onUpdate:value":y[1]||(y[1]=b=>g.value.subId=b),"checked-value":99,"unchecked-value":10},null,8,["value"])]),_:1})):L("",!0),l(e(ne),{label:"日清时间",path:"nissinTime"},{default:t(()=>[l(e(Oe),{value:g.value.nissinTime,"onUpdate:value":y[2]||(y[2]=b=>g.value.nissinTime=b),options:f.value,disabled:d.value},null,8,["value","options","disabled"])]),_:1}),l(e(ne),{label:"随机头像组",path:"randomHeadsGroup"},{default:t(()=>[l(e(Oe),{value:g.value.randomHeadsGroup,"onUpdate:value":y[3]||(y[3]=b=>g.value.randomHeadsGroup=b),options:h.value},null,8,["value","options"])]),_:1}),l(e(ne),{label:"开启反精分",path:"antiJingfen"},{default:t(()=>[l(e(xe),{value:g.value.antiJingfen,"onUpdate:value":y[4]||(y[4]=b=>g.value.antiJingfen=b)},null,8,["value"])]),_:1}),l(e(ne),{label:"开启大乱斗",path:"canBattle"},{default:t(()=>[l(e(xe),{value:g.value.canBattle,"onUpdate:value":y[5]||(y[5]=b=>g.value.canBattle=b)},null,8,["value"])]),_:1})]),_:1}),l(e(Fe),{style:{"max-width":"18rem"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...y[11]||(y[11]=[a("以下选项每个500olo ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"看帖权限",path:"lockedByCoin"},{default:t(()=>[l(e(he),{value:g.value.lockedByCoin,"onUpdate:value":y[6]||(y[6]=b=>g.value.lockedByCoin=b),placeholder:"需要多少olo才能看",max:25e3,parse:e(ft),format:e(pt),min:0,step:5e3,clearable:"",style:{"border-radius":"17px"}},null,8,["value","parse","format"])]),_:1}),l(e(ne),{label:"私密主题",path:"isPrivate"},{default:t(()=>[l(e(xe),{value:g.value.isPrivate,"onUpdate:value":y[7]||(y[7]=b=>g.value.isPrivate=b)},null,8,["value"])]),_:1}),l(e(ne),{label:"标题颜色",path:"titleColor"},{default:t(()=>[l(e(xe),{value:T.value,"onUpdate:value":y[8]||(y[8]=b=>T.value=b)},null,8,["value"]),et(l(e(Qt),{value:g.value.titleColor,"onUpdate:value":y[9]||(y[9]=b=>g.value.titleColor=b),modes:["hex"],"show-alpha":!1,swatches:D,style:{"margin-left":"12px"}},null,8,["value"]),[[tt,T.value]])]),_:1}),et(l(e(ne),{label:"合计花费"},{default:t(()=>[l(e(M),{depth:"3"},{default:t(()=>[a(j($.value)+"个olo ",1)]),_:1})]),_:1},512),[[tt,$.value>0]])]),_:1})]),_:1})]),_:1},8,["model","size"]))}}),gi=Q({__name:"TabCrowd",setup(G,{expose:c}){const m=_(),w=_(ie.tz().add(7,"day").format("YYYY-MM-DD 00:00:00")),n=_(1e6);function p(g){return ie().subtract(1,"day").isAfter(g)||ie().add(1,"month").isBefore(ie(g))}const v=R(()=>({title:m.value,olo_target:n.value,end_time:w.value}));return c({crowdParams:v}),(g,o)=>(r(),k(e(x),{vertical:"",style:{"max-width":"450px","margin-top":"8px"}},{default:t(()=>[l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...o[3]||(o[3]=[a("众筹项目",-1)])]),_:1}),l(e(ve),{value:m.value,"onUpdate:value":o[0]||(o[0]=i=>m.value=i),placeholder:"必填"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...o[4]||(o[4]=[a("目标金额",-1)])]),_:1}),l(e(he),{value:n.value,"onUpdate:value":o[1]||(o[1]=i=>n.value=i),max:1e7,min:1e5,step:1e5,parse:e(ft),format:e(pt)},null,8,["value","parse","format"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...o[5]||(o[5]=[a("结束日期",-1)])]),_:1}),l(e(rt),{"formatted-value":w.value,"onUpdate:formattedValue":o[2]||(o[2]=i=>w.value=i),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","is-date-disabled":p},null,8,["formatted-value"])]),_:1})]),_:1}))}}),vi=Q({__name:"TabGamble",setup(G,{expose:c}){const m=_(),w=_([]),n=_(ie.tz().add(7,"day").format("YYYY-MM-DD 00:00:00")),p=_(3);function v(i){i===1&&p.value<20&&(p.value+=1),i===-1&&p.value>1&&(w.value.splice(p.value-1,1),p.value-=1)}function g(i){return ie().subtract(1,"day").isAfter(i)||ie().add(1,"month").isBefore(ie(i))}const o=R(()=>({title:m.value,options:w.value,end_time:n.value}));return c({gambleParams:o}),(i,f)=>(r(),k(e(x),{vertical:"",style:{"max-width":"450px","margin-top":"8px"}},{default:t(()=>[l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...f[4]||(f[4]=[a("菠菜标题",-1)])]),_:1}),l(e(ve),{value:m.value,"onUpdate:value":f[0]||(f[0]=d=>m.value=d),placeholder:"必填"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...f[5]||(f[5]=[a("结束日期",-1)])]),_:1}),l(e(rt),{"formatted-value":n.value,"onUpdate:formattedValue":f[1]||(f[1]=d=>n.value=d),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","is-date-disabled":g},null,8,["formatted-value"])]),_:1}),f[7]||(f[7]=S("span",null,"最长菠菜时间是1个月",-1)),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}}),(r(!0),O(ee,null,me(p.value,d=>(r(),k(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[a(j(`选项#${d}`),1)]),_:2},1024),l(e(ve),{value:w.value[d-1],"onUpdate:value":h=>w.value[d-1]=h,maxlength:255},null,8,["value","onUpdate:value"])]),_:2},1024))),256)),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...f[6]||(f[6]=[a("选项数量",-1)])]),_:1}),l(e(nt),{size:"tiny",circle:"",disabled:p.value===20,onClick:f[2]||(f[2]=d=>v(1))},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(Zt))]),_:1})]),_:1},8,["disabled"]),l(e(nt),{size:"tiny",circle:"",disabled:p.value===1,onClick:f[3]||(f[3]=d=>{v(-1)})},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(el))]),_:1})]),_:1},8,["disabled"])]),_:1}),f[8]||(f[8]=S("span",null,"菠菜开奖时只能开一个选项（没有多选，因为赔率不会算……）",-1))]),_:1}))}}),bi=Q({__name:"TabHongbao",setup(G,{expose:c}){const m=te(),w=_(2e4),n=_(10),p=_(1),v=_(),g=_([]),o=_(!1),i=_(!1),f=_(null),d=_(1);function h($){$===1&&d.value<5&&(d.value+=1),$===-1&&d.value>1&&(g.value.splice(d.value-1,1),d.value-=1)}const T=[{value:1,label:"随机olo"},{value:2,label:"定额olo"}],D=R(()=>({olo:w.value,num:n.value,type:p.value,keyword:v.value,message:g.value,olo_hide:o.value,loudspeaker:i.value,pic_url:f.value}));return c({hongbaoParams:D}),($,s)=>(r(),k(e(x),{vertical:"",style:{"max-width":"450px","margin-top":"8px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...s[9]||(s[9]=[a("温馨提示：",-1)])]),_:1}),s[10]||(s[10]=a("在红包总额以外，会追加扣除7%手续费。 ",-1))]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...s[11]||(s[11]=[a("总共扣除：",-1)])]),_:1}),l(e(M),{type:"warning"},{default:t(()=>[a(j(Math.ceil(w.value*(e(m).isDouble11?1.02:1.07))),1)]),_:1}),s[12]||(s[12]=a("个奥利奥 ",-1))]),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[13]||(s[13]=[a("olo类型",-1)])]),_:1}),l(e(Oe),{value:p.value,"onUpdate:value":s[0]||(s[0]=u=>p.value=u),options:T},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[14]||(s[14]=[a("红包个数",-1)])]),_:1}),l(e(he),{value:n.value,"onUpdate:value":s[1]||(s[1]=u=>n.value=u),max:600,min:10,step:10},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[15]||(s[15]=[a("olo总额",-1)])]),_:1}),l(e(he),{value:w.value,"onUpdate:value":s[2]||(s[2]=u=>w.value=u),max:2e6,min:2e4,step:1e4,parse:e(ft),format:e(pt)},null,8,["value","parse","format"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[16]||(s[16]=[a("红包口令",-1)])]),_:1}),l(e(ve),{value:v.value,"onUpdate:value":s[3]||(s[3]=u=>v.value=u),placeholder:"必填"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[17]||(s[17]=[a("红包封面",-1)])]),_:1}),l(e(ve),{value:f.value,"onUpdate:value":s[4]||(s[4]=u=>f.value=u),placeholder:"（可选）填写图片的完整网址"},null,8,["value"])]),_:1}),(r(!0),O(ee,null,me(d.value,u=>(r(),k(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...s[18]||(s[18]=[a("回复留言",-1)])]),_:1}),l(e(ve),{value:g.value[u-1],"onUpdate:value":y=>g.value[u-1]=y,placeholder:`#${u}（可选） 多个留言时随机抽取一个`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...s[19]||(s[19]=[a("留言数量",-1)])]),_:1}),l(e(nt),{size:"tiny",circle:"",disabled:d.value===5,onClick:s[5]||(s[5]=u=>h(1))},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(Zt))]),_:1})]),_:1},8,["disabled"]),l(e(nt),{size:"tiny",circle:"",disabled:d.value===1,onClick:s[6]||(s[6]=u=>{h(-1)})},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(el))]),_:1})]),_:1},8,["disabled"])]),_:1}),l(e(x),{size:"small",align:"center",justify:"end"},{default:t(()=>[l(e(Ke),{checked:i.value,"onUpdate:checked":s[7]||(s[7]=u=>i.value=u),label:"附带发出大喇叭"},null,8,["checked"]),l(e(Ke),{checked:o.value,"onUpdate:checked":s[8]||(s[8]=u=>o.value=u),label:"隐藏olo总额"},null,8,["checked"])]),_:1})]),_:1}))}}),ci=Q({__name:"TabVote",setup(G,{expose:c}){const m=_(!1),w=_(1),n=_(),p=_([]),v=_(ie.tz().add(7,"day").format("YYYY-MM-DD 00:00:00")),g=_(3);function o(d){d===1&&g.value<20&&(g.value+=1),d===-1&&g.value>1&&(p.value.splice(g.value-1,1),g.value-=1)}function i(d){return ie().subtract(1,"day").isAfter(d)||ie().add(1,"month").isBefore(ie(d))}const f=R(()=>({multiple:m.value,max_choices:m?w.value:1,title:n.value,options:p.value,end_time:v.value}));return c({voteParams:f}),(d,h)=>(r(),k(e(x),{vertical:"",style:{"max-width":"450px","margin-top":"8px"}},{default:t(()=>[l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...h[6]||(h[6]=[a("投票标题",-1)])]),_:1}),l(e(ve),{value:n.value,"onUpdate:value":h[0]||(h[0]=T=>n.value=T),placeholder:"必填"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...h[7]||(h[7]=[a("结束日期",-1)])]),_:1}),l(e(rt),{"formatted-value":v.value,"onUpdate:formattedValue":h[1]||(h[1]=T=>v.value=T),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","is-date-disabled":i},null,8,["formatted-value"])]),_:1}),h[10]||(h[10]=S("span",null,"最长投票时间是1个月",-1)),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}}),(r(!0),O(ee,null,me(g.value,T=>(r(),k(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[a(j(`选项#${T}`),1)]),_:2},1024),l(e(ve),{value:p.value[T-1],"onUpdate:value":D=>p.value[T-1]=D,maxlength:255},null,8,["value","onUpdate:value"])]),_:2},1024))),256)),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...h[8]||(h[8]=[a("选项数量",-1)])]),_:1}),l(e(nt),{size:"tiny",circle:"",disabled:g.value===20,onClick:h[2]||(h[2]=T=>o(1))},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(Zt))]),_:1})]),_:1},8,["disabled"]),l(e(nt),{size:"tiny",circle:"",disabled:g.value===1,onClick:h[3]||(h[3]=T=>{o(-1)})},{icon:t(()=>[l(e(ye),null,{default:t(()=>[l(e(el))]),_:1})]),_:1},8,["disabled"])]),_:1}),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}}),l(e(Ke),{checked:m.value,"onUpdate:checked":h[4]||(h[4]=T=>m.value=T),label:"开启多选"},null,8,["checked"]),m.value?(r(),k(e(fe),{key:0},{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...h[9]||(h[9]=[a("最多选择",-1)])]),_:1}),l(e(he),{value:w.value,"onUpdate:value":h[5]||(h[5]=T=>w.value=T),max:g.value,min:1,step:1},null,8,["value","max"])]),_:1})):L("",!0)]),_:1}))}}),yi=Q({__name:"NewThread",props:{forumId:{}},setup(G){const c=re(),m=te(),w=Ve(),n=Ne(),p=_(),v=_("normal"),g=_(null);vt(()=>{m.showTopbarNav=!1}),ot(()=>{m.showTopbarNav=!0});const o=_(!1);vt(()=>{o.value=!0}),ot(()=>{o.value=!1}),document.title="新主题";const i=G,f=_(null),d=R(()=>f.value?.tabNormalInput),h=_(null),T=_(null),D=_(null),$=_(null);let s=!1;function u(y,b){let z;if(z={binggan:c.binggan,forum_id:i.forumId,title:y.titleInput,content:y.contentInput,nickname:y.nicknameInput,subtitle:d.value.subtitle,thread_type:v.value,post_with_admin:y.postWithAdmin,anti_jingfen:d.value.antiJingfen,is_delay:y.isDelay,is_private:d.value.isPrivate,can_battle:d.value.canBattle,random_heads_group:d.value.randomHeadsGroup,nissin_time:d.value.nissinTime,title_color:d.value.titleColor,locked_by_coin:d.value.lockedByCoin,sub_id:d.value.subId},v.value==="hongbao"){const C=h.value.hongbaoParams;if(C.type===2&&C.olo%C.num!==0){window.$message.error("选择定额红包时，总额要是红包数量的整倍数喔");return}if(!C.keyword){window.$message.error("必须要输入红包口令");return}z.hongbao_params={...C,keyword:C.keyword}}if(v.value==="vote"){const C=$.value.voteParams;if(!C.title){window.$message.error("必须要输入投票标题");return}z.vote_params={...C,title:C.title}}if(v.value==="gamble"){const C=D.value.gambleParams;if(!C.title){window.$message.error("必须要输入菠菜标题");return}z.gamble_params={...C,title:C.title}}if(v.value==="crowd"){const C=T.value.crowdParams;if(!C.title){window.$message.error("必须要输入众筹标题");return}if(!C.olo_target){window.$message.error("必须要输入众筹金额");return}z.crowd_params={...C,title:C.title}}s=!0,Go(z).then(C=>{b("success"),s=!1,ht({title:"已发送主题，是否跳转？",mode:"success",onPositiveClick:()=>n.push({name:"thread",params:{threadId:C.thread_id}})})})}return ot(()=>{v.value="normal",g.value?.resetInput()}),(y,b)=>{const z=lt("router-link");return r(),k(e(x),{vertical:"",style:{"margin-top":"8px"}},{default:t(()=>[l(Xl,{ref_key:"postInputCom",ref:g,mode:"thread","forum-id":y.forumId,disabled:!1,handling:e(s),"random-heads-group":d.value?.randomHeadsGroup,onContentCommit:u},null,8,["forum-id","handling","random-heads-group"]),l(e(Pt),{type:"line",animated:"",size:e(m).isMobile?"small":"medium",value:p.value,"onUpdate:value":b[4]||(b[4]=C=>p.value=C)},{default:t(()=>[l(e(Je),{name:"常规",tab:"常规","display-directive":"show"},{default:t(()=>[l(e(fi),{"forum-id":i.forumId,ref_key:"TabCommonComponent",ref:f},null,8,["forum-id"])]),_:1}),l(e(Je),{name:"红包",tab:"红包","display-directive":"show"},{default:t(()=>[l(e(Ke),{checked:v.value,"onUpdate:checked":b[0]||(b[0]=C=>v.value=C),"checked-value":"hongbao","unchecked-value":"normal"},{default:t(()=>[...b[5]||(b[5]=[a(" 开启红包 ",-1)])]),_:1},8,["checked"]),v.value==="hongbao"?(r(),k(e(bi),{key:0,ref_key:"TabHongbaoCom",ref:h},null,512)):L("",!0)]),_:1}),l(e(Je),{name:"投票",tab:"投票","display-directive":"show"},{default:t(()=>[l(e(Ke),{checked:v.value,"onUpdate:checked":b[1]||(b[1]=C=>v.value=C),"checked-value":"vote","unchecked-value":"normal"},{default:t(()=>[...b[6]||(b[6]=[a(" 开启投票（1000奥利奥） ",-1)])]),_:1},8,["checked"]),v.value==="vote"?(r(),k(e(ci),{key:0,ref_key:"TabVoteCom",ref:$},null,512)):L("",!0)]),_:1}),l(e(Je),{name:"菠菜",tab:"菠菜","display-directive":"show"},{default:t(()=>[l(e(Ke),{checked:v.value,"onUpdate:checked":b[2]||(b[2]=C=>v.value=C),"checked-value":"gamble","unchecked-value":"normal",disabled:y.forumId!==12},{default:t(()=>[...b[7]||(b[7]=[a(" 开启菠菜（500奥利奥） 目前只能在海滨乐园岛开菠菜（避免被日清） ",-1)])]),_:1},8,["checked","disabled"]),v.value==="gamble"?(r(),k(e(vi),{key:0,ref_key:"TabGambleCom",ref:D},null,512)):L("",!0)]),_:1}),e(c).checkAdminForums(i.forumId)?(r(),k(e(Je),{key:0,name:"众筹",tab:"众筹","display-directive":"show"},{default:t(()=>[l(e(Ke),{checked:v.value,"onUpdate:checked":b[3]||(b[3]=C=>v.value=C),"checked-value":"crowd","unchecked-value":"normal",disabled:y.forumId!==2},{default:t(()=>[...b[8]||(b[8]=[a(" 开启众筹（仅管理员可见） 目前只能在小火锅调味区开众筹（避免被日清） ",-1)])]),_:1},8,["checked","disabled"]),v.value==="crowd"?(r(),k(e(gi),{key:0,ref_key:"TabCrowdCom",ref:T},null,512)):L("",!0)]),_:1})):L("",!0)]),_:1},8,["size","value"]),o.value?(r(),k(qt,{key:0,to:"#topbar-nav"},[l(z,{to:{name:"forum",params:{forumId:i.forumId}},class:"flex-item-center"},{default:t(()=>[l(e(it),{tooltip:!1},{default:t(()=>[a(j(e(w).forumData(y.forumId)?.name),1)]),_:1}),l(e(dt),{round:"",class:"forum-tag",size:e(m).isMobile?"small":"medium"},{default:t(()=>[a(j(y.forumId),1)]),_:1},8,["size"])]),_:1},8,["to"])])):L("",!0)]),_:1})}}}),Zu=Object.freeze(Object.defineProperty({__proto__:null,default:yi},Symbol.toStringTag,{value:"Module"})),wi=Q({__name:"TabCommon",setup(G){const c=te(),m=c.userCustom,w=[{value:"top",label:"放在顶部"},{value:"center",label:"放在中间"},{value:"bottom",label:"放在底部"}],n=[{value:"imgbb",label:"(推荐)imgbb"},{value:"freeimage",label:"freeimage"},{value:"imgimg",label:"imgimg"},{value:"helloimg",label:"helloimg"},{value:"picui",label:"picui"},{value:"imgwang",label:"ImgWang"},{value:"picgo",label:"(要注册)picgo"}],p={id:0,created_at:"2021-04-28 00:44:23",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:"<span class='quote-content'>这是引用内容 <br>@№0 = = 2021-04-28 00:44:23</span><br>这是预览模式，可以确认上面设定的式样是否满意。<br>这是第二行。<br>这是第三行。",nickname:"= =",is_your_post:!0,hongbao_data:null},v=[{id:0,sub_id:0,forum_id:1,vote_question_id:null,gamble_question_id:null,crowd_id:null,hongbao_id:null,nickname:"= =",title:"这是预览模式，可以确认上面设定的式样是否满意。",sub_title:"[预览]",random_heads_group:1,posts_num:100,title_color:null,anti_jingfen:!1,nissin_date:null,has_nissined:!1,can_battle:!1,is_delay:!1,locked_by_coin:0,is_private:!1,created_at:null,updated_at:null}];return(g,o)=>(r(),k(e(x),{vertical:"",size:"small"},{default:t(()=>[l(e(oe),{title:"一般设定",size:"small"},{"header-extra":t(()=>[l(e(E),{onClick:e(c).userCustomReset},{default:t(()=>[...o[22]||(o[22]=[a("恢复默认",-1)])]),_:1},8,["onClick"])]),default:t(()=>[l(e(Xe),{ref:"formRef",model:e(m),"label-placement":"left","label-width":"auto",size:e(c).isMobile?"small":"medium",style:{"max-height":"655px","overflow-y":"auto"}},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...o[23]||(o[23]=[a("这些设定保存在本设备，不跟随饼干",-1)])]),_:1}),l(e(kt),{cols:"1 600:2","x-gap":12},{default:t(()=>[l(e(Fe),{style:{"max-width":"280px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...o[24]||(o[24]=[a("功能选项 ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"图床选择",path:"loudspeakerPosition"},{default:t(()=>[l(e(Oe),{value:e(m).imgHost,"onUpdate:value":o[0]||(o[0]=i=>e(m).imgHost=i),options:n,"menu-props":{style:{borderRadius:"10px"}}},null,8,["value"])]),_:1}),l(e(ne),{label:"自动涮锅时遇红包停止",path:"hongbaoThenStop"},{default:t(()=>[l(e(xe),{value:e(m).hongbaoThenStop,"onUpdate:value":o[1]||(o[1]=i=>e(m).hongbaoThenStop=i)},null,8,["value"])]),_:1}),l(e(ne),{label:"自动涮锅时页面不动",path:"holdPageWhenListening"},{default:t(()=>[l(e(xe),{value:e(m).holdPageWhenListening,"onUpdate:value":o[2]||(o[2]=i=>e(m).holdPageWhenListening=i)},null,8,["value"])]),_:1}),l(e(ne),{label:"减少弹出提示",path:"lessToast"},{default:t(()=>[l(e(xe),{value:e(m).lessToast,"onUpdate:value":o[3]||(o[3]=i=>e(m).lessToast=i)},null,8,["value"])]),_:1})]),_:1}),l(e(Fe),{style:{"max-width":"280px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...o[25]||(o[25]=[a("基本外观 ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"传统式回复框",path:"postLegacyMode"},{default:t(()=>[l(e(xe),{value:e(m).postLegacyMode,"onUpdate:value":o[4]||(o[4]=i=>e(m).postLegacyMode=i)},null,8,["value"])]),_:1}),l(e(ne),{label:"大喇叭和标题单色",path:"monochromeMode"},{default:t(()=>[l(e(xe),{value:e(m).monochromeMode,"onUpdate:value":o[5]||(o[5]=i=>e(m).monochromeMode=i)},null,8,["value"])]),_:1}),l(e(ne),{label:"侧边栏放左边",path:"sidebarLeft"},{default:t(()=>[l(e(xe),{value:e(m).sidebarLeft,"onUpdate:value":o[6]||(o[6]=i=>e(m).sidebarLeft=i)},null,8,["value"])]),_:1}),l(e(ne),{label:"大喇叭位置",path:"loudspeakerPosition"},{default:t(()=>[l(e(Oe),{value:e(m).loudspeakerPosition,"onUpdate:value":o[7]||(o[7]=i=>e(m).loudspeakerPosition=i),options:w,"menu-props":{style:{borderRadius:"10px"}}},null,8,["value"])]),_:1}),l(e(ne),{label:"最大引用层数",path:"quoteMax"},{default:t(()=>[l(e(he),{value:e(m).quoteMax,"onUpdate:value":o[8]||(o[8]=i=>e(m).quoteMax=i),max:6,min:1,step:1},{suffix:t(()=>[...o[26]||(o[26]=[a(" 层 ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"回复行数限高",path:"foldMaxLine"},{default:t(()=>[l(e(he),{value:e(m).foldMaxLine,"onUpdate:value":o[9]||(o[9]=i=>e(m).foldMaxLine=i),max:99,min:6,step:1},{suffix:t(()=>[...o[27]||(o[27]=[a(" 行 ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"表情包白色背景",path:"emojiWhiteBack"},{default:t(()=>[l(e(Ee),{trigger:"hover"},{trigger:t(()=>[l(e(xe),{value:e(m).emojiWhiteBack,"onUpdate:value":o[10]||(o[10]=i=>e(m).emojiWhiteBack=i)},null,8,["value"])]),default:t(()=>[o[28]||(o[28]=S("span",null,"可以解决AC娘在芝麻锅中看不清的问题",-1))]),_:1})]),_:1})]),_:1}),l(e(Fe),{style:{"max-width":"280px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...o[29]||(o[29]=[a("字体大小 ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"回复内容",path:"fontSizePost"},{default:t(()=>[l(e(he),{value:e(m).fontSizePost,"onUpdate:value":o[11]||(o[11]=i=>e(m).fontSizePost=i),max:24,min:10,step:.5},{suffix:t(()=>[...o[30]||(o[30]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"引用内容",path:"fontSizeQuote"},{default:t(()=>[l(e(he),{value:e(m).fontSizeQuote,"onUpdate:value":o[12]||(o[12]=i=>e(m).fontSizeQuote=i),max:24,min:10,step:.5},{suffix:t(()=>[...o[31]||(o[31]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"回复脚注",path:"fontSizeFooter"},{default:t(()=>[l(e(he),{value:e(m).fontSizeFooter,"onUpdate:value":o[13]||(o[13]=i=>e(m).fontSizeFooter=i),max:22,min:8,step:.5},{suffix:t(()=>[...o[32]||(o[32]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"主题列表",path:"fontSizeThreadList"},{default:t(()=>[l(e(he),{value:e(m).fontSizeThreadList,"onUpdate:value":o[14]||(o[14]=i=>e(m).fontSizeThreadList=i),max:24,min:10,step:.5},{suffix:t(()=>[...o[33]||(o[33]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"主题列表脚注",path:"fontSizeThreadListFooter"},{default:t(()=>[l(e(he),{value:e(m).fontSizeThreadListFooter,"onUpdate:value":o[15]||(o[15]=i=>e(m).fontSizeThreadListFooter=i),max:22,min:8,step:.5},{suffix:t(()=>[...o[34]||(o[34]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"输入框",path:"fontSizeInput"},{default:t(()=>[l(e(he),{value:e(m).fontSizeInput,"onUpdate:value":o[16]||(o[16]=i=>e(m).fontSizeInput=i),max:24,min:10,step:.5},{suffix:t(()=>[...o[35]||(o[35]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),l(e(Fe),{style:{"max-width":"280px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...o[36]||(o[36]=[a("间距相关 ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"回复内容行距",path:"lineHeightPost"},{default:t(()=>[l(e(he),{value:e(m).lineHeightPost,"onUpdate:value":o[17]||(o[17]=i=>e(m).lineHeightPost=i),max:40,min:16,step:2},{suffix:t(()=>[...o[37]||(o[37]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"回复内容上下间距",path:"postInnerMargin"},{default:t(()=>[l(e(he),{value:e(m).postInnerMargin,"onUpdate:value":o[18]||(o[18]=i=>e(m).postInnerMargin=i),max:30,min:0,step:1},{suffix:t(()=>[...o[38]||(o[38]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"回复卡片四周空白",path:"postCardPadding"},{default:t(()=>[l(e(he),{value:e(m).postCardPadding,"onUpdate:value":o[19]||(o[19]=i=>e(m).postCardPadding=i),max:20,min:4,step:1},{suffix:t(()=>[...o[39]||(o[39]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"主题内容上下间距",path:"threadListInnerMargin"},{default:t(()=>[l(e(he),{value:e(m).threadListInnerMargin,"onUpdate:value":o[20]||(o[20]=i=>e(m).threadListInnerMargin=i),max:30,min:0,step:1},{suffix:t(()=>[...o[40]||(o[40]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1}),l(e(ne),{label:"主题卡片四周空白",path:"threadListCardPadding"},{default:t(()=>[l(e(he),{value:e(m).threadListCardPadding,"onUpdate:value":o[21]||(o[21]=i=>e(m).threadListCardPadding=i),max:20,min:4,step:1},{suffix:t(()=>[...o[41]||(o[41]=[a(" px ",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])]),_:1}),l(e(Pe),{style:{"margin-top":"2px","margin-bottom":"2px"}}),l(Vt,{"post-data":p,"forum-id":0,"preview-mode":!0}),l(e(Pe),{style:{"margin-top":"2px","margin-bottom":"2px"}}),l(Jl,{"threads-list-data":v,"show-this":!0})]),_:1}))}}),_i={class:"bank-item"},hi={style:{"margin-left":"auto"}},ki={style:{"margin-left":"auto"}},Ot=10,Ci=Q({__name:"TabBank",setup(G){Te(q=>({bcc33106:e(w).dividerColor}));const c=re(),m=te();Ve(),Ct(),Ne();const w=je(),n=_(!1),p=_(),v=_(1e4),g=_(ie.tz().add(2,"day").format("YYYY-MM-DD 00:00:00")),o=_({pageSize:Ot}),i=[{title:"存入时间",key:"created_at",resizable:!0},{title:"存粮",key:"olo",resizable:!0},{title:"标签",key:"description",resizable:!0},{title:"到期时间",key:"expire_date",resizable:!0},{title:"操作",key:"controller",render:D,resizable:!0}],f=_(1),d=R(()=>(f.value-1)*Ot);function h(q){return ie().subtract(1,"day").isAfter(q)||ie().add(1,"year").isBefore(ie(q))}const T=R(()=>y.value.map(q=>q.olo).reduce((q,U)=>q+U,0));function D(q,U){return de(E,{onClick:()=>N(q.id,q.isExpired),size:"tiny",type:q.isExpired?"success":"warning",innerHTML:q.isExpired?"到期开仓":"提前开仓"})}const{loading:$,data:s,send:u}=ue(q=>Vo(q),{immediate:!1,initialData:[]});c.binggan!==null&&u({binggan:c.binggan});const y=R(()=>s.value.map(q=>({...q,isExpired:ie().isAfter(q.expire_date)}))),{loading:b,send:z,onSuccess:C}=ue(q=>Yo(q),{immediate:!1});C(()=>{c.refreshUserData(),u({binggan:c.binggan}),n.value=!1});function I(){if(v.value===null){window.$message.error("请输入要存入的olo");return}const q={title:"存入粮仓",closable:!1,content:"要往粮仓存入olo吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{const U={binggan:c.binggan,olo:v.value,description:p.value,expire_date:g.value};z(U)}};window.$dialog.success(q)}function N(q,U){function B(){const P={binggan:c.binggan,deposit_id:q,confirm_penalty:!U};Jo(P).then(()=>{c.refreshUserData(),u({binggan:c.binggan})})}if(U){const P={title:"取出到期的存粮",closable:!1,content:"要取出存粮吗？因为已经到期，不收取手续费。",positiveText:"确定",negativeText:"取消",onPositiveClick:B};window.$dialog.success(P)}else{const P={title:"提前取出存粮",closable:!1,content:"确定要提前取出存粮吗？将会扣除12%的奥利奥喔",positiveText:"确定",negativeText:"取消",onPositiveClick:B};window.$dialog.warning(P)}}return(q,U)=>(r(),k(e(x),{align:"center"},{default:t(()=>[l(e(E),{type:"primary",onClick:U[0]||(U[0]=B=>n.value=!0)},{default:t(()=>[...U[8]||(U[8]=[a("我要存粮",-1)])]),_:1}),l(e(oe),{title:"我的粮仓",size:"small"},yt({default:t(()=>[e(m).isMobile?L("",!0):(r(),k(e(wt),{key:0,columns:i,data:y.value,pagination:o.value,loading:e($),bordered:!1},null,8,["data","pagination","loading"])),e(m).isMobile?(r(),O(ee,{key:1},[y.value.length>0?(r(),k(e(x),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(y.value.slice(d.value,d.value+Ot),B=>(r(),O("div",_i,[B.description?(r(),k(e(x),{key:0,style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...U[10]||(U[10]=[a("存粮标签：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(B.description),1)]),_:2},1024)])]),_:2},1024)):L("",!0),l(e(x),{style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...U[11]||(U[11]=[a("存入时间：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(B.created_at),1)]),_:2},1024)]),S("div",hi,[l(e(M),{depth:3},{default:t(()=>[...U[12]||(U[12]=[a("存粮：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(B.olo),1)]),_:2},1024)])]),_:2},1024),l(e(x),{style:{"margin-bottom":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...U[13]||(U[13]=[a("到期时间：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(B.expire_date),1)]),_:2},1024)]),S("div",ki,[B.isExpired?L("",!0):(r(),k(e(E),{key:0,size:"tiny",type:"warning",onClick:P=>N(B.id,B.isExpired)},{default:t(()=>[...U[14]||(U[14]=[a("提前开仓",-1)])]),_:1},8,["onClick"])),B.isExpired?(r(),k(e(E),{key:1,size:"tiny",type:"success",onClick:P=>N(B.id,B.isExpired)},{default:t(()=>[...U[15]||(U[15]=[a("到期开仓",-1)])]),_:1},8,["onClick"])):L("",!0)])]),_:2},1024)]))),256)),l(e(ct),{page:f.value,"onUpdate:page":U[1]||(U[1]=B=>f.value=B),"item-count":y.value.length,"page-size":Ot,size:"small",style:{"margin-left":"auto"}},null,8,["page","item-count"])]),_:1})):(r(),k(e(Lt),{key:1}))],64)):L("",!0)]),_:2},[y.value.length>0?{name:"header-extra",fn:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...U[9]||(U[9]=[a("粮仓总计：",-1)])]),_:1}),S("span",null,j(T.value),1)])]),key:"0"}:void 0]),1024),l(e(Se),{show:n.value,"onUpdate:show":U[7]||(U[7]=B=>n.value=B),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"存粮",closable:"",onClose:U[6]||(U[6]=B=>n.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",loading:e(b),disabled:e(b),onClick:I},{default:t(()=>[...U[21]||(U[21]=[a("提交",-1)])]),_:1},8,["loading","disabled"]),l(e(E),{onClick:U[5]||(U[5]=B=>n.value=!1)},{default:t(()=>[...U[22]||(U[22]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[U[20]||(U[20]=S("div",null,[a(" 存粮没有利息、提前开仓扣12% "),S("br"),a(" （那有什么用啊！） ")],-1)),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...U[16]||(U[16]=[a("存粮标签",-1)])]),_:1}),l(e(ve),{value:p.value,"onUpdate:value":U[2]||(U[2]=B=>p.value=B),placeholder:"可选"},null,8,["value"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...U[17]||(U[17]=[a("olo总额",-1)])]),_:1}),l(e(he),{value:v.value,"onUpdate:value":U[3]||(U[3]=B=>v.value=B),max:1e6,min:10,step:1e4,parse:e(ft),format:e(pt)},null,8,["value","parse","format"])]),_:1}),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"5.2rem"}},{default:t(()=>[...U[18]||(U[18]=[a("到期日期",-1)])]),_:1}),l(e(rt),{"formatted-value":g.value,"onUpdate:formattedValue":U[4]||(U[4]=B=>g.value=B),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","is-date-disabled":h},null,8,["formatted-value"])]),_:1}),l(e(M),{depth:3},{default:t(()=>[...U[19]||(U[19]=[a("存粮时间最短1天，最长1年",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])]),_:1}))}}),xi={key:0},Si=["src"],zi=Q({__name:"TabChara",setup(G){const c=re(),m=te(),w=_(null),n=_(!1),p=_(!1),v=_(!1),g=_(),o=R(()=>JSON.stringify(s.value[i.value])),i=_(0),f=R(()=>s.value.map((C,I)=>({value:I,label:C.name}))),d=[{label:"等待",varName:"wait"},{label:"参战",varName:"against"},{label:"攻击",varName:"attack"},{label:"胜利",varName:"win"},{label:"失败",varName:"lose"}],h={name:{required:!0,message:"请输入角色名称",trigger:"blur"},...d.reduce((C,{label:I,varName:N})=>(C[`heads.${N}`]={required:!0,message:"请输入头像地址",trigger:"blur"},C),{}),...Array.from({length:10},(C,I)=>I).reduce((C,I)=>(C[`messages.${I}`]={required:!0,validator:(N,q)=>{const U=/%rand_num/;return q===null?new Error("请输入战斗语音"):U.test(q)?!0:new Error("必须包含%rand_num（上面有使用说明）")},trigger:"blur"},C),{})};function T(){if(g.value===void 0){window.$message.error("请输入角色数据");return}try{s.value[i.value]=JSON.parse(g.value)}catch{window.$message.error("输入数据的格式有误，请重新尝试");return}window.$message.success("已导入角色数据"),p.value=!1}function D(){gl(o.value),window.$message.success("已复制到剪贴板")}const{loading:$,data:s,send:u}=ue(C=>Ko(C),{immediate:!1,initialData:[]});c.binggan!==null&&u({binggan:c.binggan});const{loading:y,send:b}=ue(C=>Xo(C),{immediate:!1});function z(){w.value?.validate(C=>{if(C)window.$message.error("请确认信息填写完整");else{const I={binggan:c.binggan,chara_id:i.value,...s.value[i.value]};b(I)}})}return(C,I)=>(r(),k(e(x),{vertical:""},{default:t(()=>[l(e(oe),{title:"我的角色",size:"small"},yt({default:t(()=>[!e($)&&e(s).length>0?(r(),O(ee,{key:0},[l(e(x),{size:"small",justify:"end",align:"center"},{default:t(()=>[l(e(E),{onClick:I[1]||(I[1]=N=>p.value=!0)},{default:t(()=>[...I[18]||(I[18]=[a("导入角色",-1)])]),_:1}),l(e(E),{onClick:I[2]||(I[2]=N=>v.value=!0)},{default:t(()=>[...I[19]||(I[19]=[a("导出角色",-1)])]),_:1})]),_:1}),l(e(Xe),{ref_key:"formRef",ref:w,model:e(s)[i.value],"label-placement":"left","label-width":"auto",rules:h,size:e(m).isMobile?"small":"medium"},{default:t(()=>[l(e(kt),{cols:"1 1000:2","x-gap":12},{default:t(()=>[l(e(Fe),{style:{"max-width":"500px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...I[20]||(I[20]=[a(" 角色名 ",-1)])]),_:1})]),_:1}),l(e(ne),{label:"角色名",path:"name"},{default:t(()=>[l(e(ve),{value:e(s)[i.value].name,"onUpdate:value":I[3]||(I[3]=N=>e(s)[i.value].name=N),placeholder:"你的角色的名称"},null,8,["value"])]),_:1}),l(e(ne),{label:"暂停使用",path:"not_use"},{default:t(()=>[l(e(xe),{value:e(s)[i.value].not_use,"onUpdate:value":I[4]||(I[4]=N=>e(s)[i.value].not_use=N)},null,8,["value"]),I[21]||(I[21]=S("span",{style:{"margin-left":"6px"}},"暂停使用后，大乱斗时不显示选项",-1))]),_:1}),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem"}},{default:t(()=>[...I[22]||(I[22]=[a(" 头像组 ",-1)])]),_:1})]),_:1}),(r(),O(ee,null,me(d,(N,q)=>l(e(ne),{label:N.label,path:`heads.${N.varName}`},{default:t(()=>[l(e(ve),{value:e(s)[i.value].heads[N.varName],"onUpdate:value":U=>e(s)[i.value].heads[N.varName]=U},null,8,["value","onUpdate:value"]),S("img",{src:e(s)[i.value].heads[N.varName],style:{"max-height":"34px"}},null,8,Si)]),_:2},1032,["label","path"])),64))]),_:1}),l(e(Fe),{style:{"max-width":"500px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{depth:"3",style:{"font-size":"0.875rem",cursor:"pointer"},onClick:I[5]||(I[5]=N=>n.value=!0)},{default:t(()=>[...I[23]||(I[23]=[a(" 战斗语音（使用说明？） ",-1)])]),_:1})]),_:1}),(r(),O(ee,null,me(10,N=>l(e(ne),{label:`骰子${N*10-9}~${N*10}`,path:`messages.${N-1}`},{default:t(()=>[l(e(ve),{value:e(s)[i.value].messages[N-1],"onUpdate:value":q=>e(s)[i.value].messages[N-1]=q},null,8,["value","onUpdate:value"])]),_:2},1032,["label","path"])),64))]),_:1})]),_:1})]),_:1},8,["model","size"])],64)):L("",!0)]),_:2},[!e($)&&e(s).length>0?{name:"header-extra",fn:t(()=>[l(e(M),{depth:3,style:{"flex-shrink":"0"}},{default:t(()=>[...I[15]||(I[15]=[a(" 选择要编辑的角色 ",-1)])]),_:1}),l(e(Oe),{value:i.value,"onUpdate:value":I[0]||(I[0]=N=>i.value=N),options:f.value,"consistent-menu-width":!1},null,8,["value","options"])]),key:"0"}:void 0,!e($)&&e(s).length===0?{name:"header-extra",fn:t(()=>[l(e(M),{depth:3},{default:t(()=>[I[16]||(I[16]=a(" 你尚未拥有角色槽位，",-1)),e(m).isMobile?(r(),O("br",xi)):L("",!0),I[17]||(I[17]=a("请在“饼干升级”处购买 ",-1))]),_:1})]),key:"1"}:void 0]),1024),!e($)&&e(s).length>0?(r(),O(ee,{key:0},[l(e(x),{size:"small",justify:"end",align:"center"},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...I[24]||(I[24]=[a(" 各个角色要分别点提交喔 ",-1)])]),_:1}),l(e(E),{type:"primary",loading:e(y),disabled:e(y),onClick:z},{default:t(()=>[...I[25]||(I[25]=[a("提交当前角色",-1)])]),_:1},8,["loading","disabled"])]),_:1}),l(e(Se),{show:n.value,"onUpdate:show":I[7]||(I[7]=N=>n.value=N),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),closable:"",onClose:I[6]||(I[6]=N=>n.value=!1),size:"small",title:"战斗语音使用说明"},{default:t(()=>[...I[26]||(I[26]=[S("h4",null,"骰子语句：",-1),S("p",null,"1~10指投出1~10点时候的语句，如此类推。",-1),S("h4",null,"替换词会被自动替换为相应内容：",-1),S("p",null,[a("%rand_num —— 骰子数字（必须有） "),S("br"),a(" %name —— 本角色名字 "),S("br"),a(" %opponent —— 对手名字")],-1)])]),_:1},8,["style"])]),_:1},8,["show"]),l(e(Se),{show:p.value,"onUpdate:show":I[11]||(I[11]=N=>p.value=N),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),closable:"",onClose:I[10]||(I[10]=N=>p.value=!1),size:"small",title:"导入角色数据"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:T,type:"primary"},{default:t(()=>[...I[28]||(I[28]=[a("导入",-1)])]),_:1}),l(e(E),{onClick:I[9]||(I[9]=N=>p.value=!1)},{default:t(()=>[...I[29]||(I[29]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[I[27]||(I[27]=S("span",null,"将代码填入下述框就可以导入角色数据",-1)),l(e(bt),{value:g.value,"onUpdate:value":I[8]||(I[8]=N=>g.value=N),type:"textarea",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:8}},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]),l(e(Se),{show:v.value,"onUpdate:show":I[14]||(I[14]=N=>v.value=N),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),closable:"",onClose:I[13]||(I[13]=N=>v.value=!1),size:"small",title:"导出角色数据"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:D},{default:t(()=>[...I[31]||(I[31]=[a("复制",-1)])]),_:1}),l(e(E),{onClick:I[12]||(I[12]=N=>v.value=!1)},{default:t(()=>[...I[32]||(I[32]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[I[30]||(I[30]=S("span",null,"可以将下面代码复制下来分享给别人",-1)),l(e(bt),{value:o.value,type:"textarea",readonly:"",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:8}},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])],64)):L("",!0)]),_:1}))}}),Mi={key:0,style:{"line-height":"1.5rem"}},$i=Q({__name:"TabCustom",setup(G){const c=re(),m=te(),w=_(null),n=_({bingganApply:null,password:null,passwordRepeat:null,transferBinggan:!1}),p={bingganApply:{required:!0,validator:(f,d)=>{const h=/^[a-zA-Z0-9_]+$/;if(d===null)return new Error("请输入要定制的饼干");if(h.test(d)){if(d.length<7)return new Error("最少需要7个字符");if(d.length>16)return new Error("最多16个字符")}else return new Error("只能是数字、英文、下划线");return!0},trigger:"blur"},password:{required:!0,validator:(f,d)=>{const h=/^[a-zA-Z0-9_]+$/;if(d===null)return new Error("请输入密码");if(h.test(d)){if(d.length<7)return new Error("最少需要7个字符");if(d.length>20)return new Error("最多20个字符")}else return new Error("只能是数字、英文、下划线");return!0},trigger:"blur"},passwordRepeat:{required:!0,validator:(f,d)=>d===n.value.password,message:"密码不一致",trigger:"blur"}},{loading:v,send:g,onSuccess:o}=ue(f=>Qo(f),{immediate:!1});o(()=>{if(n.value.transferBinggan){const f={title:"将退出原有饼干",closable:!1,content:"已经魂穿，原有饼干已碎。请以重新导入新饼干。",positiveText:"确定",onPositiveClick:()=>{Nl(c.binggan).then(()=>{pl(),window.location.href="/"})}};window.$dialog.warning(f)}else c.refreshUserData(),n.value.password=null,n.value.passwordRepeat=null});function i(){w.value?.validate(f=>{if(f)window.$message.error("请确认信息填写完整");else{const d={title:"申请定制饼干",closable:!1,content:`申请的定制饼干：${n.value.bingganApply}`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{const h={binggan:c.binggan,binggan_apply:n.value.bingganApply,password:n.value.password,transfer_binggan:n.value.transferBinggan};g(h)}};window.$dialog.success(d)}})}return(f,d)=>(r(),k(e(oe),{title:"定制饼干",size:"small"},{default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...d[4]||(d[4]=[a("说明：",-1)])]),_:1}),d[5]||(d[5]=S("span",null,"可自由输入名称的定制饼干，并可选择魂穿到新饼干",-1))]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...d[6]||(d[6]=[a("价格：",-1)])]),_:1}),d[7]||(d[7]=S("span",null,"10万 olo",-1))]),l(e(Xe),{ref_key:"formRef",ref:w,model:n.value,"label-placement":"left","label-width":"auto",style:{"max-width":"400px"},rules:p,size:e(m).isMobile?"small":"medium"},{default:t(()=>[l(e(ne),{label:"定制饼干",path:"bingganApply"},{default:t(()=>[l(e(ve),{value:n.value.bingganApply,"onUpdate:value":d[0]||(d[0]=h=>n.value.bingganApply=h),placeholder:"7~16个字符(字母、数字、下划线)",maxlength:16,minlength:7},null,8,["value"])]),_:1}),l(e(ne),{label:"密码",path:"password"},{default:t(()=>[l(e(ve),{value:n.value.password,"onUpdate:value":d[1]||(d[1]=h=>n.value.password=h),placeholder:"7~20个字符(字母、数字、下划线)",type:"password",maxlength:20,minlength:7,"show-password-on":"click"},null,8,["value"])]),_:1}),l(e(ne),{label:"重复密码",path:"passwordRepeat"},{default:t(()=>[l(e(ve),{value:n.value.passwordRepeat,"onUpdate:value":d[2]||(d[2]=h=>n.value.passwordRepeat=h),placeholder:"再次输入密码",type:"password",maxlength:20,minlength:7,"show-password-on":"click",onKeyup:Ue(i,["enter"])},null,8,["value"])]),_:1}),l(e(ne),{label:"魂穿新饼干",path:"transferBinggan"},{default:t(()=>[l(e(xe),{value:n.value.transferBinggan,"onUpdate:value":d[3]||(d[3]=h=>n.value.transferBinggan=h)},null,8,["value"])]),_:1}),n.value.transferBinggan?(r(),O("div",Mi,[l(e(M),{depth:3},{default:t(()=>[...d[8]||(d[8]=[a("魂穿说明：",-1)])]),_:1}),d[10]||(d[10]=S("span",null,"将原有饼干的所有数据都转移到定制饼干",-1)),d[11]||(d[11]=S("br",null,null,-1)),d[12]||(d[12]=S("span",null,"包括：olo、粮仓、饼干等级、表情包、屏蔽词、成就和成就进度",-1)),d[13]||(d[13]=S("br",null,null,-1)),d[14]||(d[14]=S("span",null,"不包括：回帖主题等（也就是不能操作原有饼干的回帖）",-1)),d[15]||(d[15]=S("br",null,null,-1)),l(e(M),{type:"error",style:{"font-size":"1.125rem"}},{default:t(()=>[...d[9]||(d[9]=[a("现有饼干会被碎掉",-1)])]),_:1}),d[16]||(d[16]=S("br",null,null,-1))])):L("",!0)]),_:1},8,["model","size"]),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(E),{type:"primary",loading:e(v),disabled:e(v),onClick:i},{default:t(()=>[...d[17]||(d[17]=[a("提交",-1)])]),_:1},8,["loading","disabled"]),l(e(M),{depth:3},{default:t(()=>[...d[18]||(d[18]=[a("请务必保存好饼干和密码喔",-1)])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ii=["data-handler-id"],Ti=["src"],Di=Q({__name:"Emoji",props:{emojiSrc:{},index:{}},emits:["deleteEmoji","moveCard"],setup(G,{emit:c}){const m=G,w=c,n=_(),[p,v]=Bl({accept:"emojiImg",collect(T){return{handlerId:T.getHandlerId()}},hover(T,D){if(!n.value)return;const $=T.index,s=m.index;if($===s)return;const u=n.value?.getBoundingClientRect();(u.bottom-u.top)/2,D.getClientOffset().y-u.top,w("moveCard",$,s),T.index=s}}),[g,o]=Ja({type:"emojiImg",item:()=>({index:m.index}),collect:T=>({isDragging:T.isDragging()}),end:(T,D)=>{const $=D.getDropResult();T&&$?.name==="Dustbin"&&w("deleteEmoji",T.index)}}),{handlerId:i}=ul(p),{isDragging:f}=ul(g),d=R(()=>e(f)?0:1),h=T=>{n.value=o(v(T))};return(T,D)=>(r(),O("div",{ref:h,class:"emoji-box draggable",style:ae({opacity:d.value}),"data-handler-id":e(i)},[S("img",{src:T.emojiSrc,class:"emoji-in-box"},null,8,Ti)],12,Ii))}}),Pi=$e(Di,[["__scopeId","data-v-c3f2b658"]]),Li=Q({__name:"ExportEmojiModal",setup(G,{expose:c}){const m=te(),w=_(""),n=_(""),p=_(!1);function v(o,i){p.value=!0,w.value=o,n.value=i}c({show:v});function g(){gl(w.value),window.$message.success("已复制到剪贴板")}return(o,i)=>(r(),k(e(Se),{show:p.value,"onUpdate:show":i[2]||(i[2]=f=>p.value=f),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:n.value,closable:"",onClose:i[1]||(i[1]=f=>p.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:g},{default:t(()=>[...i[4]||(i[4]=[a("复制",-1)])]),_:1}),l(e(E),{onClick:i[0]||(i[0]=f=>p.value=!1)},{default:t(()=>[...i[5]||(i[5]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[l(e(M),null,{default:t(()=>[...i[3]||(i[3]=[a("可以用来复制给别人",-1)])]),_:1}),l(e(bt),{value:w.value,type:"textarea",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:8}},null,8,["value"])]),_:1})]),_:1},8,["style","title"])]),_:1},8,["show"]))}}),Ui={class:"emoji-box"},ji=["src"],Hi=Q({__name:"TabEmojis",setup(G){Te(W=>({"4e867efa":e(m).textColor1}));const c=re(),m=je(),w=_(null),n=rl.map(W=>W.id),p=_(n.filter(W=>!c.userData.emoji_excluded.includes(W))),v=R(()=>n.filter(W=>!p.value.includes(W))),g=_([]);function o(W){Array.isArray(W)?g.value=W.map((J,pe)=>({emojiSrc:J,id:pe})):g.value=[]}c.userLoginStatus===!0&&o(c.userData.my_emoji),Le(()=>c.userDataLoading,W=>{W===!1&&o(c.userData.my_emoji)});const i=(W,J)=>{const pe=g.value[W];g.value.splice(W,1),g.value.splice(J,0,pe)},[f,d]=Bl(()=>({accept:"emojiImg",drop:()=>({name:"Dustbin"}),collect:W=>({isOver:W.isOver(),canDrop:W.canDrop()})})),{canDrop:h,isOver:T}=ul(f),D=R(()=>e(h)&&e(T)),$=R(()=>e(D)?m.value.tagColor:m.value.cardColor);function s(W){g.value.splice(W,1)}const u=_(!1);function y(W){u.value===!0&&g.value.splice(W,1)}const b=_(!1),z=_(""),C=R(()=>z.value?.split(/[\n,，]+/).filter(W=>W!=""));function I(){b.value=!1;const W=C.value.map((J,pe)=>({emojiSrc:J,id:pe+g.value.length}));g.value=g.value.concat(W),z.value=""}function N(){let W=g.value.map(J=>J.emojiSrc);W=W.filter((J,pe)=>W.indexOf(J)===pe),g.value=W.map((J,pe)=>({emojiSrc:J,id:pe}))}function q(){b.value===!0&&I();const W={binggan:c.binggan,my_emoji:g.value.map(J=>J.emojiSrc),emoji_excluded:v.value};B(W)}const{loading:U,send:B,onSuccess:P}=ue(W=>Zo(W),{immediate:!1,initialData:[]});P(()=>c.refreshUserData());function A(){w.value?.show(g.value.map(W=>W.emojiSrc).join(`,
`),"我的表情包")}return(W,J)=>(r(),k(e(x),{vertical:""},{default:t(()=>[l(e(oe),{title:"官方表情包",size:"small"},{"header-extra":t(()=>[l(e(M),{depth:3,style:{"font-size":"0.875rem"}},{default:t(()=>[...J[5]||(J[5]=[a("可以关闭不想要的表情包",-1)])]),_:1})]),default:t(()=>[l(e(Xt),{value:p.value,"onUpdate:value":J[0]||(J[0]=pe=>p.value=pe)},{default:t(()=>[l(e(x),{size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(e(rl),pe=>(r(),k(e(Ke),{value:pe.id,label:pe.name},null,8,["value","label"]))),256))]),_:1})]),_:1},8,["value"])]),_:1}),l(e(oe),{title:"我的表情包",size:"small"},{"header-extra":t(()=>[l(e(x),{size:"small",align:"center",wrap:!0},{default:t(()=>[l(e(M),{depth:3,style:{"font-size":"0.875rem"}},{default:t(()=>[...J[6]||(J[6]=[a("可拖拽排序",-1)])]),_:1}),l(e(E),{onClick:N},{default:t(()=>[...J[7]||(J[7]=[a("去重",-1)])]),_:1}),b.value?L("",!0):(r(),k(e(E),{key:0,type:"primary",onClick:J[1]||(J[1]=pe=>b.value=!0)},{default:t(()=>[...J[8]||(J[8]=[a("追加",-1)])]),_:1}))]),_:1})]),default:t(()=>[l(e(x),{size:"small",style:{"margin-bottom":"6px"}},{default:t(()=>[l(e(xe),{value:u.value,"onUpdate:value":J[2]||(J[2]=pe=>u.value=pe)},null,8,["value"]),J[9]||(J[9]=S("span",null,"启用点击删除功能",-1))]),_:1}),l(e(x),{size:"small",style:{"touch-action":"none"}},{default:t(()=>[(r(!0),O(ee,null,me(g.value,(pe,Re)=>(r(),k(Pi,{key:pe.id,emojiSrc:pe.emojiSrc,index:Re,onClick:ce=>y(Re),onMoveCard:i,onDeleteEmoji:s},null,8,["emojiSrc","index","onClick"]))),128))]),_:1}),S("div",{ref:e(d),class:"emoji-trash",style:ae({backgroundColor:$.value})},[l(e(M),{depth:3},{default:t(()=>[...J[10]||(J[10]=[a("拖到这里删除",-1)])]),_:1}),l(e(ye),{size:28},{default:t(()=>[l(e(Ka))]),_:1})],4)]),_:1}),b.value?(r(),k(e(oe),{key:0,title:"待追加的表情包",size:"small",class:"dash-line"},{"header-extra":t(()=>[l(e(x),{size:"small"},{default:t(()=>[l(e(E),{type:"primary",onClick:I},{default:t(()=>[...J[11]||(J[11]=[a("追加",-1)])]),_:1}),l(e(E),{type:"default",onClick:J[3]||(J[3]=pe=>{b.value=!1,z.value=""})},{default:t(()=>[...J[12]||(J[12]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(C.value,(pe,Re,ce)=>(r(),O("div",Ui,[S("img",{src:pe,class:"emoji-in-box"},null,8,ji)]))),256))]),_:1}),l(e(bt),{type:"textarea",value:z.value,"onUpdate:value":J[4]||(J[4]=pe=>z.value=pe),placeholder:"在这里贴网址追加表情包。可以一次多个，每行一个。",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})):L("",!0),l(e(x),{align:"center",justify:"end"},{default:t(()=>[l(e(M),{depth:3,style:{"font-size":"0.875rem"}},{default:t(()=>[...J[13]||(J[13]=[a("上面所有变更都要提交后才生效喔",-1)])]),_:1}),l(e(E),{onClick:A},{default:t(()=>[...J[14]||(J[14]=[a("导出",-1)])]),_:1}),l(e(E),{onClick:q,type:"primary",loading:e(U),disabled:e(U)},{default:t(()=>[...J[15]||(J[15]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1}),l(Li,{ref_key:"ExportEmojiModalCom",ref:w},null,512)]),_:1}))}}),Ai=$e(Hi,[["__scopeId","data-v-7a5725ef"]]),Ri={class:"income-item"},Bi={style:{"margin-left":"auto"}},Oi={key:0,style:{"margin-top":"6px"}},Et=30,Ei=Q({__name:"TabIncome",setup(G){Te(P=>({f2e6aaa0:e(m).dividerColor})),re();const c=te();Ve(),Ct(),Ne();const m=je(),w=_([ie.tz().valueOf(),ie.tz().valueOf()]),n=_({pageSize:Et}),p=[{title:"时间",key:"created_at",resizable:!0},{title:"收支",key:"olo",resizable:!0},{title:"内容",key:"content",resizable:!0},{title:"主题",key:"thread",render:B,ellipsis:!0,resizable:!0}],v=R(()=>z.value?[{label:"加载中...",key:"loading"}]:[{label:"当月统计："+C.value.sum_month,key:"monthSum"},{label:"全年统计："+C.value.sum_year,key:"yearSum"}]),g=["default_in","default_out","battle_in","battle_out","hongbao_in","hongbao_out","reward_out","reward_in","gamble_out","gamble_in","bank_in","bank_out","post","penalty"],o=[{label:"全部",value:"all"}],i=[{label:"回帖",value:"post"},{label:"乱斗",value:"battle_in"},{label:"红包",value:"hongbao_in"},{label:"打赏",value:"reward_in"},{label:"菠菜",value:"gamble_in"},{label:"粮仓",value:"bank_in"},{label:"其他",value:"default_in"}],f=[{label:"乱斗",value:"battle_out"},{label:"红包",value:"hongbao_out"},{label:"打赏",value:"reward_out"},{label:"菠菜",value:"gamble_out"},{label:"粮仓",value:"bank_out"},{label:"罚款",value:"penalty"},{label:"其他",value:"default_out"}],d=_(["all"]);function h(P){return de(Xt,{value:d.value,"onUpdate:value":A=>{const W=A.filter(pe=>!d.value.includes(pe)),J=d.value.filter(pe=>!A.includes(pe));W.includes("all")?d.value=["all"]:J.includes("all")?d.value=g:W.length!==0&&!W.includes("all")?d.value=A.filter(pe=>pe!=="all"):J.length!==0&&A.length===0?d.value=["all"]:d.value=A}},()=>[de(x,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(P).map(A=>de(Qe,{value:A.value,label:A.label}))])])}const T=[{key:"filterOptions",type:"render",render:()=>h(o)},{label:"📈收入",key:"in",children:[{key:"filterOptionsIn",type:"render",render:()=>h(i)}]},{label:"📉支出",key:"out",children:[{key:"filterOptionsOut",type:"render",render:()=>h(f)}]}];function D(P){return ie().add(1,"day").isBefore(P)||ie(16409664e5).isAfter(P)}const $=_(1),s=R(()=>($.value-1)*Et),{loading:u,data:y,send:b}=ue(P=>en(P),{immediate:!1,initialData:[]}),{loading:z,data:C,send:I}=ue(P=>tn(P),{immediate:!1,initialData:{sum_year:0,sum_month:0}}),N=R(()=>y.value.map(P=>P.olo).reduce((P,A)=>P+A,0));Le([w,d],()=>q("day")),Ze(()=>q("day"));function q(P){if(w.value===null)window.$message.error("需要选择日期");else{const A={start_ts:w.value[0],end_ts:w.value[1],type:d.value.includes("all")?null:d.value};P==="day"&&b(A),P==="sum"&&I(A)}}function U(P){return{name:"thread",params:{threadId:P.thread_id,page:P.floor===null?1:Math.ceil((P.floor+1)/200)},hash:P.floor===null?void 0:"#f_"+P.floor}}function B(P,A){return P.thread_id!==null?de(_t,{to:U(P),target:"_blank",innerHTML:P.thread_title}):""}return(P,A)=>(r(),k(e(x),{size:"small"},{default:t(()=>[l(e(rt),{value:w.value,"onUpdate:value":A[0]||(A[0]=W=>w.value=W),type:"daterange","update-value-on-close":"",size:e(c).isMobile?"small":"medium","is-date-disabled":D,style:{"max-width":"300px"}},null,8,["value","size"]),l(e(qe),{trigger:e(c).isMobile?"click":"hover",options:T,placement:"bottom-start"},{default:t(()=>[l(e(E),null,{default:t(()=>[...A[4]||(A[4]=[a("筛选",-1)])]),_:1})]),_:1},8,["trigger"]),l(e(E),{type:"primary",onClick:A[1]||(A[1]=W=>q("day")),loading:e(u)},{default:t(()=>[...A[5]||(A[5]=[a(" 查询 ",-1)])]),_:1},8,["loading"]),l(e(oe),{title:"收支记录",size:"small"},{"header-extra":t(()=>[l(e(x),{size:"small",align:"center"},{default:t(()=>[a(" 区间小计："+j(N.value)+" ",1),l(e(qe),{trigger:"click",placement:"bottom-end",options:v.value},{default:t(()=>[l(e(E),{size:"small",onClick:A[2]||(A[2]=W=>q("sum"))},{default:t(()=>[...A[6]||(A[6]=[a("月年总计",-1)])]),_:1})]),_:1},8,["options"])]),_:1})]),default:t(()=>[e(c).isMobile?L("",!0):(r(),k(e(wt),{key:0,columns:p,data:e(y),pagination:n.value,bordered:!1,loading:e(u)},null,8,["data","pagination","loading"])),e(c).isMobile?(r(),O(ee,{key:1},[e(y).length>0?(r(),k(e(x),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(e(y).slice(s.value,s.value+Et),W=>(r(),O("div",Ri,[l(e(x),null,{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...A[7]||(A[7]=[a("时间：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(W.created_at),1)]),_:2},1024)]),S("div",Bi,[l(e(M),{depth:3},{default:t(()=>[...A[8]||(A[8]=[a("收支：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(W.olo),1)]),_:2},1024)])]),_:2},1024),l(e(x),{style:{"margin-top":"6px"}},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...A[9]||(A[9]=[a("内容：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(W.content),1)]),_:2},1024)])]),_:2},1024),W.thread_id!==null?(r(),O("div",Oi,[l(e(M),{depth:3},{default:t(()=>[...A[10]||(A[10]=[a("主题：",-1)])]),_:1}),l(e(_t),{to:U(W)},{default:t(()=>[a(j(W.thread_title),1)]),_:2},1032,["to"])])):L("",!0)]))),256)),l(e(ct),{page:$.value,"onUpdate:page":A[3]||(A[3]=W=>$.value=W),"item-count":e(y).length,"page-size":Et,size:"small",style:{"margin-left":"auto"}},null,8,["page","item-count"])]),_:1})):(r(),k(e(Lt),{key:1}))],64)):L("",!0)]),_:1})]),_:1}))}}),Ni=$e(Ei,[["__scopeId","data-v-bd174d32"]]),Fi={key:0},qi={key:0,style:{"margin-left":"auto"}},Wi={key:1,style:{"margin-left":"auto"}},Gi=Q({__name:"TabLevelup",setup(G){const c=re(),m=te(),w=_(!1),n=_(!1),p={title_pingbici:{name:"标题屏蔽词",min:1e3,max:4e3,intervel:200,olo:4e3},content_pingbici:{name:"内容屏蔽词",min:1e3,max:4e3,intervel:200,olo:4e3},fjf_pingbici:{name:"FJF黑名单",min:1e3,max:4e3,intervel:200,olo:4e3},my_emoji:{name:"我的表情包",min:5e3,max:3e4,intervel:1e3,olo:2e4},my_battle_chara:{name:"大乱斗角色",min:0,max:3,intervel:1,olo:5e4}},v=[{title:"项目",key:"name",resizable:!0},{title:"目前容量",key:"value",resizable:!0},{title:"操作",key:"controller",render:o,resizable:!0}],g=R(()=>[{name:"标题屏蔽词",value:d.value.title_pingbici,mode:"title_pingbici"},{name:"内容屏蔽词",value:d.value.content_pingbici,mode:"content_pingbici"},{name:"FJF黑名单",value:d.value.fjf_pingbici,mode:"fjf_pingbici"},{name:"我的表情包",value:d.value.my_emoji,mode:"my_emoji"},{name:"大乱斗角色",value:d.value.my_battle_chara,mode:"my_battle_chara"}]);function o(b){return de(E,{onClick:()=>D(b.mode),size:"tiny",type:"success",innerHTML:"升级"})}const i={title_pingbici:0,content_pingbici:0,fjf_pingbici:0,my_emoji:0,my_battle_chara:0},{loading:f,data:d,send:h}=ue(b=>ln(b),{immediate:!1,initialData:i});c.binggan!==null&&h({binggan:c.binggan});const T=_("title_pingbici");function D(b){T.value=b,n.value=!0}const{loading:$,send:s,onSuccess:u}=ue(b=>an(b),{immediate:!1});u(()=>{c.refreshUserData(),h({binggan:c.binggan}),n.value=!1});function y(b){const z={binggan:c.binggan,mode:b};s(z)}return(b,z)=>(r(),k(e(x),{vertical:""},{default:t(()=>[l(e(oe),{title:"升级饼干",size:"small"},{"header-extra":t(()=>[l(e(M),{depth:3},{default:t(()=>[z[8]||(z[8]=a(" 说明：可支付olo升级饼干，",-1)),e(m).isMobile?(r(),O("br",Fi)):L("",!0),z[9]||(z[9]=a("增加屏蔽词、表情包等的容量。 ",-1))]),_:1})]),default:t(()=>[l(e(wt),{columns:v,data:g.value,bordered:!1,loading:e(f)},null,8,["data","loading"])]),_:1}),l(e(x),{size:"small"},{default:t(()=>[l(e(E),{onClick:z[0]||(z[0]=C=>w.value=!0)},{default:t(()=>[...z[10]||(z[10]=[a("查看价格表",-1)])]),_:1})]),_:1}),l(e(Se),{show:w.value,"onUpdate:show":z[3]||(z[3]=C=>w.value=C),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"升级饼干价目表",closable:"",onClose:z[2]||(z[2]=C=>w.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{onClick:z[1]||(z[1]=C=>w.value=!1)},{default:t(()=>[...z[11]||(z[11]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[z[12]||(z[12]=S("img",{src:"https://wmimg.com/i/1547/2025/02/67adf151e06c9.png",style:{"max-width":"100%"}},null,-1))]),_:1},8,["style"])]),_:1},8,["show"]),l(e(Se),{show:n.value,"onUpdate:show":z[7]||(z[7]=C=>n.value=C),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),title:"升级饼干",closable:"",onClose:z[6]||(z[6]=C=>n.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",disabled:e(d)[T.value]>=p[T.value].max||e($),loading:e($),onClick:z[4]||(z[4]=C=>y(T.value))},{default:t(()=>[...z[17]||(z[17]=[a("升级！",-1)])]),_:1},8,["disabled","loading"]),l(e(E),{onClick:z[5]||(z[5]=C=>n.value=!1)},{default:t(()=>[...z[18]||(z[18]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:"",size:"small"},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...z[13]||(z[13]=[a("项目：",-1)])]),_:1}),S("span",null,j(p[T.value].name),1)]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...z[14]||(z[14]=[a("升级容量：",-1)])]),_:1}),S("span",null," +"+j(p[T.value].intervel)+" "+j(T.value==="my_battle_chara"?"角色槽":"字符"),1)]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...z[15]||(z[15]=[a("最大容量：",-1)])]),_:1}),S("span",null,j(p[T.value].max)+" "+j(T.value==="my_battle_chara"?"角色槽":"字符"),1)]),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...z[16]||(z[16]=[a("本次消费：",-1)])]),_:1}),l(e(M),{type:"warning"},{default:t(()=>[a(j(p[T.value].olo)+" 个olo",1)]),_:1})]),e(d)[T.value]>=p[T.value].max?(r(),O("span",qi,"嗷，这个项目已经塞满了！无法继续升级。")):(r(),O("span",Wi,"确定要升级这个项目吗？"))]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])]),_:1}))}}),Vi=["src"],Yi=["src"],Ji=["src"],Ki=["src"],Xi=["src"],Qi=Q({__name:"TabMedal",setup(G){Te(s=>({"0adc9ec8":e(v)}));const c=re(),m=te(),w=_(!1),n=_(),p=_(!1),v=m.isMobile?"0.70rem":"0.875rem",g=R(()=>{if(!d.value)return[];const s=[];for(const u in nl){const y=d.value.includes(Number(u));(p.value||y)&&s.push({...nl[u],id:Number(u),hasMedal:y,img:y?nl[u].img:"https://wmimg.com/i/1547/2025/02/67adf16c41bd5.png"})}return s}),o=R(()=>{if(!d.value)return[];const s=[];for(const u in Tl){const y=d.value.includes(Number(u));y&&s.push({...Tl[u],id:Number(u),hasMedal:y})}return s});function i(s){n.value=s,w.value=!0;const u={binggan:c.binggan,medal_id:s.id};$(u)}const{loading:f,data:d,send:h}=ue(s=>on(s),{immediate:!1,initialData:[]});c.binggan!==null&&h({binggan:c.binggan});const{loading:T,data:D,send:$}=ue(s=>nn(s),{immediate:!1});return(s,u)=>(r(),k(e(x),{vertical:""},{default:t(()=>[l(e(Ge),{show:e(f)},{default:t(()=>[l(e(oe),{title:"成就徽章",size:"small"},{"header-extra":t(()=>[l(e(xe),{value:p.value,"onUpdate:value":u[0]||(u[0]=y=>p.value=y)},null,8,["value"]),l(e(M),{style:{"margin-left":"6px"}},{default:t(()=>[...u[3]||(u[3]=[a("显示未获得的成就 ",-1)])]),_:1})]),default:t(()=>[!e(m).isMobile&&o.value.length>0?(r(),k(e(x),{key:0,size:[4,0]},{default:t(()=>[(r(!0),O(ee,null,me(o.value,y=>(r(),k(e(x),{vertical:"",align:"center",class:"medal-box",onClick:b=>i(y)},{default:t(()=>[S("img",{src:y.img,class:"medal-img"},null,8,Vi),l(e(M),{class:"medal-text"},{default:t(()=>[a(j(y.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),256))]),_:1})):L("",!0),e(m).isMobile&&o.value.length>0?(r(),k(e(kt),{key:1,"x-gap":"4",cols:5},{default:t(()=>[(r(!0),O(ee,null,me(o.value,y=>(r(),k(e(Fe),{align:"center",class:"medal-box-mobile",onClick:b=>i(y)},{default:t(()=>[S("img",{src:y.img,class:"medal-img-mobile"},null,8,Yi),l(e(M),{class:"medal-text"},{default:t(()=>[a(j(y.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),256))]),_:1})):L("",!0),e(m).isMobile?L("",!0):(r(),k(e(x),{key:2,size:[4,0]},{default:t(()=>[(r(!0),O(ee,null,me(g.value,y=>(r(),k(e(x),{vertical:"",align:"center",class:"medal-box",onClick:b=>i(y)},{default:t(()=>[S("img",{src:y.img,class:"medal-img"},null,8,Ji),l(e(M),{class:"medal-text"},{default:t(()=>[a(j(y.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),256))]),_:1})),e(m).isMobile?(r(),k(e(kt),{key:3,"x-gap":"4",cols:5},{default:t(()=>[(r(!0),O(ee,null,me(g.value,y=>(r(),k(e(Fe),{align:"center",class:"medal-box-mobile",onClick:b=>i(y)},{default:t(()=>[S("img",{src:y.img,class:"medal-img-mobile"},null,8,Ki),l(e(M),{class:"medal-text"},{default:t(()=>[a(j(y.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),256))]),_:1})):L("",!0)]),_:1})]),_:1},8,["show"]),l(e(Se),{show:w.value,"onUpdate:show":u[2]||(u[2]=y=>w.value=y),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(m).modalMaxWidth}),closable:"",onClose:u[1]||(u[1]=y=>w.value=!1),size:"small"},{default:t(()=>[l(e(x),{vertical:"",align:"center",class:"medal-box-modal"},{default:t(()=>[S("img",{src:n.value?.img,style:{"max-width":"100%"}},null,8,Xi),l(e(M),{style:{"font-size":"1rem"}},{default:t(()=>[a(j(n.value?.name),1)]),_:1}),l(e(M),{style:{"font-size":"1rem"}},{default:t(()=>[a(j(n.value?.describe),1)]),_:1}),l(e(Ge),{show:e(T)},{default:t(()=>[e(D)!==void 0||!e(T)?(r(),O(ee,{key:0},[e(D).medal_created_at!==null?(r(),k(e(M),{key:0,style:{"font-size":"1rem"}},{default:t(()=>[a(j(e(D).medal_created_at),1)]),_:1})):L("",!0),e(D).medal_created_at===null&&e(D).progress!==null?(r(),k(e(M),{key:1,style:{"font-size":"1rem"}},{default:t(()=>[a(j(e(D).progress)+" / "+j(e(D).threshold),1)]),_:1})):L("",!0)],64)):L("",!0)]),_:1},8,["show"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])]),_:1}))}}),Zi=Q({__name:"TabPassword",setup(G){const c=re(),m=te(),w=_(null),n=_({passwordOld:null,passwordNew:null,passwordRepeat:null}),p={passwordOld:{required:!1},passwordNew:{required:!0,validator:(f,d)=>{const h=/^[a-zA-Z0-9_]+$/;if(d===null)return new Error("请输入密码");if(h.test(d)){if(d.length<7)return new Error("最少需要7个字符");if(d.length>20)return new Error("最多20个字符")}else return new Error("只能是数字、英文、下划线");return!0},trigger:"blur"},passwordRepeat:{required:!0,validator:(f,d)=>d===n.value.passwordNew,message:"密码不一致",trigger:"blur"}},{loading:v,send:g,onSuccess:o}=ue(f=>sn(f),{immediate:!1});o(()=>{n.value.passwordOld=null,n.value.passwordNew=null,n.value.passwordRepeat=null});function i(){w.value?.validate(f=>{if(f)window.$message.error("请确认信息填写完整");else{const d={binggan:c.binggan,old_password:n.value.passwordOld,new_password:n.value.passwordNew};g(d)}})}return(f,d)=>(r(),k(e(oe),{title:"密码设定",size:"small"},{default:t(()=>[l(e(x),{vertical:""},{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...d[3]||(d[3]=[a("说明：",-1)])]),_:1}),d[4]||(d[4]=S("span",null,"新饼干无密码。建议尽快设定密码，以免饼干遗失。",-1))]),l(e(Xe),{ref_key:"formRef",ref:w,model:n.value,"label-placement":"left","label-width":"auto",style:{"max-width":"400px"},rules:p,size:e(m).isMobile?"small":"medium"},{default:t(()=>[l(e(ne),{label:"旧密码",path:"passwordOld"},{default:t(()=>[l(e(ve),{value:n.value.passwordOld,"onUpdate:value":d[0]||(d[0]=h=>n.value.passwordOld=h),placeholder:"(选填)如果未设定密码可以留空",type:"password",maxlength:20,minlength:7,"show-password-on":"click"},null,8,["value"])]),_:1}),l(e(ne),{label:"密码",path:"passwordNew"},{default:t(()=>[l(e(ve),{value:n.value.passwordNew,"onUpdate:value":d[1]||(d[1]=h=>n.value.passwordNew=h),placeholder:"7~20个字符(字母、数字、下划线)",type:"password",maxlength:20,minlength:7,"show-password-on":"click"},null,8,["value"])]),_:1}),l(e(ne),{label:"重复密码",path:"passwordRepeat"},{default:t(()=>[l(e(ve),{value:n.value.passwordRepeat,"onUpdate:value":d[2]||(d[2]=h=>n.value.passwordRepeat=h),placeholder:"再次输入密码",type:"password",maxlength:20,minlength:7,"show-password-on":"click",onKeyup:Ue(i,["enter"])},null,8,["value"])]),_:1})]),_:1},8,["model","size"]),l(e(x),{size:"small",align:"center"},{default:t(()=>[l(e(E),{type:"primary",loading:e(v),disabled:e(v),onClick:i},{default:t(()=>[...d[5]||(d[5]=[a("提交",-1)])]),_:1},8,["loading","disabled"]),l(e(M),{depth:3},{default:t(()=>[...d[6]||(d[6]=[a("请务必保存好新密码喔",-1)])]),_:1})]),_:1})]),_:1})]),_:1}))}}),eu=Q({__name:"TabPingbici",setup(G){const c=re(),m=te();_(null);const w=_({content_pingbici:[],title_pingbici:[],fjf_pingbici:[]}),n=_(c.userData.binggan.use_pingbici);c.userLoginStatus===!0&&(w.value=c.userData.pingbici,n.value=c.userData.binggan.use_pingbici),Le(()=>c.userDataLoading,f=>{f===!1&&(w.value=c.userData.pingbici,n.value=c.userData.binggan.use_pingbici)});function p(f){w.value[f]=w.value[f].filter((d,h)=>w.value[f].indexOf(d)===h)}function v(){const f={binggan:c.binggan,use_pingbici:n.value,...w.value};o(f)}const{loading:g,send:o,onSuccess:i}=ue(f=>un(f),{immediate:!1,initialData:[]});return i(()=>c.refreshUserData()),(f,d)=>(r(),k(e(x),{vertical:""},{default:t(()=>[l(e(oe),{title:"标题屏蔽词",size:"small"},{"header-extra":t(()=>[l(e(E),{onClick:d[1]||(d[1]=h=>p("title_pingbici"))},{default:t(()=>[...d[9]||(d[9]=[a("去重",-1)])]),_:1})]),default:t(()=>[l(e(ol),{value:w.value.title_pingbici,"onUpdate:value":d[0]||(d[0]=h=>w.value.title_pingbici=h),"input-props":{maxlength:20}},null,8,["value"])]),_:1}),l(e(oe),{title:"内容屏蔽词",size:"small"},{"header-extra":t(()=>[l(e(E),{onClick:d[3]||(d[3]=h=>p("content_pingbici"))},{default:t(()=>[...d[10]||(d[10]=[a("去重",-1)])]),_:1})]),default:t(()=>[l(e(ol),{value:w.value.content_pingbici,"onUpdate:value":d[2]||(d[2]=h=>w.value.content_pingbici=h),"input-props":{maxlength:20}},null,8,["value"])]),_:1}),l(e(oe),{title:"FJF小尾巴和固马屏蔽词",size:"small"},{"header-extra":t(()=>[l(e(E),{onClick:d[5]||(d[5]=h=>p("fjf_pingbici"))},{default:t(()=>[...d[12]||(d[12]=[a("去重",-1)])]),_:1})]),default:t(()=>[l(e(ol),{value:w.value.fjf_pingbici,"onUpdate:value":d[4]||(d[4]=h=>w.value.fjf_pingbici=h),"input-props":{maxlength:10}},null,8,["value"]),l(e(M),{depth:3,style:{"font-size":"0.875rem"}},{default:t(()=>[...d[11]||(d[11]=[a("注意：同一个饼干在不同FJF主题中，小尾巴会改变",-1)])]),_:1})]),_:1}),l(e(x),{align:"center",justify:"start"},{default:t(()=>[l(e(Ee),{trigger:"hover"},{trigger:t(()=>[S("div",null,[l(e(xe),{value:e(m).userCustom.hidePingbiciFloor,"onUpdate:value":d[6]||(d[6]=h=>e(m).userCustom.hidePingbiciFloor=h)},null,8,["value"]),l(e(M),{style:{"margin-left":"6px"}},{default:t(()=>[...d[13]||(d[13]=[a("完全隐藏楼层 ",-1)])]),_:1})])]),default:t(()=>[d[14]||(d[14]=S("span",null,"这个保存在本地，不用点提交",-1))]),_:1}),l(e(Ee),{trigger:"hover"},{trigger:t(()=>[S("div",null,[l(e(xe),{value:e(m).userCustom.pingbiciIngnoreCase,"onUpdate:value":d[7]||(d[7]=h=>e(m).userCustom.pingbiciIngnoreCase=h)},null,8,["value"]),l(e(M),{style:{"margin-left":"6px"}},{default:t(()=>[...d[15]||(d[15]=[a("忽略大小写 ",-1)])]),_:1})])]),default:t(()=>[d[16]||(d[16]=S("span",null,"这个保存在本地，不用点提交",-1))]),_:1})]),_:1}),l(e(x),{align:"center",justify:"end"},{default:t(()=>[l(e(Ee),{trigger:"hover"},{trigger:t(()=>[S("div",null,[l(e(xe),{value:n.value,"onUpdate:value":d[8]||(d[8]=h=>n.value=h)},null,8,["value"]),l(e(M),{style:{"margin-left":"6px"}},{default:t(()=>[...d[17]||(d[17]=[a("启用 ",-1)])]),_:1})])]),default:t(()=>[d[18]||(d[18]=S("span",null,"关闭屏蔽词功能，可以提升一点性能",-1))]),_:1}),l(e(E),{type:"primary",onClick:v,loading:e(g),disabled:e(g)},{default:t(()=>[...d[19]||(d[19]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1}))}}),tu={style:{display:"flex","align-items":"center",gap:"4px"}},lu=Q({__name:"UserCard",setup(G){const c=re(),m=te(),w=_(!0);function n(){gl(c.binggan),window.$message.success("已将饼干复制到粘贴板，请保存好喔！")}return c.refreshUserData(),(p,v)=>(r(),k(e(oe),{hoverable:"",size:"small"},{default:t(()=>[l(e(x),{justify:"space-around",vertical:e(m).isMobile,size:e(m).isMobile?"small":"medium"},{default:t(()=>[l(e(x),{vertical:!e(m).isMobile,align:"start"},{default:t(()=>[v[2]||(v[2]=S("img",{src:"/ui/my-binggan.png",style:{"max-height":"40px"}},null,-1)),S("div",null,[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...v[1]||(v[1]=[a("我的饼干",-1)])]),_:1})]),S("div",tu,[l(e(M),{depth:2,style:ae({fontSize:e(m).isMobile?"0.875rem":"1rem",cursor:w.value?"pointer":"auto"}),onClick:v[0]||(v[0]=g=>w.value=!1)},{default:t(()=>[a(j(w.value?"*点击显示*":e(c).binggan),1)]),_:1},8,["style"]),l(e(ye),{size:e(m).isMobile?18:20},{default:t(()=>[l(e(Xa),{style:{cursor:"pointer"},onClick:n})]),_:1},8,["size"])])])]),_:1},8,["vertical"]),l(e(x),{vertical:!e(m).isMobile,align:"start"},{default:t(()=>[v[4]||(v[4]=S("img",{src:"/ui/binggan-level.png",style:{"max-height":"40px"}},null,-1)),S("div",null,[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...v[3]||(v[3]=[a("饼干等级",-1)])]),_:1})]),S("div",null,[l(e(M),{depth:2,style:ae({fontSize:e(m).isMobile?"0.875rem":"1rem"})},{default:t(()=>[a(j(e(c).userData?.binggan.user_lv),1)]),_:1},8,["style"])])])]),_:1},8,["vertical"]),l(e(x),{vertical:!e(m).isMobile,align:"start"},{default:t(()=>[v[6]||(v[6]=S("img",{src:"/ui/my-olo.png",style:{"max-height":"40px"}},null,-1)),S("div",null,[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...v[5]||(v[5]=[a("奥利奥",-1)])]),_:1})]),S("div",null,[l(e(M),{depth:2,style:ae({fontSize:e(m).isMobile?"0.875rem":"1rem"})},{default:t(()=>[l(e(Sl),{from:0,to:e(c).userData?.binggan.coin,"show-separator":"",duration:2e3},null,8,["to"])]),_:1},8,["style"])])])]),_:1},8,["vertical"]),l(e(x),{vertical:!e(m).isMobile,align:"start"},{default:t(()=>[v[8]||(v[8]=S("img",{src:"/ui/bank-olo.png",style:{"max-height":"40px"}},null,-1)),S("div",null,[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...v[7]||(v[7]=[a("粮仓奥利奥",-1)])]),_:1})]),S("div",null,[l(e(M),{depth:2,style:ae({fontSize:e(m).isMobile?"0.875rem":"1rem"})},{default:t(()=>[l(e(Sl),{from:0,to:e(c).userData?.binggan.coin_in_bank,"show-separator":"",duration:2e3},null,8,["to"])]),_:1},8,["style"])])])]),_:1},8,["vertical"])]),_:1},8,["vertical","size"])]),_:1}))}}),au=Q({__name:"UserCenter",setup(G){re();const c=te();Ve(),Ct(),Ne(),je();const m=_();document.title="个人中心";const w=[{name:"medals",tab:"我的成就",component:Qi},{name:"common",tab:"一般设定",component:wi},{name:"pingbici",tab:"屏蔽词",component:eu},{name:"emojis",tab:"表情包",component:Ai},{name:"chara",tab:"我的角色",component:zi},{name:"bank",tab:"我的粮仓",component:Ci},{name:"income",tab:"收支记录",component:Ni},{name:"levelup",tab:"升级饼干",component:Gi},{name:"customBinggan",tab:"定制饼干",component:$i},{name:"password",tab:"密码设定",component:Zi}];return(n,p)=>(r(),k(e(x),{vertical:"",style:{"margin-top":"8px"}},{default:t(()=>[l(e(Qa),{backend:e(c).isMobile?e(Za):e(eo)},{default:t(()=>[l(e(lu)),l(e(Pt),{type:"line","bar-width":e(c).isMobile?0:void 0,animated:"",size:e(c).isMobile?"small":"large",value:m.value,"onUpdate:value":p[0]||(p[0]=v=>m.value=v)},{default:t(()=>[(r(),O(ee,null,me(w,v=>l(e(Je),{name:v.name,tab:v.tab,key:v.name},{default:t(()=>[(r(),k(ut(v.component)))]),_:2},1032,["name","tab"])),64))]),_:1},8,["bar-width","size","value"])]),_:1},8,["backend"]),p[1]||(p[1]=S("div",{style:{height:"50px"}},null,-1))]),_:1}))}}),er=Object.freeze(Object.defineProperty({__proto__:null,default:au},Symbol.toStringTag,{value:"Module"})),ou={class:"banner-box-sm"},nu=["src"],su=["src","onClick"],iu=Q({__name:"TabBanners",setup(G){Te(s=>({"6a1c8eac":e(w).textColor1}));const c=re();te();const m=Ve(),w=je(),n=_(0);Ze(()=>{p.value.length>0&&(n.value=p.value[0].value)});const p=R(()=>c.binggan===null||c.userData.binggan.admin_forums===void 0?[]:m.forumsData.reduce((s,u)=>(c.checkAdminForums(u.id)&&s.push({value:u.id,label:u.name,forumId:u.id}),s),[])),v=_([]);Le(n,s=>{s===void 0?v.value=[]:v.value=[...m.forumData(s)?.banners??[]]});const g=_(!1),o=_(),i=R(()=>o.value?.split(/[\n,，]+/).filter(s=>s!="")??[]);function f(){g.value=!1,v.value=v.value.concat(i.value),o.value=void 0,$()}function d(s){v.value?.splice(s,1)}const{loading:h,send:T,onSuccess:D}=ue(s=>rn(s),{immediate:!1});D(()=>{m.getForumsData()});function $(){const s={binggan:c.binggan,forum_id:n.value,banners:v.value};T(s)}return(s,u)=>(r(),k(e(x),{vertical:""},{default:t(()=>[g.value?(r(),k(e(oe),{key:0,title:"待追加的版头",size:"small",class:"dash-line"},{"header-extra":t(()=>[l(e(x),{size:"small"},{default:t(()=>[l(e(E),{type:"primary",onClick:f},{default:t(()=>[...u[4]||(u[4]=[a("追加",-1)])]),_:1}),l(e(E),{type:"default",onClick:u[0]||(u[0]=y=>{g.value=!1,o.value=void 0})},{default:t(()=>[...u[5]||(u[5]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{size:"small"},{default:t(()=>[(r(!0),O(ee,null,me(i.value,(y,b,z)=>(r(),O("div",ou,[S("img",{src:y,style:{width:"100%"}},null,8,nu)]))),256))]),_:1}),l(e(bt),{type:"textarea",value:o.value,"onUpdate:value":u[1]||(u[1]=y=>o.value=y),placeholder:"在这里贴网址追加版头。可以一次多个，每行一个。",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})):L("",!0),l(e(oe),{title:"版头设定",size:"small"},{"header-extra":t(()=>[l(e(x),{size:"small",align:"center",wrap:!0},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...u[6]||(u[6]=[a("选择小岛",-1)])]),_:1}),l(e(Oe),{value:n.value,"onUpdate:value":u[2]||(u[2]=y=>n.value=y),options:p.value,"consistent-menu-width":!1,style:{width:"100px"}},null,8,["value","options"]),g.value?L("",!0):(r(),k(e(E),{key:0,type:"primary",onClick:u[3]||(u[3]=y=>g.value=!0)},{default:t(()=>[...u[7]||(u[7]=[a("追加",-1)])]),_:1}))]),_:1})]),default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...u[8]||(u[8]=[a("点击图片移除",-1)])]),_:1}),l(e(x),{wrap:!0,size:[4,4]},{default:t(()=>[(r(!0),O(ee,null,me(v.value,(y,b)=>(r(),O("div",{key:b+(n.value??0)*1e3,class:"banner-box"},[S("img",{src:y,class:"banner-img",onClick:z=>d(b)},null,8,su)]))),128))]),_:1})]),_:1}),l(e(x),{align:"center",justify:"end"},{default:t(()=>[l(e(M),{depth:3,style:{"font-size":"0.875rem"}},{default:t(()=>[...u[9]||(u[9]=[a("各个小岛的变更要分别提交喔",-1)])]),_:1}),l(e(E),{type:"primary",loading:e(h),disable:e(h),onClick:$},{default:t(()=>[...u[10]||(u[10]=[a("提交",-1)])]),_:1},8,["loading","disable"])]),_:1})]),_:1}))}}),uu=$e(iu,[["__scopeId","data-v-35893c7d"]]),ru=Q({__name:"TabGlobal",setup(G){Te(o=>({"21c7f12a":e(m).textColor1}));const c=re();te(),Ve();const m=je(),w=_(!1),n=_(!1),p=_(!1),v=_(!1);c.admin.isSuperAdmin===!0&&dn().then(o=>{w.value=o.new_binggan,n.value=o.new_loudspeaker,p.value=o.new_binggan_force,v.value=!0});function g(o,i){const f={binggan:c.binggan,key:o,value:JSON.stringify(i)};mn(f).then()}return(o,i)=>(r(),k(e(x),{vertical:"",size:[6,12]},{default:t(()=>[l(e(x),{size:"small"},{default:t(()=>[l(e(M),{style:{width:"6.2rem"}},{default:t(()=>[...i[6]||(i[6]=[a("领取饼干开关",-1)])]),_:1}),l(e(xe),{value:w.value,"onUpdate:value":i[0]||(i[0]=f=>w.value=f),disabled:!v.value,onUpdateValue:i[1]||(i[1]=f=>g("new_binggan",f))},null,8,["value","disabled"]),et(l(e(M),{depth:3},{default:t(()=>[...i[7]||(i[7]=[a("读取中",-1)])]),_:1},512),[[tt,!v.value]])]),_:1}),l(e(x),{size:"small"},{default:t(()=>[l(e(M),{style:{width:"6.2rem"}},{default:t(()=>[...i[8]||(i[8]=[a("大喇叭开关",-1)])]),_:1}),l(e(xe),{value:n.value,"onUpdate:value":i[2]||(i[2]=f=>n.value=f),disabled:!v.value,onUpdateValue:i[3]||(i[3]=f=>g("new_loudspeaker",f))},null,8,["value","disabled"]),et(l(e(M),{depth:3},{default:t(()=>[...i[9]||(i[9]=[a("读取中",-1)])]),_:1},512),[[tt,!v.value]])]),_:1}),l(e(x),{size:"small"},{default:t(()=>[l(e(M),{style:{width:"6.2rem"}},{default:t(()=>[...i[10]||(i[10]=[a("强制打开饼干（慎用）",-1)])]),_:1}),l(e(xe),{value:p.value,"onUpdate:value":i[4]||(i[4]=f=>p.value=f),disabled:!v.value,onUpdateValue:i[5]||(i[5]=f=>g("new_binggan_force",f))},null,8,["value","disabled"]),et(l(e(M),{depth:3},{default:t(()=>[...i[11]||(i[11]=[a("读取中",-1)])]),_:1},512),[[tt,!v.value]])]),_:1})]),_:1}))}}),du=$e(ru,[["__scopeId","data-v-3d2b5c4f"]]),mu={class:"actives-item"},pu={style:{"margin-left":"auto"}},fu={key:0,style:{"margin-top":"6px"}},gu={style:{"margin-top":"6px"}},vu={style:{"margin-top":"6px"}},bu=Q({__name:"TabActives",setup(G){Te($=>({a0198f68:e(w).dividerColor})),ie.extend(Ol),ie.extend(El);const c=re(),m=te(),w=je(),n=_(ie().tz("Asia/Shanghai").format("YYYY-MM-DD"));Le(n,()=>d());const p=_(1);Le(p,()=>d()),Ze(()=>d());function v($){return ie().add(1,"day").isBefore($)}const g=[{title:"时间",key:"created_at",resizable:!0},{title:"管理员",key:"name",resizable:!0},{title:"罚款",key:"olo",resizable:!0},{title:"操作",key:"active",resizable:!0},{title:"原因",key:"content",resizable:!0},{title:"主题",key:"thread_title",render:T,resizable:!0},{title:"回复",key:"post_content",render:D,resizable:!0}],{loading:o,data:i,send:f}=ue($=>Wl($),{immediate:!1,initialData:{data:[],last_page:1}});function d(){const $={binggan:c.binggan,date:n.value,page:p.value};f($)}function h($){return{name:"thread",params:{threadId:$.thread_id,page:$.floor===null?1:Math.ceil(($.floor+1)/200)},hash:$.floor===null?void 0:"#f_"+$.floor}}function T($,s){return $.thread_id!==null?de(_t,{to:h($),target:"_blank"},()=>de(it,{style:"max-width: 120px"},()=>$.thread_title)):de(it,{style:"max-width: 120px"},()=>$.thread_title)}function D($,s){return $.thread_id!==null?de(_t,{to:h($),target:"_blank"},()=>de(it,{style:"max-width: 120px"},()=>$.post_content)):de(it,{style:"max-width: 120px"},()=>$.post_content)}return($,s)=>(r(),k(e(x),{size:"small"},{default:t(()=>[l(e(rt),{"formatted-value":n.value,"onUpdate:formattedValue":s[0]||(s[0]=u=>n.value=u),"value-format":"yyyy-MM-dd",type:"date",size:e(m).isMobile?"small":"medium","is-date-disabled":v},null,8,["formatted-value","size"]),l(e(E),{type:"primary",onClick:s[1]||(s[1]=u=>d())},{default:t(()=>[...s[4]||(s[4]=[a(" 查询 ",-1)])]),_:1}),l(e(oe),{title:"管理员操作记录",size:"small"},{default:t(()=>[e(m).isMobile?L("",!0):(r(),k(e(x),{key:0},{default:t(()=>[l(e(wt),{columns:g,data:e(i).data,bordered:!1,loading:e(o),style:{height:"100%"}},null,8,["data","loading"]),l(e(ct),{page:p.value,"onUpdate:page":s[2]||(s[2]=u=>p.value=u),"page-count":e(i).last_page,size:"medium",style:{"margin-left":"auto"}},null,8,["page","page-count"])]),_:1})),e(m).isMobile?(r(),O(ee,{key:1},[e(i).data.length>0?(r(),k(e(x),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[e(o)?L("",!0):(r(!0),O(ee,{key:0},me(e(i).data,u=>(r(),O("div",mu,[l(e(x),null,{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...s[5]||(s[5]=[a("时间：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(u.created_at),1)]),_:2},1024)]),S("div",pu,[l(e(M),{depth:3},{default:t(()=>[...s[6]||(s[6]=[a("管理员：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(u.name),1)]),_:2},1024)])]),_:2},1024),u.olo?(r(),O("div",fu,[l(e(M),{depth:3},{default:t(()=>[...s[7]||(s[7]=[a("罚款：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(u.olo),1)]),_:2},1024)])):L("",!0),S("div",gu,[l(e(M),{depth:3},{default:t(()=>[...s[8]||(s[8]=[a("操作：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(u.active),1)]),_:2},1024)]),S("div",vu,[l(e(M),{depth:3},{default:t(()=>[...s[9]||(s[9]=[a("原因：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(u.content),1)]),_:2},1024)]),u.thread_title!==null?(r(),k(e(x),{key:1,style:{"margin-top":"6px"},wrap:!1},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...s[10]||(s[10]=[a("主题：",-1)])]),_:1}),l(e(_t),{to:h(u),style:{"max-width":"80%"}},{default:t(()=>[l(e(it),null,{default:t(()=>[a(j(u.thread_title),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024)):L("",!0),u.post_content!==null?(r(),k(e(x),{key:2,style:{"margin-top":"6px"},wrap:!1},{default:t(()=>[l(e(M),{depth:3},{default:t(()=>[...s[11]||(s[11]=[a("主题：",-1)])]),_:1}),l(e(_t),{to:h(u),style:{"max-width":"80%"}},{default:t(()=>[l(e(it),null,{default:t(()=>[a(j(u.post_content),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024)):L("",!0)]))),256)),l(e(ct),{page:p.value,"onUpdate:page":s[3]||(s[3]=u=>p.value=u),"page-count":e(i).last_page,size:"small",style:{"margin-left":"auto"}},null,8,["page","page-count"])]),_:1})):(r(),k(e(Lt),{key:1}))],64)):L("",!0)]),_:1})]),_:1}))}}),cu=$e(bu,[["__scopeId","data-v-a35e3f42"]]),yu={class:"actives-item"},wu={style:{"margin-left":"auto"}},_u={key:0,style:{"margin-top":"6px"}},hu={key:1,style:{"margin-top":"6px"}},ku={style:{"margin-top":"6px"}},Cu={style:{"margin-top":"6px"}},xu=Q({__name:"TabActivesSuper",setup(G){Te(h=>({"2c7ab229":e(w).dividerColor})),ie.extend(Ol),ie.extend(El);const c=re(),m=te(),w=je(),n=_(ie().tz("Asia/Shanghai").format("YYYY-MM-DD"));Le(n,()=>d());const p=_(1);Le(p,()=>d()),Ze(()=>d());function v(h){return ie().add(1,"day").isBefore(h)}const g=[{title:"时间",key:"created_at",resizable:!0},{title:"管理员",key:"name",resizable:!0},{title:"目标饼干",key:"binggan_target",resizable:!0},{title:"罚款",key:"olo",resizable:!0},{title:"操作",key:"active",resizable:!0},{title:"原因",key:"content",resizable:!0}],{loading:o,data:i,send:f}=ue(h=>Wl(h),{immediate:!1,initialData:{data:[],last_page:1}});function d(){const h={binggan:c.binggan,date:n.value,page:p.value,show_super:!0};f(h)}return(h,T)=>(r(),k(e(x),{size:"small"},{default:t(()=>[l(e(rt),{"formatted-value":n.value,"onUpdate:formattedValue":T[0]||(T[0]=D=>n.value=D),"value-format":"yyyy-MM-dd",type:"date",size:e(m).isMobile?"small":"medium","is-date-disabled":v},null,8,["formatted-value","size"]),l(e(E),{type:"primary",onClick:T[1]||(T[1]=D=>d())},{default:t(()=>[...T[4]||(T[4]=[a(" 查询 ",-1)])]),_:1}),l(e(oe),{title:"管理员操作记录",size:"small"},{default:t(()=>[e(m).isMobile?L("",!0):(r(),k(e(x),{key:0},{default:t(()=>[l(e(wt),{columns:g,data:e(i).data,bordered:!1,loading:e(o),style:{height:"100%"}},null,8,["data","loading"]),l(e(ct),{page:p.value,"onUpdate:page":T[2]||(T[2]=D=>p.value=D),"page-count":e(i).last_page,size:"medium",style:{"margin-left":"auto"}},null,8,["page","page-count"])]),_:1})),e(m).isMobile?(r(),O(ee,{key:1},[e(i).data.length>0?(r(),k(e(x),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[e(o)?L("",!0):(r(!0),O(ee,{key:0},me(e(i).data,D=>(r(),O("div",yu,[l(e(x),null,{default:t(()=>[S("div",null,[l(e(M),{depth:3},{default:t(()=>[...T[5]||(T[5]=[a("时间：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.created_at),1)]),_:2},1024)]),S("div",wu,[l(e(M),{depth:3},{default:t(()=>[...T[6]||(T[6]=[a("管理员：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.name),1)]),_:2},1024)])]),_:2},1024),D.olo?(r(),O("div",_u,[l(e(M),{depth:3},{default:t(()=>[...T[7]||(T[7]=[a("目标饼干：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.binggan_target),1)]),_:2},1024)])):L("",!0),D.olo?(r(),O("div",hu,[l(e(M),{depth:3},{default:t(()=>[...T[8]||(T[8]=[a("罚款：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.olo),1)]),_:2},1024)])):L("",!0),S("div",ku,[l(e(M),{depth:3},{default:t(()=>[...T[9]||(T[9]=[a("操作：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.active),1)]),_:2},1024)]),S("div",Cu,[l(e(M),{depth:3},{default:t(()=>[...T[10]||(T[10]=[a("原因：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(D.content),1)]),_:2},1024)])]))),256)),l(e(ct),{page:p.value,"onUpdate:page":T[3]||(T[3]=D=>p.value=D),"page-count":e(i).last_page,size:"small",style:{"margin-left":"auto"}},null,8,["page","page-count"])]),_:1})):(r(),k(e(Lt),{key:1}))],64)):L("",!0)]),_:1})]),_:1}))}}),Su=$e(xu,[["__scopeId","data-v-296b2d9d"]]),zu=Q({__name:"TabSuperAdmin",setup(G){const c=re(),m=te(),w=Ve(),n=_(null),p=_(null),v=_(null),g=_(null),o=_({binggan:"",olo:void 0,message:""}),i=_({uuid:""}),f=_({thread_id:null,forum_id:1,nissin_clear:!0}),d=_({binggan:"",medalId:181}),h=R(()=>w.forumsData.map(X=>({value:X.id,label:X.name}))),T=[{value:181,label:"皇家御用画宗"},{value:182,label:"小火锅守护者"}],D={binggan:{required:!0,message:"请填写目标饼干",trigger:"blur"},message:{required:!1},olo:{required:!0,message:"请选择要奖罚的olo",type:"number",trigger:"blur"}},$={uuid:{required:!0,message:"请填写目标UUID",trigger:"blur"}},s={thread_id:{required:!0,message:"请填写主题ID",type:"number",trigger:"blur"},forum_id:{required:!0,message:"请选择目标小岛",type:"number",trigger:"blur"},nissin_clear:{required:!0}},u={binggan:{required:!0,message:"请填写目标饼干",trigger:"blur"},medalId:{required:!0,message:"请选择要发放的成就",type:"number",trigger:"blur"}},{loading:y,send:b,onSuccess:z,onError:C}=ue(X=>pn(X),{immediate:!1});z(()=>{o.value.binggan=""}),C(()=>{o.value.binggan=""});function I(){v.value?.validate(X=>{if(X){window.$message.error("请确认信息填写完整");return}else{const F={binggan:c.binggan,binggan_target:o.value.binggan,olo_num:o.value.olo,olo_message:o.value.message},H=o.value.olo>0?"奖励":"罚款",Y={title:"奖罚olo",closable:!1,content:`对象饼干：${o.value.binggan} ${H}${o.value.olo}个olo`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{b(F)}};window.$dialog.warning(Y)}})}const{loading:N,send:q,onSuccess:U,onError:B}=ue(X=>fn(X),{immediate:!1});U(()=>{i.value.uuid=""});function P(){n.value?.validate(X=>{if(X){window.$message.error("请确认信息填写完整");return}else{const F={binggan:c.binggan,uuid:i.value.uuid};q(F)}})}const{loading:A,send:W,onSuccess:J,onError:pe}=ue(X=>gn(X),{immediate:!1});J(()=>{f.value.thread_id=null});function Re(){p.value?.validate(X=>{if(X){window.$message.error("请确认信息填写完整");return}else{const F={binggan:c.binggan,thread_id:f.value.thread_id,forum_id:f.value.forum_id,nissin_clear:f.value.nissin_clear};W(F)}})}const{loading:ce,send:be,onSuccess:ze,onError:Ce}=ue(X=>vn(X),{immediate:!1});ze(()=>{d.value.binggan=""}),Ce(()=>{d.value.binggan=""});function Ye(){g.value?.validate(X=>{if(X){window.$message.error("请确认信息填写完整");return}else{const F={binggan:c.binggan,binggan_target:d.value.binggan,medal_id:d.value.medalId},H=T.find(se=>se.value===d.value.medalId),Y={title:"发放成就",closable:!1,content:`对象饼干：${d.value.binggan}  发放成就：${H?.label}`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{be(F)}};window.$dialog.warning(Y)}})}return(X,F)=>(r(),k(e(x),{style:{"max-width":"450px"}},{default:t(()=>[l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{style:{"font-size":"0.875rem"}},{default:t(()=>[...F[9]||(F[9]=[a("奖罚olo ",-1)])]),_:1})]),_:1}),l(e(Xe),{ref_key:"oloFormRef",ref:v,model:o.value,"label-placement":"left","label-width":"auto",rules:D,size:e(m).isMobile?"small":"medium",style:{"max-width":"300px"}},{default:t(()=>[l(e(ne),{label:"目标饼干",path:"binggan"},{default:t(()=>[l(e(ve),{value:o.value.binggan,"onUpdate:value":F[0]||(F[0]=H=>o.value.binggan=H)},null,8,["value"])]),_:1}),l(e(ne),{label:"奖罚olo",path:"olo"},{default:t(()=>[l(e(he),{value:o.value.olo,"onUpdate:value":F[1]||(F[1]=H=>o.value.olo=H),max:1e6,min:-1e6,step:1e3,parse:e(ft),format:e(pt),placeholder:"正数是奖励，负数是罚款"},null,8,["value","parse","format"])]),_:1}),l(e(ne),{label:"附带留言",path:"message"},{default:t(()=>[l(e(ve),{value:o.value.message,"onUpdate:value":F[2]||(F[2]=H=>o.value.message=H),placeholder:"将显示在收支记录"},null,8,["value"])]),_:1}),l(e(E),{type:"primary",loading:e(y),disabled:e(y),onClick:I},{default:t(()=>[...F[10]||(F[10]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model","size"]),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{style:{"font-size":"0.875rem"}},{default:t(()=>[...F[11]||(F[11]=[a("解锁UUID ",-1)])]),_:1})]),_:1}),l(e(Xe),{ref_key:"uuidFormRef",ref:n,model:i.value,"label-placement":"left","label-width":"auto",rules:$,size:e(m).isMobile?"small":"medium",style:{"max-width":"450px"}},{default:t(()=>[l(e(ne),{label:"解锁UUID",path:"uuid"},{default:t(()=>[l(e(ve),{value:i.value.uuid,"onUpdate:value":F[3]||(F[3]=H=>i.value.uuid=H)},null,8,["value"])]),_:1}),l(e(E),{type:"primary",loading:e(N),disabled:e(N),onClick:P},{default:t(()=>[...F[12]||(F[12]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model","size"]),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{style:{"font-size":"0.875rem"}},{default:t(()=>[...F[13]||(F[13]=[a("主题转区 ",-1)])]),_:1})]),_:1}),l(e(Xe),{ref_key:"transferFormRef",ref:p,model:f.value,"label-placement":"left","label-width":"auto",rules:s,size:e(m).isMobile?"small":"medium",style:{"max-width":"450px"}},{default:t(()=>[l(e(ne),{label:"主题ID",path:"thread_id"},{default:t(()=>[l(e(he),{"show-button":!1,value:f.value.thread_id,"onUpdate:value":F[4]||(F[4]=H=>f.value.thread_id=H),max:1e6,min:1},null,8,["value"])]),_:1}),l(e(ne),{label:"目标小岛",path:"forum_id"},{default:t(()=>[l(e(Oe),{value:f.value.forum_id,"onUpdate:value":F[5]||(F[5]=H=>f.value.forum_id=H),options:h.value,"consistent-menu-width":!1,style:{width:"300px"}},null,8,["value","options"])]),_:1}),l(e(ne),{label:"解锁日清",path:"nissin_clear"},{default:t(()=>[l(e(xe),{value:f.value.nissin_clear,"onUpdate:value":F[6]||(F[6]=H=>f.value.nissin_clear=H)},null,8,["value"])]),_:1}),l(e(E),{type:"primary",loading:e(A),disabled:e(A),onClick:Re},{default:t(()=>[...F[14]||(F[14]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model","size"]),l(e(Pe),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:t(()=>[l(e(M),{style:{"font-size":"0.875rem"}},{default:t(()=>[...F[15]||(F[15]=[a("发放成就 ",-1)])]),_:1})]),_:1}),l(e(Xe),{ref_key:"formRef",ref:g,model:d.value,"label-placement":"left","label-width":"auto",rules:u,size:e(m).isMobile?"small":"medium",style:{"max-width":"300px"}},{default:t(()=>[l(e(ne),{label:"目标饼干",path:"binggan"},{default:t(()=>[l(e(ve),{value:d.value.binggan,"onUpdate:value":F[7]||(F[7]=H=>d.value.binggan=H)},null,8,["value"])]),_:1}),l(e(ne),{label:"发放成就",path:"medalId"},{default:t(()=>[l(e(Oe),{value:d.value.medalId,"onUpdate:value":F[8]||(F[8]=H=>d.value.medalId=H),options:T,"menu-props":{style:{borderRadius:"10px"}}},null,8,["value"])]),_:1}),l(e(E),{type:"primary",loading:e(ce),disabled:e(ce),onClick:Ye},{default:t(()=>[...F[16]||(F[16]=[a("提交",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model","size"])]),_:1}))}}),Mu=Q({__name:"AdminCard",setup(G){const c=re(),m=te(),w=Ve(),n=R(()=>c.binggan===null||c.userData.binggan.admin_forums===void 0?[]:w.forumsData.reduce((p,v)=>(c.checkAdminForums(v.id)&&p.push({value:v.id,label:v.name,forumId:v.id}),p),[]));return(p,v)=>(r(),k(e(oe),{hoverable:"",size:"small"},{default:t(()=>[l(e(x),{vertical:e(m).isMobile},{default:t(()=>[l(e(x),{size:"small",align:"center"},{default:t(()=>[...v[0]||(v[0]=[S("img",{src:"/ui/my-binggan.png",style:{"max-width":"50px","max-height":"50px"}},null,-1),S("span",null,"管理员中心",-1)])]),_:1}),S("div",null,[l(e(M),{depth:3},{default:t(()=>[...v[1]||(v[1]=[a("我管理的板块",-1)])]),_:1}),l(e(x),null,{default:t(()=>[(r(!0),O(ee,null,me(n.value,g=>(r(),k(e(dt),null,{default:t(()=>[a(j(g.forumId)+". "+j(g.label),1)]),_:2},1024))),256))]),_:1})])]),_:1},8,["vertical"])]),_:1}))}}),$u=Q({__name:"AdminCenter",setup(G){const c=re(),m=te(),w=_();document.title="管理员中心";const n=R(()=>{const p=[{name:"banners",tab:"版头设定",component:uu}];return c.admin.isNormalAdmin&&p.unshift({name:"actives",tab:"管理状况",component:cu}),c.admin.isSuperAdmin?p.concat([{name:"global",tab:"全局设置",component:du},{name:"super_actives",tab:"超管状况",component:Su},{name:"super_admin",tab:"超管操作",component:zu}]):p});return(p,v)=>(r(),k(e(x),{vertical:"",style:{"margin-top":"8px"}},{default:t(()=>[l(e(Mu)),l(e(Pt),{type:"line","bar-width":e(m).isMobile?0:void 0,animated:"",size:e(m).isMobile?"small":"large",value:w.value,"onUpdate:value":v[0]||(v[0]=g=>w.value=g)},{default:t(()=>[(r(!0),O(ee,null,me(n.value,g=>(r(),k(e(Je),{name:g.name,tab:g.tab,key:g.name},{default:t(()=>[(r(),k(ut(g.component)))]),_:2},1032,["name","tab"]))),128))]),_:1},8,["bar-width","size","value"]),v[1]||(v[1]=S("div",{style:{height:"50px"}},null,-1))]),_:1}))}}),tr=Object.freeze(Object.defineProperty({__proto__:null,default:$u},Symbol.toStringTag,{value:"Module"})),Iu=Q({__name:"NewLoudspeakerModal",emits:["refreshLoudspeaker"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_(null),v=_({subId:"1",content:void 0,color:void 0,threadId:void 0,days:1,effectiveDate:ie.tz().format("YYYY-MM-DD HH:mm:ss")}),g=_(!1),o=R(()=>({id:1,sub_id:1,content:v.value.content||"（这里是预览）",color:v.value.color||null,thread_id:null,effective_date:v.value.effectiveDate,expire_date:v.value.effectiveDate,created_at:v.value.effectiveDate,is_your_loudspeaker:!0})),i={effectiveDate:{required:!0,message:"请选择生效日期和时间"},days:{required:!0,message:"请填写生效天数",type:"number"},content:{required:!0,message:"请填写内容"},color:{required:!1},threadId:{required:!1},subId:{required:!1}},f=_(!1);function d(){f.value=!0}c({show:d});const h=m,{loading:T,send:D}=ue(s=>bn(s),{immediate:!1});function $(){p.value?.validate(s=>{if(s)window.$message.error("请确认信息填写完整");else{const u={binggan:n.binggan,sub_id:v.value.subId,content:v.value.content,color:g?v.value.color:void 0,thread_id:v.value.threadId,effective_date:v.value.effectiveDate,days:v.value.days};D(u).then(()=>{h("refreshLoudspeaker"),f.value=!1})}})}return(s,u)=>(r(),k(e(Se),{show:f.value,"onUpdate:show":u[9]||(u[9]=y=>f.value=y),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),title:"发布大喇叭",closable:"",onClose:u[8]||(u[8]=y=>f.value=!1),size:"small"},{action:t(()=>[l(e(x),{justify:"end"},{default:t(()=>[l(e(E),{type:"primary",disable:e(T),loading:e(T),onClick:$},{default:t(()=>[...u[10]||(u[10]=[a("发布",-1)])]),_:1},8,["disable","loading"]),l(e(E),{onClick:u[7]||(u[7]=y=>f.value=!1)},{default:t(()=>[...u[11]||(u[11]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[u[12]||(u[12]=S("div",null,[a(" 价格暂定为5000个olo（每天）"),S("br"),a(" 禁止发布辱骂、诅咒、黑锦鲤等方面情绪。 ")],-1)),l(e(Xe),{ref_key:"formRef",ref:p,model:v.value,"label-placement":"left","label-width":"auto",rules:i,size:e(w).isMobile?"small":"medium",style:{"margin-top":"10px"}},{default:t(()=>[l(e(ne),{label:"生效时间",path:"effectiveDate"},{default:t(()=>[l(e(rt),{"formatted-value":v.value.effectiveDate,"onUpdate:formattedValue":u[0]||(u[0]=y=>v.value.effectiveDate=y),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",size:e(w).isMobile?"small":"medium"},null,8,["formatted-value","size"])]),_:1}),l(e(ne),{label:"生效天数",path:"days"},{default:t(()=>[l(e(he),{value:v.value.days,"onUpdate:value":u[1]||(u[1]=y=>v.value.days=y),max:3,min:1,step:1,placeholder:"1-3天"},null,8,["value"])]),_:1}),l(e(ne),{label:"内容",path:"content"},{default:t(()=>[l(e(ve),{placeholder:"最多100字",type:"textarea",maxlength:"100","show-count":"",autosize:{minRows:3,maxRows:5},value:v.value.content,"onUpdate:value":u[2]||(u[2]=y=>v.value.content=y)},null,8,["value"])]),_:1}),l(e(ne),{label:"设定颜色",path:"color"},{default:t(()=>[l(e(xe),{value:g.value,"onUpdate:value":u[3]||(u[3]=y=>g.value=y)},null,8,["value"]),et(l(e(Qt),{value:v.value.color,"onUpdate:value":u[4]||(u[4]=y=>v.value.color=y),modes:["hex"],"show-alpha":!1,style:{"max-width":"7rem","margin-left":"12px"}},null,8,["value"]),[[tt,g.value]])]),_:1}),l(e(ne),{label:"链接主题",path:"threadId"},{default:t(()=>[l(e(ve),{value:v.value.threadId,"onUpdate:value":u[5]||(u[5]=y=>v.value.threadId=y),placeholder:"主题网址的ID（可留空）"},null,8,["value"])]),_:1}),e(n).admin.isSuperAdmin?(r(),k(e(ne),{key:0,label:"设为置顶",path:"subId"},{default:t(()=>[l(e(xe),{"onUpdate:value":u[6]||(u[6]=y=>v.value.subId=y),"checked-value":10,"unchecked-value":"1"})]),_:1})):L("",!0)]),_:1},8,["model","size"]),(r(),k(ut(o.value.thread_id?"router-link":"span"),{style:ae([{color:o.value.color},{"white-space":"pre-wrap"}]),to:o.value.thread_id!==null?`/thread/${o.value.thread_id}/1`:void 0},{default:t(()=>[a(j(o.value.content),1)]),_:1},8,["style","to"]))]),_:1},8,["style"])]),_:1},8,["show"]))}}),Tu=Q({__name:"LoudspeakerPage",setup(G){Te(y=>({"1386222b":e(n).textColor1}));const c=re(),m=te(),w=_(),n=je();document.title="大喇叭";const p=_(),v=_(!1),g=_(1),o=_(30),i=R(()=>(g.value-1)*o.value),f={binggan:c.binggan,mode:"all"},{loading:d,data:h,send:T}=ue(y=>Fl(y),{immediate:!1,initialData:[]});T(f);const D=R(()=>h.value.filter(y=>!(v.value&&!y.is_your_loudspeaker||p.value&&!ie.tz(p.value).isSame(y.effective_date,"day")))),{data:$}=ue(cn);function s(y){const b={title:"强制删除大喇叭",closable:!1,content:"要强制删除这个大喇叭吗？这是管理员功能。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{yn({binggan:c.binggan,loudspeaker_id:y}).then(()=>T(f))}};window.$dialog.warning(b)}function u(y,b=!1){const z={title:"撤回大喇叭",closable:!1,content:b?"由于已超过5分钟，olo将不会退回，是否接受？":"要撤回这个大喇叭吗？如果是5分钟内撤回将退回olo",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{wn({binggan:c.binggan,loudspeaker_id:y,confirm_penalty:b}).then(()=>T(f)).catch(C=>{C.cause!==void 0&&C.cause.code==21430&&u(y,!0)})}};b?window.$dialog.warning(z):window.$dialog.success(z)}return(y,b)=>(r(),k(e(x),{vertical:"",style:{"margin-top":"8px"}},{default:t(()=>[l(e(x),{size:"small",align:"center"},{default:t(()=>[S("img",{style:ae({height:e(m).isMobile?"48px":"64px"}),src:"/ui/miku-loudspeaker.png"},null,4),l(e(to),{style:ae({fontSize:e(m).isMobile?"16px":"20px"}),gradient:{from:"#7fcab9",to:"#99b1c5"}},{default:t(()=>[...b[6]||(b[6]=[a(" 爱乃是盲目～🎵 ",-1)])]),_:1},8,["style"]),l(e(Ee),{placement:"bottom",trigger:"hover",disabled:e($)},{trigger:t(()=>[l(e(E),{type:"primary",disabled:!e($),onClick:b[0]||(b[0]=z=>w.value?.show()),style:{"margin-left":"auto"}},{default:t(()=>[...b[7]||(b[7]=[a("发布大喇叭",-1)])]),_:1},8,["disabled"])]),default:t(()=>[l(e(M),null,{default:t(()=>[...b[8]||(b[8]=[a("嗷！目前暂停发布大喇叭…… ",-1)])]),_:1})]),_:1},8,["disabled"])]),_:1}),l(e(x),{size:"small",justify:"end",align:"center"},{default:t(()=>[l(e(M),null,{default:t(()=>[...b[9]||(b[9]=[a("只看自己",-1)])]),_:1}),l(e(xe),{value:v.value,"onUpdate:value":b[1]||(b[1]=z=>v.value=z)},null,8,["value"]),l(e(rt),{"formatted-value":p.value,"onUpdate:formattedValue":b[2]||(b[2]=z=>p.value=z),"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"筛选生效日期",size:e(m).isMobile?"small":"medium"},null,8,["formatted-value","size"])]),_:1}),l(Gt,{page:g.value,"onUpdate:page":[b[3]||(b[3]=z=>g.value=z),b[4]||(b[4]=z=>g.value=z)],"last-page":Math.ceil(D.value.length/o.value),style:{"margin-right":"auto"}},null,8,["page","last-page"]),D.value.length>0?(r(!0),O(ee,{key:0},me(D.value.slice(i.value,i.value+o.value),z=>(r(),k(e(oe),{key:z.id,size:"small",bordered:!0,class:"loudspeaker-card"},{default:t(()=>[(r(),k(ut(z.thread_id?"router-link":"span"),{style:ae([{color:z.color},{"white-space":"pre-wrap"}]),to:z.thread_id!==null?`/thread/${z.thread_id}/1`:void 0},{default:t(()=>[a(j(z.content),1)]),_:2},1032,["style","to"])),l(e(x),{size:"small"},{default:t(()=>[S("span",null,[l(e(M),{depth:3},{default:t(()=>[...b[10]||(b[10]=[a("生效：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(z.effective_date),1)]),_:2},1024)]),S("span",null,[l(e(M),{depth:3},{default:t(()=>[...b[11]||(b[11]=[a("到期：",-1)])]),_:1}),l(e(M),null,{default:t(()=>[a(j(z.expire_date),1)]),_:2},1024)]),b[13]||(b[13]=S("div",{style:{"margin-left":"auto"}},null,-1)),z.is_your_loudspeaker?(r(),k(e(ye),{key:0,size:e(m).isMobile?20:24,style:{cursor:"pointer"},onClick:C=>u(z.id,!1)},{default:t(()=>[l(e($t))]),_:1},8,["size","onClick"])):L("",!0),e(c).admin.isNormalAdmin?(r(),k(e(E),{key:1,size:"tiny",type:"warning",onClick:C=>s(z.id)},{default:t(()=>[...b[12]||(b[12]=[a("强制删除",-1)])]),_:1},8,["onClick"])):L("",!0)]),_:2},1024)]),_:2},1024))),128)):(r(),k(e(Lt),{key:1})),l(Iu,{ref_key:"NewLoudspeakerModalCom",ref:w,onRefreshLoudspeaker:b[5]||(b[5]=z=>e(T)(f))},null,512)]),_:1}))}}),Du=$e(Tu,[["__scopeId","data-v-3027cefc"]]),lr=Object.freeze(Object.defineProperty({__proto__:null,default:Du},Symbol.toStringTag,{value:"Module"})),Pu=["src"],Lu={key:0},Uu={key:1},ju={key:2},Hu=Q({__name:"VoteModal",emits:["refreshMoeData"],setup(G,{expose:c,emit:m}){const w=te(),n=re(),p=_({emojiUrl:"",emojiGroupId:0,emojiId:0,voteNum:0,endFlag:0}),v=_(),g=_(!1);function o($){g.value=!0,p.value=$,v.value=void 0}c({show:o});const{loading:i,send:f,onSuccess:d,onError:h}=ue($=>_n($),{immediate:!1});function T(){if(v.value===void 0){window.$message.error("请输入投票数");return}const $={binggan:n.binggan,emoji_id:p.value.emojiId,emoji_group_id:p.value.emojiGroupId,olo:v.value*100};f($)}d(()=>{D("refreshMoeData",p.value.emojiGroupId),v.value=void 0,g.value=!1});const D=m;return($,s)=>(r(),k(e(Se),{show:g.value,"onUpdate:show":s[3]||(s[3]=u=>g.value=u),"display-directive":"if"},{default:t(()=>[l(e(oe),{style:ae({maxWidth:e(w).modalMaxWidth}),closable:"",onClose:s[2]||(s[2]=u=>g.value=!1),size:"small"},{action:t(()=>[l(e(x),{align:"center"},{default:t(()=>[p.value.endFlag===0?(r(),O("span",Lu," 活动尚未开始 ")):L("",!0),p.value.endFlag===1?(r(),O("span",Uu,[s[5]||(s[5]=a(" 将会花费 ",-1)),l(e(M),{type:"error"},{default:t(()=>[a(j((v.value??0)*100),1)]),_:1}),s[6]||(s[6]=a(" 个olo ",-1))])):L("",!0),p.value.endFlag===2?(r(),O("span",ju," 活动已经结束了 ")):L("",!0),l(e(E),{type:"primary",onClick:T,loading:e(i),disabled:e(i)||p.value.endFlag!==1,style:{"margin-left":"auto"}},{default:t(()=>[...s[7]||(s[7]=[a("投票",-1)])]),_:1},8,["loading","disabled"]),l(e(E),{onClick:s[1]||(s[1]=u=>g.value=!1)},{default:t(()=>[...s[8]||(s[8]=[a("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[l(e(x),{vertical:"",align:"center",size:[4,4]},{default:t(()=>[S("img",{style:{"max-width":"100%"},src:p.value.emojiUrl},null,8,Pu),S("span",null,"当前票数："+j(p.value.voteNum),1),l(e(fe),null,{default:t(()=>[l(e(ge),{style:{width:"4.2rem"}},{default:t(()=>[...s[4]||(s[4]=[a("投票额",-1)])]),_:1}),l(e(he),{value:v.value,"onUpdate:value":s[0]||(s[0]=u=>v.value=u),max:1e4,min:1,step:1,onKeyup:Ue(T,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Au=["src"],Ru=["src"],Bu={key:0},Ou=["src"],Eu=Q({__name:"EmojiContest",setup(G){Te(U=>({"6df645c9":T.value}));const c=ie.tz("2025-6-18 20:00"),m=ie.tz("2025-6-22 20:00"),w=[1,2,3,5,6,9,10,11,16,17],n={1:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad2bca02d05.png",name:"AC娘"},2:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ab7d8f0753f.gif",name:"鹦鹉鸡"},3:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ab6a329cadc.gif",name:"咪子鱼"},5:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad3601c5eef.png",name:"麻将脸"},6:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad38710da48.jpg",name:"小恐龙"},9:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad3dc22bbe8.png",name:"小企鹅"},10:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad3e55cf286.png",name:"小黄脸"},11:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad4141eae00.gif",name:"FUFU"},16:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad4a651928d.gif",name:"药水哥"},17:{emojiUrl:"https://wmimg.com/i/1547/2025/02/67ad4b806cb12.gif",name:"吉伊卡哇"}},p=R(()=>fl(["https://wmimg.com/i/1547/2025/06/6846dbf60cbe7.png","https://wmimg.com/i/1547/2025/06/684bfbe7b431e.png","https://wmimg.com/i/1547/2025/06/684bfbe7b7345.png","https://wmimg.com/i/1547/2025/06/684bfbe7b63bd.png","https://wmimg.com/i/1547/2025/06/684bfbe7b7345.png","https://wmimg.com/i/1547/2025/06/684ed1e7bb22c.png","https://wmimg.com/i/1547/2025/06/684ed1e80632a.png","https://wmimg.com/i/1547/2025/06/684ed1e836f2a.png","https://wmimg.com/i/1547/2025/06/684ed1e84c426.png","https://wmimg.com/i/1547/2025/06/684ed1e8b0e52.png","https://wmimg.com/i/1547/2025/06/6851648dcb6d2.png","https://wmimg.com/i/1547/2025/06/6851648e13773.png","https://wmimg.com/i/1547/2025/06/6851648e3bcbc.png","https://wmimg.com/i/1547/2025/06/6851648e625d2.png","https://wmimg.com/i/1547/2025/06/6851648eb0d26.png","https://wmimg.com/i/1547/2025/06/6851648e8dc8a.png","https://wmimg.com/i/1547/2025/06/6851648f30ffd.png","https://wmimg.com/i/1547/2025/06/6851648f7d3e4.png","https://wmimg.com/i/1547/2025/06/6851648fc2c42.png","https://wmimg.com/i/1547/2025/06/685164901f2e1.png","https://wmimg.com/i/1547/2025/06/685164908d7c0.png","https://wmimg.com/i/1547/2025/06/6851649219afa.png","https://wmimg.com/i/1547/2025/06/68529871267f8.png","https://wmimg.com/i/1547/2025/06/68529871e2f82.png","https://wmimg.com/i/1547/2025/06/68529872d9dfe.png","https://wmimg.com/i/1547/2025/06/68529874985d7.png","https://wmimg.com/i/1547/2025/06/6853f4c7241a9.png","https://wmimg.com/i/1547/2025/06/6853f4c7398bf.png","https://wmimg.com/i/1547/2025/06/6853f4c879f68.png","https://wmimg.com/i/1547/2025/06/6853f4c8a79e7.png","https://wmimg.com/i/1547/2025/06/6853f4c8a1cff.png","https://wmimg.com/i/1547/2025/06/6853f4c90044e.png","https://wmimg.com/i/1547/2025/06/6853f4c922153.png","https://wmimg.com/i/1547/2025/06/6853f4c9554d3.png","https://wmimg.com/i/1547/2025/06/6853f4c980080.png","https://wmimg.com/i/1547/2025/06/6853f4c9915bc.png","https://wmimg.com/i/1547/2025/06/6853f4c9a9560.png","https://wmimg.com/i/1547/2025/06/6853f4ca6a226.png","https://wmimg.com/i/1547/2025/06/6853f4cac866b.png","https://wmimg.com/i/1547/2025/06/6853f4cba2151.png","https://wmimg.com/i/1547/2025/06/6853f4cca2d7b.png","https://wmimg.com/i/1547/2025/06/6853f4cd69b2a.png","https://wmimg.com/i/1547/2025/06/68553c704951c.jpg","https://wmimg.com/i/1547/2025/06/68553c705161e.jpg","https://wmimg.com/i/1547/2025/06/68553c707937a.png","https://wmimg.com/i/1547/2025/06/68553c707ccc9.jpg","https://wmimg.com/i/1547/2025/06/68553c706d0f2.jpg","https://wmimg.com/i/1547/2025/06/68553c7074599.png","https://wmimg.com/i/1547/2025/06/68553c708ac17.png","https://wmimg.com/i/1547/2025/06/68553c70c30b6.png","https://wmimg.com/i/1547/2025/06/68553c70882ce.jpg","https://wmimg.com/i/1547/2025/06/68553c708b3da.png","https://wmimg.com/i/1547/2025/06/68553c7108d3f.png","https://wmimg.com/i/1547/2025/06/68553c70dd7e9.png","https://wmimg.com/i/1547/2025/06/68553c70b8e98.png","https://wmimg.com/i/1547/2025/06/68553c70d740c.png","https://wmimg.com/i/1547/2025/06/68553c709272c.jpg","https://wmimg.com/i/1547/2025/06/68553c706a0ae.jpg","https://wmimg.com/i/1547/2025/06/68568a002d152.png","https://wmimg.com/i/1547/2025/06/68568a002dc09.png","https://wmimg.com/i/1547/2025/06/68568a03dde5b.png","https://wmimg.com/i/1547/2025/06/68568a03d96e6.png","https://wmimg.com/i/1547/2025/06/68568a03dfcfd.png","https://wmimg.com/i/1547/2025/06/68568a03df4e2.jpg","https://wmimg.com/i/1547/2025/06/68568a03e3aa3.png","https://wmimg.com/i/1547/2025/06/68568a0415e61.png","https://wmimg.com/i/1547/2025/06/68568a064ffce.png","https://wmimg.com/i/1547/2025/06/68568a06818b2.png","https://wmimg.com/i/1547/2025/06/68568a0a1b3d0.png","https://wmimg.com/i/1547/2025/06/6857e51383c97.png","https://wmimg.com/i/1547/2025/06/6857e515e5f30.png","https://wmimg.com/i/1547/2025/06/6857e5175a23e.png","https://wmimg.com/i/1547/2025/06/6857e51838c8c.png","https://wmimg.com/i/1547/2025/06/6857e5190dcba.png","https://wmimg.com/i/1547/2025/06/6857e51b9c559.png","https://wmimg.com/i/1547/2025/06/6857e51bdb484.png","https://wmimg.com/i/1547/2025/06/6857e520ba724.png","https://wmimg.com/i/1547/2025/06/6857e5219c037.jpg","https://wmimg.com/i/1547/2025/06/6857e5220e7cc.png","https://wmimg.com/i/1547/2025/06/6857e52267cb2.png","https://wmimg.com/i/1547/2025/06/6857e5229b3fb.png","https://wmimg.com/i/1547/2025/06/6857e5238c110.png","https://wmimg.com/i/1547/2025/06/6857e523cf940.png","https://wmimg.com/i/1547/2025/06/6857e5248d188.jpg","https://wmimg.com/i/1547/2025/06/6857e5268484a.png","https://wmimg.com/i/1547/2025/06/6857e526ea309.png","https://wmimg.com/i/1547/2025/06/6857e52a27843.png","https://wmimg.com/i/1547/2025/06/6857e529e5b1b.png","https://wmimg.com/i/1547/2025/06/6857e52ab95b7.png","https://wmimg.com/i/1547/2025/06/6857e52b62ed1.png","https://wmimg.com/i/1547/2025/06/6857e52c467fb.png","https://wmimg.com/i/1547/2025/06/6857e52d63ae9.png","https://wmimg.com/i/1547/2025/06/6857e52de6146.png","https://wmimg.com/i/1547/2025/06/6857e52dc60be.png","https://wmimg.com/i/1547/2025/06/6857e52ede6ff.png","https://wmimg.com/i/1547/2025/06/6857e52fd3c59.png","https://wmimg.com/i/1547/2025/06/6857e53037102.png","https://wmimg.com/i/1547/2025/06/6857e5307699f.jpg","https://wmimg.com/i/1547/2025/06/6857e5314b1e3.png","https://wmimg.com/i/1547/2025/06/6857e5330f863.png","https://wmimg.com/i/1547/2025/06/6857e533614a2.png","https://wmimg.com/i/1547/2025/06/6857e533d3a3b.png","https://wmimg.com/i/1547/2025/06/6857e534cb9ef.png","https://wmimg.com/i/1547/2025/06/6857e5741af04.png"]).slice(0,5)),v=R(()=>{const U=ie.tz();return U<c?`活动将于 ${c.format("M月D日H点")} 开始`:U>m?"投票已经结束！":`投票正在进行！将于${m.format("M月D日H点")}结束。（${g.value}）`}),g=R(()=>{const U=ie.tz(),B=m.diff(U,"hour"),P=m.diff(U,"minute")-60*B;return`剩余${B}小时${P}分钟`}),o=re(),i=te(),f=_(),d=R(()=>In.filter(U=>w.includes(U.id))),h=_(null),T=R(()=>i.userCustom.emojiWhiteBack?"#FFFFFF":void 0);function D(U){U===0?C():(s.value=[],u(U))}const{loading:$,data:s,send:u,onSuccess:y}=ue(U=>hn(U),{immediate:!1,initialData:[]}),{loading:b,data:z,send:C}=ue(kn,{immediate:!1,initialData:[]});o.binggan&&C();function I(U){return U.reduce((B,P)=>(B+=P.votes_num_total,B),0)}function N(U,B){let P=0;const A=ie.tz();A>c&&(P=1),A>m&&(P=2),h?.value?.show({emojiUrl:U.emojis[B.emoji_id],emojiGroupId:U.id,emojiId:B.emoji_id,voteNum:B.votes_num_total,endFlag:P})}function q(U){C(),D(U)}return(U,B)=>{const P=lt("router-link");return r(),k(e(x),{vertical:"",size:[12,12]},{default:t(()=>[l(e(dl),{"show-arrow":"",trigger:e(i).isMobile?"click":"hover",autoplay:"",interval:1e4},{default:t(()=>[(r(!0),O(ee,null,me(p.value,A=>(r(),O("img",{src:A,class:"carousel-img"},null,8,Au))),256))]),_:1},8,["trigger"]),l(e(It),{"show-icon":!1,type:"warning"},{default:t(()=>[B[2]||(B[2]=S("span",null,"（new!）本次活动新增版头应援活动喔！",-1)),l(P,{to:"/thread/153992"},{default:t(()=>[...B[1]||(B[1]=[a("点击这里参与",-1)])]),_:1})]),_:1}),l(e(It),{"show-icon":!1,type:"default"},{default:t(()=>[a(j(v.value),1)]),_:1}),l(e(Pt),{type:"line",animated:"",placement:"left",size:e(i).isMobile?"small":"large",value:f.value,"onUpdate:value":[B[0]||(B[0]=A=>f.value=A),D]},{default:t(()=>[(r(),k(e(Je),{key:0,name:0,tab:"我的本命"},{default:t(()=>[S("div",null,[l(e(It),{"show-icon":!1,type:"default"},{default:t(()=>[...B[3]||(B[3]=[a(" 自己票数最多的“角色”为“⭐我的本命”，如该角色夺冠将获得特殊成就哦！ ",-1),S("br",null,null,-1),a("注：这里的表情包图片只是用来代表该角色，不是你投票最多的图片。 ",-1)])]),_:1})]),l(e(Ge),{show:e(b),style:{height:"120px"}},{default:t(()=>[l(e(x),{wrap:!0,size:[4,4],style:{"margin-top":"12px"}},{default:t(()=>[(r(!0),O(ee,null,me(e(z),(A,W)=>(r(),k(e(x),{key:W,style:{width:"72px",height:"120px"},vertical:"",align:"center",justify:"end",size:[0,4]},{default:t(()=>[S("img",{src:n[A.emoji_group_id].emojiUrl,style:{"max-width":"100%"},class:"emoji-moe-img"},null,8,Ru),S("span",null,j(W==0?"⭐":"")+" "+j(n[A.emoji_group_id].name),1),S("span",null,j(A.votes_num_total||""),1)]),_:2},1024))),128)),e(z).length===0?(r(),O("span",Bu,"你的投票记录将会显示在这里。")):L("",!0)]),_:1})]),_:1},8,["show"])]),_:1})),(r(!0),O(ee,null,me(d.value,(A,W)=>(r(),k(e(Je),{key:W+1,name:A.id,tab:A.name},{default:t(()=>[l(e(Ge),{show:e($),style:{height:"400px"}},{default:t(()=>[l(e(x),{style:{"margin-top":"12px"},align:"center"},{default:t(()=>[S("span",null,j(A.name)+" 总票数： "+j(I(e(s))),1),l(e(E),{type:"primary",style:{"margin-left":"auto"},onClick:J=>D(A.id)},{default:t(()=>[...B[4]||(B[4]=[a("刷新",-1)])]),_:1},8,["onClick"])]),_:2},1024),l(e(x),{wrap:!0,size:[8,4],style:{"margin-top":"12px"}},{default:t(()=>[(r(!0),O(ee,null,me(e(s),(J,pe)=>(r(),k(e(x),{key:A.id*1e3+J.emoji_id,class:"emoji-moe-box",vertical:"",align:"center",size:[0,4],onClick:Re=>N(A,J)},{default:t(()=>[S("img",{src:A.emojis[J.emoji_id],style:{"max-width":"100%","max-height":"100%"},class:"emoji-moe-img"},null,8,Ou),S("span",null,j(J.votes_num_total||""),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1032,["show"])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["size","value"]),l(Hu,{ref_key:"VoteModalCom",ref:h,onRefreshMoeData:q},null,512)]),_:1})}}}),Nu=$e(Eu,[["__scopeId","data-v-c7687dde"]]),ar=Object.freeze(Object.defineProperty({__proto__:null,default:Nu},Symbol.toStringTag,{value:"Module"}));export{tr as A,ar as E,Xu as F,Ju as H,lr as L,Zu as N,Qu as T,er as U,Yu as _,Ku as a};
