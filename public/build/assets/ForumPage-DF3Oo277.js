import{w as Z,l as D,b as ee,u as he,d as N,c as _e,U as te,A as i,M as f,f as s,F as w,Q as j,C as G,a as e,k as h,i as ge,H as a,j as k,m as A,z as l,s as u,G as b,n as y,h as U,R as se,O as ae,_ as oe,o as ye,$ as I,p as W,q as K,r as ve,t as be,g as we,v as X,N as ke,x as Ce,S,y as B,B as Ie}from"./app-B2drsNOL.js";import{u as Se,t as Y}from"./forums-CePljDen.js";import{u as Te,S as $e,_ as xe,a as Le,b as Ne}from"./LoudspeakerComponent.vue_vue_type_style_index_0_lang-DHxkSPeU.js";import{d as ze,s as Fe,u as Me}from"./showDialog-Cw8f8jnG.js";import{_ as Pe}from"./loudspeaker-m62Yo0KA.js";import{N as re,a as Re}from"./Skeleton-BweStD4V.js";import{_ as qe}from"./FInput.vue_vue_type_script_setup_true_lang-Bol_oO2v.js";import{s as E}from"./subtitles-DW7M559j.js";import{N as Oe}from"./Ellipsis-BqG_uPAi.js";import{N as Ue}from"./Tag-BtYqZA-s.js";import"./Spin-CzMpsNM8.js";import"./Pagination-BNTe2wqJ.js";import"./use-locale-BJdz_TnG.js";import"./prop-DfVitj0l.js";import"./Input-L1FXtgKl.js";import"./Select-CJ12f3RA.js";import"./_createCompounder-DYhEc9fo.js";import"./use-houdini-e1es8r-l.js";const We=p=>(se("data-v-9f1bc30a"),p=p(),ae(),p),Be=We(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),Ee={key:0},je=Z({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(p,{emit:T}){D(c=>({73130296:e(_).hoverColor,"46c230e6":e(m).isMobile?"0.75rem":"0.875rem","0ab23be9":e(_).textColor1}));const m=ee(),_=he(),C=T,z=N(()=>({paddingBottom:m.isMobile?"6px":""})),v=Te({}).data,{loading:$,send:F,onSuccess:M}=_e(c=>ze(c),{immediate:!1});M(()=>{C("withdrawDelayThreadSuccess")});function x(c){Fe({title:"要撤回延时主题吗？",onPositiveClick:()=>{F(c)}})}return(c,H)=>{const L=te("router-link");return c.showThis?(i(),f(e(h),{key:0,vertical:"",size:2},{default:s(()=>[(i(!0),w(G,null,j(c.threadsListData,t=>(i(),f(e(ge),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":z.value,hoverable:""},{default:s(()=>[a(e(h),{vertical:""},{default:s(()=>[k("div",{style:A({color:t.title_color&&!e(m).userCustom.monochromeMode?t.title_color:e(_).textColor1}),class:"thread-title"},[l(u(t.sub_title)+" ",1),a(L,{to:{name:"thread",params:{threadId:t.id}},style:A({color:t.title_color&&!e(m).userCustom.monochromeMode?t.title_color:e(_).textColor1,pointerEvents:t.is_delay?"none":void 0}),target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(u(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(i(),f(L,{key:0,to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+u(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):b("",!0),e(v)[t.id]?(i(),f(e(y),{key:1,size:"tiny",type:"primary",onClick:g=>c.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(v)[t.id].floor+1)/200)},hash:"#f_"+e(v)[t.id].floor})},{default:s(()=>{var g;return[l(" ["+u((g=e(v)[t.id])==null?void 0:g.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):b("",!0),t.is_your_thread?(i(),f(e(y),{key:2,size:"tiny",type:"warning",disabled:e($),onClick:g=>x(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):b("",!0)],4),a(e(h),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+u(t.updated_at),1)]),k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+u(t.nickname),1)]),Be,l(" "+u(t.posts_num>1200?"🔥":"")+" "+u(t.vote_question_id?"🗳️":"")+" "+u(t.gamble_question_id?"🎲":"")+" "+u(t.crowd_id?"💰":"")+" "+u(t.hongbao_id?"🧧":"")+" ",1),t.locked_by_coin>0?(i(),w("span",Ee,"🔒"+u(t.locked_by_coin),1)):b("",!0),k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+u(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(i(),f(e(h),{key:1,vertical:"",size:2},{default:s(()=>[(i(),w(G,null,j(50,t=>a(e(re),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Ge=oe(je,[["__scopeId","data-v-9f1bc30a"]]),le=p=>(se("data-v-8897430a"),p=p(),ae(),p),Ae={key:0,class:"carousel-box"},He={key:0,class:"carousel-box"},Qe=["src"],Ve=le(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),Je=le(()=>k("div",{style:{height:"50px"}},null,-1)),Ke=Z({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(p){D(o=>({"163596af":e(m).bannerHeight}));const T=ye(),m=ee(),_=Se(),C=we(),z=I(null);I(),Me();const r=p,v=W("banner_hiden",!1),$=W("new_window_to_post",!1);function F(){return S(h,{style:"padding:6px 8px",vertical:!0},()=>[S(B,{checked:v.value,"onUpdate:checked":o=>v.value=o,label:"隐藏版头"}),S(B,{checked:$.value,"onUpdate:checked":o=>$.value=o,label:"新窗口打开"})])}const M=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:F}],x=W("subtitles_included",E),c=N(()=>E.filter(o=>!x.value.includes(o)));function H(){return S(Ie,{value:x.value,"onUpdate:value":o=>x.value=o},()=>[S(h,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(E).map(o=>S(B,{value:o,label:o}))])])}const L=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:H}],t=I(r.search),g=I(!!r.search);K(t,o=>{Ne(()=>C.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:o||void 0}}))()});function ne(){C.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ie(){t.value=void 0,g.value=!1}function ue(){C.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=I(r.page);function de(o){C.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}K(()=>r.page,o=>P.value=o);const Q=N(()=>({forumId:r.forumId,binggan:T.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:c.value,searchTitle:r.search,delay:r.delay})),{loading:R,data:q}=ve(()=>Y(Q.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,c],{initialData:[],immediate:!0}),V=I(!1),{fetching:Xe,onSuccess:ce,fetch:pe}=be();function J(o=!1){V.value=o,pe(Y(Q.value))}ce(()=>{V.value&&window.$message.success("已刷新数据")});const me=N(()=>{if(R.value)return[];if(T.userData.binggan.use_pingbici){const o=m.userCustom.pingbiciIngnoreCase?"gi":"g";return q.value.threads_data.data.filter(n=>{for(let O of T.userData.pingbici.title_pingbici)if(new RegExp(O,o).test(n.title))return!1;return!0})}else return q.value.threads_data.data});return(o,n)=>{const O=te("router-link");return i(),f(e(h),{vertical:""},{default:s(()=>[e(v)?b("",!0):(i(),w("div",Ae,[e(_).forumsDataLoading?(i(),w("div",He,[a(e(re),{class:"carousel-skeleton",sharp:""})])):b("",!0),e(_).forumsDataLoading?b("",!0):(i(),f(e(Re),{key:1,"show-arrow":"",trigger:"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(i(!0),w(G,null,j((d=e(_).forumData(o.forumId))==null?void 0:d.banners,fe=>(i(),w("img",{src:fe,class:"carousel-img"},null,8,Qe))),256))]}),_:1}))])),a(e(h),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(X),{trigger:"hover",options:M,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1}),a(e(X),{trigger:"hover",options:L,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1}),a(e(ke),{size:e(m).isMobile?28:34},{default:s(()=>[a(e($e),{style:{cursor:"pointer"},onClick:n[0]||(n[0]=d=>g.value=!g.value)})]),_:1},8,["size"]),Ve,a(e(y),{type:"primary",onClick:n[1]||(n[1]=d=>o.$router.push({name:"loudspeaker"}))},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:n[2]||(n[2]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),g.value?(i(),f(e(h),{key:1,wrap:!1},{default:s(()=>[a(e(qe),{value:t.value,"onUpdate:value":n[3]||(n[3]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":""},null,8,["value"]),a(e(y),{type:"primary",onClick:ne},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:ie},{default:s(()=>[l("清空")]),_:1})]),_:1})):b("",!0),a(xe),a(Ge,{"threads-list-data":me.value,"new-window-to-post":e($),"show-this":!e(R),onWithdrawDelayThreadSuccess:J},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(h),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:ue},{default:s(()=>[l(u(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Pe,{page:P.value,"onUpdate:page":[n[4]||(n[4]=d=>P.value=d),de],"last-page":e(R)?1:e(q).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Je,(i(),f(Ce,{to:"#topbar-nav"},[a(O,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Oe),{style:A({maxWidth:e(m).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(u((d=e(_).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(Ue),{round:"",class:"forum-tag",size:e(m).isMobile?"small":"medium"},{default:s(()=>[l(u(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(Le,{mode:"forum",ref_key:"SidebarCom",ref:z,onRefresh:n[5]||(n[5]=d=>J(!0)),onNewThread:n[6]||(n[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),ht=oe(Ke,[["__scopeId","data-v-8897430a"]]);export{ht as default};
