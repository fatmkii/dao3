import{w as Q,b as X,$ as d,g as ce,A as D,M as W,o as a,H as t,m as e,s as j,z as o,t as J,v as le,y as N,at as he,D as F,E as ie,I as de,F as Z,J as Y,an as Ge,B as ve,x as ue,al as Se,aX as be,T as Ue,W as Le,R as Ee,b2 as He,aU as Be,aY as Ke,aV as Te,aB as qe,Q as _e,_ as me,b3 as We,b0 as Ae,b1 as Je,S as ge,n as Pe,N as ae,a_ as Qe,a$ as Ze,r as et,ak as tt,u as at,X as Re,aM as lt,C as re,b4 as nt,b5 as ot,b6 as st,aW as ut,b7 as it,b8 as rt,p as dt,b9 as ct}from"./vendor-DQqxAeCv.js";import{u as te,a as ne,b as O,e as E,c as ee,g as Oe,w as vt,p as mt,r as je,d as Ie}from"./app-CvEUHSZB.js";import{s as ft}from"./showDialog-D6khvXZG.js";import{b as pt,c as gt,d as De,e as ht,g as bt,f as _t,i as wt,_ as yt}from"./emojiData-Dr9ILPKe.js";import{i as Xe,a as Ve}from"./inputNumberFormat-DaYmlx6U.js";const Ct=Q({__name:"RollModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:P}){const H=te(),n=ne(),C=B,z=X(()=>{let x=[];if(s.value>0&&g.value>0){for(var k=0;k<s.value;k++)x[k]=Math.floor(Math.random()*g.value)+1;return x.join()}else return null}),S=d(),h=d(),s=d(1),g=d(100),f=d(!1);function M(){f.value=!0}U({show:M});const b=P,{loading:l,send:c,onSuccess:w}=ce(x=>pt(x),{immediate:!1});function $(){if(!s.value){window.$message.error("请填写骰子数量");return}if(!g.value){window.$message.error("请填写骰子数量");return}const x={binggan:n.binggan,thread_id:C.threadId,forum_id:C.forumId,roll_name:S.value,roll_event:h.value,roll_num:s.value,roll_range:g.value};c(x)}return w(()=>{b("refreshPostsList"),f.value=!1}),(x,k)=>(D(),W(e(de),{show:f.value,"onUpdate:show":k[6]||(k[6]=u=>f.value=u),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"Roll点",closable:"",onClose:k[5]||(k[5]=u=>f.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:$,disabled:e(l)},{default:a(()=>[o("Roll it!")]),_:1},8,["disabled"]),t(e(O),{onClick:k[4]||(k[4]=u=>f.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(J),null,{default:a(()=>[o(" 输出参考： ")]),_:1}),t(e(J),null,{default:a(()=>[o(le(S.value?`「${S.value}」，`:"")+" "+le(h.value?`「${h.value}」的结果：`:"")+" "+le(`${s.value} d ${g.value} = 「${z.value}」`),1)]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("Roll点昵称")]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:S.value,"onUpdate:value":k[0]||(k[0]=u=>S.value=u)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("Roll点事件")]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:h.value,"onUpdate:value":k[1]||(k[1]=u=>h.value=u)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("骰子数量")]),_:1}),t(e(he),{max:100,min:1,placeholder:"必须填写",value:s.value,"onUpdate:value":k[2]||(k[2]=u=>s.value=u)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("骰子大小")]),_:1}),t(e(he),{max:1e4,min:1,placeholder:"必须填写",value:g.value,"onUpdate:value":k[3]||(k[3]=u=>g.value=u)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),kt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},It=Y("defs",null,null,-1),xt=Y("path",{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92c-19.1.1-36.8-5.4-52-15l-54 55c29.1 22.4 65.9 36 106 36c93.8 0 170-75.1 170-168z",fill:"currentColor"},null,-1),Mt=Y("path",{d:"M833 446h-60c-4.4 0-8 3.6-8 8c0 140.3-113.7 254-254 254c-63 0-120.7-23-165-61l-54 54c48.9 43.2 110.8 72.3 179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328c0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9c-3.1-3-8.1-3-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68c-10.5-27.9-16.3-58.2-16.2-89.8c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8c0 53 12.5 103 34.6 147.4l-137 137c-3.1 3.1-3.1 8.2 0 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92c46 0 84.1 32.3 92.3 74.7L417 401z",fill:"currentColor"},null,-1),$t=[It,xt,Mt],zt=Q({name:"AudioMutedOutlined",render:function(U,P){return D(),Z("svg",kt,$t)}}),Tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Dt=Y("path",{d:"M911.5 700.7a8 8 0 0 0-10.3-4.8L840 718.2V180c0-37.6-30.4-68-68-68H252c-37.6 0-68 30.4-68 68v538.2l-61.3-22.3c-.9-.3-1.8-.5-2.7-.5c-4.4 0-8 3.6-8 8V763c0 3.3 2.1 6.3 5.3 7.5L501 910.1c7.1 2.6 14.8 2.6 21.9 0l383.8-139.5c3.2-1.2 5.3-4.2 5.3-7.5v-59.6c0-1-.2-1.9-.5-2.8zM512 837.5l-256-93.1V184h512v560.4l-256 93.1zM660.6 312h-54.5c-3 0-5.8 1.7-7.1 4.4l-84.7 168.8H511l-84.7-168.8a8 8 0 0 0-7.1-4.4h-55.7c-1.3 0-2.6.3-3.8 1c-3.9 2.1-5.3 7-3.2 10.8l103.9 191.6h-57c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76v39h-76c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76V704c0 4.4 3.6 8 8 8h49.9c4.4 0 8-3.6 8-8v-63.5h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8h-76.3v-39h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8H564l103.7-191.6c.6-1.2 1-2.5 1-3.8c-.1-4.3-3.7-7.9-8.1-7.9z",fill:"currentColor"},null,-1),Ht=[Dt],St=Q({name:"MoneyCollectOutlined",render:function(U,P){return D(),Z("svg",Tt,Ht)}}),Ne=()=>{const B=Oe.Get("api/captcha",{name:"postGetter",params:{},localCache:null,hitSource:[]});return B.meta={shouldRemind:!1},B},Ye=B=>{const U=new FormData;U.append("file",B.file),U.append("mode",B.mode),U.append("binggan",B.binggan),U.append("thread_id",String(B.thread_id)),U.append("forum_id",String(B.forum_id));const P=Oe.Post("api/img_upload",U,{name:"uploadImagePoster",params:{},localCache:null,hitSource:[]});return P.meta={shouldRemind:!0},P},Ut=["src"],Lt=Q({__name:"CaptchaModal",emits:["waterUnlockOnSuccess"],setup(B,{expose:U,emit:P}){const H=te(),n=ne(),C=d(),z=X(()=>g.value.captcha_key),S=d(!1);function h(){S.value=!0,M()}U({show:h});const s=P,{data:g,loading:f,send:M}=ce(Ne,{immediate:!1}),{fetch:b}=Ge();function l(){b(Ne())}const{loading:c,send:w,onSuccess:$,onError:x}=ce(u=>vt(u),{immediate:!1});function k(){if(!C.value){window.$message.error("验证码不能为空");return}const u={binggan:n.binggan,captcha_code:C.value,captcha_key:z.value};w(u),$(()=>{C.value="",S.value=!1,s("waterUnlockOnSuccess")}),x(()=>{C.value="",l()})}return(u,p)=>(D(),W(e(de),{show:S.value,"onUpdate:show":p[3]||(p[3]=I=>S.value=I),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"验证码",closable:"",onClose:p[2]||(p[2]=I=>S.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:k,loading:e(c),disabled:e(c)},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"]),t(e(O),{onClick:p[1]||(p[1]=I=>S.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(J),null,{default:a(()=>[o(" 嗷……你可能刷太多了，休息一下吧。 ")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"},class:"round"},{default:a(()=>[o("输入")]),_:1}),t(e(ee),{placeholder:"请输入验证码",maxlength:"4","show-count":"",value:C.value,"onUpdate:value":p[0]||(p[0]=I=>C.value=I),onKeyup:ve(k,["enter"])},null,8,["value"])]),_:1}),e(f)?ue("",!0):(D(),Z("img",{key:0,src:"data:image/png;base64,"+e(g).captcha_img,style:{"max-width":"200px"},onClick:l},null,8,Ut)),t(e(J),null,{default:a(()=>[o(" 点击可更换验证码。不区分大小写。 ")]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Bt=Q({__name:"BattleModal",props:{threadId:{},forumId:{},randomHeadsGroup:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:P}){const H=te(),n=ne(),C=d(null),z=B,S=X(()=>{const u=[{value:1,label:"共通",available:!0}];return gt.forEach(p=>{p.value===z.randomHeadsGroup&&u.push(p)}),u}),h=X(()=>{const u=De[g.value-1];if(g.value===1){const p=n.userData.my_battle_chara.filter(I=>!I.not_use).map((I,G)=>({value:G+240,label:I.name}));return u.concat(p)}else return u}),s=d(1),g=d(z.randomHeadsGroup),f=d(100);Se(g,u=>{u===1?s.value=De[u-1][8].value:s.value=De[u-1][0].value},{immediate:!0});const{loading:M,send:b,onSuccess:l,onError:c}=ce(u=>ht(u),{immediate:!1});function w(u){var K;const{timestamp:p,newPostKey:I}=bt((K=u==null?void 0:u.isTrusted)!=null?K:!0,z.threadId,n.binggan),G={binggan:n.binggan,forum_id:z.forumId,thread_id:z.threadId,battle_olo:f.value,chara_id:s.value>=240?s.value-240:s.value,is_custom_chara:s.value>=240,chara_group:g.value-1,new_post_key:I,timestamp:p};b(G)}l(()=>{k("refreshPostsList"),$.value=!1}),c(u=>{var p;u.error.cause!==void 0&&u.error.cause.code===244291&&((p=C.value)==null||p.show())});const $=d(!1);function x(){$.value=!0}U({show:x});const k=P;return(u,p)=>(D(),W(e(de),{show:$.value,"onUpdate:show":p[5]||(p[5]=I=>$.value=I),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"表情包大乱斗！",closable:"",onClose:p[4]||(p[4]=I=>$.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:w,loading:e(M)},{default:a(()=>[o("提交")]),_:1},8,["loading"]),t(e(O),{onClick:p[3]||(p[3]=I=>$.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(J),null,{default:a(()=>[o("小斗怡情，大斗伤身，强斗奥飞湮灭")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("主题")]),_:1}),t(e(be),{value:g.value,"onUpdate:value":p[0]||(p[0]=I=>g.value=I),options:S.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("角色")]),_:1}),t(e(be),{value:s.value,"onUpdate:value":p[1]||(p[1]=I=>s.value=I),options:h.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("下注")]),_:1}),t(e(he),{value:f.value,"onUpdate:value":p[2]||(p[2]=I=>f.value=I),max:1e6,min:1,step:100,parse:e(Xe),format:e(Ve),onKeyup:ve(w,["enter"])},null,8,["value","parse","format"])]),_:1})]),_:1}),t(Lt,{ref_key:"CaptchaModalCom",ref:C,onWaterUnlockOnSuccess:w},null,512)]),_:1},8,["style"])]),_:1},8,["show"]))}}),At=Q({__name:"CodeModal",emits:["insertCode"],setup(B,{expose:U,emit:P}){const H=te(),n=d(0),C=d(),z=d(),S=[{value:0,label:"折叠内容"},{value:1,label:"超链接"},{value:2,label:"图片"}],h=X(()=>[{prepend_1:"显示内容",prepend_2:"隐藏内容",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"显示内容",inputDefault_2:"隐藏内容",insertText:`<details><summary>${C.value}</summary>${z.value}</details>`},{prepend_1:"显示文字",prepend_2:"链接网址",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"点我跳转",inputDefault_2:"",insertText:`<a href="${z.value}">${C.value}</a>`},{prepend_1:"图片链接",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<img src="${C.value}">`}]);Se(n,()=>{C.value=h.value[n.value].inputDefault_1,z.value=h.value[n.value].inputDefault_2},{immediate:!0});function s(){M("insertCode",h.value[n.value].insertText),C.value=h.value[n.value].inputDefault_1,z.value=h.value[n.value].inputDefault_2,g.value=!1}const g=d(!1);function f(){g.value=!0}U({show:f});const M=P;return(b,l)=>(D(),W(e(de),{show:g.value,"onUpdate:show":l[5]||(l[5]=c=>g.value=c),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"快捷代码",closable:"",onClose:l[4]||(l[4]=c=>g.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:s},{default:a(()=>[o("插入")]),_:1}),t(e(O),{onClick:l[3]||(l[3]=c=>g.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(J),null,{default:a(()=>[o("代码预览：")]),_:1}),t(e(J),null,{default:a(()=>[o(le(h.value[n.value].insertText),1)]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("代码内容")]),_:1}),t(e(be),{value:n.value,"onUpdate:value":l[0]||(l[0]=c=>n.value=c),options:S},null,8,["value"])]),_:1}),Ue(t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o(le(h.value[n.value].prepend_1),1)]),_:1}),t(e(ee),{value:C.value,"onUpdate:value":l[1]||(l[1]=c=>C.value=c),onKeyup:ve(s,["enter"])},null,8,["value"])]),_:1},512),[[Le,h.value[n.value].inputEnable_1]]),Ue(t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o(le(h.value[n.value].prepend_2),1)]),_:1}),t(e(ee),{value:z.value,"onUpdate:value":l[2]||(l[2]=c=>z.value=c),onKeyup:ve(s,["enter"])},null,8,["value"])]),_:1},512),[[Le,h.value[n.value].inputEnable_2]])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Pt=["width","height"],Rt=["width","height"],jt=Y("div",null,"颜色",-1),Nt=Y("div",null,"画笔",-1),Et=["onClick"],Wt=Y("div",null,"操作",-1),Ot=["title","innerHTML","onClick"],Xt=Q({__name:"DrawerModal",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(B,{expose:U,emit:P}){const H=ne();te();const n=B,C=d(!1);function z(){C.value=!0}U({show:z});const S=P,h=d(),s=X(()=>{var i;return(i=h.value)==null?void 0:i.getContext("2d")}),g=d(),f=X(()=>{var i;return(i=g.value)==null?void 0:i.getContext("2d")}),M=new Image;let b=!1;const l={x:0,y:0,width:0,height:0},c=d([]),w=d([]),$=d([]),x=d({lineWidth:3,lineColor:"#111111",shadowBlur:1}),k=d(!1),u=d(!1);let p=0,I=0;const G=X(()=>window.innerWidth>836?796:window.innerWidth-36),K=X(()=>window.innerHeight>580?400:window.innerHeight-212),q=X(()=>[{title:"上一步",action:"prev",className:c.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>'},{title:"下一步",action:"next",className:w.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>'},{title:"橡皮擦",action:"eraser",className:c.value.length||w.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/></svg>'},{title:"清除",action:"clear",className:c.value.length||w.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/></svg>'},{title:"拖动背景",action:"drag",className:u.value?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor"  viewBox="0 0 16 16"> <path d="M6.75 1a.75.75 0 0 1 .75.75V8a.5.5 0 0 0 1 0V5.467l.086-.004c.317-.012.637-.008.816.027.134.027.294.096.448.182.077.042.15.147.15.314V8a.5.5 0 1 0 1 0V6.435a4.9 4.9 0 0 1 .106-.01c.316-.024.584-.01.708.04.118.046.3.207.486.43.081.096.15.19.2.259V8.5a.5.5 0 0 0 1 0v-1h.342a1 1 0 0 1 .995 1.1l-.271 2.715a2.5 2.5 0 0 1-.317.991l-1.395 2.442a.5.5 0 0 1-.434.252H6.035a.5.5 0 0 1-.416-.223l-1.433-2.15a1.5 1.5 0 0 1-.243-.666l-.345-3.105a.5.5 0 0 1 .399-.546L5 8.11V9a.5.5 0 0 0 1 0V1.75A.75.75 0 0 1 6.75 1zM8.5 4.466V1.75a1.75 1.75 0 1 0-3.5 0v5.34l-1.2.24a1.5 1.5 0 0 0-1.196 1.636l.345 3.106a2.5 2.5 0 0 0 .405 1.11l1.433 2.15A1.5 1.5 0 0 0 6.035 16h6.385a1.5 1.5 0 0 0 1.302-.756l1.395-2.441a3.5 3.5 0 0 0 .444-1.389l.271-2.715a2 2 0 0 0-1.99-2.199h-.581a5.114 5.114 0 0 0-.195-.248c-.191-.229-.51-.568-.88-.716-.364-.146-.846-.132-1.158-.108l-.132.012a1.26 1.26 0 0 0-.56-.642 2.632 2.632 0 0 0-.738-.288c-.31-.062-.739-.058-1.05-.046l-.048.002zm2.094 2.025z"/></svg>'}]),L=[{lineWidth:3,innerHTML:"🖌️",font_size:12},{lineWidth:6,innerHTML:"🖌️",font_size:16},{lineWidth:12,innerHTML:"🖌️",font_size:20}];function A(){const i=new ImageData(G.value,K.value);$.value.push(i)}Ee(()=>{A()});function fe(){s.value.lineWidth=x.value.lineWidth,s.value.shadowBlur=x.value.shadowBlur,s.value.shadowColor=x.value.lineColor,s.value.strokeStyle=x.value.lineColor,s.value.lineCap="round",s.value.lineJoin="round"}function we(i){if(b)if(u.value){const r=i.target;let _,y;i instanceof MouseEvent?(_=i.clientX-r.getBoundingClientRect().x,y=i.clientY-r.getBoundingClientRect().y):(_=i.changedTouches[0].clientX-r.getBoundingClientRect().x,y=i.changedTouches[0].clientY-r.getBoundingClientRect().y),g.value.height=g.value.height;let R={x:l.x+(_-p),y:l.y+(y-I),width:l.width,height:l.height};ke(M,R)}else{s.value.beginPath(),s.value.moveTo(p,I);const r=i.target;let _,y;i instanceof MouseEvent?(_=i.clientX-r.getBoundingClientRect().x,y=i.clientY-r.getBoundingClientRect().y):(_=i.changedTouches[0].clientX-r.getBoundingClientRect().x,y=i.changedTouches[0].clientY-r.getBoundingClientRect().y),s.value.globalCompositeOperation=k.value?"destination-out":"source-over",s.value.lineTo(_,y),[p,I]=[_,y],s.value.stroke()}}function ye(i){if(u.value){const r=i.target;let _,y;i instanceof MouseEvent?(_=i.clientX-r.getBoundingClientRect().x,y=i.clientY-r.getBoundingClientRect().y):(_=i.changedTouches[0].clientX-r.getBoundingClientRect().x,y=i.changedTouches[0].clientY-r.getBoundingClientRect().y),l.x+=_-p,l.y+=y-I,b=!1}else{const r=s.value.getImageData(0,0,h.value.width,h.value.height);w.value.length?($.value=[],$.value=$.value.concat(c.value),$.value.push(r),w.value=[]):$.value.push(r),b=!1}}function Ce(i){if(u.value){const r=i.target;let _,y;i instanceof MouseEvent?(_=i.clientX-r.getBoundingClientRect().x,y=i.clientY-r.getBoundingClientRect().y):(_=i.changedTouches[0].clientX-r.getBoundingClientRect().x,y=i.changedTouches[0].clientY-r.getBoundingClientRect().y),p=_,I=y,b=!0}else{b=!0;const r=i.target;let _,y;i instanceof MouseEvent?(_=i.clientX-r.getBoundingClientRect().x,y=i.clientY-r.getBoundingClientRect().y):(_=i.changedTouches[0].clientX-r.getBoundingClientRect().x,y=i.changedTouches[0].clientY-r.getBoundingClientRect().y),fe(),p=_,I=y;const R=s.value.getImageData(0,0,h.value.width,h.value.height);c.value.push(R)}}function pe(i){x.value.lineWidth=i,k.value=!1,u.value=!1}function xe(i){switch(i){case"prev":if(c.value.length){const r=c.value.pop(),_=$.value[c.value.length+1];w.value.push(_),s.value.putImageData(r,0,0)}break;case"next":if(w.value.length){const r=w.value.pop(),_=$.value[$.value.length-w.value.length-2];c.value.push(_),s.value.putImageData(r,0,0)}break;case"clear":s.value.clearRect(0,0,h.value.width,h.value.height),c.value=[],w.value=[],$.value=[$.value[0]];break;case"eraser":k.value=!0;break;case"drag":u.value=!0;break}}function oe(i){if(i.file.file){var r=new FileReader;r.readAsDataURL(i.file.file),r.onload=_=>{M.src=_.target.result,M.onload=function(){var y=g,R=M;l.width=R.width,l.height=R.height,R.width/R.height>=y.value.width/y.value.height?R.width>y.value.width&&(l.width=y.value.width,l.height=R.height*y.value.width/R.width):R.height>y.value.height&&(l.width=R.width*y.value.height/R.height,l.height=y.value.height),ke(R,l)}}}}function ke(i,r){f.value.drawImage(i,r.x,r.y,r.width,r.height)}const se=d(!1);function Me(){let i=new Image;i.src=h.value.toDataURL("image/png"),i.onload=()=>{f.value.drawImage(i,0,0),r(g.value)};function r(y){y.toBlob(R=>{R&&_(R)},"image/png")}function _(y){const R={binggan:H.binggan,file:y,mode:"img",thread_id:n.threadId,forum_id:n.forumId};se.value=!0,Ye(R).then($e=>{S("insertImage",$e.file_url),se.value=!1,C.value=!1}).catch(()=>{se.value=!1})}}return(i,r)=>(D(),W(e(de),{show:C.value,"onUpdate:show":r[5]||(r[5]=_=>C.value=_),"display-directive":"show"},{default:a(()=>[t(e(ie),{style:F({maxWidth:G.value+4+"px"}),title:"涂鸦板",closable:"",onClose:r[4]||(r[4]=_=>C.value=!1),size:"small","content-style":{padding:"0px"}},{default:a(()=>[Y("div",{id:"canvas-container",style:F({width:G.value+"px",height:K.value+"px"})},[Y("canvas",{id:"drawer-canvas-background",ref_key:"canvasBackground",ref:g,width:G.value,height:K.value,onTouchmove:r[0]||(r[0]=He(()=>{},["prevent"]))},null,40,Pt),Y("canvas",{id:"drawer-canvas",ref_key:"canvas",ref:h,class:Be({painting:!u.value,dragging:u.value}),width:G.value,height:K.value,onTouchmove:[r[1]||(r[1]=He(()=>{},["prevent"])),we],onMousedown:Ce,onMouseup:ye,onMousemove:we,onTouchstart:Ce,onTouchend:ye},null,42,Rt)],4),t(e(Ke),{"x-gap":"6",cols:4},{default:a(()=>[t(e(Te),{span:"1"},{default:a(()=>[jt,t(e(qe),{value:x.value.lineColor,"onUpdate:value":r[2]||(r[2]=_=>x.value.lineColor=_),modes:["hex"],"show-alpha":!1},null,8,["value"])]),_:1}),t(e(Te),{span:"1"},{default:a(()=>[Nt,t(e(j),{id:"canvas-brush",size:"small",align:"center"},{default:a(()=>[(D(),Z(me,null,_e(L,(_,y)=>Y("span",{key:y,style:F({fontSize:_.font_size+"px"}),onClick:R=>pe(_.lineWidth)},le(_.innerHTML),13,Et)),64))]),_:1})]),_:1}),t(e(Te),{span:"2"},{default:a(()=>[Wt,t(e(j),{id:"canvas-control",size:"small"},{default:a(()=>[(D(!0),Z(me,null,_e(q.value,(_,y)=>(D(),Z("span",{key:y,title:_.title,class:Be([_.className]),innerHTML:_.innerHTML,onClick:R=>xe(_.action)},null,10,Ot))),128))]),_:1})]),_:1})]),_:1})]),action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(We),{"default-upload":!1,onChange:oe,"show-file-list":!1},{default:a(()=>[t(e(O),null,{default:a(()=>[o("加载图片")]),_:1})]),_:1}),t(e(O),{type:"primary",onClick:Me,disabled:i.userIsLocked,loading:se.value},{default:a(()=>[o("上传")]),_:1},8,["disabled","loading"]),t(e(O),{onClick:r[3]||(r[3]=_=>C.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Vt=["onClick"],Yt=["src"],Ft=Q({__name:"EmojiTab",props:{randomHeadsGroup:{default:1},autoHide:{type:Boolean,default:!0}},emits:["appendEmoji"],setup(B,{emit:U}){const P=ne(),H=te(),n=B,C=X(()=>{let l=0,c=0;return H.isMobile&&(H.userCustom.sidebarLeft?l=20:c=20),{paddingLeft:l+"px",paddingRight:c+"px"}}),z=d(),S=X(()=>{const l=_t.filter(c=>!P.userData.emoji_excluded.includes(c.id)&&(c.headsId===0||c.headsId===n.randomHeadsGroup));return P.userData.my_emoji&&l.unshift({id:0,headsId:0,name:"自定义",emojis:P.userData.my_emoji}),l}),h=U;function s(l,c){h("appendEmoji",l,c==="自定义"),n.autoHide&&(z.value=-1)}let g=!1;function f(l,c){return ge("span",{onClick:()=>M(c),innerHTML:l})}function M(l){l===z.value&&(g=!0,z.value=-1)}function b(l,c){return g?(g=!1,!1):!0}return(l,c)=>(D(),W(e(Je),{type:"line","bar-width":0,animated:"",onBeforeLeave:b,size:e(H).isMobile?"small":"medium","default-value":-1,value:z.value,"onUpdate:value":c[0]||(c[0]=w=>z.value=w)},{default:a(()=>[(D(!0),Z(me,null,_e(S.value,(w,$,x)=>(D(),W(e(Ae),{name:w.id,tab:f(w.name,w.id)},{default:a(()=>[t(e(j),{size:"small",class:"emoji-container",style:F(C.value)},{default:a(()=>[(D(!0),Z(me,null,_e(w.emojis,(k,u,p)=>(D(),Z("div",{class:"emoji-box",onClick:I=>s(k,w.name)},[Y("img",{src:k,class:"emoji-in-box"},null,8,Yt)],8,Vt))),256))]),_:2},1032,["style"])]),_:2},1032,["name","tab"]))),256)),t(e(Ae),{name:-1,tab:"隐藏"})]),_:1},8,["size","value"]))}}),Gt=Q({__name:"HongbaoModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:P}){const H=te(),n=ne(),C=B,z=[{value:1,label:"口令红包 直接公开口令"},{value:2,label:"抢答红包 回复答对才公开口令"},{value:3,label:"暗号红包 抢完红包才公开口令"}],S=[{value:1,label:"随机olo"},{value:2,label:"定额olo"}],h=d(3e3),s=d(10),g=d(1),f=d(1),M=d(),b=d(),l=d([]),c=d(!1),w=d(1);function $(q){q===1&&w.value<5&&(w.value+=1),q===-1&&w.value>1&&(l.value.splice(w.value-1,1),w.value-=1)}const{loading:x,send:k,onSuccess:u}=ce(q=>wt(q),{immediate:!1});function p(){if(M.value===void 0){window.$message.error("必须填写“红包口令”喔");return}if(b.value===void 0&&[2,3].includes(f.value)){window.$message.error("抢答红包或者暗号红包时，必须填写“口令提示”喔");return}if(g.value===2&&h.value%s.value!==0){window.$message.error("选择定额红包时，总额要是红包数量的整倍数喔");return}const q={binggan:n.binggan,forum_id:C.forumId,thread_id:C.threadId,hongbao_olo:h.value,hongbao_num:s.value,type:g.value,key_word_type:f.value,hongbao_key_word:M.value,hongbao_question:b.value,hongbao_message_json:l.value,hongbao_olo_hide:c.value};k(q)}u(()=>{K("refreshPostsList"),I.value=!1});const I=d(!1);function G(){I.value=!0}U({show:G});const K=P;return(q,L)=>(D(),W(e(de),{show:I.value,"onUpdate:show":L[11]||(L[11]=A=>I.value=A),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"发起红包",closable:"",onClose:L[10]||(L[10]=A=>I.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:p,disabled:e(x),loading:e(x)},{default:a(()=>[o("提交")]),_:1},8,["disabled","loading"]),t(e(O),{onClick:L[9]||(L[9]=A=>I.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[Y("div",null,[t(e(J),{depth:3},{default:a(()=>[o("温馨提示：")]),_:1}),o("在红包总额以外，会追加扣除7%手续费。 ")]),Y("div",null,[t(e(J),{depth:3},{default:a(()=>[o("总共扣除：")]),_:1}),t(e(J),{type:"warning"},{default:a(()=>[o(le(Math.ceil(h.value*(e(H).isDouble11?1.02:1.07))),1)]),_:1}),o("个奥利奥 ")]),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包类型")]),_:1}),t(e(be),{value:f.value,"onUpdate:value":L[0]||(L[0]=A=>f.value=A),options:z},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("olo类型")]),_:1}),t(e(be),{value:g.value,"onUpdate:value":L[1]||(L[1]=A=>g.value=A),options:S},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包个数")]),_:1}),t(e(he),{value:s.value,"onUpdate:value":L[2]||(L[2]=A=>s.value=A),max:50,min:5,step:5},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("olo总额")]),_:1}),t(e(he),{value:h.value,"onUpdate:value":L[3]||(L[3]=A=>h.value=A),max:1e6,min:3e3,step:1e3,parse:e(Xe),format:e(Ve)},null,8,["value","parse","format"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包口令")]),_:1}),t(e(ee),{value:M.value,"onUpdate:value":L[4]||(L[4]=A=>M.value=A),placeholder:"必填"},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("口令提示")]),_:1}),t(e(ee),{value:b.value,"onUpdate:value":L[5]||(L[5]=A=>b.value=A),placeholder:"抢答红包或者暗号红包时，必填"},null,8,["value"])]),_:1}),(D(!0),Z(me,null,_e(w.value,A=>(D(),W(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("回复留言")]),_:1}),t(e(ee),{value:l.value[A-1],"onUpdate:value":fe=>l.value[A-1]=fe,placeholder:`#${A}（可选） 多个留言时随机抽取一个`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),t(e(j),{size:"small",align:"center"},{default:a(()=>[t(e(J),{depth:3},{default:a(()=>[o("留言数量")]),_:1}),t(e(Pe),{size:"tiny",circle:"",disabled:w.value===5,onClick:L[6]||(L[6]=A=>$(1))},{icon:a(()=>[t(e(ae),null,{default:a(()=>[t(e(Qe))]),_:1})]),_:1},8,["disabled"]),t(e(Pe),{size:"tiny",circle:"",disabled:w.value===1,onClick:L[7]||(L[7]=A=>{$(-1)})},{icon:a(()=>[t(e(ae),null,{default:a(()=>[t(e(Ze))]),_:1})]),_:1},8,["disabled"]),t(e(et),{checked:c.value,"onUpdate:checked":L[8]||(L[8]=A=>c.value=A),label:"隐藏olo总额",style:{"margin-left":"auto"}},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Kt=Q({__name:"ImageUpload",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(B,{emit:U}){const P=te(),H=ne(),n=d(null),C=B,z=U;function S(f){var M=document.getElementsByTagName("body")[0],b=document.createElement("script");b.setAttribute("id","image-upload-js");var l=document.getElementById("upload-button");f=="mjj"&&(b.setAttribute("async","true"),b.setAttribute("data-mode","manual"),b.setAttribute("src","https://mjj.today/sdk/pup.js"),b.setAttribute("data-url","https://mjj.today/upload"),b.setAttribute("data-auto-insert","html-embed"),l==null||l.setAttribute("data-chevereto-pup-trigger","")),f=="imgbb"&&(b.setAttribute("async","true"),b.setAttribute("data-mode","manual"),b.setAttribute("src","https://imgbb.com/upload.js"),b.setAttribute("data-url","https://imgbb.com/upload"),b.setAttribute("data-auto-insert","html-embed-medium"),l==null||l.setAttribute("data-imgbb-trigger","")),f=="freeimage"&&(b.setAttribute("async","true"),b.setAttribute("data-mode","manual"),b.setAttribute("src","https://freeimage.host/sdk/pup.js"),b.setAttribute("data-url","https://freeimage.host/upload"),b.setAttribute("data-auto-insert","html-embed-medium"),l==null||l.setAttribute("data-chevereto-pup-trigger","")),M.appendChild(b)}function h(){const f=document.getElementById("image-upload-js");f==null||f.remove()}Ee(()=>{S(P.userCustom.imgHost)}),tt(()=>{h()});const s=d(!1),g=({file:f,data:M,headers:b,withCredentials:l,action:c,onFinish:w,onError:$,onProgress:x})=>{var k;if(f.file!==null){if(f.file.size>1024e3){window.$message.error("图片大小不能超过10M喔"),(k=n.value)==null||k.clear();return}const u={binggan:H.binggan,file:f.file,mode:"img",thread_id:C.threadId,forum_id:C.forumId};s.value=!0,Ye(u).then(p=>{var I;z("insertImage",p.file_url),(I=n.value)==null||I.clear(),s.value=!1}).catch(()=>{var p;(p=n.value)==null||p.clear(),s.value=!1})}};return(f,M)=>f.forumId===419?(D(),W(e(We),{key:0,accept:"image/*",action:"/api/img_upload","custom-request":g,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:n},{default:a(()=>[t(e(O),{style:{"margin-right":"auto"},disabled:f.userIsLocked,loading:s.value},{default:a(()=>[o("上传图片")]),_:1},8,["disabled","loading"])]),_:1},512)):(D(),W(e(O),{key:1,style:{"margin-right":"auto"},disabled:f.userIsLocked,"data-target":"#content-input",id:"upload-button"},{default:a(()=>[o("上传图片")]),_:1},8,["disabled"]))}}),qt=Q({__name:"PingbiciModal",setup(B,{expose:U}){const P=te(),H=ne(),n=d(),{loading:C,send:z,onSuccess:S}=ce(f=>mt(f),{immediate:!1});function h(){if(!n.value){window.$message.error("请填写屏蔽词");return}const f={binggan:H.binggan,content_pingbici:n.value};z(f)}S(()=>{H.refreshUserData(),s.value=!1});const s=d(!1);function g(){s.value=!0}return U({show:g}),(f,M)=>(D(),W(e(de),{show:s.value,"onUpdate:show":M[3]||(M[3]=b=>s.value=b),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(P).modalMaxWidth}),title:"追加屏蔽词",closable:"",onClose:M[2]||(M[2]=b=>s.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:h,loading:e(C),disabled:!n.value||e(C)},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"]),t(e(O),{onClick:M[1]||(M[1]=b=>s.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(J),null,{default:a(()=>[o("暂时只做了“内容屏蔽词”的追加")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"4.2rem"}},{default:a(()=>[o("屏蔽词")]),_:1}),t(e(ee),{value:n.value,"onUpdate:value":M[0]||(M[0]=b=>n.value=b),max:255,onKeyup:ve(h,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),aa=Q({__name:"PostInput",props:{mode:{},disabled:{type:Boolean},handling:{type:Boolean},forumId:{default:0},threadId:{default:0},randomHeadsGroup:{default:1}},emits:["contentCommit","refreshPostsList"],setup(B,{expose:U,emit:P}){const H=ne(),n=te(),C=d(null),z=d(null),S=d(null),h=d(null),s=d(null),g=d(null),f=d(null),M=B,b=X(()=>({fontSize:n.userCustom.fontSizeInput+"px",borderRadius:"10px"})),l=X(()=>H.userData.binggan.locked_ttl>0?`你的饼干封禁中，将于${Math.floor(H.userData.binggan.locked_ttl/3600)+1}小时后解封`:"正文内容"),c=X(()=>H.userData.binggan.locked_ttl>0),w=d(H.userData.binggan.nickname||"= ="),$=d(""),x=d(""),k=d(!1),u=d(!1);function p(){w.value=H.userData.binggan.nickname||"= =",$.value="",x.value="",k.value=!1,u.value=!1}const I=X(()=>({id:0,created_at:"预览模式",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:x.value,nickname:w.value,is_your_post:!0,hongbao_data:null})),G=X(()=>({class:{"nickname-input":!0,admin:u.value}})),K=d(!1),q=at("emoji_auto_hide",!1);function L(){let m=[ge(Ie,{checked:K.value,"onUpdate:checked":v=>K.value=v,label:"实时预览"}),ge(Ie,{checked:q.value,"onUpdate:checked":v=>q.value=v,label:"表情包自动收起"})];return H.userData.binggan.admin!==0&&H.checkAdminForums(M.forumId)&&m.push(ge(Ie,{checked:u.value,"onUpdate:checked":v=>u.value=v,label:"管理员"})),ge(j,{style:"padding:6px 8px",vertical:!0},()=>m)}const A=[{key:"funcOption",type:"render",render:L}],fe=[{label:"涂鸦板",key:"draw",icon:je(ct,{size:"1.5rem"})},{label:"屏蔽词",key:"mute",icon:je(zt,{size:"1.5rem"})}];function we(m){var v,T;switch(m){case"mute":(v=s.value)==null||v.show();break;case"draw":(T=f.value)==null||T.show();break}}Se(u,m=>w.value=m?"管理员":"= =");function ye(m){return m.selectionStart!=null?m.selectionStart:0}function Ce(m,v){const T=ye(m),V=m.value,Fe=V.substring(0,T)+v+V.substring(T);x.value=Fe}function pe(m){const v=document.getElementById("content-input");Ce(v,m),se(),v.focus()}function xe(){ft({title:"要清空内容吗？",onPositiveClick:()=>x.value=""})}const oe=d([""]);function ke(){oe.value.length>1&&(oe.value.pop(),x.value=oe.value.slice(-1)[0])}function se(){var m;oe.value.push((m=x.value)!=null?m:""),oe.value.length>20&&oe.value.shift()}function Me(m,v){pe(`<img src='${m}' class='${v?"custom-emoji-img":"emoji-img"}'>`)}function i(m){pe(m)}function r(m){pe(`<img src='${m}' />`)}function _(m){var v;x.value=m,se(),(v=C.value)==null||v.focus()}const y=P;function R(m){if(!m.isTrusted){const T={title:"错误",closable:!1,content:"请不要用脚本回复喔，可能会被系统判断为脚本并碎饼干。",positiveText:"确定"};window.$dialog.warning(T);return}new Promise(function(T,V){y("contentCommit",{contentInput:x.value,nicknameInput:w.value,postWithAdmin:u.value,titleInput:$.value,isDelay:k.value,ist:m.isTrusted},T)}).then($e)}function $e(){$.value="",x.value="",k.value=!1}const ze=d(!1);return U({quoteHandle:_,isTyping:ze,resetInput:p}),(m,v)=>(D(),W(e(j),{vertical:""},{default:a(()=>[K.value?(D(),Z(me,{key:0},[m.mode==="thread"?(D(),W(e(ie),{class:"thread-title-container",size:"small",key:"title-card"},{default:a(()=>[Y("span",{class:"thread-title",style:F({fontSize:e(n).userCustom.fontSizeThreadList+"px"})},le($.value||"标题预览")+" [0] ",5)]),_:1})):ue("",!0),t(yt,{"post-data":I.value,"forum-id":0,"preview-mode":!0},null,8,["post-data"])],64)):ue("",!0),t(e(j),{size:"small",wrap:!1,align:"center",style:F({paddingRight:e(n).isMobile?"24px":"0px"})},{default:a(()=>[t(e(N),{style:{"max-width":"300px"}},{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("昵称")]),_:1}),t(e(ee),{maxlength:30,value:w.value,"onUpdate:value":v[0]||(v[0]=T=>w.value=T),"show-count":"","input-props":G.value},null,8,["value","input-props"])]),_:1}),t(e(Re),{trigger:e(n).isMobile?"click":"hover",options:A,placement:"bottom-start"},{default:a(()=>[t(e(O),{size:"medium",style:{"flex-shrink":"0"},secondary:!1},{default:a(()=>[o("功能")]),_:1})]),_:1},8,["trigger"])]),_:1},8,["style"]),m.mode==="thread"?(D(),W(e(N),{key:1},{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("标题")]),_:1}),t(e(ee),{maxlength:100,value:$.value,"onUpdate:value":v[1]||(v[1]=T=>$.value=T),"show-count":"",placeholder:"标题内容"},null,8,["value"])]),_:1})):ue("",!0),t(Ft,{"auto-hide":e(q),"random-heads-group":m.randomHeadsGroup,onAppendEmoji:Me},null,8,["auto-hide","random-heads-group"]),t(e(j),{size:e(n).isMobile?"small":"medium",justify:"end",align:"center",style:F({paddingRight:e(n).isMobile?"24px":"0px"})},{default:a(()=>[t(e(Re),{trigger:"click",options:fe,onSelect:we,size:e(n).isMobile?"medium":"large"},{default:a(()=>[t(e(ae),{size:e(n).isMobile?20:24,style:{cursor:"pointer"}},{default:a(()=>[t(e(lt))]),_:1},8,["size"])]),_:1},8,["size"]),m.mode==="post"?(D(),W(e(re),{key:0,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(St),{style:{cursor:"pointer"},onClick:v[2]||(v[2]=T=>{var V;return(V=z.value)==null?void 0:V.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 发红包 ")]),_:1},8,["trigger"])):ue("",!0),m.mode==="post"?(D(),W(e(re),{key:1,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(nt),{style:{cursor:"pointer"},onClick:v[3]||(v[3]=T=>{var V;return(V=S.value)==null?void 0:V.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 大乱斗 ")]),_:1},8,["trigger"])):ue("",!0),m.mode==="post"?(D(),W(e(re),{key:2,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(ot),{style:{cursor:"pointer"},onClick:v[4]||(v[4]=T=>{var V;return(V=h.value)==null?void 0:V.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" Roll点 ")]),_:1},8,["trigger"])):ue("",!0),t(e(re),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(st),{style:{cursor:"pointer"},onClick:v[5]||(v[5]=T=>{var V;return(V=g.value)==null?void 0:V.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 快捷代码 ")]),_:1},8,["trigger"]),t(e(ut),{vertical:""}),t(e(re),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(it),{style:{cursor:"pointer"},onClick:ke})]),_:1},8,["size"])]),default:a(()=>[o(" 撤销 ")]),_:1},8,["trigger"]),t(e(re),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(ae),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(rt),{style:{cursor:"pointer"},onClick:xe})]),_:1},8,["size"])]),default:a(()=>[o(" 清空 ")]),_:1},8,["trigger"])]),_:1},8,["size","style"]),t(e(dt),{value:x.value,"onUpdate:value":v[6]||(v[6]=T=>x.value=T),type:"textarea",placeholder:l.value,autosize:{minRows:5,maxRows:10},ref_key:"contentInputDom",ref:C,style:F(b.value),"input-props":{id:"content-input"},disabled:c.value,onChange:se,onKeyup:v[7]||(v[7]=ve(He(T=>R(T),["ctrl"]),["enter"])),onBlur:v[8]||(v[8]=T=>ze.value=!1),onFocus:v[9]||(v[9]=T=>ze.value=!0)},null,8,["value","placeholder","style","disabled"]),t(e(j),{justify:"end",align:"center"},{default:a(()=>[t(Kt,{"user-is-locked":c.value,"forum-id":m.forumId,"thread-id":m.threadId,onInsertImage:r},null,8,["user-is-locked","forum-id","thread-id"]),m.mode==="thread"?(D(),W(e(Ie),{key:0,checked:k.value,"onUpdate:checked":v[10]||(v[10]=T=>k.value=T)},{default:a(()=>[o("延时发送")]),_:1},8,["checked"])):ue("",!0),t(e(re),{placement:"bottom-start",trigger:"hover",disabled:e(n).isMobile},{trigger:a(()=>[t(e(O),{type:"primary",onClick:v[11]||(v[11]=T=>R(T)),loading:m.handling,disabled:m.handling||c.value},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"])]),default:a(()=>[o(" 可以Ctrl+Enter ")]),_:1},8,["disabled"])]),_:1}),t(Gt,{ref_key:"HongbaoModalCom",ref:z,"thread-id":m.threadId,"forum-id":m.forumId,onRefreshPostsList:v[12]||(v[12]=T=>y("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(Bt,{ref_key:"BattleModalCom",ref:S,"thread-id":m.threadId,"forum-id":m.forumId,"random-heads-group":m.randomHeadsGroup,onRefreshPostsList:v[13]||(v[13]=T=>y("refreshPostsList"))},null,8,["thread-id","forum-id","random-heads-group"]),t(Ct,{ref_key:"RollModalCom",ref:h,"thread-id":m.threadId,"forum-id":m.forumId,onRefreshPostsList:v[14]||(v[14]=T=>y("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(qt,{ref_key:"PingbiciModalCom",ref:s},null,512),t(At,{ref_key:"CodeModalCom",ref:g,onInsertCode:i},null,512),t(Xt,{ref_key:"DrawerModalCom",ref:f,onInsertImage:r,"user-is-locked":c.value,"forum-id":m.forumId,"thread-id":m.threadId},null,8,["user-is-locked","forum-id","thread-id"])]),_:1}))}});export{aa as _,Lt as a};
