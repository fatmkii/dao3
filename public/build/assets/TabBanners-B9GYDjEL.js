import{w as R,l as U,a,o as q,b as G,u as M,$ as v,e as O,d as z,q as P,c as Q,A as u,M as x,f as s,i as S,H as n,k as d,n as c,z as o,F as _,C as w,Q as F,j as N,G as j,h,_ as E}from"./app-DZn8TC2l.js";import{s as V}from"./admin-CbIJN8xi.js";import{u as J}from"./forums-CDHnnzHl.js";import{N as K}from"./Input-CsV99p3p.js";import{N as L}from"./Select-Bztgj_qK.js";import"./use-locale-CDSAGZaJ.js";import"./Tag-_00ZnYwm.js";const W={class:"banner-box-sm"},X=["src"],Y=["src","onClick"],Z=R({__name:"TabBanners",setup(ee){U(t=>({"6a1c8eac":a(A).textColor1}));const f=q();G();const b=J(),A=M(),i=v(0);O(()=>{g.value.length>0&&(i.value=g.value[0].value)});const g=z(()=>f.binggan===null||f.userData.binggan.admin_forums===void 0?[]:b.forumsData.reduce((t,e)=>(f.checkAdminForums(e.id)&&t.push({value:e.id,label:e.name,forumId:e.id}),t),[])),r=v([]);P(i,t=>{var e;t===void 0?r.value=[]:r.value=[...((e=b.forumData(t))==null?void 0:e.banners)??[]]});const m=v(!1),p=v(),k=z(()=>{var t;return((t=p.value)==null?void 0:t.split(/[\n,，]+/).filter(e=>e!=""))??[]});function $(){m.value=!1,r.value=r.value.concat(k.value),p.value=void 0,C()}function H(t){var e;(e=r.value)==null||e.splice(t,1)}const{loading:B,send:D,onSuccess:T}=Q(t=>V(t),{immediate:!1});T(()=>{b.getForumsData()});function C(){const t={binggan:f.binggan,forum_id:i.value,banners:r.value};D(t)}return(t,e)=>(u(),x(a(d),{vertical:""},{default:s(()=>[m.value?(u(),x(a(S),{key:0,title:"待追加的版头",size:"small",class:"dash-line"},{"header-extra":s(()=>[n(a(d),{size:"small"},{default:s(()=>[n(a(c),{type:"primary",onClick:$},{default:s(()=>[o("追加")]),_:1}),n(a(c),{type:"default",onClick:e[0]||(e[0]=l=>{m.value=!1,p.value=void 0})},{default:s(()=>[o("关闭")]),_:1})]),_:1})]),default:s(()=>[n(a(d),{size:"small"},{default:s(()=>[(u(!0),_(w,null,F(k.value,(l,y,I)=>(u(),_("div",W,[N("img",{src:l,style:{width:"100%"}},null,8,X)]))),256))]),_:1}),n(a(K),{type:"textarea",value:p.value,"onUpdate:value":e[1]||(e[1]=l=>p.value=l),placeholder:"在这里贴网址追加版头。可以一次多个，每行一个。",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})):j("",!0),n(a(S),{title:"版头设定",size:"small"},{"header-extra":s(()=>[n(a(d),{size:"small",align:"center",wrap:!0},{default:s(()=>[n(a(h),{depth:3},{default:s(()=>[o("选择小岛")]),_:1}),n(a(L),{value:i.value,"onUpdate:value":e[2]||(e[2]=l=>i.value=l),options:g.value,"consistent-menu-width":!1,style:{width:"100px"}},null,8,["value","options"]),m.value?j("",!0):(u(),x(a(c),{key:0,type:"primary",onClick:e[3]||(e[3]=l=>m.value=!0)},{default:s(()=>[o("追加")]),_:1}))]),_:1})]),default:s(()=>[n(a(h),{depth:3},{default:s(()=>[o("点击图片移除")]),_:1}),n(a(d),{wrap:!0,size:[4,4]},{default:s(()=>[(u(!0),_(w,null,F(r.value,(l,y)=>(u(),_("div",{key:y+(i.value??0)*1e3,class:"banner-box"},[N("img",{src:l,class:"banner-img",onClick:I=>H(y)},null,8,Y)]))),128))]),_:1})]),_:1}),n(a(d),{align:"center",justify:"end"},{default:s(()=>[n(a(h),{depth:3,style:{"font-size":"0.875rem"}},{default:s(()=>[o("各个小岛的变更要分别提交喔")]),_:1}),n(a(c),{type:"primary",loading:a(B),disable:a(B),onClick:C},{default:s(()=>[o("提交")]),_:1},8,["loading","disable"])]),_:1})]),_:1}))}}),oe=E(Z,[["__scopeId","data-v-35893c7d"]]);export{oe as default};
