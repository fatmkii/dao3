import{w as q,$ as F,g as A,A as l,M as b,o as t,H as o,m as e,s as v,F as x,x as M,z as f,t as ae,v as _,J as m,y as ne,at as oe,B as se,D as ie,E as le,I as re,b as N,K as me,az as W,b0 as K,aF as Q,Q as V,_ as R,b1 as ue,ai as de,aj as ce}from"./vendor-B725aRmw.js";import{a as P,g as L,u as J,b as E,e as fe,_ as pe}from"./app-DwjKfYBl.js";import{e as ge}from"./emojiData-CxlyCw2q.js";import{d as C}from"./dayjs.min-Bn5otCi-.js";const X=P(),_e=i=>{const u=L.Get("api/emoji_contest/"+i,{name:"moeDataGetter-"+i,params:{binggan:X.binggan},localCache:null,hitSource:[]});return u.meta={shouldRemind:!1},u},we=()=>{const i=L.Get("api/emoji_contest/show_user_votes",{name:"moeUserVoteDataGetter",params:{binggan:X.binggan},localCache:null,hitSource:[]});return i.meta={shouldRemind:!1},i},ve=i=>{const u=L.Post("api/emoji_contest/user_vote",i,{name:"moeUserVotePoster",params:{},localCache:null,hitSource:[]});return u.meta={shouldRemind:!0},u},he=["src"],je={key:0},be={key:1},ye={key:2},Ue=q({__name:"VoteModal",emits:["refreshMoeData"],setup(i,{expose:u,emit:h}){const z=J(),I=P(),r=F({emojiUrl:"",emojiGroupId:0,emojiId:0,voteNum:0,endFlag:0}),p=F(),w=F(!1);function k(d){w.value=!0,r.value=d,p.value=void 0}u({show:k});const{loading:S,send:D,onSuccess:y,onError:O}=A(d=>ve(d),{immediate:!1});function U(){if(p.value===void 0){window.$message.error("请输入投票数");return}const d={binggan:I.binggan,emoji_id:r.value.emojiId,emoji_group_id:r.value.emojiGroupId,olo:p.value*100};D(d)}y(()=>{G("refreshMoeData",r.value.emojiGroupId),p.value=void 0,w.value=!1});const G=h;return(d,c)=>(l(),b(e(re),{show:w.value,"onUpdate:show":c[3]||(c[3]=g=>w.value=g),"display-directive":"if"},{default:t(()=>[o(e(le),{style:ie({maxWidth:e(z).modalMaxWidth}),closable:"",onClose:c[2]||(c[2]=g=>w.value=!1),size:"small"},{action:t(()=>[o(e(v),{align:"center"},{default:t(()=>[r.value.endFlag===0?(l(),x("span",je," 活动尚未开始 ")):M("",!0),r.value.endFlag===1?(l(),x("span",be,[f(" 将会花费 "),o(e(ae),{type:"error"},{default:t(()=>{var g;return[f(_(((g=p.value)!=null?g:0)*100),1)]}),_:1}),f(" 个olo ")])):M("",!0),r.value.endFlag===2?(l(),x("span",ye," 活动已经结束了 ")):M("",!0),o(e(E),{type:"primary",onClick:U,loading:e(S),disabled:e(S)||r.value.endFlag!==1,style:{"margin-left":"auto"}},{default:t(()=>[f("投票")]),_:1},8,["loading","disabled"]),o(e(E),{onClick:c[1]||(c[1]=g=>w.value=!1)},{default:t(()=>[f("关闭")]),_:1})]),_:1})]),default:t(()=>[o(e(v),{vertical:"",align:"center",size:[4,4]},{default:t(()=>[m("img",{src:r.value.emojiUrl},null,8,he),m("span",null,"当前票数："+_(r.value.voteNum),1),o(e(ne),null,{default:t(()=>[o(e(fe),{style:{width:"4.2rem"}},{default:t(()=>[f("投票额")]),_:1}),o(e(oe),{value:p.value,"onUpdate:value":c[0]||(c[0]=g=>p.value=g),max:1e3,min:1,step:1,onKeyup:se(U,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Y=i=>(de("data-v-8ee5c435"),i=i(),ce(),i),xe=Y(()=>m("img",{src:"https://i.mji.rip/2024/05/04/1c8db8f920b7cd2bfa1e5a21611df31e.png",style:{width:"100%"}},null,-1)),Se=Y(()=>m("br",null,null,-1)),$e=["src"],Ce=["src"],Fe=q({__name:"EmojiContest",setup(i){me(n=>({"5c7178b5":O.value}));const u=C("2024-06-18 20:00"),h=C("2024-06-21 20:00"),z=[1,2,3,4,5,6,7,8,9,10,11,16],I={1:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/6643615d5fdc9.png",name:"AC娘"},2:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664363e93d3cf.gif",name:"鹦鹉鸡"},3:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664366659ab29.gif",name:"咪子鱼"},4:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664368477446c.gif",name:"小黑猫"},5:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664369af63190.png",name:"麻将脸"},6:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436b99dd1ea.jpg",name:"小恐龙"},7:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436cb41e3e3.gif",name:"TD猫"},8:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436ee568b88.gif",name:"小豆泥"},9:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436fa983d7f.jpg",name:"小企鹅"},10:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664371e81e84c.png",name:"小黄脸"},11:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437362aba46.gif",name:"FUFU"},16:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437b01d45b7.gif",name:"药水哥"}},r=N(()=>{const n=C();return n<u?`活动将于 ${n.format("M月D日H点")} 开始`:n>h?"投票已经结束！":`投票正在进行！将于${h.format("M月D日H点")}结束。（${p.value}）`}),p=N(()=>{const n=C(),s=h.diff(n,"hour"),a=h.diff(n,"minute")-60*s;return`剩余${s}小时${a}分钟`}),w=P(),k=J(),S=F(),D=N(()=>ge.filter(n=>z.includes(n.id))),y=F(null),O=N(()=>k.userCustom.emojiWhiteBack?"#FFFFFF":void 0);function U(n){n===0?H():(d.value=[],c(n))}const{loading:G,data:d,send:c,onSuccess:g}=A(n=>_e(n),{immediate:!1,initialData:[]}),{loading:B,data:Z,send:H}=A(we,{immediate:!1,initialData:[]});w.binggan&&H();function ee(n){return n.reduce((s,a)=>(s+=a.votes_num_total,s),0)}function te(n,s){var T;let a=0;const j=C();j>u&&(a=1),j>h&&(a=2),(T=y==null?void 0:y.value)==null||T.show({emojiUrl:n.emojis[s.emoji_id],emojiGroupId:n.id,emojiId:s.emoji_id,voteNum:s.votes_num_total,endFlag:a})}return(n,s)=>(l(),b(e(v),{vertical:"",size:[12,12]},{default:t(()=>[xe,o(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(_(r.value),1)]),_:1}),o(e(ue),{type:"line",animated:"",placement:"left",size:e(k).isMobile?"small":"large",value:S.value,"onUpdate:value":[s[0]||(s[0]=a=>S.value=a),U]},{default:t(()=>[(l(),b(e(K),{key:0,name:0,tab:"我的本命"},{default:t(()=>[m("div",null,[o(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(" 自己票数最多的“角色”为“⭐我的本命”，如该角色夺冠将获得特殊成就哦！ "),Se,f("注：这里的表情包图片只是用来代表该角色，不是你投票最多的图片。 ")]),_:1})]),o(e(Q),{show:e(B),style:{height:"120px"}},{default:t(()=>[e(B)?M("",!0):(l(),b(e(v),{key:0,wrap:!0,size:[4,4],style:{"margin-top":"12px"}},{default:t(()=>[(l(!0),x(R,null,V(e(Z),(a,j)=>(l(),b(e(v),{key:j,style:{width:"72px",height:"120px"},vertical:"",align:"center",justify:"end",size:[0,4]},{default:t(()=>[m("img",{src:I[a.emoji_group_id].emojiUrl,style:{"max-width":"100%"},class:"emoji-moe-img"},null,8,$e),m("span",null,_(j==0?"⭐":"")+" "+_(I[a.emoji_group_id].name),1),m("span",null,_(a.votes_num_total||""),1)]),_:2},1024))),128))]),_:1}))]),_:1},8,["show"])]),_:1})),(l(!0),x(R,null,V(D.value,(a,j,T)=>(l(),b(e(K),{key:j+1,name:a.id,tab:a.name},{default:t(()=>[o(e(Q),{show:e(G),style:{height:"400px"}},{default:t(()=>[o(e(v),{style:{"margin-top":"12px"},align:"center"},{default:t(()=>[m("span",null,_(a.name)+" 总票数： "+_(ee(e(d))),1),o(e(E),{type:"primary",style:{"margin-left":"auto"},onClick:$=>U(a.id)},{default:t(()=>[f("刷新")]),_:2},1032,["onClick"])]),_:2},1024),o(e(v),{wrap:!0,size:[8,4],style:{"margin-top":"12px"}},{default:t(()=>[(l(!0),x(R,null,V(e(d),($,Ie)=>(l(),b(e(v),{key:a.id*1e3+$.emoji_id,class:"emoji-moe-box",vertical:"",align:"center",size:[0,4],onClick:ke=>te(a,$)},{default:t(()=>[m("img",{src:a.emojis[$.emoji_id],style:{"max-width":"100%","max-height":"100%"},class:"emoji-moe-img"},null,8,Ce),m("span",null,_($.votes_num_total||""),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1032,["show"])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["size","value"]),o(Ue,{ref_key:"VoteModalCom",ref:y,onRefreshMoeData:s[1]||(s[1]=a=>{e(H)})},null,512)]),_:1}))}}),Ge=pe(Fe,[["__scopeId","data-v-8ee5c435"]]);export{Ge as default};
