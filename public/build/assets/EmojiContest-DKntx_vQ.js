import{w as Q,$ as z,i as A,A as i,M as S,q as t,H as s,o as e,x as v,F as b,C as M,z as f,y as ne,B as p,O as u,D as se,aw as oe,E as ie,J as le,K as re,L as me,e as h,u as ue,t as de,b as k,P as ce,aC as W,b3 as q,aI as K,Q as V,a2 as R,b4 as fe,al as _e,am as ge}from"./vendor-CGtf6mcl.js";import{a as E,g as L,u as J,b as P,e as pe,_ as we}from"./app-CQGHXDvq.js";import{e as he}from"./emojiData-CxlyCw2q.js";const X=E(),ve=o=>{const m=L.Get("api/emoji_contest/"+o,{name:"moeDataGetter-"+o,params:{binggan:X.binggan},localCache:null,hitSource:[]});return m.meta={shouldRemind:!1},m},je=()=>{const o=L.Get("api/emoji_contest/show_user_votes",{name:"moeUserVoteDataGetter",params:{binggan:X.binggan},localCache:null,hitSource:[]});return o.meta={shouldRemind:!1},o},ye=o=>{const m=L.Post("api/emoji_contest/user_vote",o,{name:"moeUserVotePoster",params:{},localCache:null,hitSource:[]});return m.meta={shouldRemind:!0},m},be=["src"],xe={key:0},Ue={key:1},Se={key:2},Ce=Q({__name:"VoteModal",emits:["refreshMoeData"],setup(o,{expose:m,emit:j}){const N=J(),F=E(),l=z({emojiUrl:"",emojiGroupId:0,emojiId:0,voteNum:0,endFlag:0}),_=z(),w=z(!1);function I(d){w.value=!0,l.value=d,_.value=void 0}m({show:I});const{loading:C,send:D,onSuccess:x,onError:O}=A(d=>ye(d),{immediate:!1});function U(){if(_.value===void 0){window.$message.error("请输入投票数");return}const d={binggan:F.binggan,emoji_id:l.value.emojiId,emoji_group_id:l.value.emojiGroupId,olo:_.value*100};D(d)}x(()=>{G("refreshMoeData",l.value.emojiGroupId),_.value=void 0,w.value=!1});const G=j;return(d,c)=>(i(),S(e(me),{show:w.value,"onUpdate:show":c[3]||(c[3]=g=>w.value=g),"display-directive":"if"},{default:t(()=>[s(e(re),{style:le({maxWidth:e(N).modalMaxWidth}),closable:"",onClose:c[2]||(c[2]=g=>w.value=!1),size:"small"},{action:t(()=>[s(e(v),{align:"center"},{default:t(()=>[l.value.endFlag===0?(i(),b("span",xe," 活动尚未开始 ")):M("",!0),l.value.endFlag===1?(i(),b("span",Ue,[f(" 将会花费 "),s(e(ne),{type:"error"},{default:t(()=>{var g;return[f(p(((g=_.value)!=null?g:0)*100),1)]}),_:1}),f(" 个olo ")])):M("",!0),l.value.endFlag===2?(i(),b("span",Se," 活动已经结束了 ")):M("",!0),s(e(P),{type:"primary",onClick:U,loading:e(C),disabled:e(C)||l.value.endFlag!==1,style:{"margin-left":"auto"}},{default:t(()=>[f("投票")]),_:1},8,["loading","disabled"]),s(e(P),{onClick:c[1]||(c[1]=g=>w.value=!1)},{default:t(()=>[f("关闭")]),_:1})]),_:1})]),default:t(()=>[s(e(v),{vertical:"",align:"center",size:[4,4]},{default:t(()=>[u("img",{src:l.value.emojiUrl},null,8,be),u("span",null,"当前票数："+p(l.value.voteNum),1),s(e(se),null,{default:t(()=>[s(e(pe),{style:{width:"4.2rem"}},{default:t(()=>[f("投票额")]),_:1}),s(e(oe),{value:_.value,"onUpdate:value":c[0]||(c[0]=g=>_.value=g),max:1e4,min:1,step:1,onKeyup:ie(U,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Y=o=>(_e("data-v-003d0cc5"),o=o(),ge(),o),$e=Y(()=>u("img",{src:"https://www.freeimg.cn/i/2024/06/13/666af8740a938.png",style:{width:"100%"}},null,-1)),ze=Y(()=>u("br",null,null,-1)),Fe=["src"],Ie={key:0},ke=["src"],Me=Q({__name:"EmojiContest",setup(o){ce(a=>({f729518a:O.value})),h.extend(ue),h.extend(de),h.tz.setDefault("Asia/Shanghai");const m=h.tz("2024-06-18 20:00"),j=h.tz("2024-06-22 20:00"),N=[1,2,3,4,5,6,7,9,10,11,16],F={1:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/6643615d5fdc9.png",name:"AC娘"},2:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664363e93d3cf.gif",name:"鹦鹉鸡"},3:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664366659ab29.gif",name:"咪子鱼"},4:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664368477446c.gif",name:"小黑猫"},5:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664369af63190.png",name:"麻将脸"},6:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436b99dd1ea.jpg",name:"小恐龙"},7:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436cb41e3e3.gif",name:"TD猫"},9:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436fa983d7f.jpg",name:"小企鹅"},10:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664371e81e84c.png",name:"小黄脸"},11:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437362aba46.gif",name:"FUFU"},16:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437b01d45b7.gif",name:"药水哥"}},l=k(()=>{const a=h.tz();return a<m?`活动将于 ${m.format("M月D日H点")} 开始`:a>j?"投票已经结束！":`投票正在进行！将于${j.format("M月D日H点")}结束。（${_.value}）`}),_=k(()=>{const a=h.tz(),r=j.diff(a,"hour"),n=j.diff(a,"minute")-60*r;return`剩余${r}小时${n}分钟`}),w=E(),I=J(),C=z(),D=k(()=>he.filter(a=>N.includes(a.id))),x=z(null),O=k(()=>I.userCustom.emojiWhiteBack?"#FFFFFF":void 0);function U(a){a===0?H():(d.value=[],c(a))}const{loading:G,data:d,send:c,onSuccess:g}=A(a=>ve(a),{immediate:!1,initialData:[]}),{loading:Z,data:B,send:H}=A(je,{immediate:!1,initialData:[]});w.binggan&&H();function ee(a){return a.reduce((r,n)=>(r+=n.votes_num_total,r),0)}function te(a,r){var T;let n=0;const y=h.tz();y>m&&(n=1),y>j&&(n=2),(T=x==null?void 0:x.value)==null||T.show({emojiUrl:a.emojis[r.emoji_id],emojiGroupId:a.id,emojiId:r.emoji_id,voteNum:r.votes_num_total,endFlag:n})}function ae(a){H(),U(a)}return(a,r)=>(i(),S(e(v),{vertical:"",size:[12,12]},{default:t(()=>[$e,s(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(p(l.value),1)]),_:1}),s(e(fe),{type:"line",animated:"",placement:"left",size:e(I).isMobile?"small":"large",value:C.value,"onUpdate:value":[r[0]||(r[0]=n=>C.value=n),U]},{default:t(()=>[(i(),S(e(q),{key:0,name:0,tab:"我的本命"},{default:t(()=>[u("div",null,[s(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(" 自己票数最多的“角色”为“⭐我的本命”，如该角色夺冠将获得特殊成就哦！ "),ze,f("注：这里的表情包图片只是用来代表该角色，不是你投票最多的图片。 ")]),_:1})]),s(e(K),{show:e(Z),style:{height:"120px"}},{default:t(()=>[s(e(v),{wrap:!0,size:[4,4],style:{"margin-top":"12px"}},{default:t(()=>[(i(!0),b(R,null,V(e(B),(n,y)=>(i(),S(e(v),{key:y,style:{width:"72px",height:"120px"},vertical:"",align:"center",justify:"end",size:[0,4]},{default:t(()=>[u("img",{src:F[n.emoji_group_id].emojiUrl,style:{"max-width":"100%"},class:"emoji-moe-img"},null,8,Fe),u("span",null,p(y==0?"⭐":"")+" "+p(F[n.emoji_group_id].name),1),u("span",null,p(n.votes_num_total||""),1)]),_:2},1024))),128)),e(B).length===0?(i(),b("span",Ie,"你的投票记录将会显示在这里。")):M("",!0)]),_:1})]),_:1},8,["show"])]),_:1})),(i(!0),b(R,null,V(D.value,(n,y,T)=>(i(),S(e(q),{key:y+1,name:n.id,tab:n.name},{default:t(()=>[s(e(K),{show:e(G),style:{height:"400px"}},{default:t(()=>[s(e(v),{style:{"margin-top":"12px"},align:"center"},{default:t(()=>[u("span",null,p(n.name)+" 总票数： "+p(ee(e(d))),1),s(e(P),{type:"primary",style:{"margin-left":"auto"},onClick:$=>U(n.id)},{default:t(()=>[f("刷新")]),_:2},1032,["onClick"])]),_:2},1024),s(e(v),{wrap:!0,size:[8,4],style:{"margin-top":"12px"}},{default:t(()=>[(i(!0),b(R,null,V(e(d),($,Ne)=>(i(),S(e(v),{key:n.id*1e3+$.emoji_id,class:"emoji-moe-box",vertical:"",align:"center",size:[0,4],onClick:De=>te(n,$)},{default:t(()=>[u("img",{src:n.emojis[$.emoji_id],style:{"max-width":"100%","max-height":"100%"},class:"emoji-moe-img"},null,8,ke),u("span",null,p($.votes_num_total||""),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1032,["show"])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["size","value"]),s(Ce,{ref_key:"VoteModalCom",ref:x,onRefreshMoeData:ae},null,512)]),_:1}))}}),Ve=we(Me,[["__scopeId","data-v-003d0cc5"]]);export{Ve as default};
