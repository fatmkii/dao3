import{w as q,$,g as A,A as i,M as x,o as t,H as o,m as e,s as h,F as b,x as N,z as f,t as ne,v as g,J as u,y as oe,at as se,B as ie,D as le,E as re,I as me,b as M,K as ue,az as W,b0 as K,aF as Q,Q as V,_ as R,b1 as de,ai as ce,aj as fe}from"./vendor-B725aRmw.js";import{a as P,g as L,u as J,b as E,e as _e,_ as pe}from"./app-B1E9hQ9C.js";import{e as ge}from"./emojiData-CxlyCw2q.js";import{d as F}from"./dayjs.min-Bn5otCi-.js";const X=P(),we=s=>{const m=L.Get("api/emoji_contest/"+s,{name:"moeDataGetter-"+s,params:{binggan:X.binggan},localCache:null,hitSource:[]});return m.meta={shouldRemind:!1},m},he=()=>{const s=L.Get("api/emoji_contest/show_user_votes",{name:"moeUserVoteDataGetter",params:{binggan:X.binggan},localCache:null,hitSource:[]});return s.meta={shouldRemind:!1},s},ve=s=>{const m=L.Post("api/emoji_contest/user_vote",s,{name:"moeUserVotePoster",params:{},localCache:null,hitSource:[]});return m.meta={shouldRemind:!0},m},je=["src"],be={key:0},ye={key:1},Ue={key:2},xe=q({__name:"VoteModal",emits:["refreshMoeData"],setup(s,{expose:m,emit:v}){const D=J(),I=P(),l=$({emojiUrl:"",emojiGroupId:0,emojiId:0,voteNum:0,endFlag:0}),_=$(),w=$(!1);function k(d){w.value=!0,l.value=d,_.value=void 0}m({show:k});const{loading:S,send:z,onSuccess:y,onError:O}=A(d=>ve(d),{immediate:!1});function U(){if(_.value===void 0){window.$message.error("请输入投票数");return}const d={binggan:I.binggan,emoji_id:l.value.emojiId,emoji_group_id:l.value.emojiGroupId,olo:_.value*100};z(d)}y(()=>{G("refreshMoeData",l.value.emojiGroupId),_.value=void 0,w.value=!1});const G=v;return(d,c)=>(i(),x(e(me),{show:w.value,"onUpdate:show":c[3]||(c[3]=p=>w.value=p),"display-directive":"if"},{default:t(()=>[o(e(re),{style:le({maxWidth:e(D).modalMaxWidth}),closable:"",onClose:c[2]||(c[2]=p=>w.value=!1),size:"small"},{action:t(()=>[o(e(h),{align:"center"},{default:t(()=>[l.value.endFlag===0?(i(),b("span",be," 活动尚未开始 ")):N("",!0),l.value.endFlag===1?(i(),b("span",ye,[f(" 将会花费 "),o(e(ne),{type:"error"},{default:t(()=>{var p;return[f(g(((p=_.value)!=null?p:0)*100),1)]}),_:1}),f(" 个olo ")])):N("",!0),l.value.endFlag===2?(i(),b("span",Ue," 活动已经结束了 ")):N("",!0),o(e(E),{type:"primary",onClick:U,loading:e(S),disabled:e(S)||l.value.endFlag!==1,style:{"margin-left":"auto"}},{default:t(()=>[f("投票")]),_:1},8,["loading","disabled"]),o(e(E),{onClick:c[1]||(c[1]=p=>w.value=!1)},{default:t(()=>[f("关闭")]),_:1})]),_:1})]),default:t(()=>[o(e(h),{vertical:"",align:"center",size:[4,4]},{default:t(()=>[u("img",{src:l.value.emojiUrl},null,8,je),u("span",null,"当前票数："+g(l.value.voteNum),1),o(e(oe),null,{default:t(()=>[o(e(_e),{style:{width:"4.2rem"}},{default:t(()=>[f("投票额")]),_:1}),o(e(se),{value:_.value,"onUpdate:value":c[0]||(c[0]=p=>_.value=p),max:1e3,min:1,step:1,onKeyup:ie(U,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Y=s=>(ce("data-v-bfb083de"),s=s(),fe(),s),Se=Y(()=>u("img",{src:"https://www.freeimg.cn/i/2024/06/13/666af8740a938.png",style:{width:"100%"}},null,-1)),Ce=Y(()=>u("br",null,null,-1)),Fe=["src"],$e={key:0},Ie=["src"],ke=q({__name:"EmojiContest",setup(s){ue(a=>({"093b26da":O.value}));const m=F("2024-06-18 20:00"),v=F("2024-06-21 20:00"),D=[1,2,3,4,5,6,7,9,10,11,16],I={1:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/6643615d5fdc9.png",name:"AC娘"},2:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664363e93d3cf.gif",name:"鹦鹉鸡"},3:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664366659ab29.gif",name:"咪子鱼"},4:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664368477446c.gif",name:"小黑猫"},5:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664369af63190.png",name:"麻将脸"},6:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436b99dd1ea.jpg",name:"小恐龙"},7:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436cb41e3e3.gif",name:"TD猫"},9:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66436fa983d7f.jpg",name:"小企鹅"},10:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/664371e81e84c.png",name:"小黄脸"},11:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437362aba46.gif",name:"FUFU"},16:{emojiUrl:"https://www.freeimg.cn/i/2024/05/14/66437b01d45b7.gif",name:"药水哥"}},l=M(()=>{const a=F();return a<m?`活动将于 ${m.format("M月D日H点")} 开始`:a>v?"投票已经结束！":`投票正在进行！将于${v.format("M月D日H点")}结束。（${_.value}）`}),_=M(()=>{const a=F(),r=v.diff(a,"hour"),n=v.diff(a,"minute")-60*r;return`剩余${r}小时${n}分钟`}),w=P(),k=J(),S=$(),z=M(()=>ge.filter(a=>D.includes(a.id))),y=$(null),O=M(()=>k.userCustom.emojiWhiteBack?"#FFFFFF":void 0);function U(a){a===0?H():(d.value=[],c(a))}const{loading:G,data:d,send:c,onSuccess:p}=A(a=>we(a),{immediate:!1,initialData:[]}),{loading:Z,data:B,send:H}=A(he,{immediate:!1,initialData:[]});w.binggan&&H();function ee(a){return a.reduce((r,n)=>(r+=n.votes_num_total,r),0)}function te(a,r){var T;let n=0;const j=F();j>m&&(n=1),j>v&&(n=2),(T=y==null?void 0:y.value)==null||T.show({emojiUrl:a.emojis[r.emoji_id],emojiGroupId:a.id,emojiId:r.emoji_id,voteNum:r.votes_num_total,endFlag:n})}function ae(a){H(),U(a)}return(a,r)=>(i(),x(e(h),{vertical:"",size:[12,12]},{default:t(()=>[Se,o(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(g(l.value),1)]),_:1}),o(e(de),{type:"line",animated:"",placement:"left",size:e(k).isMobile?"small":"large",value:S.value,"onUpdate:value":[r[0]||(r[0]=n=>S.value=n),U]},{default:t(()=>[(i(),x(e(K),{key:0,name:0,tab:"我的本命"},{default:t(()=>[u("div",null,[o(e(W),{"show-icon":!1,type:"default"},{default:t(()=>[f(" 自己票数最多的“角色”为“⭐我的本命”，如该角色夺冠将获得特殊成就哦！ "),Ce,f("注：这里的表情包图片只是用来代表该角色，不是你投票最多的图片。 ")]),_:1})]),o(e(Q),{show:e(Z),style:{height:"120px"}},{default:t(()=>[o(e(h),{wrap:!0,size:[4,4],style:{"margin-top":"12px"}},{default:t(()=>[(i(!0),b(R,null,V(e(B),(n,j)=>(i(),x(e(h),{key:j,style:{width:"72px",height:"120px"},vertical:"",align:"center",justify:"end",size:[0,4]},{default:t(()=>[u("img",{src:I[n.emoji_group_id].emojiUrl,style:{"max-width":"100%"},class:"emoji-moe-img"},null,8,Fe),u("span",null,g(j==0?"⭐":"")+" "+g(I[n.emoji_group_id].name),1),u("span",null,g(n.votes_num_total||""),1)]),_:2},1024))),128)),e(B).length===0?(i(),b("span",$e,"你的投票记录将会显示在这里。")):N("",!0)]),_:1})]),_:1},8,["show"])]),_:1})),(i(!0),b(R,null,V(z.value,(n,j,T)=>(i(),x(e(K),{key:j+1,name:n.id,tab:n.name},{default:t(()=>[o(e(Q),{show:e(G),style:{height:"400px"}},{default:t(()=>[o(e(h),{style:{"margin-top":"12px"},align:"center"},{default:t(()=>[u("span",null,g(n.name)+" 总票数： "+g(ee(e(d))),1),o(e(E),{type:"primary",style:{"margin-left":"auto"},onClick:C=>U(n.id)},{default:t(()=>[f("刷新")]),_:2},1032,["onClick"])]),_:2},1024),o(e(h),{wrap:!0,size:[8,4],style:{"margin-top":"12px"}},{default:t(()=>[(i(!0),b(R,null,V(e(d),(C,Me)=>(i(),x(e(h),{key:n.id*1e3+C.emoji_id,class:"emoji-moe-box",vertical:"",align:"center",size:[0,4],onClick:Ne=>te(n,C)},{default:t(()=>[u("img",{src:n.emojis[C.emoji_id],style:{"max-width":"100%","max-height":"100%"},class:"emoji-moe-img"},null,8,Ie),u("span",null,g(C.votes_num_total||""),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1032,["show"])]),_:2},1032,["name","tab"]))),128))]),_:1},8,["size","value"]),o(xe,{ref_key:"VoteModalCom",ref:y,onRefreshMoeData:ae},null,512)]),_:1}))}}),Te=pe(ke,[["__scopeId","data-v-bfb083de"]]);export{Te as default};
