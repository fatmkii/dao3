import{n as oe,l as W,t as f,g as Me,p as j,j as H,q as e,D as ge,x as l,E as t,F as ve,H as Z,I as O,S as Q,L as i,P as ne,M as _,av as he,am as Le,a_ as ye,O as we,a2 as Be,a3 as Ue,a1 as We,b5 as Ae,J,b6 as Pe,aU as Se,a$ as Ge,aY as De,aD as Ve,i as ue,Q as de,w as Ce,b3 as Ke,b4 as Re,m as be,B as je,N as ae,b1 as Je,b2 as Qe,C as Ze,al as et,K as te,u as tt,a4 as Ne,aO as lt,R as ie,b7 as at,b8 as nt,b9 as ut,ba as ot,aZ as st,bb as it,bc as rt,z as dt,bd as vt,be as mt}from"./vendor-CSO85mTd.js";import{u as se,a as re,e as E,c as ee,b as Y,i as Oe,j as ft,p as gt,r as _e,d as Ie}from"./app-DxyQFTmL.js";import{s as pt}from"./showDialog-Bx8V4rWM.js";import{c as ct,d as bt,e as He,b as ht,f as yt,g as wt,i as Ct,j as kt,_ as xt}from"./emojiData-BW8_2TmQ.js";import{i as Ye,a as Xe}from"./inputNumberFormat-BPxWRFt_.js";const It=oe({__name:"RollModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(k,{expose:X,emit:S}){const A=se(),s=re(),M=k,z=W(()=>{let d=[];if(v.value>0&&b.value>0){for(var u=0;u<v.value;u++)d[u]=Math.floor(Math.random()*b.value)+1;return d.join()}else return null}),R=f(),h=f(),v=f(1),b=f(100),D=f(!1);function I(){D.value=!0}X({show:I});const B=S,{loading:r,send:y,onSuccess:g}=Me(d=>ct(d),{immediate:!1});function C(){if(!v.value){window.$message.error("è¯·å¡«å†™éª°å­æ•°é‡");return}if(!b.value){window.$message.error("è¯·å¡«å†™éª°å­æ•°é‡");return}const d={binggan:s.binggan,thread_id:M.threadId,forum_id:M.forumId,roll_name:R.value,roll_event:h.value,roll_num:v.value,roll_range:b.value};y(d)}return g(()=>{B("refreshPostsList"),D.value=!1}),(d,u)=>(H(),j(e(ge),{show:D.value,"onUpdate:show":u[6]||(u[6]=p=>D.value=p),"display-directive":"if"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:e(A).modalMaxWidth}),title:"Rollç‚¹",closable:"",onClose:u[5]||(u[5]=p=>D.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Y),{type:"primary",onClick:C,disabled:e(r)},{default:l(()=>[...u[12]||(u[12]=[i("Roll it!",-1)])]),_:1},8,["disabled"]),t(e(Y),{onClick:u[4]||(u[4]=p=>D.value=!1)},{default:l(()=>[...u[13]||(u[13]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Q),null,{default:l(()=>[...u[7]||(u[7]=[i(" è¾“å‡ºå‚è€ƒï¼š ",-1)])]),_:1}),t(e(Q),null,{default:l(()=>[i(ne(R.value?`ã€Œ${R.value}ã€ï¼Œ`:"")+" "+ne(h.value?`ã€Œ${h.value}ã€çš„ç»“æœï¼š`:"")+" "+ne(`${v.value} d ${b.value} = ã€Œ${z.value}ã€`),1)]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...u[8]||(u[8]=[i("Rollç‚¹æ˜µç§°",-1)])]),_:1}),t(e(ee),{placeholder:"å¯ç•™ç©º",maxlength:100,value:R.value,"onUpdate:value":u[0]||(u[0]=p=>R.value=p)},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...u[9]||(u[9]=[i("Rollç‚¹äº‹ä»¶",-1)])]),_:1}),t(e(ee),{placeholder:"å¯ç•™ç©º",maxlength:100,value:h.value,"onUpdate:value":u[1]||(u[1]=p=>h.value=p)},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...u[10]||(u[10]=[i("éª°å­æ•°é‡",-1)])]),_:1}),t(e(he),{max:100,min:1,placeholder:"å¿…é¡»å¡«å†™",value:v.value,"onUpdate:value":u[2]||(u[2]=p=>v.value=p)},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:l(()=>[...u[11]||(u[11]=[i("éª°å­å¤§å°",-1)])]),_:1}),t(e(he),{max:1e4,min:1,placeholder:"å¿…é¡»å¡«å†™",value:b.value,"onUpdate:value":u[3]||(u[3]=p=>b.value=p)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Mt=oe({__name:"BattleModal",props:{threadId:{},forumId:{},randomHeadsGroup:{}},emits:["refreshPostsList"],setup(k,{expose:X,emit:S}){const A=se(),s=re(),M=f(null),z=k,R=W(()=>{const p=[{value:1,label:"å…±é€š",available:!0}];return bt.forEach(c=>{c.value===z.randomHeadsGroup&&p.push(c)}),p}),h=W(()=>{const p=He[b.value-1];if(b.value===1){const c=s.userData.my_battle_chara.filter(L=>!L.not_use).map((L,q)=>({value:q+240,label:L.name}));return p.concat(c)}else return p}),v=f(1),b=f(z.randomHeadsGroup),D=f(100);Le(b,p=>{p===1?v.value=He[p-1][8].value:v.value=He[p-1][0].value},{immediate:!0});const{loading:I,send:B,onSuccess:r,onError:y}=Me(p=>yt(p),{immediate:!1});function g(p){var N;const{timestamp:c,newPostKey:L}=wt((N=p==null?void 0:p.isTrusted)!=null?N:!0,z.threadId,s.binggan),q={binggan:s.binggan,forum_id:z.forumId,thread_id:z.threadId,battle_olo:D.value,chara_id:v.value>=240?v.value-240:v.value,is_custom_chara:v.value>=240,chara_group:b.value-1,new_post_key:L,timestamp:c};B(q)}r(()=>{u("refreshPostsList"),C.value=!1}),y(p=>{var c;p.error.cause!==void 0&&p.error.cause.code===244291&&((c=M.value)==null||c.show())});const C=f(!1);function d(){C.value=!0}X({show:d});const u=S;return(p,c)=>(H(),j(e(ge),{show:C.value,"onUpdate:show":c[5]||(c[5]=L=>C.value=L),"display-directive":"if"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:e(A).modalMaxWidth}),title:"è¡¨æƒ…åŒ…å¤§ä¹±æ–—ï¼",closable:"",onClose:c[4]||(c[4]=L=>C.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Y),{type:"primary",onClick:g,loading:e(I)},{default:l(()=>[...c[10]||(c[10]=[i("æäº¤",-1)])]),_:1},8,["loading"]),t(e(Y),{onClick:c[3]||(c[3]=L=>C.value=!1)},{default:l(()=>[...c[11]||(c[11]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Q),null,{default:l(()=>[...c[6]||(c[6]=[i("å°æ–—æ€¡æƒ…ï¼Œå¤§æ–—ä¼¤èº«ï¼Œå¼ºæ–—å¥¥é£æ¹®ç­",-1)])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...c[7]||(c[7]=[i("ä¸»é¢˜",-1)])]),_:1}),t(e(ye),{value:b.value,"onUpdate:value":c[0]||(c[0]=L=>b.value=L),options:R.value},null,8,["value","options"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...c[8]||(c[8]=[i("è§’è‰²",-1)])]),_:1}),t(e(ye),{value:v.value,"onUpdate:value":c[1]||(c[1]=L=>v.value=L),options:h.value},null,8,["value","options"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...c[9]||(c[9]=[i("ä¸‹æ³¨",-1)])]),_:1}),t(e(he),{value:D.value,"onUpdate:value":c[2]||(c[2]=L=>D.value=L),max:1e6,min:1,step:100,parse:e(Xe),format:e(Ye),onKeyup:we(g,["enter"])},null,8,["value","parse","format"])]),_:1})]),_:1}),t(ht,{ref_key:"CaptchaModalCom",ref:M,onWaterUnlockOnSuccess:g,type:"new_post"},null,512)]),_:1},8,["style"])]),_:1},8,["show"]))}}),Tt=oe({__name:"CodeModal",emits:["insertCode"],setup(k,{expose:X,emit:S}){const A=se(),s=f(0),M=f(),z=f(),R=[{value:0,label:"æŠ˜å å†…å®¹"},{value:1,label:"è¶…é“¾æ¥"},{value:2,label:"å›¾ç‰‡"},{value:3,label:"åˆ é™¤çº¿"}],h=W(()=>[{prepend_1:"æ˜¾ç¤ºå†…å®¹",prepend_2:"éšè—å†…å®¹",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"æ˜¾ç¤ºå†…å®¹",inputDefault_2:"éšè—å†…å®¹",insertText:`<details><summary>${M.value}</summary>${z.value}</details>`},{prepend_1:"æ˜¾ç¤ºæ–‡å­—",prepend_2:"é“¾æ¥ç½‘å€",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"ç‚¹æˆ‘è·³è½¬",inputDefault_2:"",insertText:`<a href="${z.value}">${M.value}</a>`},{prepend_1:"å›¾ç‰‡é“¾æ¥",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<img src="${M.value}">`},{prepend_1:"åˆ é™¤æ–‡å­—",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<del>${M.value}</del>`}]);Le(s,()=>{M.value=h.value[s.value].inputDefault_1,z.value=h.value[s.value].inputDefault_2},{immediate:!0});function v(){I("insertCode",h.value[s.value].insertText),M.value=h.value[s.value].inputDefault_1,z.value=h.value[s.value].inputDefault_2,b.value=!1}const b=f(!1);function D(){b.value=!0}X({show:D});const I=S;return(B,r)=>(H(),j(e(ge),{show:b.value,"onUpdate:show":r[5]||(r[5]=y=>b.value=y),"display-directive":"if"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:e(A).modalMaxWidth}),title:"å¿«æ·ä»£ç ",closable:"",onClose:r[4]||(r[4]=y=>b.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Y),{type:"primary",onClick:v},{default:l(()=>[...r[8]||(r[8]=[i("æ’å…¥",-1)])]),_:1}),t(e(Y),{onClick:r[3]||(r[3]=y=>b.value=!1)},{default:l(()=>[...r[9]||(r[9]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Q),null,{default:l(()=>[...r[6]||(r[6]=[i("ä»£ç é¢„è§ˆï¼š",-1)])]),_:1}),t(e(Q),null,{default:l(()=>[i(ne(h.value[s.value].insertText),1)]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...r[7]||(r[7]=[i("ä»£ç å†…å®¹",-1)])]),_:1}),t(e(ye),{value:s.value,"onUpdate:value":r[0]||(r[0]=y=>s.value=y),options:R},null,8,["value"])]),_:1}),Be(t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[i(ne(h.value[s.value].prepend_1),1)]),_:1}),t(e(ee),{value:M.value,"onUpdate:value":r[1]||(r[1]=y=>M.value=y),onKeyup:we(v,["enter"])},null,8,["value"])]),_:1},512),[[Ue,h.value[s.value].inputEnable_1]]),Be(t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[i(ne(h.value[s.value].prepend_2),1)]),_:1}),t(e(ee),{value:z.value,"onUpdate:value":r[2]||(r[2]=y=>z.value=y),onKeyup:we(v,["enter"])},null,8,["value"])]),_:1},512),[[Ue,h.value[s.value].inputEnable_2]])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),$t=["width","height"],zt=["width","height"],Dt=["onClick"],Ht=["title","innerHTML","onClick"],At=oe({__name:"DrawerModal",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(k,{expose:X,emit:S}){const A=re();se();const s=k,M=f(!1);function z(){M.value=!0}X({show:z});const R=S,h=f(),v=W(()=>{var m;return(m=h.value)==null?void 0:m.getContext("2d")}),b=f(),D=W(()=>{var m;return(m=b.value)==null?void 0:m.getContext("2d")}),I=new Image;let B=!1;const r={x:0,y:0,width:0,height:0},y=f([]),g=f([]),C=f([]),d=f({lineWidth:3,lineColor:"#111111",shadowBlur:1}),u=f(!1),p=f(!1);let c=0,L=0;const q=W(()=>window.innerWidth>836?796:window.innerWidth-36),N=W(()=>window.innerHeight>580?400:window.innerHeight-212),F=W(()=>[{title:"ä¸Šä¸€æ­¥",action:"prev",className:y.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>'},{title:"ä¸‹ä¸€æ­¥",action:"next",className:g.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>'},{title:"æ©¡çš®æ“¦",action:"eraser",className:y.value.length||g.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/></svg>'},{title:"æ¸…é™¤",action:"clear",className:y.value.length||g.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/></svg>'},{title:"æ‹–åŠ¨èƒŒæ™¯",action:"drag",className:p.value?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor"  viewBox="0 0 16 16"> <path d="M6.75 1a.75.75 0 0 1 .75.75V8a.5.5 0 0 0 1 0V5.467l.086-.004c.317-.012.637-.008.816.027.134.027.294.096.448.182.077.042.15.147.15.314V8a.5.5 0 1 0 1 0V6.435a4.9 4.9 0 0 1 .106-.01c.316-.024.584-.01.708.04.118.046.3.207.486.43.081.096.15.19.2.259V8.5a.5.5 0 0 0 1 0v-1h.342a1 1 0 0 1 .995 1.1l-.271 2.715a2.5 2.5 0 0 1-.317.991l-1.395 2.442a.5.5 0 0 1-.434.252H6.035a.5.5 0 0 1-.416-.223l-1.433-2.15a1.5 1.5 0 0 1-.243-.666l-.345-3.105a.5.5 0 0 1 .399-.546L5 8.11V9a.5.5 0 0 0 1 0V1.75A.75.75 0 0 1 6.75 1zM8.5 4.466V1.75a1.75 1.75 0 1 0-3.5 0v5.34l-1.2.24a1.5 1.5 0 0 0-1.196 1.636l.345 3.106a2.5 2.5 0 0 0 .405 1.11l1.433 2.15A1.5 1.5 0 0 0 6.035 16h6.385a1.5 1.5 0 0 0 1.302-.756l1.395-2.441a3.5 3.5 0 0 0 .444-1.389l.271-2.715a2 2 0 0 0-1.99-2.199h-.581a5.114 5.114 0 0 0-.195-.248c-.191-.229-.51-.568-.88-.716-.364-.146-.846-.132-1.158-.108l-.132.012a1.26 1.26 0 0 0-.56-.642 2.632 2.632 0 0 0-.738-.288c-.31-.062-.739-.058-1.05-.046l-.048.002zm2.094 2.025z"/></svg>'}]),G=[{lineWidth:3,innerHTML:"ğŸ–Œï¸",font_size:12},{lineWidth:6,innerHTML:"ğŸ–Œï¸",font_size:16},{lineWidth:12,innerHTML:"ğŸ–Œï¸",font_size:20}];function V(){const m=new ImageData(q.value,N.value);C.value.push(m)}We(()=>{V()});function n(){v.value.lineWidth=d.value.lineWidth,v.value.shadowBlur=d.value.shadowBlur,v.value.shadowColor=d.value.lineColor,v.value.strokeStyle=d.value.lineColor,v.value.lineCap="round",v.value.lineJoin="round"}function P(m){if(B)if(p.value){const o=m.target;let w,x;m instanceof MouseEvent?(w=m.clientX-o.getBoundingClientRect().x,x=m.clientY-o.getBoundingClientRect().y):(w=m.changedTouches[0].clientX-o.getBoundingClientRect().x,x=m.changedTouches[0].clientY-o.getBoundingClientRect().y),b.value.height=b.value.height;let U={x:r.x+(w-c),y:r.y+(x-L),width:r.width,height:r.height};le(I,U)}else{v.value.beginPath(),v.value.moveTo(c,L);const o=m.target;let w,x;m instanceof MouseEvent?(w=m.clientX-o.getBoundingClientRect().x,x=m.clientY-o.getBoundingClientRect().y):(w=m.changedTouches[0].clientX-o.getBoundingClientRect().x,x=m.changedTouches[0].clientY-o.getBoundingClientRect().y),v.value.globalCompositeOperation=u.value?"destination-out":"source-over",v.value.lineTo(w,x),[c,L]=[w,x],v.value.stroke()}}function me(m){if(p.value){const o=m.target;let w,x;m instanceof MouseEvent?(w=m.clientX-o.getBoundingClientRect().x,x=m.clientY-o.getBoundingClientRect().y):(w=m.changedTouches[0].clientX-o.getBoundingClientRect().x,x=m.changedTouches[0].clientY-o.getBoundingClientRect().y),r.x+=w-c,r.y+=x-L,B=!1}else{const o=v.value.getImageData(0,0,h.value.width,h.value.height);g.value.length?(C.value=[],C.value=C.value.concat(y.value),C.value.push(o),g.value=[]):C.value.push(o),B=!1}}function ke(m){if(p.value){const o=m.target;let w,x;m instanceof MouseEvent?(w=m.clientX-o.getBoundingClientRect().x,x=m.clientY-o.getBoundingClientRect().y):(w=m.changedTouches[0].clientX-o.getBoundingClientRect().x,x=m.changedTouches[0].clientY-o.getBoundingClientRect().y),c=w,L=x,B=!0}else{B=!0;const o=m.target;let w,x;m instanceof MouseEvent?(w=m.clientX-o.getBoundingClientRect().x,x=m.clientY-o.getBoundingClientRect().y):(w=m.changedTouches[0].clientX-o.getBoundingClientRect().x,x=m.changedTouches[0].clientY-o.getBoundingClientRect().y),n(),c=w,L=x;const U=v.value.getImageData(0,0,h.value.width,h.value.height);y.value.push(U)}}function Te(m){d.value.lineWidth=m,u.value=!1,p.value=!1}function pe(m){switch(m){case"prev":if(y.value.length){const o=y.value.pop(),w=C.value[y.value.length+1];g.value.push(w),v.value.putImageData(o,0,0)}break;case"next":if(g.value.length){const o=g.value.pop(),w=C.value[C.value.length-g.value.length-2];y.value.push(w),v.value.putImageData(o,0,0)}break;case"clear":v.value.clearRect(0,0,h.value.width,h.value.height),y.value=[],g.value=[],C.value=[C.value[0]];break;case"eraser":u.value=!0;break;case"drag":p.value=!0;break}}function $e(m){if(m.file.file){var o=new FileReader;o.readAsDataURL(m.file.file),o.onload=w=>{I.src=w.target.result,I.onload=function(){var x=b,U=I;r.width=U.width,r.height=U.height,U.width/U.height>=x.value.width/x.value.height?U.width>x.value.width&&(r.width=x.value.width,r.height=U.height*x.value.width/U.width):U.height>x.value.height&&(r.width=U.width*x.value.height/U.height,r.height=x.value.height),le(U,r)}}}}function le(m,o){D.value.drawImage(m,o.x,o.y,o.width,o.height)}const fe=f(!1);function ce(){let m=new Image;m.src=h.value.toDataURL("image/png"),m.onload=()=>{D.value.drawImage(m,0,0),o(b.value)};function o(x){x.toBlob(U=>{U&&w(U)},"image/png")}function w(x){const U={binggan:A.binggan,file:x,mode:"draw",thread_id:s.threadId,forum_id:s.forumId};fe.value=!0,Oe(U).then(xe=>{R("insertImage",xe.file_url),fe.value=!1,M.value=!1}).catch(()=>{fe.value=!1})}}return(m,o)=>(H(),j(e(ge),{show:M.value,"onUpdate:show":o[5]||(o[5]=w=>M.value=w),"display-directive":"show"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:q.value+4+"px"}),title:"æ¶‚é¸¦æ¿",closable:"",onClose:o[4]||(o[4]=w=>M.value=!1),size:"small","content-style":{padding:"0px"}},{default:l(()=>[J("div",{id:"canvas-container",style:Z({width:q.value+"px",height:N.value+"px"})},[J("canvas",{id:"drawer-canvas-background",ref_key:"canvasBackground",ref:b,width:q.value,height:N.value,onTouchmove:o[0]||(o[0]=Pe(()=>{},["prevent"]))},null,40,$t),J("canvas",{id:"drawer-canvas",ref_key:"canvas",ref:h,class:Se({painting:!p.value,dragging:p.value}),width:q.value,height:N.value,onTouchmove:[o[1]||(o[1]=Pe(()=>{},["prevent"])),P],onMousedown:ke,onMouseup:me,onMousemove:P,onTouchstart:ke,onTouchend:me},null,42,zt)],4),t(e(Ge),{"x-gap":"6",cols:4},{default:l(()=>[t(e(De),{span:"1"},{default:l(()=>[o[6]||(o[6]=J("div",null,"é¢œè‰²",-1)),t(e(Ve),{value:d.value.lineColor,"onUpdate:value":o[2]||(o[2]=w=>d.value.lineColor=w),modes:["hex"],"show-alpha":!1},null,8,["value"])]),_:1}),t(e(De),{span:"1"},{default:l(()=>[o[7]||(o[7]=J("div",null,"ç”»ç¬”",-1)),t(e(O),{id:"canvas-brush",size:"small",align:"center"},{default:l(()=>[(H(),ue(de,null,Ce(G,(w,x)=>J("span",{key:x,style:Z({fontSize:w.font_size+"px"}),onClick:U=>Te(w.lineWidth)},ne(w.innerHTML),13,Dt)),64))]),_:1})]),_:1}),t(e(De),{span:"2"},{default:l(()=>[o[8]||(o[8]=J("div",null,"æ“ä½œ",-1)),t(e(O),{id:"canvas-control",size:"small"},{default:l(()=>[(H(!0),ue(de,null,Ce(F.value,(w,x)=>(H(),ue("span",{key:x,title:w.title,class:Se([w.className]),innerHTML:w.innerHTML,onClick:U=>pe(w.action)},null,10,Ht))),128))]),_:1})]),_:1})]),_:1})]),action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Ae),{"default-upload":!1,onChange:$e,"show-file-list":!1},{default:l(()=>[t(e(Y),null,{default:l(()=>[...o[9]||(o[9]=[i("åŠ è½½å›¾ç‰‡",-1)])]),_:1})]),_:1}),t(e(Y),{type:"primary",onClick:ce,disabled:k.userIsLocked,loading:fe.value},{default:l(()=>[...o[10]||(o[10]=[i("ä¸Šä¼ ",-1)])]),_:1},8,["disabled","loading"]),t(e(Y),{onClick:o[3]||(o[3]=w=>M.value=!1)},{default:l(()=>[...o[11]||(o[11]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Pt=["onClick"],Lt=["src"],Bt=oe({__name:"EmojiTab",props:{randomHeadsGroup:{default:1},autoHide:{type:Boolean,default:!0}},emits:["appendEmoji"],setup(k,{emit:X}){const S=re(),A=se(),s=k,M=W(()=>{let r=0,y=0;return A.isMobile&&(A.userCustom.sidebarLeft?r=20:y=20),{paddingLeft:r+"px",paddingRight:y+"px"}}),z=f(),R=W(()=>{const r=Ct.filter(y=>!S.userData.emoji_excluded.includes(y.id)&&(y.headsId===0||y.headsId===s.randomHeadsGroup));return S.userData.my_emoji&&r.unshift({id:0,headsId:0,name:"è‡ªå®šä¹‰",emojis:S.userData.my_emoji}),r}),h=X;function v(r,y){h("appendEmoji",r,y==="è‡ªå®šä¹‰"),s.autoHide&&(z.value=-1)}let b=!1;function D(r,y){return be("span",{onClick:()=>I(y),innerHTML:r})}function I(r){r===z.value&&(b=!0,z.value=-1)}function B(r,y){return b?(b=!1,!1):!0}return(r,y)=>(H(),j(e(Ke),{type:"line","bar-width":0,animated:"",onBeforeLeave:B,size:e(A).isMobile?"small":"medium","default-value":-1,value:z.value,"onUpdate:value":y[0]||(y[0]=g=>z.value=g)},{default:l(()=>[(H(!0),ue(de,null,Ce(R.value,(g,C)=>(H(),j(e(Re),{name:g.id,tab:D(g.name,g.id)},{default:l(()=>[t(e(O),{size:"small",class:"emoji-container",style:Z(M.value)},{default:l(()=>[(H(!0),ue(de,null,Ce(g.emojis,(d,u)=>(H(),ue("div",{class:"emoji-box",onClick:p=>v(d,g.name)},[J("img",{src:d,class:"emoji-in-box"},null,8,Lt)],8,Pt))),256))]),_:2},1032,["style"])]),_:2},1032,["name","tab"]))),256)),t(e(Re),{name:-1,tab:"éšè—"})]),_:1},8,["size","value"]))}}),Ee=10,Ut=oe({__name:"HongbaoModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(k,{expose:X,emit:S}){const A=se(),s=re(),M=k,z=[{value:1,label:"å£ä»¤çº¢åŒ… ç›´æ¥å…¬å¼€å£ä»¤"},{value:2,label:"æŠ¢ç­”çº¢åŒ… å›å¤ç­”å¯¹æ‰å…¬å¼€å£ä»¤"},{value:3,label:"æš—å·çº¢åŒ… æŠ¢å®Œçº¢åŒ…æ‰å…¬å¼€å£ä»¤"}],R=[{value:1,label:"éšæœºolo"},{value:2,label:"å®šé¢olo"}],h=f(3e3),v=f(10),b=f(1),D=f(1),I=f(),B=f(),r=f([]),y=f(!1),g=f(),C=W(()=>A.isDouble11?Math.ceil(h.value*1.02):A.isOctober1st&&v.value>=20?h.value:Math.ceil(h.value*1.07)),d=f(1);function u(V){V===1&&d.value<Ee&&(d.value+=1),V===-1&&d.value>1&&(r.value.splice(d.value-1,1),d.value-=1)}const{loading:p,send:c,onSuccess:L}=Me(V=>kt(V),{immediate:!1});function q(){function V(){const n={binggan:s.binggan,forum_id:M.forumId,thread_id:M.threadId,hongbao_olo:h.value,hongbao_num:v.value,type:b.value,key_word_type:D.value,hongbao_key_word:I.value,hongbao_question:B.value,hongbao_message_json:r.value,hongbao_olo_hide:y.value,pic_url:g.value};c(n)}if(I.value===void 0){window.$message.error("å¿…é¡»å¡«å†™â€œçº¢åŒ…å£ä»¤â€å–”");return}if(B.value===void 0&&[2,3].includes(D.value)){window.$message.error("æŠ¢ç­”çº¢åŒ…æˆ–è€…æš—å·çº¢åŒ…æ—¶ï¼Œå¿…é¡»å¡«å†™â€œå£ä»¤æç¤ºâ€å–”");return}if(b.value===2&&h.value%v.value!==0){const n={title:"æé†’",closable:!1,content:"oloæ€»é¢ä¸æ˜¯çº¢åŒ…ä¸ªæ•°çš„æ•´å€æ•°ï¼Œå¤šå‡ºçš„ä½™æ•°oloå°†åœ¨æœ€åä¸€ä¸ªçº¢åŒ…å‘å‡ºã€‚",positiveText:"ç¡®å®š",negativeText:"å–æ¶ˆ",onPositiveClick:()=>{V()}};window.$dialog.warning(n);return}V()}L(()=>{G("refreshPostsList"),N.value=!1});const N=f(!1);function F(){N.value=!0}X({show:F});const G=S;return(V,n)=>(H(),j(e(ge),{show:N.value,"onUpdate:show":n[12]||(n[12]=P=>N.value=P),"display-directive":"if"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:e(A).modalMaxWidth}),title:"å‘èµ·çº¢åŒ…",closable:"",onClose:n[11]||(n[11]=P=>N.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Y),{type:"primary",onClick:q,disabled:e(p),loading:e(p)},{default:l(()=>[...n[31]||(n[31]=[i("æäº¤",-1)])]),_:1},8,["disabled","loading"]),t(e(Y),{onClick:n[10]||(n[10]=P=>N.value=!1)},{default:l(()=>[...n[32]||(n[32]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[J("div",null,[t(e(Q),{depth:3},{default:l(()=>[...n[13]||(n[13]=[i("æ¸©é¦¨æç¤ºï¼š",-1)])]),_:1}),e(A).isDouble11?(H(),j(e(Q),{key:0},{default:l(()=>[...n[14]||(n[14]=[J("del",null,"åœ¨çº¢åŒ…æ€»é¢ä»¥å¤–ï¼Œä¼šè¿½åŠ æ‰£é™¤7%æ‰‹ç»­è´¹ã€‚",-1),J("br",null,null,-1),i(" æ´»åŠ¨æœŸé—´é™æ—¶æ‰‹ç»­è´¹2%ï¼ ",-1)])]),_:1})):e(A).isOctober1st?(H(),j(e(Q),{key:1},{default:l(()=>[n[16]||(n[16]=J("del",null,"åœ¨çº¢åŒ…æ€»é¢ä»¥å¤–ï¼Œä¼šè¿½åŠ æ‰£é™¤7%æ‰‹ç»­è´¹ã€‚",-1)),n[17]||(n[17]=J("br",null,null,-1)),n[18]||(n[18]=i(" 10æœˆ1æ—¥â€œçº¢åŒ…ä¸ªæ•°â€åœ¨20ä¸ªåŠä»¥ä¸Šæ—¶ï¼Œæ‰‹ç»­è´¹",-1)),t(e(Q),{type:"error"},{default:l(()=>[...n[15]||(n[15]=[i("0%!!",-1)])]),_:1})]),_:1})):(H(),j(e(Q),{key:2},{default:l(()=>[...n[19]||(n[19]=[i(" åœ¨çº¢åŒ…æ€»é¢ä»¥å¤–ï¼Œä¼šè¿½åŠ æ‰£é™¤7%æ‰‹ç»­è´¹ã€‚ ",-1)])]),_:1}))]),J("div",null,[t(e(Q),{depth:3},{default:l(()=>[...n[20]||(n[20]=[i("æ€»å…±æ‰£é™¤ï¼š",-1)])]),_:1}),t(e(Q),{type:"warning"},{default:l(()=>[i(ne(C.value),1)]),_:1}),n[21]||(n[21]=i("ä¸ªå¥¥åˆ©å¥¥ ",-1))]),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[22]||(n[22]=[i("çº¢åŒ…ç±»å‹",-1)])]),_:1}),t(e(ye),{value:D.value,"onUpdate:value":n[0]||(n[0]=P=>D.value=P),options:z},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[23]||(n[23]=[i("oloç±»å‹",-1)])]),_:1}),t(e(ye),{value:b.value,"onUpdate:value":n[1]||(n[1]=P=>b.value=P),options:R},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[24]||(n[24]=[i("çº¢åŒ…ä¸ªæ•°",-1)])]),_:1}),t(e(he),{value:v.value,"onUpdate:value":n[2]||(n[2]=P=>v.value=P),max:50,min:5,step:5},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[25]||(n[25]=[i("oloæ€»é¢",-1)])]),_:1}),t(e(he),{value:h.value,"onUpdate:value":n[3]||(n[3]=P=>h.value=P),max:1e6,min:3e3,step:1e3,parse:e(Xe),format:e(Ye)},null,8,["value","parse","format"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[26]||(n[26]=[i("çº¢åŒ…å£ä»¤",-1)])]),_:1}),t(e(ee),{value:I.value,"onUpdate:value":n[4]||(n[4]=P=>I.value=P),placeholder:"å¿…å¡«"},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[27]||(n[27]=[i("çº¢åŒ…å°é¢",-1)])]),_:1}),t(e(ee),{value:g.value,"onUpdate:value":n[5]||(n[5]=P=>g.value=P),placeholder:"ï¼ˆå¯é€‰ï¼‰å¡«å†™å›¾ç‰‡çš„å®Œæ•´ç½‘å€"},null,8,["value"])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[28]||(n[28]=[i("å£ä»¤æç¤º",-1)])]),_:1}),t(e(ee),{value:B.value,"onUpdate:value":n[6]||(n[6]=P=>B.value=P),placeholder:"æŠ¢ç­”çº¢åŒ…æˆ–è€…æš—å·çº¢åŒ…æ—¶ï¼Œå¿…å¡«"},null,8,["value"])]),_:1}),(H(!0),ue(de,null,Ce(d.value,P=>(H(),j(e(_),null,{default:l(()=>[t(e(E),{style:{width:"5.2rem"}},{default:l(()=>[...n[29]||(n[29]=[i("å›å¤ç•™è¨€",-1)])]),_:1}),t(e(ee),{value:r.value[P-1],"onUpdate:value":me=>r.value[P-1]=me,placeholder:`#${P}ï¼ˆå¯é€‰ï¼‰ å¤šä¸ªç•™è¨€æ—¶éšæœºæŠ½å–ä¸€ä¸ª`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),t(e(O),{size:"small",align:"center"},{default:l(()=>[t(e(Q),{depth:3},{default:l(()=>[...n[30]||(n[30]=[i("ç•™è¨€æ•°é‡",-1)])]),_:1}),t(e(je),{size:"tiny",circle:"",disabled:d.value>=Ee,onClick:n[7]||(n[7]=P=>u(1))},{icon:l(()=>[t(e(ae),null,{default:l(()=>[t(e(Je))]),_:1})]),_:1},8,["disabled"]),t(e(je),{size:"tiny",circle:"",disabled:d.value<=1,onClick:n[8]||(n[8]=P=>{u(-1)})},{icon:l(()=>[t(e(ae),null,{default:l(()=>[t(e(Qe))]),_:1})]),_:1},8,["disabled"]),t(e(Ze),{checked:y.value,"onUpdate:checked":n[9]||(n[9]=P=>y.value=P),label:"éšè—oloæ€»é¢",style:{"margin-left":"auto"}},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),St=oe({__name:"ImageUpload",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(k,{emit:X}){const S=se(),A=re(),s=f(null),M=k,z=X,R=["mjj","imgbb","freeimage","picgo","tutu"],h=["imge","imgtbl","imgimg","helloimg","picui","imgwang"],v=W(()=>M.forumId===419?0:R.includes(S.userCustom.imgHost)?1:h.includes(S.userCustom.imgHost)?2:1),b=f(!1),D=({file:g,data:C,headers:d,withCredentials:u,action:p,onFinish:c,onError:L,onProgress:q})=>{var N;if(g.file!==null){if(g.file.size>1024e3){window.$message.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10Må–”"),(N=s.value)==null||N.clear();return}const F={binggan:A.binggan,file:g.file,mode:"img",thread_id:M.threadId,forum_id:M.forumId};b.value=!0,Oe(F).then(G=>{var V;z("insertImage",G.file_url),(V=s.value)==null||V.clear(),b.value=!1}).catch(()=>{var G;(G=s.value)==null||G.clear(),b.value=!1})}};function I(g){var C=document.getElementsByTagName("body")[0],d=document.createElement("script");d.setAttribute("id","image-upload-js");var u=document.getElementById("upload-button");g=="mjj"&&(d.setAttribute("async","true"),d.setAttribute("data-mode","manual"),d.setAttribute("src","https://mjj.today/sdk/pup.js"),d.setAttribute("data-url","https://mjj.today/upload"),d.setAttribute("data-auto-insert","html-embed"),u==null||u.setAttribute("data-chevereto-pup-trigger","")),g=="imgbb"&&(d.setAttribute("async","true"),d.setAttribute("data-mode","manual"),d.setAttribute("src","https://imgbb.com/upload.js"),d.setAttribute("data-url","https://imgbb.com/upload"),d.setAttribute("data-auto-insert","html-embed-medium"),u==null||u.setAttribute("data-imgbb-trigger","")),g=="freeimage"&&(d.setAttribute("async","true"),d.setAttribute("data-mode","manual"),d.setAttribute("src","https://freeimage.host/sdk/pup.js"),d.setAttribute("data-url","https://freeimage.host/upload"),d.setAttribute("data-auto-insert","html-embed-medium"),u==null||u.setAttribute("data-chevereto-pup-trigger","")),g=="picgo"&&(d.setAttribute("async","true"),d.setAttribute("data-mode","manual"),d.setAttribute("src","https://www.picgo.net/sdk/pup.js"),d.setAttribute("data-url","https://www.picgo.net/upload"),d.setAttribute("data-auto-insert","html-embed"),u==null||u.setAttribute("data-chevereto-pup-trigger","")),C.appendChild(d)}const B=W(()=>({imge:"https://imge.cc/api/v1/upload",imgtbl:"https://imgtbl.com/api/v1/upload",imgimg:"https://imgimg.cc/api/v1/upload",helloimg:"https://www.helloimg.com/api/v1/upload",picui:"https://picui.cn/api/v1/upload",imgwang:"https://img.wang/api/v1/upload"})[S.userCustom.imgHost]||""),r=({file:g,data:C,headers:d,withCredentials:u,action:p,onFinish:c,onError:L,onProgress:q})=>{if(g.file!==null){const N={file:g.file,url:B.value};b.value=!0,ft(N).then(F=>{var G;console.log(F.data),F.status===!0?z("insertImage",F.data.links.url):window.$message.error(F.message),(G=s.value)==null||G.clear(),b.value=!1}).catch(()=>{var F;(F=s.value)==null||F.clear(),b.value=!1})}};function y(){const g=document.getElementById("image-upload-js");g==null||g.remove()}return We(()=>{R.includes(S.userCustom.imgHost)&&I(S.userCustom.imgHost)}),et(()=>{y()}),(g,C)=>(H(),ue(de,null,[v.value===0?(H(),j(e(Ae),{key:0,accept:"image/*","custom-request":D,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:s},{default:l(()=>[t(e(Y),{style:{"margin-right":"auto"},disabled:k.userIsLocked,loading:b.value},{default:l(()=>[...C[0]||(C[0]=[i("ä¸Šä¼ å›¾ç‰‡",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):te("",!0),v.value===1?(H(),j(e(Y),{key:1,style:{"margin-right":"auto"},disabled:k.userIsLocked,"data-target":"#content-input",id:"upload-button"},{default:l(()=>[...C[1]||(C[1]=[i("ä¸Šä¼ å›¾ç‰‡",-1)])]),_:1},8,["disabled"])):te("",!0),v.value===2?(H(),j(e(Ae),{key:2,accept:"image/*","custom-request":r,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:s},{default:l(()=>[t(e(Y),{style:{"margin-right":"auto"},disabled:k.userIsLocked,loading:b.value},{default:l(()=>[...C[2]||(C[2]=[i("ä¸Šä¼ å›¾ç‰‡",-1)])]),_:1},8,["disabled","loading"])]),_:1},512)):te("",!0)],64))}}),Rt=oe({__name:"PingbiciModal",setup(k,{expose:X}){const S=se(),A=re(),s=f(),{loading:M,send:z,onSuccess:R}=Me(D=>gt(D),{immediate:!1});function h(){if(!s.value){window.$message.error("è¯·å¡«å†™å±è”½è¯");return}const D={binggan:A.binggan,content_pingbici:s.value};z(D)}R(()=>{A.refreshUserData(),v.value=!1});const v=f(!1);function b(){v.value=!0}return X({show:b}),(D,I)=>(H(),j(e(ge),{show:v.value,"onUpdate:show":I[3]||(I[3]=B=>v.value=B),"display-directive":"if"},{default:l(()=>[t(e(ve),{style:Z({maxWidth:e(S).modalMaxWidth}),title:"è¿½åŠ å±è”½è¯",closable:"",onClose:I[2]||(I[2]=B=>v.value=!1),size:"small"},{action:l(()=>[t(e(O),{justify:"end"},{default:l(()=>[t(e(Y),{type:"primary",onClick:h,loading:e(M),disabled:!s.value||e(M)},{default:l(()=>[...I[6]||(I[6]=[i("æäº¤",-1)])]),_:1},8,["loading","disabled"]),t(e(Y),{onClick:I[1]||(I[1]=B=>v.value=!1)},{default:l(()=>[...I[7]||(I[7]=[i("å…³é—­",-1)])]),_:1})]),_:1})]),default:l(()=>[t(e(O),{vertical:""},{default:l(()=>[t(e(Q),null,{default:l(()=>[...I[4]||(I[4]=[i("æš‚æ—¶åªåšäº†â€œå†…å®¹å±è”½è¯â€çš„è¿½åŠ ",-1)])]),_:1}),t(e(_),null,{default:l(()=>[t(e(E),{style:{width:"4.2rem"}},{default:l(()=>[...I[5]||(I[5]=[i("å±è”½è¯",-1)])]),_:1}),t(e(ee),{value:s.value,"onUpdate:value":I[0]||(I[0]=B=>s.value=B),maxlength:20,"show-count":"",onKeyup:we(h,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Ot=oe({__name:"PostInput",props:{mode:{},disabled:{type:Boolean},handling:{type:Boolean},forumId:{default:0},threadId:{default:0},randomHeadsGroup:{default:1}},emits:["contentCommit","refreshPostsList"],setup(k,{expose:X,emit:S}){const A=re(),s=se(),M=f(null),z=f(null),R=f(null),h=f(null),v=f(null),b=f(null),D=f(null),I=k,B=W(()=>({fontSize:s.userCustom.fontSizeInput+"px",borderRadius:"10px"})),r=W(()=>{const T=(u.value.match(/\r?\n|\r/g)||[]).length+2;return T<5?5:T>10?10:T}),y=W(()=>A.userData.binggan.locked_ttl>0?`ä½ çš„é¥¼å¹²å°ç¦ä¸­ï¼Œå°†äº${Math.floor(A.userData.binggan.locked_ttl/3600)+1}å°æ—¶åè§£å°`:"æ­£æ–‡å†…å®¹"),g=W(()=>A.userData.binggan.locked_ttl>0),C=f(A.userData.binggan.nickname||"= ="),d=f(""),u=f(""),p=f(!1),c=f(!1);function L(){C.value=A.userData.binggan.nickname||"= =",d.value="",u.value="",p.value=!1,c.value=!1}const q=W(()=>({id:0,created_at:"é¢„è§ˆæ¨¡å¼",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:u.value,nickname:C.value,is_your_post:!0,hongbao_data:null})),N=W(()=>({class:{"nickname-input":!0,admin:c.value}})),F=f(!1),G=tt("emoji_auto_hide",!1);function V(){let T=[be(Ie,{checked:F.value,"onUpdate:checked":a=>F.value=a,label:"å®æ—¶é¢„è§ˆ"}),be(Ie,{checked:G.value,"onUpdate:checked":a=>G.value=a,label:"è¡¨æƒ…åŒ…è‡ªåŠ¨æ”¶èµ·"})];return A.userData.binggan.admin!==0&&A.checkAdminForums(I.forumId)&&T.push(be(Ie,{checked:c.value,"onUpdate:checked":a=>c.value=a,label:"ç®¡ç†å‘˜"})),be(O,{style:"padding:6px 8px",vertical:!0},()=>T)}const n=[{key:"funcOption",type:"render",render:V}],P=[{label:"æ¶‚é¸¦æ¿",key:"draw",icon:_e(vt,{size:"1.5rem"})},{label:"å±è”½è¯",key:"mute",icon:_e(mt,{size:"1.5rem"})}];function me(T){var a,$;switch(T){case"mute":(a=v.value)==null||a.show();break;case"draw":($=D.value)==null||$.show();break}}Le(c,T=>C.value=T?"ç®¡ç†å‘˜":"= =");function ke(T){return T.selectionStart!=null?T.selectionStart:0}function Te(T,a){const $=ke(T),K=T.value,qe=K.substring(0,$)+a+K.substring($);u.value=qe,setTimeout(()=>{T.selectionStart=$+a.length,T.selectionEnd=$+a.length},0)}function pe(T){const a=document.getElementById("content-input");Te(a,T),ce(),a.focus()}function $e(){pt({title:"è¦æ¸…ç©ºå†…å®¹å—ï¼Ÿ",onPositiveClick:()=>u.value=""})}const le=f([""]);function fe(){le.value.length>1&&(le.value.pop(),u.value=le.value.slice(-1)[0])}function ce(){var T;le.value.push((T=u.value)!=null?T:""),le.value.length>20&&le.value.shift()}function m(T,a){pe(`<img src='${T}' class='${a?"custom-emoji-img":"emoji-img"}'>`)}function o(T){pe(T)}function w(T){pe(`<img src='${T}' />`)}function x(T){var a;u.value=T,ce(),(a=M.value)==null||a.focus()}const U=S;function xe(T){if(!T.isTrusted){const $={title:"é”™è¯¯",closable:!1,content:"è¯·ä¸è¦ç”¨è„šæœ¬å›å¤å–”ï¼Œå¯èƒ½ä¼šè¢«ç³»ç»Ÿåˆ¤æ–­ä¸ºè„šæœ¬å¹¶ç¢é¥¼å¹²ã€‚",positiveText:"ç¡®å®š"};window.$dialog.warning($);return}new Promise(function($,K){U("contentCommit",{contentInput:u.value,nicknameInput:C.value,postWithAdmin:c.value,titleInput:d.value,isDelay:p.value,ist:T.isTrusted},$)}).then(Fe)}function Fe(){d.value="",u.value="",p.value=!1}const ze=f(!1);return X({quoteHandle:x,isTyping:ze,resetInput:L}),(T,a)=>(H(),j(e(O),{vertical:""},{default:l(()=>[F.value?(H(),ue(de,{key:0},[k.mode==="thread"?(H(),j(e(ve),{class:"thread-title-container",size:"small",key:"title-card"},{default:l(()=>[J("span",{class:"thread-title",style:Z({fontSize:e(s).userCustom.fontSizeThreadList+"px"})},ne(d.value||"æ ‡é¢˜é¢„è§ˆ")+" [0] ",5)]),_:1})):te("",!0),t(xt,{"post-data":q.value,"forum-id":0,"preview-mode":!0},null,8,["post-data"])],64)):te("",!0),t(e(O),{size:"small",wrap:!1,align:"center",style:Z({paddingRight:e(s).isMobile?"24px":"0px"})},{default:l(()=>[t(e(_),{style:{"max-width":"300px"}},{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...a[15]||(a[15]=[i("æ˜µç§°",-1)])]),_:1}),t(e(ee),{maxlength:30,value:C.value,"onUpdate:value":a[0]||(a[0]=$=>C.value=$),"show-count":"","input-props":N.value},null,8,["value","input-props"])]),_:1}),t(e(Ne),{trigger:e(s).isMobile?"click":"hover",options:n,placement:"bottom-start"},{default:l(()=>[t(e(Y),{size:"medium",style:{"flex-shrink":"0"},secondary:!1},{default:l(()=>[...a[16]||(a[16]=[i("åŠŸèƒ½",-1)])]),_:1})]),_:1},8,["trigger"])]),_:1},8,["style"]),k.mode==="thread"?(H(),j(e(_),{key:1},{default:l(()=>[t(e(E),{style:{width:"3.2rem"}},{default:l(()=>[...a[17]||(a[17]=[i("æ ‡é¢˜",-1)])]),_:1}),t(e(ee),{maxlength:100,value:d.value,"onUpdate:value":a[1]||(a[1]=$=>d.value=$),"show-count":"",placeholder:"æ ‡é¢˜å†…å®¹"},null,8,["value"])]),_:1})):te("",!0),t(Bt,{"auto-hide":e(G),"random-heads-group":k.randomHeadsGroup,onAppendEmoji:m},null,8,["auto-hide","random-heads-group"]),t(e(O),{size:e(s).isMobile?"small":"medium",justify:"end",align:"center",style:Z({paddingRight:e(s).isMobile?"24px":"0px"})},{default:l(()=>[t(e(Ne),{trigger:"click",options:P,onSelect:me,size:e(s).isMobile?"medium":"large"},{default:l(()=>[t(e(ae),{size:e(s).isMobile?20:24,style:{cursor:"pointer"}},{default:l(()=>[t(e(lt))]),_:1},8,["size"])]),_:1},8,["size"]),k.mode==="post"?(H(),j(e(ie),{key:0,placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(at),{style:{cursor:"pointer"},onClick:a[2]||(a[2]=$=>{var K;return(K=z.value)==null?void 0:K.show()})})]),_:1},8,["size"])]),default:l(()=>[a[18]||(a[18]=i(" å‘çº¢åŒ… ",-1))]),_:1},8,["trigger"])):te("",!0),k.mode==="post"?(H(),j(e(ie),{key:1,placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(nt),{style:{cursor:"pointer"},onClick:a[3]||(a[3]=$=>{var K;return(K=R.value)==null?void 0:K.show()})})]),_:1},8,["size"])]),default:l(()=>[a[19]||(a[19]=i(" å¤§ä¹±æ–— ",-1))]),_:1},8,["trigger"])):te("",!0),k.mode==="post"?(H(),j(e(ie),{key:2,placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(ut),{style:{cursor:"pointer"},onClick:a[4]||(a[4]=$=>{var K;return(K=h.value)==null?void 0:K.show()})})]),_:1},8,["size"])]),default:l(()=>[a[20]||(a[20]=i(" Rollç‚¹ ",-1))]),_:1},8,["trigger"])):te("",!0),t(e(ie),{placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(ot),{style:{cursor:"pointer"},onClick:a[5]||(a[5]=$=>{var K;return(K=b.value)==null?void 0:K.show()})})]),_:1},8,["size"])]),default:l(()=>[a[21]||(a[21]=i(" å¿«æ·ä»£ç  ",-1))]),_:1},8,["trigger"]),t(e(st),{vertical:""}),t(e(ie),{placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(it),{style:{cursor:"pointer"},onClick:fe})]),_:1},8,["size"])]),default:l(()=>[a[22]||(a[22]=i(" æ’¤é”€ ",-1))]),_:1},8,["trigger"]),t(e(ie),{placement:"bottom-start",trigger:e(s).isMobile?"click":"hover"},{trigger:l(()=>[t(e(ae),{size:e(s).isMobile?28:32},{default:l(()=>[t(e(rt),{style:{cursor:"pointer"},onClick:$e})]),_:1},8,["size"])]),default:l(()=>[a[23]||(a[23]=i(" æ¸…ç©º ",-1))]),_:1},8,["trigger"])]),_:1},8,["size","style"]),t(e(dt),{value:u.value,"onUpdate:value":a[6]||(a[6]=$=>u.value=$),type:"textarea",placeholder:y.value,rows:r.value,ref_key:"contentInputDom",ref:M,style:Z(B.value),"input-props":{id:"content-input"},disabled:g.value,onChange:ce,onKeyup:a[7]||(a[7]=we(Pe($=>xe($),["ctrl"]),["enter"])),onBlur:a[8]||(a[8]=$=>ze.value=!1),onFocus:a[9]||(a[9]=$=>ze.value=!0)},null,8,["value","placeholder","rows","style","disabled"]),t(e(O),{justify:"end",align:"center"},{default:l(()=>[t(St,{"user-is-locked":g.value,"forum-id":k.forumId,"thread-id":k.threadId,onInsertImage:w},null,8,["user-is-locked","forum-id","thread-id"]),k.mode==="thread"?(H(),j(e(ie),{key:0,placement:"bottom-start",trigger:"hover",disabled:e(s).isMobile},{trigger:l(()=>[t(e(Ie),{checked:p.value,"onUpdate:checked":a[10]||(a[10]=$=>p.value=$)},{default:l(()=>[...a[24]||(a[24]=[i("å»¶æ—¶å‘é€",-1)])]),_:1},8,["checked"])]),default:l(()=>[a[25]||(a[25]=i(" ç¬¬äºŒå¤©8ç‚¹è‡ªåŠ¨å‘å‡º ",-1))]),_:1},8,["disabled"])):te("",!0),t(e(ie),{placement:"bottom-start",trigger:"hover",disabled:e(s).isMobile},{trigger:l(()=>[t(e(Y),{type:"primary",onClick:a[11]||(a[11]=$=>xe($)),loading:k.handling,disabled:k.handling||g.value},{default:l(()=>[...a[26]||(a[26]=[i("æäº¤",-1)])]),_:1},8,["loading","disabled"])]),default:l(()=>[a[27]||(a[27]=i(" å¯ä»¥Ctrl+Enter ",-1))]),_:1},8,["disabled"])]),_:1}),t(Ut,{ref_key:"HongbaoModalCom",ref:z,"thread-id":k.threadId,"forum-id":k.forumId,onRefreshPostsList:a[12]||(a[12]=$=>U("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(Mt,{ref_key:"BattleModalCom",ref:R,"thread-id":k.threadId,"forum-id":k.forumId,"random-heads-group":k.randomHeadsGroup,onRefreshPostsList:a[13]||(a[13]=$=>U("refreshPostsList"))},null,8,["thread-id","forum-id","random-heads-group"]),t(It,{ref_key:"RollModalCom",ref:h,"thread-id":k.threadId,"forum-id":k.forumId,onRefreshPostsList:a[14]||(a[14]=$=>U("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(Rt,{ref_key:"PingbiciModalCom",ref:v},null,512),t(Tt,{ref_key:"CodeModalCom",ref:b,onInsertCode:o},null,512),t(At,{ref_key:"DrawerModalCom",ref:D,onInsertImage:w,"user-is-locked":g.value,"forum-id":k.forumId,"thread-id":k.threadId},null,8,["user-is-locked","forum-id","thread-id"])]),_:1}))}});export{Ot as _};
