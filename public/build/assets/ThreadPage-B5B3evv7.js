import{x as J,z as N,A as s,V as $,ar as Et,o as Ot,as as fe,b as y,F as _,K as t,R as o,t as e,S as se,T as ie,U as S,a1 as x,X as l,_ as T,Q as Ie,a5 as Fe,Y as Oe,at as qe,Z as he,q as D,W as w,au as jt,av as at,aw as mt,w as Z,a6 as ft,i as Ce,n as je,ax as ke,ay as pe,a2 as pt,az as Ut,aA as Ft,a3 as gt,a4 as vt,aB as be,N as ge,aC as Ve,a9 as Ae,aD as ht,aE as Vt,$ as ne,J as Se,aF as Bt,aq as Wt,P as Kt,am as Yt,an as Qt,a7 as nt,a0 as Jt,a8 as st,ao as lt,ap as Xt,al as Zt,C as He,aG as eo}from"./vendor-DamaS_bj.js";import{h as to,a as oo,g as _t,n as ao,D as no,_ as rt,p as so}from"./emojiData-BZl9PvKN.js";import{t as lo,p as it}from"./showDialog-DfAZGtWi.js";import{u as le,c as V,f as Ue,b as ee,d as _e,g as ro,h as re,i as W,r as ve,_ as xe,a as X,e as ut}from"./app-CRZ7Digb.js";import{_ as dt}from"./loudspeaker-Dtgrv2yY.js";import{_ as io,a as uo}from"./PostInput.vue_vue_type_script_setup_true_lang-DJEI9F7-.js";import{S as co,L as Ee,a as mo,U as fo,D as po}from"./LoudspeakerComponent-wzXM4NPN.js";import{u as go,t as vo,a as ho,d as _o,r as bo,b as wo,c as yo,e as ko,f as Co}from"./admin-DHMiVug_.js";import{i as So,a as Io}from"./inputNumberFormat-BPxWRFt_.js";import{u as xo}from"./browseLogger-C2_cwgCY.js";import{D as $o}from"./Delete-BfEHc_M2.js";import"./forums-DgGzAUO0.js";const Po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 576 512"},Mo=$("path",{d:"M528.1 171.5L382 150.2L316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2L47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103l-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5l105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3l23.7-138.4l-100.6-98l139-20.2l62.2-126l62.2 126l139 20.2l-100.6 98z",fill:"currentColor"},null,-1),zo=[Mo],Lo=J({name:"StarRegular",render:function(n,u){return s(),N("svg",Po,zo)}}),Do={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 576 512"},To=$("path",{d:"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 35.7 22.5 72.4 61.9 100.7c31.5 22.7 69.8 37.1 110 41.7C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6c40.3-4.6 78.6-19 110-41.7c39.3-28.3 61.9-65 61.9-100.7V88c0-13.3-10.7-24-24-24zM99.3 192.8C74.9 175.2 64 155.6 64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2c-15.1-5.2-29.2-12.4-41.7-21.4zM512 144c0 16.1-17.7 36.1-35.3 48.8c-12.5 9-26.7 16.2-41.8 21.4c7-25 11.8-53.6 12.8-86.2H512v16z",fill:"currentColor"},null,-1),Ro=[To],Ho=J({name:"Trophy",render:function(n,u){return s(),N("svg",Do,Ro)}}),Ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 640 512"},qo=$("path",{d:"M608 320h-64v64h22.4c5.3 0 9.6 3.6 9.6 8v16c0 4.4-4.3 8-9.6 8H73.6c-5.3 0-9.6-3.6-9.6-8v-16c0-4.4 4.3-8 9.6-8H96v-64H32c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32h576c17.7 0 32-14.3 32-32v-96c0-17.7-14.3-32-32-32zm-96 64V64.3c0-17.9-14.5-32.3-32.3-32.3H160.4C142.5 32 128 46.5 128 64.3V384h384zM211.2 202l25.5-25.3c4.2-4.2 11-4.2 15.2.1l41.3 41.6l95.2-94.4c4.2-4.2 11-4.2 15.2.1l25.3 25.5c4.2 4.2 4.2 11-.1 15.2L300.5 292c-4.2 4.2-11 4.2-15.2-.1l-74.1-74.7c-4.3-4.2-4.2-11 0-15.2z",fill:"currentColor"},null,-1),No=[qo],Go=J({name:"VoteYea",render:function(n,u){return s(),N("svg",Ao,No)}}),Eo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},Oo=$("g",{fill:"none"},[$("path",{d:"M24.134 32.634a1.25 1.25 0 0 0 0-1.768l-5.616-5.616H32.75a1.25 1.25 0 1 0 0-2.5H18.518l5.616-5.616a1.25 1.25 0 0 0-1.768-1.768l-7.75 7.75a1.25 1.25 0 0 0 0 1.768l7.75 7.75a1.25 1.25 0 0 0 1.768 0zM24 44c11.046 0 20-8.954 20-20S35.046 4 24 4S4 12.954 4 24s8.954 20 20 20zm17.5-20c0 9.665-7.835 17.5-17.5 17.5S6.5 33.665 6.5 24S14.335 6.5 24 6.5S41.5 14.335 41.5 24z",fill:"currentColor"})],-1),jo=[Oo],Uo=J({name:"ArrowCircleLeft48Regular",render:function(n,u){return s(),N("svg",Eo,jo)}}),Fo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Vo=$("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),Bo=$("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 320L192 192"},null,-1),Wo=$("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M192 320l128-128"},null,-1),Ko=[Vo,Bo,Wo],bt=J({name:"CloseCircleOutline",render:function(n,u){return s(),N("svg",Fo,Ko)}}),Yo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Qo=$("path",{d:"M48 366.92L240 480V284L48 170zM192 288c8.84 0 16 10.75 16 24s-7.16 24-16 24s-16-10.75-16-24s7.16-24 16-24zm-96 32c8.84 0 16 10.75 16 24s-7.16 24-16 24s-16-10.75-16-24s7.16-24 16-24z",fill:"currentColor"},null,-1),Jo=$("path",{d:"M272 284v196l192-113.08V170zm48 140c-8.84 0-16-10.75-16-24s7.16-24 16-24s16 10.75 16 24s-7.16 24-16 24zm0-88c-8.84 0-16-10.75-16-24s7.16-24 16-24s16 10.75 16 24s-7.16 24-16 24zm96 32c-8.84 0-16-10.75-16-24s7.16-24 16-24s16 10.75 16 24s-7.16 24-16 24zm0-88c-8.84 0-16-10.75-16-24s7.16-24 16-24s16 10.75 16 24s-7.16 24-16 24zm32 77.64z",fill:"currentColor"},null,-1),Xo=$("path",{d:"M256 32L64 144l192 112l192-112zm0 120c-13.25 0-24-7.16-24-16s10.75-16 24-16s24 7.16 24 16s-10.75 16-24 16z",fill:"currentColor"},null,-1),Zo=[Qo,Jo,Xo],ea=J({name:"DiceSharp",render:function(n,u){return s(),N("svg",Yo,Zo)}});var ta=Et();const oa=Ot(ta);window.Pusher=oa;class aa{_echoConnector;constructor(){this._echoConnector=null}connect(){if(this._echoConnector===null){const n=window.location.hostname;this._echoConnector=new fe({broadcaster:"reverb",key:"h1gdqae9h4rihjohv1vv",wsHost:n,wsPort:"8090",wssPort:"8090",forceTLS:!0,enabledTransports:["ws","wss"],namespace:""})}else throw new Error("Echo实例已经连接过了")}disconnect(){if(this._echoConnector instanceof fe)this._echoConnector.disconnect(),this._echoConnector=null;else throw new Error("Echo实例已经删除过了")}channel(n){if(this._echoConnector instanceof fe)return this._echoConnector.channel(n);throw new Error("Echo实例需要先连接.connect()")}leaveChannel(n){if(this._echoConnector instanceof fe)this._echoConnector.leaveChannel(n);else throw new Error("Echo实例需要先连接.connect()")}leaveAllChannels(){if(this._echoConnector instanceof fe)this._echoConnector.leaveAllChannels();else throw new Error("Echo实例需要先连接.connect()")}get isConnected(){return this._echoConnector instanceof fe}get pusher(){return this._echoConnector instanceof fe?this._echoConnector.connector.pusher:null}}function na(){return new aa}const sa={0:{name:"空白占位",ImgSrc:""},23410:{name:"已日清",ImgSrc:"https://wmimg.com/i/1547/2025/02/67adef97cf647.png"},23401:{name:"olo不足",ImgSrc:"https://wmimg.com/i/1547/2025/02/67adef9811f04.png"},234011:{name:"私密主题",ImgSrc:"https://wmimg.com/i/1547/2025/02/67adef97ce810.png"},23404:{name:"板块or主题不存在",ImgSrc:"https://wmimg.com/i/1547/2025/02/67adef9818836.png"},21404:{name:"需要饼干",ImgSrc:"https://wmimg.com/i/1547/2025/02/67adef97e42d8.png"}},la=["src"],ra=J({__name:"ForbiddenModal",setup(f,{expose:n}){const u=y(0),R=y(""),v=le(),h=y(!1);function I(p){u.value=p.errorCode,R.value=p.message,h.value=!0}return n({show:I}),(p,i)=>(s(),_(e(Ie),{show:h.value,"onUpdate:show":i[2]||(i[2]=g=>h.value=g),"display-directive":"if"},{default:t(()=>[o(e(se),{style:ie({maxWidth:e(v).modalMaxWidth}),closable:"",onClose:i[1]||(i[1]=g=>h.value=!1),size:"small"},{action:t(()=>[o(e(S),{justify:"end"},{default:t(()=>[o(e(V),{onClick:i[0]||(i[0]=g=>h.value=!1)},{default:t(()=>[...i[3]||(i[3]=[l("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[o(e(S),{vertical:""},{default:t(()=>[$("img",{style:{width:"100%"},src:e(sa)[u.value].ImgSrc},null,8,la),o(e(x),null,{default:t(()=>[l(T(R.value),1)]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),ia=J({__name:"JumpModal",props:{threadId:{},postsNum:{},page:{}},setup(f,{expose:n}){const u=le(),R=Fe(),v=f,h=y(),I=y(!1);function p(){I.value=!0}n({show:p});function i(){if(h.value!==void 0){const g=Math.ceil((h.value+1)/200),k="#f_"+h.value;if(R.push({name:"thread",params:{threadId:v.threadId,page:g},hash:k}),g===v.page){const M=document.querySelector(k);M?.scrollIntoView({block:"center",behavior:"auto"}),M?.classList.add("on-focus")}I.value=!1}}return(g,k)=>(s(),_(e(Ie),{show:I.value,"onUpdate:show":k[3]||(k[3]=M=>I.value=M),"display-directive":"if"},{default:t(()=>[o(e(se),{style:ie({maxWidth:e(u).modalMaxWidth}),title:"跳楼机",closable:"",onClose:k[2]||(k[2]=M=>I.value=!1),size:"small"},{action:t(()=>[o(e(S),{justify:"end"},{default:t(()=>[o(e(V),{type:"primary",onClick:i,disabled:!h.value},{default:t(()=>[...k[5]||(k[5]=[l("Jump!",-1)])]),_:1},8,["disabled"]),o(e(V),{onClick:k[1]||(k[1]=M=>I.value=!1)},{default:t(()=>[...k[6]||(k[6]=[l("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[o(e(S),{vertical:""},{default:t(()=>[o(e(x),null,{default:t(()=>[l(" 最大高度："+T(g.postsNum)+"楼 ",1)]),_:1}),o(e(Oe),null,{default:t(()=>[o(e(Ue),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...k[4]||(k[4]=[l("跳楼",-1)])]),_:1}),o(e(qe),{placeholder:"请输入楼层号",max:g.postsNum,value:h.value,"onUpdate:value":k[0]||(k[0]=M=>h.value=M),onKeyup:he(i,["enter"])},null,8,["max","value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),ua=J({__name:"AdminActionModal",props:{threadId:{},forumId:{default:0}},emits:["refreshPostsList"],setup(f,{expose:n,emit:u}){const R=le(),v=ee(),h=Fe(),I=y(null),p=f,i=y({contentInput:void 0,switchInput:!1}),g=y("hint"),k=y(!0),M=y();let b;const O=D(()=>({contentInput:{required:P.value.requireContent,message:"请填写理由"},switchInput:{required:!1}})),K={hint:{requireContent:!1,contentMessage:!1,requireSwitch:!1},ban:{requireContent:!0,contentMessage:"你要永久粉碎这个饼干吗？",requireSwitch:!1},lock:{requireContent:!0,contentMessage:`要封禁这个饼干吗？
第1次3天、2次6天、3次9天、4次碎饼`,requireSwitch:!1},deleteAll:{requireContent:!0,contentMessage:`要用管理员权限删除该饼干全部回复吗？
此功能请谨慎使用，仅在有恶意刷屏时。`,requireSwitch:!0},delete:{requireContent:!0,contentMessage:"要用管理员权限删除这个回复吗？",requireSwitch:!0},recovery:{requireContent:!0,contentMessage:"要用管理员权限恢复这个回复吗？",requireSwitch:!1},deleteThread:{requireContent:!0,contentMessage:"要用管理员权限删除这个主题吗？",requireSwitch:!1},setTop:{requireContent:!1,contentMessage:"要设为置顶吗？",requireSwitch:!1},cancelTop:{requireContent:!1,contentMessage:"要取消置顶吗？",requireSwitch:!1}},P=D(()=>K[g.value]),d=y(!1);function C(z){g.value=z.action,b=z.postId??0,M.value=void 0,d.value=!0,z.action==="hint"?(k.value=!1,q("hint")):k.value=!0}n({show:C});const H=u;function q(z){if(z==="hint"){M.value="查询中……";const m={binggan:v.binggan,thread_id:p.threadId,post_id:b};go(m).then(c=>{M.value=`此饼干状态：${c.user_status}。已被锁定过${c.locked_count}次。`});return}I.value?.validate(m=>{if(m){window.$message.error("请确认信息填写完整");return}else switch(z){case"ban":const c={binggan:v.binggan,thread_id:p.threadId,post_id:b,content:i.value.contentInput};Co(c).then(()=>{d.value=!1,H("refreshPostsList")});break;case"lock":const G={binggan:v.binggan,thread_id:p.threadId,post_id:b,content:i.value.contentInput};ko(G).then(()=>{d.value=!1,H("refreshPostsList")});break;case"deleteAll":const te={binggan:v.binggan,thread_id:p.threadId,post_id:b,content:i.value.contentInput,reduce_olo:i.value.switchInput};yo(te).then(()=>{d.value=!1,H("refreshPostsList")});break;case"delete":const B={binggan:v.binggan,thread_id:p.threadId,post_id:b,content:i.value.contentInput,reduce_olo:i.value.switchInput};wo(B).then(()=>{d.value=!1,H("refreshPostsList")});break;case"recovery":const j={binggan:v.binggan,thread_id:p.threadId,post_id:b,content:i.value.contentInput};bo(j).then(()=>{d.value=!1,H("refreshPostsList")});break;case"deleteThread":const oe={binggan:v.binggan,thread_id:p.threadId,content:i.value.contentInput};_o(oe).then(()=>{d.value=!1,h.push({name:"forum",params:{forumId:p.forumId,page:1}})});break;case"setTop":const E={binggan:v.binggan,thread_id:p.threadId};ho(E).then(()=>{d.value=!1,H("refreshPostsList")});break;case"cancelTop":const A={binggan:v.binggan,thread_id:p.threadId};vo(A).then(()=>{d.value=!1,H("refreshPostsList")});break}})}return(z,m)=>(s(),_(e(Ie),{show:d.value,"onUpdate:show":m[5]||(m[5]=c=>d.value=c),"display-directive":"if",size:"small"},{default:t(()=>[o(e(se),{style:ie({maxWidth:e(R).modalMaxWidth}),title:"管理员操作",closable:"",onClose:m[4]||(m[4]=c=>d.value=!1),size:"small"},{action:t(()=>[o(e(S),{justify:"end"},{default:t(()=>[k.value?(s(),_(e(V),{key:0,type:"warning",onClick:m[2]||(m[2]=c=>q(g.value))},{default:t(()=>[...m[7]||(m[7]=[l("提交",-1)])]),_:1})):w("",!0),o(e(V),{onClick:m[3]||(m[3]=c=>d.value=!1)},{default:t(()=>[...m[8]||(m[8]=[l("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[o(e(S),{vertical:""},{default:t(()=>[P.value.contentMessage?(s(),_(e(x),{key:0,style:{"white-space":"pre-wrap"}},{default:t(()=>[l(T(P.value.contentMessage),1)]),_:1})):w("",!0),M.value?(s(),_(e(x),{key:1},{default:t(()=>[l(T(M.value),1)]),_:1})):w("",!0),o(e(jt),{ref_key:"formRef",ref:I,model:i.value,"label-placement":"left","label-width":"auto",rules:O.value,size:e(R).isMobile?"small":"medium",style:{"margin-top":"10px"}},{default:t(()=>[P.value.requireContent?(s(),_(e(at),{key:0,label:"理由",path:"contentInput"},{default:t(()=>[o(e(_e),{placeholder:"必填",value:i.value.contentInput,"onUpdate:value":m[0]||(m[0]=c=>i.value.contentInput=c)},null,8,["value"])]),_:1})):w("",!0),P.value.requireSwitch?(s(),_(e(at),{key:1,label:"罚款olo",path:"switchInput"},{default:t(()=>[o(e(mt),{value:i.value.switchInput,"onUpdate:value":m[1]||(m[1]=c=>i.value.switchInput=c)},null,8,["value"]),o(e(x),{style:{"margin-left":"6px"}},{default:t(()=>[...m[6]||(m[6]=[l("每个帖子罚款500，封顶5000个olo",-1)])]),_:1})]),_:1})):w("",!0)]),_:1},8,["model","rules","size"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),da=J({__name:"RewardModal",emits:["refreshPostsList"],setup(f,{expose:n,emit:u}){const R=le(),v=ee(),h=y(100),I=y(),p=y(!1),i=y();function g(P){i.value=P,p.value=!0}n({show:g});const k=u;function M(){const P={binggan:v.binggan,post_floor_message:"@"+i.value.postFloorMessage,forum_id:i.value.forumId,thread_id:i.value.threadId,post_id:i.value.postId,coin:h.value,content:I.value};O(P)}const{loading:b,send:O,onSuccess:K}=Z(P=>ro(P),{immediate:!1});return K(()=>{p.value=!1,k("refreshPostsList")}),(P,d)=>(s(),_(e(Ie),{show:p.value,"onUpdate:show":d[4]||(d[4]=C=>p.value=C),"display-directive":"if"},{default:t(()=>[o(e(se),{style:ie({maxWidth:e(R).modalMaxWidth}),title:`打赏给№${i.value?.floor}`,closable:"",onClose:d[3]||(d[3]=C=>p.value=!1),size:"small"},{action:t(()=>[o(e(S),{justify:"end"},{default:t(()=>[o(e(V),{type:"primary",onClick:M,loading:e(b)},{default:t(()=>[...d[12]||(d[12]=[l("打赏",-1)])]),_:1},8,["loading"]),o(e(V),{onClick:d[2]||(d[2]=C=>p.value=!1)},{default:t(()=>[...d[13]||(d[13]=[l("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[o(e(S),{vertical:""},{default:t(()=>[$("div",null,[e(R).isDouble11?(s(),_(e(x),{key:1},{default:t(()=>[...d[6]||(d[6]=[$("del",null,"友情提示：在打赏额以外，会追加扣除7%手续费。",-1),$("br",null,null,-1),l(" 活动期间限时手续费2%！ ",-1)])]),_:1})):(s(),_(e(x),{key:0},{default:t(()=>[...d[5]||(d[5]=[l(" 友情提示：在打赏额以外，会追加扣除7%手续费。",-1)])]),_:1})),d[9]||(d[9]=$("br",null,null,-1)),o(e(x),null,{default:t(()=>[...d[7]||(d[7]=[l("总共扣除：",-1)])]),_:1}),o(e(x),{type:"error"},{default:t(()=>[l(T(Math.ceil(h.value*(e(R).isDouble11?1.02:1.07))),1)]),_:1}),o(e(x),null,{default:t(()=>[...d[8]||(d[8]=[l("块奥利奥。",-1)])]),_:1})]),o(e(Oe),null,{default:t(()=>[o(e(Ue),{style:{width:"3.2rem"}},{default:t(()=>[...d[10]||(d[10]=[l("打赏",-1)])]),_:1}),o(e(qe),{type:"password",placeholder:"olo数量","show-password-on":"mousedown",clearable:"",value:h.value,"onUpdate:value":d[0]||(d[0]=C=>h.value=C),onKeyup:he(M,["enter"]),max:1e6,min:1,step:1e3,parse:e(Io),format:e(So)},null,8,["value","parse","format"])]),_:1}),o(e(Oe),null,{default:t(()=>[o(e(Ue),{style:{width:"3.2rem"},class:"round"},{default:t(()=>[...d[11]||(d[11]=[l("留言",-1)])]),_:1}),o(e(_e),{value:I.value,"onUpdate:value":d[1]||(d[1]=C=>I.value=C),placeholder:"（可留空）",onKeyup:he(M,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style","title"])]),_:1},8,["show"]))}});let ct;function ca(f,n=500){return function(...u){clearTimeout(ct),ct=setTimeout(()=>{f(...u)},n)}}const ma=J({__name:"BrowseLogger",props:{postsListLoading:{type:Boolean},disableScroll:{type:Boolean,default:!1},isSearch:{type:Boolean},threadId:{},page:{}},setup(f){const n=f,u=y(!1),R=ft(),v=xo();function h(){function p(){const g=window.innerWidth/2;return document.elementsFromPoint(g,100)}ca(()=>{const g=p(),k=v.get(n.threadId);g.forEach(M=>{const b=Number(M.getAttribute("floor"));b&&b>k.floor&&v.log(n.threadId,b)})},100)()}function I(){if(!R.hash&&v.get(n.threadId)){const p=v.get(n.threadId),i=Math.ceil((p.floor+1)/200);if(i===n.page&&p.floor!==0){const g=document.getElementById("f_"+p.floor);g!==null&&(g.scrollIntoView({behavior:"auto",block:"center"}),window.$message.success(`已自动滚到上次浏览进度${p.floor}楼`))}i>n.page&&(u.value=!0)}}return Ce(()=>n.postsListLoading,p=>{p===!1&&!n.disableScroll&&je(()=>I())}),ke(()=>{v.initThread(n.threadId),window.addEventListener("scroll",h)}),pe(()=>{u.value=!1,window.removeEventListener("scroll",h)}),(p,i)=>{const g=pt("router-link");return u.value&&!p.isSearch?(s(),_(e(Ut),{key:0,type:"success",closable:"",style:{"border-radius":"10px"}},{default:t(()=>[l(" 你上次已经浏览到"+T(e(v).get(p.threadId).floor)+"楼， ",1),o(g,{onClick:i[0]||(i[0]=k=>u.value=!1),to:{name:"thread",params:{threadId:p.threadId,page:Math.ceil((e(v).get(p.threadId).floor+1)/200)}}},{default:t(()=>[...i[1]||(i[1]=[l(" 点击这里 ",-1)])]),_:1},8,["to"]),i[2]||(i[2]=l(" 跳转 ",-1))]),_:1})):w("",!0)}}}),fa=J({__name:"ChangeColorModal",props:{threadId:{}},emits:["refreshPostsList"],setup(f,{expose:n,emit:u}){const R=le(),v=ee(),h=f,I=y(),p=["#b65954","#c78878","#9b7e70","#de7562","#fca44b","#f1c727","#f6da79","#fbda97","#9fc778","#78c79f","#8ab185","#98c0d9","#8691db","#7878c7","#566b7c","#9678c7","#9f78c7","#ca95e9","#ecacc6","#a86fa2","#7e3749"],i=y(!1);function g(){i.value=!0}n({show:g});const{loading:k,send:M,onSuccess:b}=Z(K=>lo(K),{immediate:!1});function O(){if(!I.value){window.$message.error("颜色输入不能为空");return}const K={binggan:v.binggan,thread_id:h.threadId,color:I.value};M(K),b(()=>i.value=!1)}return(K,P)=>(s(),_(e(Ie),{show:i.value,"onUpdate:show":P[3]||(P[3]=d=>i.value=d),"display-directive":"if"},{default:t(()=>[o(e(se),{style:ie({maxWidth:e(R).modalMaxWidth}),title:"标题改色",closable:"",onClose:P[2]||(P[2]=d=>i.value=!1),size:"small"},{action:t(()=>[o(e(S),{justify:"end"},{default:t(()=>[o(e(V),{type:"primary",onClick:O,disabled:e(k),loading:e(k)},{default:t(()=>[...P[5]||(P[5]=[l("提交",-1)])]),_:1},8,["disabled","loading"]),o(e(V),{onClick:P[1]||(P[1]=d=>i.value=!1)},{default:t(()=>[...P[6]||(P[6]=[l("关闭",-1)])]),_:1})]),_:1})]),default:t(()=>[o(e(S),{vertical:""},{default:t(()=>[o(e(x),null,{default:t(()=>[...P[4]||(P[4]=[l(" 要更换标题颜色吗？每次收费500个olo喔 ",-1)])]),_:1}),o(e(Ft),{value:I.value,"onUpdate:value":P[0]||(P[0]=d=>I.value=d),modes:["hex"],"show-alpha":!1,style:{"max-width":"8.2rem"},swatches:p},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),pa=ee(),ga=f=>{const n=re.Get("api/crowds/"+f,{name:"crowdDataGetter-"+f,params:{binggan:pa.binggan},localCache:null,hitSource:[]});return n.meta={shouldRemind:!1},n},va=f=>{const n=re.Post("api/crowds/",f,{name:"userCrowdPoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},ha=f=>{const n=re.Post("api/crowds/repeal",f,{name:"adminCrowdRepealPoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},_a={style:{"text-align":"center"}},ba={key:0},wa={key:1},ya={key:2},ka={key:3},Ca=J({__name:"CrowdComponent",props:{crowdId:{},forumId:{}},setup(f){gt(B=>({"02a8d6e9":e(v).dividerColor}));const n=f,u=ee(),R=le(),v=vt(),h=y(1e3),I=D(()=>{const B=W.tz(C.value.end_date),j=W(),oe=B.diff(j,"hour");return oe>=1?`${oe}小时后`:`${B.diff(j,"minute")}分钟后`}),p=D(()=>W.tz(C.value.end_date).format("YY年M月D日 HH:mm")),i=D(()=>W().isAfter(W.tz(C.value.end_date))),g=[{label:"中止",key:"repeal",icon:ve(bt,{size:"1.5rem"})}];function k(B){switch(B){case"repeal":te();break}}const M=[{title:"我支持的olo",key:"olo",resizable:!0},{title:"参与时间",key:"created_at",resizable:!0}],{data:b,loading:O,send:K,onSuccess:P}=Z(ga(n.crowdId),{immediate:!1});function d(){K({binggan:u.binggan})}u.binggan&&d();const C=D(()=>b.value?.crowd),H=D(()=>b.value?.crowd_record??[]),q=D(()=>Math.round(C.value.olo_total/C.value.olo_target*100)),{loading:z,send:m,onSuccess:c}=Z(B=>va(B),{immediate:!1});c(()=>{d()});function G(){if(!h.value){window.$message.error("请输入众筹金额喔");return}const B={binggan:u.binggan,crowd_olo:h.value,crowd_id:n.crowdId},j={title:"参加众筹",closable:!1,content:`确定要参加众筹吗？将消耗${h.value}个olo`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{m(B)}};window.$dialog.warning(j)}function te(){const B={binggan:u.binggan,crowd_id:n.crowdId},j={title:"中止众筹",closable:!1,content:"确定要中止众筹吗？已投注的olo将会退回",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{ha(B).then(()=>{d()})}};window.$dialog.warning(j)}return(B,j)=>(s(),_(e(se),{size:"small",bordered:!0},{default:t(()=>[o(e(be),{show:e(O)},{default:t(()=>[C.value!==void 0?(s(),_(e(S),{key:0,vertical:""},{default:t(()=>[o(e(S),{size:"small",align:"center",class:"crowd-title"},{default:t(()=>[o(e(ge),{size:e(R).isMobile?24:32},{default:t(()=>[o(e(Ho))]),_:1},8,["size"]),$("span",null,T(C.value.title),1)]),_:1}),o(e(S),{vertical:"",align:"center"},{default:t(()=>[o(e(Ve),{type:"dashboard",status:"success",percentage:q.value},{default:t(()=>[$("span",_a,"进度"+T(q.value)+"% ",1)]),_:1},8,["percentage"]),i.value&&C.value.is_closed===0?(s(),N("span",ba,"众筹已经过期了")):w("",!0),C.value.is_closed===1?(s(),N("span",wa,"众筹已达成目标！谢谢各位参与~")):w("",!0),C.value.is_closed===2?(s(),N("span",ya,"众筹已经被管理员中止，olo已退回")):w("",!0),!i.value&&C.value.is_closed===0?(s(),N("div",ka,[o(e(x),{depth:3},{default:t(()=>[...j[1]||(j[1]=[l("结束时间：",-1)])]),_:1}),$("span",null,T(p.value)+" ("+T(I.value)+")",1)])):w("",!0),$("div",null,[o(e(x),{depth:3},{default:t(()=>[...j[2]||(j[2]=[l("众筹目标：",-1)])]),_:1}),$("span",null,T(`${C.value.olo_target.toLocaleString("en-us")} 个olo`),1)]),$("div",null,[o(e(x),{depth:3},{default:t(()=>[...j[3]||(j[3]=[l("已众筹到：",-1)])]),_:1}),$("span",null,T(`${C.value.olo_total.toLocaleString("en-us")} 个olo`),1)]),o(e(S),{size:"small",align:"center"},{default:t(()=>[o(e(qe),{max:1e6,min:1,step:1e3,placeholder:"投入额",disabled:i.value||C.value.is_closed!==0,value:h.value,"onUpdate:value":j[0]||(j[0]=oe=>h.value=oe)},null,8,["disabled","value"]),o(e(V),{type:"primary",onClick:G,loading:e(z),disabled:e(z)||i.value||C.value.is_closed!==0},{default:t(()=>[...j[4]||(j[4]=[l("投入",-1)])]),_:1},8,["loading","disabled"]),e(u).checkAdminForums(B.forumId)&&C.value.is_closed===0?(s(),_(e(Ae),{key:0,trigger:e(R).isMobile?"click":"hover",options:g,onSelect:k,placement:"bottom-start"},{default:t(()=>[o(e(V),{type:"warning"},{default:t(()=>[...j[5]||(j[5]=[l("管理",-1)])]),_:1})]),_:1},8,["trigger"])):w("",!0)]),_:1})]),_:1}),H.value.length>0?(s(),_(e(ht),{key:0,columns:M,data:H.value,bordered:!1},null,8,["data"])):w("",!0)]),_:1})):w("",!0)]),_:1},8,["show"])]),_:1}))}}),Sa=xe(Ca,[["__scopeId","data-v-c8ea6852"]]),Ia=ee(),xa=f=>{const n=re.Get("api/gambles/"+f,{name:"gambleDataGetter-"+f,params:{binggan:Ia.binggan},localCache:null,hitSource:[]});return n.meta={shouldRemind:!1},n},$a=f=>{const n=re.Post("api/gambles/",f,{name:"userGamblePoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},Pa=f=>{const n=re.Post("api/gambles/close",f,{name:"adminGambleClosePoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},Ma=f=>{const n=re.Post("api/gambles/repeal",f,{name:"adminGambleRepealPoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},za={key:0},La={key:1},Da={key:2},Ta={key:3},Ra={class:"gamble-item"},Ha={style:{"margin-left":"auto"}},Aa=J({__name:"GambleComponent",props:{gambleId:{},forumId:{}},setup(f){gt(E=>({"8196b06e":e(v).dividerColor}));const n=f,u=ee(),R=le(),v=vt(),h=y(),I=y(1e3),p=D(()=>{const E=W.tz(H.value.end_date),A=W(),U=E.diff(A,"hour");return U>=1?`${U}小时后`:`${E.diff(A,"minute")}分钟后`}),i=D(()=>W.tz(H.value.end_date).format("YY年M月D日 HH:mm")),g=D(()=>W().isAfter(W.tz(H.value.end_date))),k=[{label:"开奖",key:"close",icon:ve(Lo,{size:"1.5rem"})},{label:"中止",key:"repeal",icon:ve(bt,{size:"1.5rem"})}];function M(E){switch(E){case"close":j();break;case"repeal":oe();break}}const b=[{title:"我的投注",key:"option_text",resizable:!0},{title:"投注额",key:"betting_olo",resizable:!0},{title:"赔率",key:"odds",render:E=>E.odds?.toFixed(2)??"（开奖时确定）",resizable:!0},{title:"奖金",key:"win_olo",resizable:!0}],{data:O,loading:K,send:P,onSuccess:d}=Z(xa(n.gambleId),{immediate:!1});function C(){P({binggan:u.binggan})}u.binggan&&C();const H=D(()=>O.value.gamble_question),q=D(()=>O.value.gamble_options),z=D(()=>O.value.user_choices?.map(E=>({...E,option_text:q.value.find(A=>A.id===E.option_id)?.option_text}))??[]),m=D(()=>q.value.find(E=>E.id===H.value.result_option_id)?.option_text),{loading:c,send:G,onSuccess:te}=Z(E=>$a(E),{immediate:!1});te(()=>{C()});function B(){if(!h.value||!I.value){window.$message.error("请选择选项和输入投注额喔");return}const E={binggan:u.binggan,gamble_question_id:n.gambleId,bet_option:h.value,betting_olo:I.value},A={title:"参加菠菜",closable:!1,content:`确定要参加菠菜吗？将消耗${I.value}个olo`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{G(E)}};window.$dialog.warning(A)}function j(){if(!h.value){window.$message.error("请选择选项喔");return}const E={binggan:u.binggan,gamble_question_id:n.gambleId,result_option:h.value},A={title:"开奖菠菜",closable:!1,content:`确定要开奖吗？开奖选项是：${q.value.find(U=>U.id===h.value)?.option_text}`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Pa(E).then(()=>{C()})}};window.$dialog.warning(A)}function oe(){const E={binggan:u.binggan,gamble_question_id:n.gambleId},A={title:"中止菠菜",closable:!1,content:"确定要中止菠菜吗？已投注的olo将会退回",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{Ma(E).then(()=>{C()})}};window.$dialog.warning(A)}return(E,A)=>(s(),_(e(se),{size:"small",bordered:!0},{default:t(()=>[o(e(be),{show:e(K)},{default:t(()=>[e(O)!==void 0?(s(),_(e(S),{key:0,vertical:""},{default:t(()=>[o(e(S),{size:"small",align:"center",class:"gamble-title"},{default:t(()=>[o(e(ge),{size:e(R).isMobile?24:32},{default:t(()=>[o(e(ea))]),_:1},8,["size"]),$("span",null,T(H.value.title),1)]),_:1}),o(e(Vt),{value:h.value,"onUpdate:value":A[0]||(A[0]=U=>h.value=U)},{default:t(()=>[o(e(S),{vertical:"",size:"large"},{default:t(()=>[(s(!0),N(ne,null,Se(q.value,(U,$e)=>(s(),N("div",{key:U.id},[o(e(Bt),{value:U.id,label:`（当前赔率 ${U.odds.toFixed(2)}）： ${U.id==H.value.result_option_id?"⭐":""} ${U.option_text}`},null,8,["value","label"]),o(e(Ve),{status:"success",type:"line",height:e(R).isMobile?20:24,percentage:Math.floor(U.olo_total/H.value.olo_total*100),"indicator-placement":"inside"},{default:t(()=>[l(T(U.olo_total),1)]),_:2},1032,["height","percentage"])]))),128))]),_:1})]),_:1},8,["value"]),g.value&&H.value.is_closed===0?(s(),N("span",za,"菠菜已经关闭投注")):w("",!0),H.value.is_closed===1?(s(),N("span",La,T(`菠菜已开奖，奖金已发放。中奖项是：${m.value}`),1)):w("",!0),H.value.is_closed===2?(s(),N("span",Da,"菠菜已经被管理员中止，投注olo已退回")):w("",!0),!g.value&&H.value.is_closed===0?(s(),N("div",Ta,[o(e(x),{depth:3},{default:t(()=>[...A[2]||(A[2]=[l("结束时间：",-1)])]),_:1}),$("span",null,T(i.value)+" ("+T(p.value)+")",1)])):w("",!0),o(e(S),{size:"small",align:"center"},{default:t(()=>[o(e(qe),{max:1e6,min:1,step:1e3,placeholder:"投注额",disabled:g.value||H.value.is_closed!==0,value:I.value,"onUpdate:value":A[1]||(A[1]=U=>I.value=U)},null,8,["disabled","value"]),o(e(V),{type:"primary",onClick:B,loading:e(c),disabled:e(c)||g.value||H.value.is_closed!==0},{default:t(()=>[...A[3]||(A[3]=[l("投注",-1)])]),_:1},8,["loading","disabled"]),e(u).checkAdminForums(E.forumId)&&H.value.is_closed===0?(s(),_(e(Ae),{key:0,trigger:e(R).isMobile?"click":"hover",options:k,onSelect:M,placement:"bottom-start"},{default:t(()=>[o(e(V),{type:"warning"},{default:t(()=>[...A[4]||(A[4]=[l("管理",-1)])]),_:1})]),_:1},8,["trigger"])):w("",!0)]),_:1}),!e(R).isMobile&&z.value.length>0?(s(),_(e(ht),{key:4,columns:b,data:z.value,bordered:!1},null,8,["data"])):w("",!0),e(R).isMobile?(s(),N(ne,{key:5},[z.value.length>0?(s(),_(e(S),{key:0,vertical:"",align:"start",size:"small"},{default:t(()=>[(s(!0),N(ne,null,Se(z.value,U=>(s(),N("div",Ra,[o(e(S),{style:{"margin-bottom":"6px"}},{default:t(()=>[$("div",null,[o(e(x),{depth:3},{default:t(()=>[...A[5]||(A[5]=[l("我的投注：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(U.option_text),1)]),_:2},1024)])]),_:2},1024),o(e(S),{style:{"margin-bottom":"6px"}},{default:t(()=>[$("div",null,[o(e(x),{depth:3},{default:t(()=>[...A[6]||(A[6]=[l("投注额：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(U.betting_olo),1)]),_:2},1024)])]),_:2},1024),U.win_olo?(s(),_(e(S),{key:0,style:{"margin-bottom":"6px"}},{default:t(()=>[$("div",null,[o(e(x),{depth:3},{default:t(()=>[...A[7]||(A[7]=[l("赔率：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(U.odds?.toFixed(2)),1)]),_:2},1024)]),$("div",Ha,[o(e(x),{depth:3},{default:t(()=>[...A[8]||(A[8]=[l("奖金：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(U.win_olo),1)]),_:2},1024)])]),_:2},1024)):w("",!0)]))),256))]),_:1})):w("",!0)],64)):w("",!0)]),_:1})):w("",!0)]),_:1},8,["show"])]),_:1}))}}),qa=xe(Aa,[["__scopeId","data-v-d08fb987"]]),Na={key:0},Ga=J({__name:"HongbaoComponent",props:{hongbaoId:{},threadId:{},forumId:{},noHongbaoPicMode:{type:Boolean}},emits:["refreshPostsList"],setup(f,{emit:n}){const u=ee(),R=le(),v=f,h=D(()=>g.value.pic_url&&!v.noHongbaoPicMode),I=D(()=>h.value?{backgroundImage:`linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)), url(${g.value.pic_url})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{}),p=y(),i=D(()=>({1:"随机olo",2:"定额olo"})[g.value.type]),{data:g,loading:k,send:M,onSuccess:b}=Z(to(v.hongbaoId),{immediate:!1,initialData:{}});b(q=>{p.value=q.data.key_word});function O(){M({binggan:u.binggan})}u.binggan&&O();const{loading:K,send:P,onSuccess:d}=Z(q=>oo(q),{immediate:!1});d(()=>{H("refreshPostsList")});function C(q){if(!q.isTrusted){const G={title:"错误",closable:!1,content:"请不要用脚本抢红包喔",positiveText:"确定"};window.$dialog.warning(G);return}const{timestamp:z,newPostKey:m}=_t(q.isTrusted,v.threadId,u.binggan),c={binggan:u.binggan,forum_id:v.forumId,thread_id:v.threadId,content:"--红包口令: "+p.value,nickname:"= =",post_with_admin:!1,new_post_key:m,timestamp:z,hongbao_id:v.hongbaoId,hongbao_key_word:p.value};P(c).then(()=>{O()})}const H=n;return(q,z)=>(s(),_(e(se),{size:"small",bordered:!0,class:"hongbao-card",style:ie(I.value)},{default:t(()=>[o(e(be),{show:e(k)},{default:t(()=>[o(e(S),{vertical:"",align:"center"},{default:t(()=>[o(e(S),{align:"center",size:"small"},{default:t(()=>[o(e(x),{style:{"font-size":"1rem"}},{default:t(()=>[...z[1]||(z[1]=[l("口令红包",-1)])]),_:1}),h.value?w("",!0):(s(),N("img",{key:0,src:"/hongbao.svg",style:ie({height:e(R).isMobile?"30px":"36px"})},null,4))]),_:1}),$("div",null,[e(g).key_word?(s(),_(e(x),{key:0,depth:3},{default:t(()=>[...z[2]||(z[2]=[l("口令：",-1)])]),_:1})):w("",!0),o(e(x),null,{default:t(()=>[l(T(e(g).key_word),1)]),_:1})]),$("div",null,[o(e(x),{depth:3},{default:t(()=>[...z[3]||(z[3]=[l("数量：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(e(g).num_remains)+" /"+T(e(g).num_total)+" （"+T(i.value)+"）",1)]),_:1})]),e(g).olo_hide?w("",!0):(s(),N("div",Na,[o(e(x),{depth:3},{default:t(()=>[...z[4]||(z[4]=[l("总额：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(e(g).olo_total?.toLocaleString("en-us"))+" olo ",1)]),_:1})])),o(e(S),{size:"small",wrap:!1},{default:t(()=>[e(g).hongbao_user===null?(s(),_(e(_e),{key:0,value:p.value,"onUpdate:value":z[0]||(z[0]=m=>p.value=m),maxlength:255,onKeyup:he(C,["enter"]),style:{"max-width":"328px"},placeholder:e(g).num_remains===0?"已经抢光啦":"请输入口令","auto-size":"",disabled:e(g).hongbao_user!==null||e(g).num_remains===0},null,8,["value","placeholder","disabled"])):(s(),_(e(_e),{key:1,value:`你抢到了${e(g).hongbao_user?.olo.toLocaleString("en-us")}个olo`,maxlength:255,style:{"max-width":"328px"},"auto-size":"",disabled:""},null,8,["value"])),o(e(V),{type:"primary",onClick:C,disabled:e(g).hongbao_user!==null||e(K)||e(g).num_remains===0},{default:t(()=>[...z[5]||(z[5]=[l("抢！",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["style"]))}}),Ea=xe(Ga,[["__scopeId","data-v-d0fedc06"]]),Oa=ee(),ja=f=>{const n=re.Get("api/votes/"+f,{name:"voteDataGetter-"+f,params:{binggan:Oa.binggan},localCache:null,hitSource:[]});return n.meta={shouldRemind:!1},n},Ua=f=>{const n=re.Post("api/votes/",f,{name:"userVotePoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},Fa={key:0},Va=J({__name:"VoteComponent",props:{voteId:{}},setup(f){const n=f,u=ee(),R=le(),v=y([]);Ce(v,(m,c)=>{m.length>O.value.max_choices&&(window.$message.error(`最多只能选择${O.value.max_choices}个选项喔`),v.value=c)});const h=D(()=>{const m=W.tz(O.value.end_date),c=W(),G=m.diff(c,"hour");return G>=1?`${G}小时后`:`${m.diff(c,"minute")}分钟后`}),I=D(()=>W.tz(O.value.end_date).format("YY年M月D日 HH:mm")),p=D(()=>W().isAfter(W.tz(O.value.end_date))),{data:i,loading:g,send:k,onSuccess:M}=Z(ja(n.voteId),{immediate:!1});M(m=>{m.data.user_choices&&(v.value=m.data.user_choices.options_id)});function b(){k({binggan:u.binggan})}u.binggan&&b();const O=D(()=>i.value.vote_question),K=D(()=>i.value.vote_options),P=D(()=>i.value.user_choices),d=D(()=>P.value!==null),{loading:C,send:H,onSuccess:q}=Z(m=>Ua(m),{immediate:!1});q(()=>{b()});function z(){const m={binggan:u.binggan,vote_question_id:n.voteId,vote_options:v.value};H(m)}return(m,c)=>(s(),_(e(se),{size:"small",bordered:!0},{default:t(()=>[o(e(be),{show:e(g)},{default:t(()=>[e(i)!==void 0?(s(),_(e(S),{key:0,vertical:""},{default:t(()=>[o(e(S),{size:"small",align:"center",class:"vote-title"},{default:t(()=>[o(e(ge),{size:e(R).isMobile?24:32},{default:t(()=>[o(e(Go))]),_:1},8,["size"]),$("span",null,T(e(i).vote_question.title),1)]),_:1}),o(e(Wt),{value:v.value,"onUpdate:value":c[0]||(c[0]=G=>v.value=G),disabled:d.value},{default:t(()=>[o(e(S),{vertical:"",size:"large"},{default:t(()=>[(s(!0),N(ne,null,Se(K.value,(G,te)=>(s(),N("div",{key:G.id},[o(e(Kt),{value:G.id,label:`${te+1}. ${G.option_text}`},null,8,["value","label"]),o(e(Ve),{status:"success",type:"line",height:e(R).isMobile?20:24,percentage:Math.floor(G.vote_total/O.value.vote_total*100),"indicator-placement":"inside"},{default:t(()=>[l(T(G.vote_total)+"票 ",1)]),_:2},1032,["height","percentage"])]))),128))]),_:1})]),_:1},8,["value","disabled"]),p.value?(s(),N("span",Fa,"投票已经结束了")):(s(),N(ne,{key:1},[$("div",null,[o(e(x),{depth:3},{default:t(()=>[...c[1]||(c[1]=[l("最多选择：",-1)])]),_:1}),$("span",null,T(O.value.max_choices)+"个选项",1)]),$("div",null,[o(e(x),{depth:3},{default:t(()=>[...c[2]||(c[2]=[l("结束时间：",-1)])]),_:1}),$("span",null,T(I.value)+" ("+T(h.value)+")",1)])],64)),o(e(S),{size:"small",align:"center"},{default:t(()=>[o(e(V),{type:"primary",onClick:z,loading:e(C),disabled:e(C)||d.value||p.value},{default:t(()=>[...c[3]||(c[3]=[l("投票",-1)])]),_:1},8,["loading","disabled"]),d.value?(s(),_(e(x),{key:0,depth:3},{default:t(()=>[...c[4]||(c[4]=[l("你已经投过票了，谢谢参与！",-1)])]),_:1})):w("",!0)]),_:1})]),_:1})):w("",!0)]),_:1},8,["show"])]),_:1}))}}),Ba=xe(Va,[["__scopeId","data-v-467006fa"]]),Wa=ee(),Ka=f=>{const n=re.Post("api/store_pool",f,{name:"poolStorePoster",params:{},localCache:null,hitSource:[]});return n.meta={shouldRemind:!0},n},Ya=()=>{const f=re.Get("api/get_pool",{name:"poolDataGetter",params:{binggan:Wa.binggan},localCache:null,hitSource:[]});return f.meta={shouldRemind:!1},f},Qa=J({__name:"PoolComponent",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(f,{emit:n}){const u=f,R=ee(),v=le(),h=W.tz("2025-1-29 00:00"),I=W.tz("2025-2-1 00:00"),p=D(()=>{const m=W.tz();return m<h?0:m>I?2:1}),i=D(()=>({0:`活动将于 ${h.format("M月D日H点")} 开始`,1:`请投入你的祝福~~，活动将于${I.format("M月D日H点")}结束。（${g.value}）`,2:"祝福池已关闭，请等待开奖。"})[p.value]),g=D(()=>{const m=W.tz(),c=I.diff(m,"hour"),G=I.diff(m,"minute")-60*c;return`剩余${c}小时${G}分钟`}),k=y(),{data:M,loading:b,send:O,onSuccess:K}=Z(Ya(),{immediate:!1,initialData:{}});function P(){O()}R.binggan&&P();const{loading:d,send:C,onSuccess:H}=Z(m=>Ka(m),{immediate:!1});function q(m){if(k.value===void 0){const G={title:"错误",closable:!1,content:"请输入祝福语喔",positiveText:"确定"};window.$dialog.warning(G);return}const c={binggan:R.binggan,forum_id:u.forumId,thread_id:u.threadId,message:k.value,olo:m?3e5:1e3,admin:m};C(c).then(()=>{P(),z("refreshPostsList")})}const z=n;return(m,c)=>(s(),_(e(se),{size:"small",bordered:!0},{default:t(()=>[o(e(be),{show:e(b)},{default:t(()=>[o(e(S),{vertical:"",align:"center"},{default:t(()=>[o(e(S),{align:"center",size:"small"},{default:t(()=>[o(e(x),{style:{"font-size":"1rem"}},{default:t(()=>[...c[4]||(c[4]=[l("祝福池",-1)])]),_:1}),$("img",{src:"/hongbao.svg",style:ie({height:e(v).isMobile?"30px":"36px"})},null,4)]),_:1}),$("div",null,[o(e(x),{depth:3},{default:t(()=>[...c[5]||(c[5]=[l("祝福池总额：",-1)])]),_:1}),o(e(x),null,{default:t(()=>[l(T(e(M).olo_total?.toLocaleString("en-us"))+" olo ",1)]),_:1})]),o(e(S),{size:"small",wrap:!1},{default:t(()=>[o(e(_e),{value:k.value,"onUpdate:value":c[0]||(c[0]=G=>k.value=G),maxlength:255,onKeyup:c[1]||(c[1]=he(G=>q(!1),["enter"])),style:{"max-width":"328px"},placeholder:e(M).user_pool===null?"请留下祝福语":"已经投过祝福啦","auto-size":"",disabled:e(M).user_pool!==null},null,8,["value","placeholder","disabled"]),o(e(V),{type:"primary",onClick:c[2]||(c[2]=G=>q(!1)),disabled:e(M).user_pool!==null||e(d)||p.value!==1},{default:t(()=>[...c[6]||(c[6]=[l("投入祝福",-1)])]),_:1},8,["disabled"]),e(R).admin.isSuperAdmin?(s(),_(e(V),{key:0,type:"warning",onClick:c[3]||(c[3]=G=>q(!0))},{default:t(()=>[...c[7]||(c[7]=[l("投入30w",-1)])]),_:1})):w("",!0)]),_:1}),o(e(S),{align:"center",size:"small"},{default:t(()=>[$("span",null,T(i.value),1)]),_:1})]),_:1})]),_:1},8,["show"])]),_:1}))}}),Ja={bordered:!0,class:"post-item-skeleton"},Xa=J({__name:"ThreadPage",props:{threadId:{},page:{},search:{}},setup(f){const n=ee(),u=le(),R=ft(),v=Fe(),h=y(null),I=y([]),p=y(null),i=y(null),g=y(null),k=y(null),M=y(null);ke(()=>{u.showTopbarNav=!1}),pe(()=>{u.showTopbarNav=!0});const b=f,O=y(null),K=y(null),P=y(null),d=y(null),C=y(null),H=y(null),q=y(!0),z=y(!1);ke(()=>{z.value=!0}),pe(()=>{z.value=!1});const m=D(()=>{const r=W.tz(F.value.nissin_date),a=W(),Y=r.diff(a,"hour"),L=r.diff(a,"minute")-60*Y;return`${Y}小时${L}分钟后`}),c=y(!1),G=y(!1),te=X("no_video_mode",!1),B=X("no_image_mode",!1),j=X("no_emoji_mode",!1),oe=X("no_custom_emoji_mode",!1),E=X("no_head_mode",!1),A=X("no_battle_mode",!1),U=X("no_roll_mode",!1),$e=X("no_reward_mode",!1),Be=X("no_hongbao_mode",!1),Pe=X("no_hongbao_pic_mode",!1),Me=X("no_mention_mode",!1),ze=X("use_url_mode",!1),We=X("no_pailou_mode",!1),wt=D(()=>{const r=[{ref:te,label:"音频视频"},{ref:B,label:"图片"},{ref:j,label:"一般表情包"},{ref:oe,label:"自定义表情包"},{ref:E,label:"头像"},{ref:A,label:"大乱斗"},{ref:U,label:"roll点"},{ref:$e,label:"打赏"},{ref:Be,label:"红包结果"},{ref:Pe,label:"红包封面"},{ref:Me,label:"关闭@标注"},{ref:We,label:"无内容排楼"}];return n.admin.isSuperAdmin?r.unshift({ref:c,label:"超管模式启动！"}):n.admin.isNormalAdmin&&r.unshift({ref:G,label:"让代码失效"}),r});function yt(){return He(S,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(wt.value).map(r=>He(ut,{checked:r.ref.value,"onUpdate:checked":a=>r.ref.value=a,label:r.label})),He(eo,{keepAliveOnHover:!1,placement:"bottom",style:{width:"max-content"}},{trigger:()=>He(ut,{checked:ze.value,"onUpdate:checked":r=>ze.value=r,label:"自动转换超链接"}),default:()=>"实验性功能，可能会导致回复显示出错"})])}const kt=[{type:"group",key:"header",label:"屏蔽"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:yt}],Ct=D(()=>{const r=[{label:"删除主题",key:"deleteThread",icon:ve($o,{size:"1.5rem"})}];return F.value.sub_id===0?r.push({label:"设为置顶",key:"setTop",icon:ve(fo,{size:"1.5rem"})}):r.push({label:"取消置顶",key:"cancelTop",icon:ve(po,{size:"1.5rem"})}),r});function St(r){H.value?.show({action:r})}const we=y(b.page);function Ke(r){v.push({name:"thread",params:{threadId:b.threadId,page:r},query:{search:b.search}})}Ce(()=>b.page,r=>we.value=r);const Ye=D(()=>({threadId:b.threadId,binggan:n.binggan,page:b.page,searchContent:b.search,noMentionMode:Me.value})),{loading:ue,data:de,onSuccess:It,onError:xt,send:$t}=Yt(()=>it(Ye.value),[()=>b.threadId,()=>b.page,()=>b.search],{initialData:{},immediate:!0});It(r=>{document.title=r.data.thread_data.title,je(()=>{if(R.hash){const a=document.querySelector(R.hash);a?.scrollIntoView({block:"center",behavior:"auto"}),a?.classList.add("on-focus")}})}),xt(r=>{q.value=!1,r.error.cause!==void 0&&r.error.cause.code!==401&&d.value?.show({errorCode:r.error.cause.code,message:r.error.message})}),ke(()=>{$t(),q.value=!0}),pe(()=>{ue.value=!0,h.value?.resetInput()});const Qe=y(!1),{fetching:Ne,onSuccess:Pt,onError:Mt,fetch:zt}=Qt();function ae(r=!1){Ne.value!==!0&&(Qe.value=r,zt(it(Ye.value)))}Pt(()=>{I.value.forEach(r=>{r.refreshBattleData()}),Qe.value&&!u.userCustom.lessToast&&window.$message.success("已刷新数据")}),Mt(r=>{q.value=!1,r.error.cause!==void 0&&d.value?.show({errorCode:r.error.cause.code,message:r.error.message})});const Lt=D(()=>de.value.posts_data.data),F=D(()=>de.value.thread_data),Q=D(()=>de.value.forum_data),Le=D(()=>de.value.your_post_floors),Je=D(()=>{let r;return r=Lt.value.filter(a=>{if(A.value===!0&&a.battle_id!==null||U.value===!0&&a.created_by_admin===2&&a.nickname==="Roll点系统")return!1;if($e.value===!0&&a.created_by_admin===2&&a.nickname==="奥利奥打赏系统"&&!a.is_your_post){if(Le.value.length>0){const Y=a.content.match(/@№[0-9]+/g);if(Y===null)return!1;const L=Number(Y[0].slice(2));if(Le.value.includes(L))return!0}return!1}if(Be.value===!0){const Y=a.created_by_admin==2&&a.nickname=="红包结果"&&!a.is_your_post,L=/^--红包口令: /.test(a.content)&&!a.is_your_post;if(Y||L)return!1}if(We.value===!0&&!a.is_your_post&&/^<span(.*?)<\/span>$/s.test(a.content))return!1;if(n.userData?.binggan.use_pingbici&&u.userCustom.hidePingbiciFloor){const Y=u.userCustom.pingbiciIngnoreCase?"gi":"g";for(let L of n.userData.pingbici.content_pingbici)if(new RegExp(L,Y).test(a.content))return!1;if(F.value.anti_jingfen){for(let L of n.userData.pingbici.fjf_pingbici)if(new RegExp(L,"g").test(a.created_binggan_hash.slice(0,5)))return!1}for(let L of n.userData.pingbici.fjf_pingbici)if(new RegExp(L,Y).test(a.nickname))return!1}return!0}),r}),De=y(b.search),Te=y(!!b.search);function Xe(){v.push({name:"thread",params:{threadId:b.threadId,page:1},query:{search:De.value||void 0}})}function Dt(){De.value=void 0,Te.value=!1,v.push({name:"thread",params:{threadId:b.threadId,page:1}})}const ce=y(!1),Re=y(!1),Ze=D(()=>b.page===(ue.value?b.page:de.value.posts_data.lastPage)),ye=na();function Tt(r){r.post_floor>=b.page*200?(ce.value=!1,Re.value=!0):de.value.posts_data.data.find(Y=>Y.id===r.post_id)||Rt(r.thread_id,r.post_id)}function Rt(r,a){const Y={binggan:n.binggan,post_id:a,thread_id:r};so(Y).then(L=>{de.value.posts_data.data.push(L),u.userCustom.hongbaoThenStop&&L.hongbao_id!==null&&(window.$message.info("有红包！停止涮锅！（个人中心开启了红包自动停止涮锅）"),ce.value=!1);const me=document.body.clientHeight-document.documentElement.scrollTop;je(()=>{(h.value?.isTyping||u.userCustom.holdPageWhenListening)&&(document.documentElement.scrollTop=document.body.clientHeight-me)})})}Ce(ce,r=>{if(r===!0)try{ae(!1),ye.connect(),ye.channel("thread_"+b.threadId).listen("NewPost",a=>Tt(a)),ye.pusher?.connection.bind("state_change",a=>{a.current==="unavailable"&&(window.$message.error("嗷……服务器的自动涮锅服务好像出问题了，暂时不能使用"),ce.value=!1)})}catch{window.$message.error("嗷……服务器的自动涮锅服务好像出问题了，暂时不能使用"),ce.value=!1}else ye.isConnected&&ye.disconnect()}),pe(()=>{ce.value=!1}),Ce([()=>b.threadId,()=>b.page,()=>b.search],()=>{ce.value=!1,Re.value=!1});let et,Ge;function tt(r,a){const{timestamp:Y,newPostKey:L}=_t(r.ist,F.value.id,n.binggan),me={binggan:n.binggan,forum_id:Q.value.id,thread_id:F.value.id,content:r.contentInput,nickname:r.nicknameInput,post_with_admin:r.postWithAdmin,new_post_key:L,timestamp:Y};Ge=a,et=r,qt(me)}function Ht(){tt(et,Ge)}const{loading:At,send:qt,onSuccess:Nt,onError:Gt}=Z(r=>ao(r),{immediate:!1});Nt(()=>{Ge("success"),ae(!1)}),Gt(r=>{r.error.cause!==void 0&&r.error.cause.code===244291&&K.value?.show()});function ot(r){r.ctrlKey&&r.key==="x"&&ae(!0)}return ke(()=>{window.addEventListener("keyup",ot)}),pe(()=>{window.removeEventListener("keyup",ot)}),(r,a)=>{const Y=pt("router-link");return s(),N(ne,null,[o(e(S),{vertical:""},{default:t(()=>[q.value?(s(),N(ne,{key:0},[o(e(S),{align:"center",style:{"margin-top":"8px"}},{default:t(()=>[o(e(ge),{size:e(u).isMobile?28:34},{default:t(()=>[o(e(co),{style:{cursor:"pointer"},onClick:a[0]||(a[0]=L=>Te.value=!Te.value)})]),_:1},8,["size"]),o(dt,{page:we.value,"onUpdate:page":[a[1]||(a[1]=L=>we.value=L),Ke],"last-page":e(ue)?1:e(de).posts_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Te.value?(s(),_(e(S),{key:0,wrap:!1},{default:t(()=>[o(e(_e),{value:De.value,"onUpdate:value":a[2]||(a[2]=L=>De.value=L),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索回复内容","auto-size":"",onKeyup:he(Xe,["enter"])},null,8,["value"]),o(e(V),{type:"primary",onClick:Xe},{default:t(()=>[...a[15]||(a[15]=[l("搜索",-1)])]),_:1}),o(e(V),{type:"default",onClick:Dt},{default:t(()=>[...a[16]||(a[16]=[l("清空",-1)])]),_:1})]),_:1})):w("",!0),e(u).userCustom.loudspeakerPosition==="top"?(s(),_(Ee,{key:1})):w("",!0),o(ma,{page:r.page,"thread-id":r.threadId,"posts-list-loading":e(ue),"disable-scroll":!!r.search,"is-search":!!r.search},null,8,["page","thread-id","posts-list-loading","disable-scroll","is-search"])],64)):w("",!0),!e(ue)&&q.value?(s(),N(ne,{key:1},[o(e(se),{class:"thread-title-container",size:"small",key:"title-card"},{default:t(()=>[$("span",{class:"thread-title",style:ie({fontSize:e(u).userCustom.fontSizeThreadList+"px"})},T(F.value?.title)+" ["+T(F.value?.posts_num)+"] ",5),e(n).checkAdminForums(Q.value?.id)?(s(),_(e(Ae),{key:0,trigger:"click",options:Ct.value,onSelect:St,size:e(u).isMobile?"medium":"large"},{default:t(()=>[o(e(ge),{size:e(u).isMobile?20:24,style:{cursor:"pointer",float:"right","margin-left":"0.5rem"}},{default:t(()=>[o(e(no))]),_:1},8,["size"])]),_:1},8,["options","size"])):w("",!0),F.value?.is_your_thread?(s(),_(e(V),{key:1,size:"small",type:"primary",style:{float:"right","margin-left":"0.5rem"},onClick:a[3]||(a[3]=L=>O.value?.show())},{default:t(()=>[...a[17]||(a[17]=[l(" 变色 ",-1)])]),_:1})):w("",!0)]),_:1}),o(e(S),{vertical:"",size:2},{default:t(()=>[o(rt,{"post-data":Je.value[0],"your-posts-list":Le.value,"anti-jingfen":F.value?.anti_jingfen,"forum-id":Q.value.id,"no-custom-emoji-mode":e(oe),"no-emoji-mode":e(j),"no-head-mode":e(E),"no-image-mode":e(B),"no-video-mode":e(te),"use-url-mode":e(ze),"random-head-group-index":F.value.random_heads_group,"super-admin-mode":c.value,"no-mention-mode":e(Me),onShowRewardModal:C.value?.show,"no-hongbao-pic-mode":e(Pe),onQuoteClick:h.value?.quoteHandle,onRefreshPostsList:a[4]||(a[4]=L=>ae(!1)),onAdminHandle:H.value?.show},null,8,["post-data","your-posts-list","anti-jingfen","forum-id","no-custom-emoji-mode","no-emoji-mode","no-head-mode","no-image-mode","no-video-mode","use-url-mode","random-head-group-index","super-admin-mode","no-mention-mode","onShowRewardModal","no-hongbao-pic-mode","onQuoteClick","onAdminHandle"]),F.value.vote_question_id!==null?(s(),_(Ba,{key:0,ref_key:"VoteComponentCom",ref:p,"vote-id":F.value.vote_question_id},null,8,["vote-id"])):w("",!0),F.value.gamble_question_id!==null?(s(),_(qa,{key:1,ref_key:"GambleComponentCom",ref:i,"gamble-id":F.value.gamble_question_id,"forum-id":Q.value?.id},null,8,["gamble-id","forum-id"])):w("",!0),F.value.crowd_id!==null?(s(),_(Sa,{key:2,ref_key:"CrowdComponentCom",ref:g,"crowd-id":F.value.crowd_id,"forum-id":Q.value?.id},null,8,["crowd-id","forum-id"])):w("",!0),F.value.hongbao_id!==null?(s(),_(Ea,{key:3,ref_key:"HongbaoComponentCom",ref:k,"hongbao-id":F.value.hongbao_id,"thread-id":r.threadId,"forum-id":Q.value?.id,"no-hongbao-pic-mode":e(Pe),onRefreshPostsList:a[5]||(a[5]=L=>ae(!1))},null,8,["hongbao-id","thread-id","forum-id","no-hongbao-pic-mode"])):w("",!0),r.threadId===138549?(s(),_(Qa,{key:4,ref_key:"PoolComponentCom",ref:M,"thread-id":r.threadId,"forum-id":Q.value?.id,onRefreshPostsList:a[6]||(a[6]=L=>ae(!1))},null,8,["thread-id","forum-id"])):w("",!0),(s(!0),N(ne,null,Se(Je.value.slice(1),L=>(s(),_(rt,{key:L.id,"post-data":L,"your-posts-list":Le.value,"anti-jingfen":F.value?.anti_jingfen,"forum-id":Q.value.id,"no-custom-emoji-mode":e(oe),"no-emoji-mode":e(j),"no-head-mode":e(E),"no-image-mode":e(B),"no-video-mode":e(te),"use-url-mode":e(ze),"random-head-group-index":F.value.random_heads_group,"super-admin-mode":c.value,"admin-mode":G.value,"no-mention-mode":e(Me),onShowRewardModal:C.value?.show,"no-hongbao-pic-mode":e(Pe),onQuoteClick:h.value?.quoteHandle,onRefreshPostsList:a[7]||(a[7]=me=>ae(!1)),onAdminHandle:H.value?.show,ref_for:!0,ref_key:"PostItemComs",ref:I},null,8,["post-data","your-posts-list","anti-jingfen","forum-id","no-custom-emoji-mode","no-emoji-mode","no-head-mode","no-image-mode","no-video-mode","use-url-mode","random-head-group-index","super-admin-mode","admin-mode","no-mention-mode","onShowRewardModal","no-hongbao-pic-mode","onQuoteClick","onAdminHandle"]))),128))]),_:1}),o(e(S),{align:"center",style:{"margin-top":"8px"}},{default:t(()=>[o(e(V),{type:"primary",loading:e(Ne),disabled:e(Ne),onClick:a[8]||(a[8]=L=>ae(!0))},{default:t(()=>[...a[18]||(a[18]=[l("刷新",-1)])]),_:1},8,["loading","disabled"]),o(e(mt),{value:ce.value,"onUpdate:value":a[9]||(a[9]=L=>ce.value=L),disabled:!Ze.value||Re.value},{checked:t(()=>[...a[19]||(a[19]=[l(" 涮锅中 ",-1)])]),unchecked:t(()=>[...a[20]||(a[20]=[l(" 自动涮锅 ",-1)])]),_:1},8,["value","disabled"]),Re.value?(s(),_(Y,{key:0,to:{name:"thread",params:{threadId:r.threadId,page:r.page+1}}},{default:t(()=>[...a[21]||(a[21]=[l("回帖已经翻页、点击前往 ",-1)])]),_:1},8,["to"])):w("",!0),Ze.value?w("",!0):(s(),_(e(x),{key:1},{default:t(()=>[...a[22]||(a[22]=[l("在最新一页才能自动涮锅",-1)])]),_:1}))]),_:1}),o(e(S),{align:"center",style:ie([{"margin-top":"8px"},{paddingRight:e(u).isMobile?"24px":"0px"}])},{default:t(()=>[o(e(Jt),{placement:"bottom-start",trigger:"hover"},{trigger:t(()=>[o(e(ge),{size:34},{default:t(()=>[o(e(Uo),{onClick:a[10]||(a[10]=L=>e(v).push({name:"forum",params:{forumId:Q.value?.id}})),style:{cursor:"pointer"}})]),_:1})]),default:t(()=>[o(e(x),null,{default:t(()=>[...a[23]||(a[23]=[l("返回小岛",-1)])]),_:1})]),_:1}),o(dt,{page:we.value,"onUpdate:page":[a[11]||(a[11]=L=>we.value=L),Ke],"last-page":e(ue)?1:e(de).posts_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1},8,["style"]),e(u).userCustom.loudspeakerPosition==="center"?(s(),_(Ee,{key:0})):w("",!0)],64)):(s(),_(e(S),{key:2,vertical:"",size:2},{default:t(()=>[(s(),N(ne,null,Se(200,L=>$("div",Ja)),64))]),_:1})),nt(o(io,{ref_key:"postInputCom",ref:h,mode:"post","forum-id":Q.value?.id,"thread-id":r.threadId,disabled:!1,handling:e(At),"random-heads-group":F.value?.random_heads_group,onContentCommit:tt,onRefreshPostsList:ae},null,8,["forum-id","thread-id","handling","random-heads-group"]),[[st,!e(ue)&&q.value]]),!e(ue)&&q.value?(s(),N(ne,{key:3},[o(e(S),{justify:"end"},{default:t(()=>[Q.value.is_nissin===2&&F.value.sub_id===0?(s(),_(e(x),{key:0},{default:t(()=>[a[24]||(a[24]=l(" 本贴将于 ",-1)),o(e(x),{type:"error"},{default:t(()=>[l(T(m.value),1)]),_:1}),a[25]||(a[25]=l(" 日清，请及时更换帖子喔 ",-1))]),_:1})):w("",!0),Q.value.is_nissin===1&&F.value.sub_id===0?(s(),_(e(x),{key:1},{default:t(()=>[a[27]||(a[27]=l(" 本小岛 ",-1)),o(e(x),{type:"error"},{default:t(()=>[...a[26]||(a[26]=[l(" 每日早上8:00 ",-1)])]),_:1}),a[28]||(a[28]=l(" 日清，请及时更换帖子喔 ",-1))]),_:1})):w("",!0)]),_:1}),o(e(S),null,{default:t(()=>[o(e(V),{type:"primary",onClick:a[12]||(a[12]=L=>e(v).push({name:"forum",params:{forumId:Q.value?.id}}))},{default:t(()=>[...a[29]||(a[29]=[l("返回小岛",-1)])]),_:1})]),_:1}),e(u).userCustom.loudspeakerPosition==="bottom"?(s(),_(Ee,{key:0})):w("",!0),a[31]||(a[31]=$("div",{style:{height:"50px"}},null,-1)),z.value?(s(),N(ne,{key:1},[(s(),_(lt,{to:"#topbar-nav"},[o(Y,{to:{name:"forum",params:{forumId:Q.value?.id}},class:"flex-item-center"},{default:t(()=>[o(e(Xt),{tooltip:!1},{default:t(()=>[l(T(Q.value?.name),1)]),_:1}),o(e(Zt),{round:"",class:"forum-tag",size:e(u).isMobile?"small":"medium"},{default:t(()=>[l(T(Q.value?.id),1)]),_:1},8,["size"])]),_:1},8,["to"])])),(s(),_(lt,{to:"#topbar-func"},[o(e(Ae),{trigger:e(u).isMobile?"click":"hover",options:kt,placement:"bottom-start"},{default:t(()=>[o(e(V),null,{default:t(()=>[...a[30]||(a[30]=[l("屏蔽",-1)])]),_:1})]),_:1},8,["trigger"])]))],64)):w("",!0),o(fa,{ref_key:"ChangeColorModalCom",ref:O,"thread-id":r.threadId},null,8,["thread-id"]),o(uo,{ref_key:"CaptchaModalCom",ref:K,onWaterUnlockOnSuccess:Ht},null,512),o(ia,{ref_key:"JumpModalCom",ref:P,"thread-id":r.threadId,"posts-num":F.value.posts_num,page:r.page},null,8,["thread-id","posts-num","page"]),o(da,{ref_key:"RewardModalCom",ref:C,onRefreshPostsList:ae},null,512)],64)):w("",!0),o(mo,{mode:"thread",onRefresh:a[13]||(a[13]=L=>ae(!0)),onShowJumpModal:a[14]||(a[14]=L=>P.value.show())})]),_:1}),nt(o(e(be),{size:"large",class:"spin"},null,512),[[st,e(ue)]]),o(ra,{ref_key:"ForbiddenModalCom",ref:d},null,512),e(n).checkAdminForums(Q.value?.id)?(s(),_(ua,{key:0,ref_key:"AdminActionModalCom",ref:H,onRefreshPostsList:ae,"thread-id":r.threadId,"forum-id":Q.value?.id},null,8,["thread-id","forum-id"])):w("",!0)],64)}}}),mn=xe(Xa,[["__scopeId","data-v-31ce79c6"]]);export{mn as default};
