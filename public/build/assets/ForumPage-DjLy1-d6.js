import{w as ee,l as te,b as se,u as _e,d as z,c as ge,U as ae,A as i,M as h,f as s,F as w,Q as j,C as G,a as e,k as _,i as K,H as a,j as k,m as A,z as l,s as u,G as b,n as y,h as U,R as oe,O as re,_ as le,o as ye,$ as C,p as W,q as X,r as ve,t as be,g as we,v as Y,N as ke,x as Se,S as I,y as B,B as Ce}from"./app-Bkek0-g6.js";import{u as Ie,t as Z}from"./forums-CV3FCPIQ.js";import{u as Te,S as $e,L as xe,a as Le,b as ze}from"./LoudspeakerComponent-w7OizQA8.js";import{d as Ne,s as Fe,u as Me}from"./showDialog-D_M2HhbU.js";import{_ as Pe}from"./loudspeaker-dIkncKj8.js";import{_ as Oe}from"./FInput.vue_vue_type_script_setup_true_lang-cXbnOQOQ.js";import{s as E}from"./subtitles-DW7M559j.js";import{N as Re}from"./Ellipsis-Csm9JjfW.js";import{N as qe,a as Ue}from"./Skeleton-CsPCAJb_.js";import{N as We}from"./Tag-CNHGSnKb.js";import"./Spin-DFfZ-euf.js";import"./Pagination-ChFyZ-cH.js";import"./use-locale-DVs0hfkD.js";import"./prop-DfVitj0l.js";import"./Input-BV_BI3gk.js";import"./Select-y4KCVrHh.js";import"./Forward-C_J8q9hB.js";import"./_createCompounder-YUK0gL_z.js";import"./use-houdini-8tRH7ZuU.js";const Be=p=>(oe("data-v-92d410c5"),p=p(),re(),p),Ee=Be(()=>k("span",{style:{"margin-left":"auto"}},null,-1)),je={key:0},Ge=ee({__name:"ThreadList",props:{threadsListData:{},showThis:{type:Boolean},newWindowToPost:{type:Boolean,default:!1}},emits:["withdrawDelayThreadSuccess"],setup(p,{emit:T}){te(c=>({"4b1418b0":e(f).hoverColor,"284e4759":(e(m).isMobile,"0.875rem"),e1605438:e(f).textColor1}));const m=se(),f=_e(),S=T,N=z(()=>({paddingBottom:m.isMobile?"6px":""})),v=Te({}).data,{loading:$,send:F,onSuccess:M}=ge(c=>Ne(c),{immediate:!1});M(()=>{S("withdrawDelayThreadSuccess")});function x(c){Fe({title:"要撤回延时主题吗？",onPositiveClick:()=>{F(c)}})}return(c,H)=>{const L=ae("router-link");return c.showThis?(i(),h(e(_),{key:0,vertical:"",size:2},{default:s(()=>[(i(!0),w(G,null,j(c.threadsListData,t=>(i(),h(e(K),{size:"small",bordered:!0,key:t.id,class:"thread-cards","content-style":N.value,hoverable:""},{default:s(()=>[a(e(_),{vertical:""},{default:s(()=>[k("div",{style:A({color:t.title_color&&!e(m).userCustom.monochromeMode?t.title_color:e(f).textColor1}),class:"thread-title"},[l(u(t.sub_title)+" "+u(t.vote_question_id?"🗳️":"")+" "+u(t.gamble_question_id?"🎲":"")+" "+u(t.crowd_id?"💰":"")+" "+u(t.hongbao_id?"🧧":"")+" ",1),a(L,{to:{name:"thread",params:{threadId:t.id}},style:A([{"font-size":"1.0rem"},{color:t.title_color&&!e(m).userCustom.monochromeMode?t.title_color:e(f).textColor1,pointerEvents:t.is_delay?"none":void 0}]),target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(u(t.title),1)]),_:2},1032,["to","style","target"]),t.posts_num>200?(i(),h(L,{key:0,style:{"font-size":"1.0rem"},to:{name:"thread",params:{threadId:t.id,page:Math.ceil((t.posts_num+1)/200)}},target:c.newWindowToPost?"_blank":!1},{default:s(()=>[l(" ["+u(Math.ceil((t.posts_num+1)/200))+"] ",1)]),_:2},1032,["to","target"])):b("",!0),e(v)[t.id]?(i(),h(e(y),{key:1,size:"tiny",type:"primary",onClick:g=>c.$router.push({name:"thread",params:{threadId:t.id,page:Math.ceil((e(v)[t.id].floor+1)/200)},hash:`#f_${e(v)[t.id].floor}`})},{default:s(()=>{var g;return[l(" ["+u((g=e(v)[t.id])==null?void 0:g.floor)+"楼] ",1)]}),_:2},1032,["onClick"])):b("",!0),t.is_your_thread?(i(),h(e(y),{key:2,size:"tiny",type:"warning",disabled:e($),onClick:g=>x(t.id)},{default:s(()=>[l("撤回")]),_:2},1032,["disabled","onClick"])):b("",!0)],4),a(e(_),{size:"small",class:"thread-title-secondary"},{default:s(()=>[k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("最新回复:")]),_:1}),l(" "+u(t.updated_at),1)]),k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("发帖人:")]),_:1}),l(" "+u(t.nickname),1)]),Ee,l(" "+u(t.posts_num>1200?"🔥":"")+" ",1),t.locked_by_coin>0?(i(),w("span",je,"🔒"+u(t.locked_by_coin),1)):b("",!0),k("span",null,[a(e(U),{depth:"3"},{default:s(()=>[l("Re:")]),_:1}),l(" "+u(t.posts_num),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["content-style"]))),128))]),_:1})):(i(),h(e(_),{key:1,vertical:"",size:2},{default:s(()=>[(i(),w(G,null,j(50,t=>a(e(K),{class:"threads-card-skeleton"})),64))]),_:1}))}}}),Ae=le(Ge,[["__scopeId","data-v-92d410c5"]]),ne=p=>(oe("data-v-a0a849f2"),p=p(),re(),p),He={key:0,class:"carousel-box"},Qe={key:0,class:"carousel-box"},Ve=["src"],De=ne(()=>k("div",{style:{"margin-left":"auto"}},null,-1)),Je=ne(()=>k("div",{style:{height:"50px"}},null,-1)),Ke=ee({__name:"ForumPage",props:{forumId:{},page:{},search:{},delay:{type:Boolean}},setup(p){var J;te(o=>({"0c57e2d0":e(m).bannerHeight}));const T=ye(),m=se(),f=Ie(),S=we(),N=C(null);C(),Me();const r=p;document.title=((J=f.forumData(r.forumId))==null?void 0:J.name)??"小火锅";const v=W("banner_hiden",!1),$=W("new_window_to_post",!1);function F(){return I(_,{style:"padding:6px 8px",vertical:!0},()=>[I(B,{checked:v.value,"onUpdate:checked":o=>v.value=o,label:"隐藏版头"}),I(B,{checked:$.value,"onUpdate:checked":o=>$.value=o,label:"新窗口打开"})])}const M=[{type:"group",key:"header",label:"功能"},{key:"header-divider",type:"divider"},{key:"funcOption",type:"render",render:F}],x=W("subtitles_included",E),c=z(()=>E.filter(o=>!x.value.includes(o)));function H(){return I(Ce,{value:x.value,"onUpdate:value":o=>x.value=o},()=>[I(_,{style:"padding:6px 8px",vertical:!0},()=>[Array.from(E).map(o=>I(B,{value:o,label:o}))])])}const L=[{type:"group",key:"header",label:"筛选"},{key:"header-divider",type:"divider"},{key:"filterOptions",type:"render",render:H}],t=C(r.search),g=C(!!r.search);X(t,o=>{ze(()=>S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:o||void 0}}))()});function ie(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{search:t.value||void 0}})}function ue(){t.value=void 0,g.value=!1}function de(){S.push({name:"forum",params:{forumId:r.forumId,page:1},query:{delay:r.delay?void 0:"true"}})}const P=C(r.page);function ce(o){S.push({name:"forum",params:{forumId:r.forumId,page:o},query:{search:r.search,delay:r.delay?"true":void 0}})}X(()=>r.page,o=>P.value=o);const Q=z(()=>({forumId:r.forumId,binggan:T.binggan,page:r.page,threadsPerPage:50,subtitlesExcluded:c.value,searchTitle:r.search,delay:r.delay})),{loading:O,data:R,onSuccess:Xe}=ve(()=>Z(Q.value),[()=>r.forumId,()=>r.page,()=>r.search,()=>r.delay,c],{initialData:[],immediate:!0}),V=C(!1),{fetching:Ye,onSuccess:pe,fetch:me}=be();function D(o=!1){V.value=o,me(Z(Q.value))}pe(()=>{V.value&&window.$message.success("已刷新数据")});const fe=z(()=>{if(O.value)return[];if(T.userData.binggan.use_pingbici){const o=m.userCustom.pingbiciIngnoreCase?"gi":"g";return R.value.threads_data.data.filter(n=>{for(let q of T.userData.pingbici.title_pingbici)if(new RegExp(q,o).test(n.title))return!1;return!0})}else return R.value.threads_data.data});return(o,n)=>{const q=ae("router-link");return i(),h(e(_),{vertical:""},{default:s(()=>[e(v)?b("",!0):(i(),w("div",He,[e(f).forumsDataLoading?(i(),w("div",Qe,[a(e(qe),{class:"carousel-skeleton",sharp:""})])):b("",!0),e(f).forumsDataLoading?b("",!0):(i(),h(e(Ue),{key:1,"show-arrow":"",trigger:"hover",autoplay:"",interval:1e4},{default:s(()=>{var d;return[(i(!0),w(G,null,j((d=e(f).forumData(o.forumId))==null?void 0:d.banners,he=>(i(),w("img",{src:he,class:"carousel-img"},null,8,Ve))),256))]}),_:1}))])),a(e(_),{style:{"margin-top":"8px"},size:"small"},{default:s(()=>[a(e(Y),{trigger:"hover",options:M,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("功能")]),_:1})]),_:1}),a(e(Y),{trigger:"hover",options:L,placement:"bottom-start"},{default:s(()=>[a(e(y),null,{default:s(()=>[l("筛选")]),_:1})]),_:1}),a(e(ke),{size:e(m).isMobile?28:34},{default:s(()=>[a(e($e),{style:{cursor:"pointer"},onClick:n[0]||(n[0]=d=>g.value=!g.value)})]),_:1},8,["size"]),De,a(e(y),{type:"primary",onClick:n[1]||(n[1]=d=>o.$router.push({name:"loudspeaker"}))},{default:s(()=>[l("大喇叭")]),_:1}),a(e(y),{type:"primary",onClick:n[2]||(n[2]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},{default:s(()=>[l("新主题")]),_:1})]),_:1}),g.value?(i(),h(e(_),{key:1,wrap:!1},{default:s(()=>[a(e(Oe),{value:t.value,"onUpdate:value":n[3]||(n[3]=d=>t.value=d),maxlength:100,style:{"max-width":"400px"},placeholder:"搜索标题","auto-size":""},null,8,["value"]),a(e(y),{type:"primary",onClick:ie},{default:s(()=>[l("搜索")]),_:1}),a(e(y),{type:"default",onClick:ue},{default:s(()=>[l("清空")]),_:1})]),_:1})):b("",!0),a(xe),a(Ae,{"threads-list-data":fe.value,"new-window-to-post":e($),"show-this":!e(O),onWithdrawDelayThreadSuccess:D},null,8,["threads-list-data","new-window-to-post","show-this"]),a(e(_),{align:"center"},{default:s(()=>[a(e(y),{type:r.delay?"default":"primary",onClick:de},{default:s(()=>[l(u(r.delay?"关闭延时主题":"查看延时主题"),1)]),_:1},8,["type"]),a(Pe,{page:P.value,"onUpdate:page":[n[4]||(n[4]=d=>P.value=d),ce],"last-page":e(O)?1:e(R).threads_data.lastPage,style:{"margin-left":"auto"}},null,8,["page","last-page"])]),_:1}),Je,(i(),h(Se,{to:"#topbar-nav"},[a(q,{to:"/",class:"flex-item-center"},{default:s(()=>[a(e(Re),{style:A({maxWidth:e(m).isMobile?"120px":"900px"}),tooltip:!1},{default:s(()=>{var d;return[l(u((d=e(f).forumData(o.forumId))==null?void 0:d.name),1)]}),_:1},8,["style"]),a(e(We),{round:"",class:"forum-tag",size:e(m).isMobile?"small":"medium"},{default:s(()=>[l(u(o.forumId),1)]),_:1},8,["size"])]),_:1})])),a(Le,{mode:"forum",ref_key:"SidebarCom",ref:N,onRefresh:n[5]||(n[5]=d=>D(!0)),onNewThread:n[6]||(n[6]=d=>o.$router.push({name:"new-thread",params:{forumId:r.forumId}}))},null,512)]),_:1})}}}),yt=le(Ke,[["__scopeId","data-v-a0a849f2"]]);export{yt as default};
