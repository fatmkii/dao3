import{w as J,b as X,$ as d,i as ce,A as S,M as W,q as a,H as t,o as e,x as j,z as o,y as q,B as ne,D as N,aw as be,J as F,K as ie,L as re,F as Z,O as V,aq as Ke,E as ve,C as ue,ao as He,a_ as _e,_ as Le,a0 as Ue,X as Ee,b5 as Se,aX as Be,a$ as qe,aY as Te,aE as Je,Q as we,a2 as me,b6 as We,b3 as Pe,b4 as Qe,S as he,p as Ae,N as le,b1 as Ze,b2 as et,v as tt,an as at,f as lt,a1 as Re,aP as nt,I as se,b7 as ot,b8 as st,b9 as ut,aZ as it,ba as rt,bb as dt,r as ct,bc as vt}from"./vendor-CGtf6mcl.js";import{u as te,a as oe,b as O,e as E,c as ee,g as Oe,w as mt,p as ft,r as je,d as xe}from"./app-scxDScDq.js";import{s as pt}from"./showDialog-zPHE49ZE.js";import{b as gt,c as ht,d as De,e as bt,g as _t,f as wt,_ as yt}from"./PostItem.vue_vue_type_script_setup_true_lang-B0Ebjk9u.js";import{i as Xe,a as Ye}from"./inputNumberFormat-DaYmlx6U.js";import{e as Ct}from"./emojiData-CmSvr5Em.js";const kt=J({__name:"RollModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:R}){const H=te(),n=oe(),C=B,$=X(()=>{let T=[];if(s.value>0&&h.value>0){for(var g=0;g<s.value;g++)T[g]=Math.floor(Math.random()*h.value)+1;return T.join()}else return null}),L=d(),b=d(),s=d(1),h=d(100),p=d(!1);function x(){p.value=!0}U({show:x});const _=R,{loading:l,send:f,onSuccess:y}=ce(T=>gt(T),{immediate:!1});function M(){if(!s.value){window.$message.error("请填写骰子数量");return}if(!h.value){window.$message.error("请填写骰子数量");return}const T={binggan:n.binggan,thread_id:C.threadId,forum_id:C.forumId,roll_name:L.value,roll_event:b.value,roll_num:s.value,roll_range:h.value};f(T)}return y(()=>{_("refreshPostsList"),p.value=!1}),(T,g)=>(S(),W(e(re),{show:p.value,"onUpdate:show":g[6]||(g[6]=i=>p.value=i),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"Roll点",closable:"",onClose:g[5]||(g[5]=i=>p.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:M,disabled:e(l)},{default:a(()=>[o("Roll it!")]),_:1},8,["disabled"]),t(e(O),{onClick:g[4]||(g[4]=i=>p.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(q),null,{default:a(()=>[o(" 输出参考： ")]),_:1}),t(e(q),null,{default:a(()=>[o(ne(L.value?`「${L.value}」，`:"")+" "+ne(b.value?`「${b.value}」的结果：`:"")+" "+ne(`${s.value} d ${h.value} = 「${$.value}」`),1)]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("Roll点昵称")]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:L.value,"onUpdate:value":g[0]||(g[0]=i=>L.value=i)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("Roll点事件")]),_:1}),t(e(ee),{placeholder:"可留空",maxlength:100,value:b.value,"onUpdate:value":g[1]||(g[1]=i=>b.value=i)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("骰子数量")]),_:1}),t(e(be),{max:100,min:1,placeholder:"必须填写",value:s.value,"onUpdate:value":g[2]||(g[2]=i=>s.value=i)},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"},class:"round"},{default:a(()=>[o("骰子大小")]),_:1}),t(e(be),{max:1e4,min:1,placeholder:"必须填写",value:h.value,"onUpdate:value":g[3]||(g[3]=i=>h.value=i)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),It={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},xt=V("defs",null,null,-1),Mt=V("path",{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92c-19.1.1-36.8-5.4-52-15l-54 55c29.1 22.4 65.9 36 106 36c93.8 0 170-75.1 170-168z",fill:"currentColor"},null,-1),$t=V("path",{d:"M833 446h-60c-4.4 0-8 3.6-8 8c0 140.3-113.7 254-254 254c-63 0-120.7-23-165-61l-54 54c48.9 43.2 110.8 72.3 179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328c0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9c-3.1-3-8.1-3-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68c-10.5-27.9-16.3-58.2-16.2-89.8c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8c0 53 12.5 103 34.6 147.4l-137 137c-3.1 3.1-3.1 8.2 0 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92c46 0 84.1 32.3 92.3 74.7L417 401z",fill:"currentColor"},null,-1),zt=[xt,Mt,$t],Tt=J({name:"AudioMutedOutlined",render:function(U,R){return S(),Z("svg",It,zt)}}),Dt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},St=V("path",{d:"M911.5 700.7a8 8 0 0 0-10.3-4.8L840 718.2V180c0-37.6-30.4-68-68-68H252c-37.6 0-68 30.4-68 68v538.2l-61.3-22.3c-.9-.3-1.8-.5-2.7-.5c-4.4 0-8 3.6-8 8V763c0 3.3 2.1 6.3 5.3 7.5L501 910.1c7.1 2.6 14.8 2.6 21.9 0l383.8-139.5c3.2-1.2 5.3-4.2 5.3-7.5v-59.6c0-1-.2-1.9-.5-2.8zM512 837.5l-256-93.1V184h512v560.4l-256 93.1zM660.6 312h-54.5c-3 0-5.8 1.7-7.1 4.4l-84.7 168.8H511l-84.7-168.8a8 8 0 0 0-7.1-4.4h-55.7c-1.3 0-2.6.3-3.8 1c-3.9 2.1-5.3 7-3.2 10.8l103.9 191.6h-57c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76v39h-76c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76V704c0 4.4 3.6 8 8 8h49.9c4.4 0 8-3.6 8-8v-63.5h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8h-76.3v-39h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8H564l103.7-191.6c.6-1.2 1-2.5 1-3.8c-.1-4.3-3.7-7.9-8.1-7.9z",fill:"currentColor"},null,-1),Ht=[St],Lt=J({name:"MoneyCollectOutlined",render:function(U,R){return S(),Z("svg",Dt,Ht)}}),Ne=()=>{const B=Oe.Get("api/captcha",{name:"postGetter",params:{},localCache:null,hitSource:[]});return B.meta={shouldRemind:!1},B},Ve=B=>{const U=new FormData;U.append("file",B.file),U.append("mode",B.mode),U.append("binggan",B.binggan),U.append("thread_id",String(B.thread_id)),U.append("forum_id",String(B.forum_id));const R=Oe.Post("api/img_upload",U,{name:"uploadImagePoster",params:{},localCache:null,hitSource:[]});return R.meta={shouldRemind:!0},R},Ut=["src"],Bt=J({__name:"CaptchaModal",emits:["waterUnlockOnSuccess"],setup(B,{expose:U,emit:R}){const H=te(),n=oe(),C=d(),$=X(()=>h.value.captcha_key),L=d(!1);function b(){L.value=!0,x()}U({show:b});const s=R,{data:h,loading:p,send:x}=ce(Ne,{immediate:!1}),{fetch:_}=Ke();function l(){_(Ne())}const{loading:f,send:y,onSuccess:M,onError:T}=ce(i=>mt(i),{immediate:!1});function g(){if(!C.value){window.$message.error("验证码不能为空");return}const i={binggan:n.binggan,captcha_code:C.value,captcha_key:$.value};y(i),M(()=>{C.value="",L.value=!1,s("waterUnlockOnSuccess")}),T(()=>{C.value="",l()})}return(i,v)=>(S(),W(e(re),{show:L.value,"onUpdate:show":v[3]||(v[3]=k=>L.value=k),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"验证码",closable:"",onClose:v[2]||(v[2]=k=>L.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:g,loading:e(f),disabled:e(f)},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"]),t(e(O),{onClick:v[1]||(v[1]=k=>L.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(q),null,{default:a(()=>[o(" 嗷……你可能刷太多了，休息一下吧。 ")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"},class:"round"},{default:a(()=>[o("输入")]),_:1}),t(e(ee),{placeholder:"请输入验证码",maxlength:"4","show-count":"",value:C.value,"onUpdate:value":v[0]||(v[0]=k=>C.value=k),onKeyup:ve(g,["enter"])},null,8,["value"])]),_:1}),e(p)?ue("",!0):(S(),Z("img",{key:0,src:"data:image/png;base64,"+e(h).captcha_img,style:{"max-width":"200px"},onClick:l},null,8,Ut)),t(e(q),null,{default:a(()=>[o(" 点击可更换验证码。不区分大小写。 ")]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Pt=J({__name:"BattleModal",props:{threadId:{},forumId:{},randomHeadsGroup:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:R}){const H=te(),n=oe(),C=d(null),$=B,L=X(()=>{const i=[{value:1,label:"共通",available:!0}];return ht.forEach(v=>{v.value===$.randomHeadsGroup&&i.push(v)}),i}),b=X(()=>{const i=De[h.value-1];if(h.value===1){const v=n.userData.my_battle_chara.filter(k=>!k.not_use).map((k,G)=>({value:G+240,label:k.name}));return i.concat(v)}else return i}),s=d(1),h=d($.randomHeadsGroup),p=d(100);He(h,i=>{i===1?s.value=De[i-1][8].value:s.value=De[i-1][0].value},{immediate:!0});const{loading:x,send:_,onSuccess:l,onError:f}=ce(i=>bt(i),{immediate:!1});function y(i){var Q;const{timestamp:v,newPostKey:k}=_t((Q=i==null?void 0:i.isTrusted)!=null?Q:!0,$.threadId,n.binggan),G={binggan:n.binggan,forum_id:$.forumId,thread_id:$.threadId,battle_olo:p.value,chara_id:s.value>=240?s.value-240:s.value,is_custom_chara:s.value>=240,chara_group:h.value-1,new_post_key:k,timestamp:v};_(G)}l(()=>{g("refreshPostsList"),M.value=!1}),f(i=>{var v;i.error.cause!==void 0&&i.error.cause.code===244291&&((v=C.value)==null||v.show())});const M=d(!1);function T(){M.value=!0}U({show:T});const g=R;return(i,v)=>(S(),W(e(re),{show:M.value,"onUpdate:show":v[5]||(v[5]=k=>M.value=k),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"表情包大乱斗！",closable:"",onClose:v[4]||(v[4]=k=>M.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:y,loading:e(x)},{default:a(()=>[o("提交")]),_:1},8,["loading"]),t(e(O),{onClick:v[3]||(v[3]=k=>M.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(q),null,{default:a(()=>[o("小斗怡情，大斗伤身，强斗奥飞湮灭")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("主题")]),_:1}),t(e(_e),{value:h.value,"onUpdate:value":v[0]||(v[0]=k=>h.value=k),options:L.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("角色")]),_:1}),t(e(_e),{value:s.value,"onUpdate:value":v[1]||(v[1]=k=>s.value=k),options:b.value},null,8,["value","options"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("下注")]),_:1}),t(e(be),{value:p.value,"onUpdate:value":v[2]||(v[2]=k=>p.value=k),max:1e6,min:1,step:100,parse:e(Xe),format:e(Ye),onKeyup:ve(y,["enter"])},null,8,["value","parse","format"])]),_:1})]),_:1}),t(Bt,{ref_key:"CaptchaModalCom",ref:C,onWaterUnlockOnSuccess:y},null,512)]),_:1},8,["style"])]),_:1},8,["show"]))}}),At=J({__name:"CodeModal",emits:["insertCode"],setup(B,{expose:U,emit:R}){const H=te(),n=d(0),C=d(),$=d(),L=[{value:0,label:"折叠内容"},{value:1,label:"超链接"},{value:2,label:"图片"}],b=X(()=>[{prepend_1:"显示内容",prepend_2:"隐藏内容",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"显示内容",inputDefault_2:"隐藏内容",insertText:`<details><summary>${C.value}</summary>${$.value}</details>`},{prepend_1:"显示文字",prepend_2:"链接网址",inputEnable_1:!0,inputEnable_2:!0,inputDefault_1:"点我跳转",inputDefault_2:"",insertText:`<a href="${$.value}">${C.value}</a>`},{prepend_1:"图片链接",prepend_2:"",inputEnable_1:!0,inputEnable_2:!1,inputDefault_1:"",inputDefault_2:"",insertText:`<img src="${C.value}">`}]);He(n,()=>{C.value=b.value[n.value].inputDefault_1,$.value=b.value[n.value].inputDefault_2},{immediate:!0});function s(){x("insertCode",b.value[n.value].insertText),C.value=b.value[n.value].inputDefault_1,$.value=b.value[n.value].inputDefault_2,h.value=!1}const h=d(!1);function p(){h.value=!0}U({show:p});const x=R;return(_,l)=>(S(),W(e(re),{show:h.value,"onUpdate:show":l[5]||(l[5]=f=>h.value=f),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"快捷代码",closable:"",onClose:l[4]||(l[4]=f=>h.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:s},{default:a(()=>[o("插入")]),_:1}),t(e(O),{onClick:l[3]||(l[3]=f=>h.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(q),null,{default:a(()=>[o("代码预览：")]),_:1}),t(e(q),null,{default:a(()=>[o(ne(b.value[n.value].insertText),1)]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("代码内容")]),_:1}),t(e(_e),{value:n.value,"onUpdate:value":l[0]||(l[0]=f=>n.value=f),options:L},null,8,["value"])]),_:1}),Le(t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o(ne(b.value[n.value].prepend_1),1)]),_:1}),t(e(ee),{value:C.value,"onUpdate:value":l[1]||(l[1]=f=>C.value=f),onKeyup:ve(s,["enter"])},null,8,["value"])]),_:1},512),[[Ue,b.value[n.value].inputEnable_1]]),Le(t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o(ne(b.value[n.value].prepend_2),1)]),_:1}),t(e(ee),{value:$.value,"onUpdate:value":l[2]||(l[2]=f=>$.value=f),onKeyup:ve(s,["enter"])},null,8,["value"])]),_:1},512),[[Ue,b.value[n.value].inputEnable_2]])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Rt=["width","height"],jt=["width","height"],Nt=V("div",null,"颜色",-1),Et=V("div",null,"画笔",-1),Wt=["onClick"],Ot=V("div",null,"操作",-1),Xt=["title","innerHTML","onClick"],Yt=J({__name:"DrawerModal",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(B,{expose:U,emit:R}){const H=oe();te();const n=B,C=d(!1);function $(){C.value=!0}U({show:$});const L=R,b=d(),s=X(()=>{var u;return(u=b.value)==null?void 0:u.getContext("2d")}),h=d(),p=X(()=>{var u;return(u=h.value)==null?void 0:u.getContext("2d")}),x=new Image;let _=!1;const l={x:0,y:0,width:0,height:0},f=d([]),y=d([]),M=d([]),T=d({lineWidth:3,lineColor:"#111111",shadowBlur:1}),g=d(!1),i=d(!1);let v=0,k=0;const G=X(()=>window.innerWidth>836?796:window.innerWidth-36),Q=X(()=>window.innerHeight>580?400:window.innerHeight-212),K=X(()=>[{title:"上一步",action:"prev",className:f.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/></svg>'},{title:"下一步",action:"next",className:y.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>'},{title:"橡皮擦",action:"eraser",className:f.value.length||y.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/></svg>'},{title:"清除",action:"clear",className:f.value.length||y.value.length?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">  <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/></svg>'},{title:"拖动背景",action:"drag",className:i.value?"active":"",innerHTML:'<svg width="20" height="20" fill="currentColor"  viewBox="0 0 16 16"> <path d="M6.75 1a.75.75 0 0 1 .75.75V8a.5.5 0 0 0 1 0V5.467l.086-.004c.317-.012.637-.008.816.027.134.027.294.096.448.182.077.042.15.147.15.314V8a.5.5 0 1 0 1 0V6.435a4.9 4.9 0 0 1 .106-.01c.316-.024.584-.01.708.04.118.046.3.207.486.43.081.096.15.19.2.259V8.5a.5.5 0 0 0 1 0v-1h.342a1 1 0 0 1 .995 1.1l-.271 2.715a2.5 2.5 0 0 1-.317.991l-1.395 2.442a.5.5 0 0 1-.434.252H6.035a.5.5 0 0 1-.416-.223l-1.433-2.15a1.5 1.5 0 0 1-.243-.666l-.345-3.105a.5.5 0 0 1 .399-.546L5 8.11V9a.5.5 0 0 0 1 0V1.75A.75.75 0 0 1 6.75 1zM8.5 4.466V1.75a1.75 1.75 0 1 0-3.5 0v5.34l-1.2.24a1.5 1.5 0 0 0-1.196 1.636l.345 3.106a2.5 2.5 0 0 0 .405 1.11l1.433 2.15A1.5 1.5 0 0 0 6.035 16h6.385a1.5 1.5 0 0 0 1.302-.756l1.395-2.441a3.5 3.5 0 0 0 .444-1.389l.271-2.715a2 2 0 0 0-1.99-2.199h-.581a5.114 5.114 0 0 0-.195-.248c-.191-.229-.51-.568-.88-.716-.364-.146-.846-.132-1.158-.108l-.132.012a1.26 1.26 0 0 0-.56-.642 2.632 2.632 0 0 0-.738-.288c-.31-.062-.739-.058-1.05-.046l-.048.002zm2.094 2.025z"/></svg>'}]),D=[{lineWidth:3,innerHTML:"🖌️",font_size:12},{lineWidth:6,innerHTML:"🖌️",font_size:16},{lineWidth:12,innerHTML:"🖌️",font_size:20}];function P(){const u=new ImageData(G.value,Q.value);M.value.push(u)}Ee(()=>{P()});function fe(){s.value.lineWidth=T.value.lineWidth,s.value.shadowBlur=T.value.shadowBlur,s.value.shadowColor=T.value.lineColor,s.value.strokeStyle=T.value.lineColor,s.value.lineCap="round",s.value.lineJoin="round"}function ye(u){if(_)if(i.value){const r=u.target;let w,I;u instanceof MouseEvent?(w=u.clientX-r.getBoundingClientRect().x,I=u.clientY-r.getBoundingClientRect().y):(w=u.changedTouches[0].clientX-r.getBoundingClientRect().x,I=u.changedTouches[0].clientY-r.getBoundingClientRect().y),h.value.height=h.value.height;let A={x:l.x+(w-v),y:l.y+(I-k),width:l.width,height:l.height};ae(x,A)}else{s.value.beginPath(),s.value.moveTo(v,k);const r=u.target;let w,I;u instanceof MouseEvent?(w=u.clientX-r.getBoundingClientRect().x,I=u.clientY-r.getBoundingClientRect().y):(w=u.changedTouches[0].clientX-r.getBoundingClientRect().x,I=u.changedTouches[0].clientY-r.getBoundingClientRect().y),s.value.globalCompositeOperation=g.value?"destination-out":"source-over",s.value.lineTo(w,I),[v,k]=[w,I],s.value.stroke()}}function Ce(u){if(i.value){const r=u.target;let w,I;u instanceof MouseEvent?(w=u.clientX-r.getBoundingClientRect().x,I=u.clientY-r.getBoundingClientRect().y):(w=u.changedTouches[0].clientX-r.getBoundingClientRect().x,I=u.changedTouches[0].clientY-r.getBoundingClientRect().y),l.x+=w-v,l.y+=I-k,_=!1}else{const r=s.value.getImageData(0,0,b.value.width,b.value.height);y.value.length?(M.value=[],M.value=M.value.concat(f.value),M.value.push(r),y.value=[]):M.value.push(r),_=!1}}function ke(u){if(i.value){const r=u.target;let w,I;u instanceof MouseEvent?(w=u.clientX-r.getBoundingClientRect().x,I=u.clientY-r.getBoundingClientRect().y):(w=u.changedTouches[0].clientX-r.getBoundingClientRect().x,I=u.changedTouches[0].clientY-r.getBoundingClientRect().y),v=w,k=I,_=!0}else{_=!0;const r=u.target;let w,I;u instanceof MouseEvent?(w=u.clientX-r.getBoundingClientRect().x,I=u.clientY-r.getBoundingClientRect().y):(w=u.changedTouches[0].clientX-r.getBoundingClientRect().x,I=u.changedTouches[0].clientY-r.getBoundingClientRect().y),fe(),v=w,k=I;const A=s.value.getImageData(0,0,b.value.width,b.value.height);f.value.push(A)}}function Me(u){T.value.lineWidth=u,g.value=!1,i.value=!1}function pe(u){switch(u){case"prev":if(f.value.length){const r=f.value.pop(),w=M.value[f.value.length+1];y.value.push(w),s.value.putImageData(r,0,0)}break;case"next":if(y.value.length){const r=y.value.pop(),w=M.value[M.value.length-y.value.length-2];f.value.push(w),s.value.putImageData(r,0,0)}break;case"clear":s.value.clearRect(0,0,b.value.width,b.value.height),f.value=[],y.value=[],M.value=[M.value[0]];break;case"eraser":g.value=!0;break;case"drag":i.value=!0;break}}function $e(u){if(u.file.file){var r=new FileReader;r.readAsDataURL(u.file.file),r.onload=w=>{x.src=w.target.result,x.onload=function(){var I=h,A=x;l.width=A.width,l.height=A.height,A.width/A.height>=I.value.width/I.value.height?A.width>I.value.width&&(l.width=I.value.width,l.height=A.height*I.value.width/A.width):A.height>I.value.height&&(l.width=A.width*I.value.height/A.height,l.height=I.value.height),ae(A,l)}}}}function ae(u,r){p.value.drawImage(u,r.x,r.y,r.width,r.height)}const de=d(!1);function ge(){let u=new Image;u.src=b.value.toDataURL("image/png"),u.onload=()=>{p.value.drawImage(u,0,0),r(h.value)};function r(I){I.toBlob(A=>{A&&w(A)},"image/png")}function w(I){const A={binggan:H.binggan,file:I,mode:"img",thread_id:n.threadId,forum_id:n.forumId};de.value=!0,Ve(A).then(Ie=>{L("insertImage",Ie.file_url),de.value=!1,C.value=!1}).catch(()=>{de.value=!1})}}return(u,r)=>(S(),W(e(re),{show:C.value,"onUpdate:show":r[5]||(r[5]=w=>C.value=w),"display-directive":"show"},{default:a(()=>[t(e(ie),{style:F({maxWidth:G.value+4+"px"}),title:"涂鸦板",closable:"",onClose:r[4]||(r[4]=w=>C.value=!1),size:"small","content-style":{padding:"0px"}},{default:a(()=>[V("div",{id:"canvas-container",style:F({width:G.value+"px",height:Q.value+"px"})},[V("canvas",{id:"drawer-canvas-background",ref_key:"canvasBackground",ref:h,width:G.value,height:Q.value,onTouchmove:r[0]||(r[0]=Se(()=>{},["prevent"]))},null,40,Rt),V("canvas",{id:"drawer-canvas",ref_key:"canvas",ref:b,class:Be({painting:!i.value,dragging:i.value}),width:G.value,height:Q.value,onTouchmove:[r[1]||(r[1]=Se(()=>{},["prevent"])),ye],onMousedown:ke,onMouseup:Ce,onMousemove:ye,onTouchstart:ke,onTouchend:Ce},null,42,jt)],4),t(e(qe),{"x-gap":"6",cols:4},{default:a(()=>[t(e(Te),{span:"1"},{default:a(()=>[Nt,t(e(Je),{value:T.value.lineColor,"onUpdate:value":r[2]||(r[2]=w=>T.value.lineColor=w),modes:["hex"],"show-alpha":!1},null,8,["value"])]),_:1}),t(e(Te),{span:"1"},{default:a(()=>[Et,t(e(j),{id:"canvas-brush",size:"small",align:"center"},{default:a(()=>[(S(),Z(me,null,we(D,(w,I)=>V("span",{key:I,style:F({fontSize:w.font_size+"px"}),onClick:A=>Me(w.lineWidth)},ne(w.innerHTML),13,Wt)),64))]),_:1})]),_:1}),t(e(Te),{span:"2"},{default:a(()=>[Ot,t(e(j),{id:"canvas-control",size:"small"},{default:a(()=>[(S(!0),Z(me,null,we(K.value,(w,I)=>(S(),Z("span",{key:I,title:w.title,class:Be([w.className]),innerHTML:w.innerHTML,onClick:A=>pe(w.action)},null,10,Xt))),128))]),_:1})]),_:1})]),_:1})]),action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(We),{"default-upload":!1,onChange:$e,"show-file-list":!1},{default:a(()=>[t(e(O),null,{default:a(()=>[o("加载图片")]),_:1})]),_:1}),t(e(O),{type:"primary",onClick:ge,disabled:u.userIsLocked,loading:de.value},{default:a(()=>[o("上传")]),_:1},8,["disabled","loading"]),t(e(O),{onClick:r[3]||(r[3]=w=>C.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),Vt=["onClick"],Ft=["src"],Gt=J({__name:"EmojiTab",props:{randomHeadsGroup:{default:1},autoHide:{type:Boolean,default:!0}},emits:["appendEmoji"],setup(B,{emit:U}){const R=oe(),H=te(),n=B,C=X(()=>{let l=0,f=0;return H.isMobile&&(H.userCustom.sidebarLeft?l=20:f=20),{paddingLeft:l+"px",paddingRight:f+"px"}}),$=d(),L=X(()=>{const l=Ct.filter(f=>!R.userData.emoji_excluded.includes(f.id)&&(f.headsId===0||f.headsId===n.randomHeadsGroup));return R.userData.my_emoji&&l.unshift({id:0,headsId:0,name:"自定义",emojis:R.userData.my_emoji}),l}),b=U;function s(l,f){b("appendEmoji",l,f==="自定义"),n.autoHide&&($.value=-1)}let h=!1;function p(l,f){return he("span",{onClick:()=>x(f),innerHTML:l})}function x(l){l===$.value&&(h=!0,$.value=-1)}function _(l,f){return h?(h=!1,!1):!0}return(l,f)=>(S(),W(e(Qe),{type:"line","bar-width":0,animated:"",onBeforeLeave:_,size:e(H).isMobile?"small":"medium","default-value":-1,value:$.value,"onUpdate:value":f[0]||(f[0]=y=>$.value=y)},{default:a(()=>[(S(!0),Z(me,null,we(L.value,(y,M,T)=>(S(),W(e(Pe),{name:y.id,tab:p(y.name,y.id)},{default:a(()=>[t(e(j),{size:"small",class:"emoji-container",style:F(C.value)},{default:a(()=>[(S(!0),Z(me,null,we(y.emojis,(g,i,v)=>(S(),Z("div",{class:"emoji-box",onClick:k=>s(g,y.name)},[V("img",{src:g,class:"emoji-in-box"},null,8,Ft)],8,Vt))),256))]),_:2},1032,["style"])]),_:2},1032,["name","tab"]))),256)),t(e(Pe),{name:-1,tab:"隐藏"})]),_:1},8,["size","value"]))}}),Kt=J({__name:"HongbaoModal",props:{threadId:{},forumId:{}},emits:["refreshPostsList"],setup(B,{expose:U,emit:R}){const H=te(),n=oe(),C=B,$=[{value:1,label:"口令红包 直接公开口令"},{value:2,label:"抢答红包 回复答对才公开口令"},{value:3,label:"暗号红包 抢完红包才公开口令"}],L=[{value:1,label:"随机olo"},{value:2,label:"定额olo"}],b=d(3e3),s=d(10),h=d(1),p=d(1),x=d(),_=d(),l=d([]),f=d(!1),y=d(1);function M(K){K===1&&y.value<5&&(y.value+=1),K===-1&&y.value>1&&(l.value.splice(y.value-1,1),y.value-=1)}const{loading:T,send:g,onSuccess:i}=ce(K=>wt(K),{immediate:!1});function v(){if(x.value===void 0){window.$message.error("必须填写“红包口令”喔");return}if(_.value===void 0&&[2,3].includes(p.value)){window.$message.error("抢答红包或者暗号红包时，必须填写“口令提示”喔");return}if(h.value===2&&b.value%s.value!==0){window.$message.error("选择定额红包时，总额要是红包数量的整倍数喔");return}const K={binggan:n.binggan,forum_id:C.forumId,thread_id:C.threadId,hongbao_olo:b.value,hongbao_num:s.value,type:h.value,key_word_type:p.value,hongbao_key_word:x.value,hongbao_question:_.value,hongbao_message_json:l.value,hongbao_olo_hide:f.value};g(K)}i(()=>{Q("refreshPostsList"),k.value=!1});const k=d(!1);function G(){k.value=!0}U({show:G});const Q=R;return(K,D)=>(S(),W(e(re),{show:k.value,"onUpdate:show":D[11]||(D[11]=P=>k.value=P),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(H).modalMaxWidth}),title:"发起红包",closable:"",onClose:D[10]||(D[10]=P=>k.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:v,disabled:e(T),loading:e(T)},{default:a(()=>[o("提交")]),_:1},8,["disabled","loading"]),t(e(O),{onClick:D[9]||(D[9]=P=>k.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[V("div",null,[t(e(q),{depth:3},{default:a(()=>[o("温馨提示：")]),_:1}),o("在红包总额以外，会追加扣除7%手续费。 ")]),V("div",null,[t(e(q),{depth:3},{default:a(()=>[o("总共扣除：")]),_:1}),t(e(q),{type:"warning"},{default:a(()=>[o(ne(Math.ceil(b.value*(e(H).isDouble11?1.02:1.07))),1)]),_:1}),o("个奥利奥 ")]),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包类型")]),_:1}),t(e(_e),{value:p.value,"onUpdate:value":D[0]||(D[0]=P=>p.value=P),options:$},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("olo类型")]),_:1}),t(e(_e),{value:h.value,"onUpdate:value":D[1]||(D[1]=P=>h.value=P),options:L},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包个数")]),_:1}),t(e(be),{value:s.value,"onUpdate:value":D[2]||(D[2]=P=>s.value=P),max:50,min:5,step:5},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("olo总额")]),_:1}),t(e(be),{value:b.value,"onUpdate:value":D[3]||(D[3]=P=>b.value=P),max:1e6,min:3e3,step:1e3,parse:e(Xe),format:e(Ye)},null,8,["value","parse","format"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("红包口令")]),_:1}),t(e(ee),{value:x.value,"onUpdate:value":D[4]||(D[4]=P=>x.value=P),placeholder:"必填"},null,8,["value"])]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("口令提示")]),_:1}),t(e(ee),{value:_.value,"onUpdate:value":D[5]||(D[5]=P=>_.value=P),placeholder:"抢答红包或者暗号红包时，必填"},null,8,["value"])]),_:1}),(S(!0),Z(me,null,we(y.value,P=>(S(),W(e(N),null,{default:a(()=>[t(e(E),{style:{width:"5.2rem"}},{default:a(()=>[o("回复留言")]),_:1}),t(e(ee),{value:l.value[P-1],"onUpdate:value":fe=>l.value[P-1]=fe,placeholder:`#${P}（可选） 多个留言时随机抽取一个`,maxlength:255},null,8,["value","onUpdate:value","placeholder"])]),_:2},1024))),256)),t(e(j),{size:"small",align:"center"},{default:a(()=>[t(e(q),{depth:3},{default:a(()=>[o("留言数量")]),_:1}),t(e(Ae),{size:"tiny",circle:"",disabled:y.value===5,onClick:D[6]||(D[6]=P=>M(1))},{icon:a(()=>[t(e(le),null,{default:a(()=>[t(e(Ze))]),_:1})]),_:1},8,["disabled"]),t(e(Ae),{size:"tiny",circle:"",disabled:y.value===1,onClick:D[7]||(D[7]=P=>{M(-1)})},{icon:a(()=>[t(e(le),null,{default:a(()=>[t(e(et))]),_:1})]),_:1},8,["disabled"]),t(e(tt),{checked:f.value,"onUpdate:checked":D[8]||(D[8]=P=>f.value=P),label:"隐藏olo总额",style:{"margin-left":"auto"}},null,8,["checked"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),qt=J({__name:"ImageUpload",props:{userIsLocked:{type:Boolean},forumId:{},threadId:{}},emits:["insertImage"],setup(B,{emit:U}){const R=te(),H=oe(),n=d(null),C=B,$=U;function L(p){var x=document.getElementsByTagName("body")[0],_=document.createElement("script");_.setAttribute("id","image-upload-js");var l=document.getElementById("upload-button");p=="mjj"&&(_.setAttribute("async","true"),_.setAttribute("data-mode","manual"),_.setAttribute("src","https://mjj.today/sdk/pup.js"),_.setAttribute("data-url","https://mjj.today/upload"),_.setAttribute("data-auto-insert","html-embed"),l==null||l.setAttribute("data-chevereto-pup-trigger","")),p=="imgbb"&&(_.setAttribute("async","true"),_.setAttribute("data-mode","manual"),_.setAttribute("src","https://imgbb.com/upload.js"),_.setAttribute("data-url","https://imgbb.com/upload"),_.setAttribute("data-auto-insert","html-embed-medium"),l==null||l.setAttribute("data-imgbb-trigger","")),p=="freeimage"&&(_.setAttribute("async","true"),_.setAttribute("data-mode","manual"),_.setAttribute("src","https://freeimage.host/sdk/pup.js"),_.setAttribute("data-url","https://freeimage.host/upload"),_.setAttribute("data-auto-insert","html-embed-medium"),l==null||l.setAttribute("data-chevereto-pup-trigger","")),x.appendChild(_)}function b(){const p=document.getElementById("image-upload-js");p==null||p.remove()}Ee(()=>{L(R.userCustom.imgHost)}),at(()=>{b()});const s=d(!1),h=({file:p,data:x,headers:_,withCredentials:l,action:f,onFinish:y,onError:M,onProgress:T})=>{var g;if(p.file!==null){if(p.file.size>1024e3){window.$message.error("图片大小不能超过10M喔"),(g=n.value)==null||g.clear();return}const i={binggan:H.binggan,file:p.file,mode:"img",thread_id:C.threadId,forum_id:C.forumId};s.value=!0,Ve(i).then(v=>{var k;$("insertImage",v.file_url),(k=n.value)==null||k.clear(),s.value=!1}).catch(()=>{var v;(v=n.value)==null||v.clear(),s.value=!1})}};return(p,x)=>p.forumId===419?(S(),W(e(We),{key:0,accept:"image/*",action:"/api/img_upload","custom-request":h,"show-file-list":!1,max:1,ref_key:"NUploadCom",ref:n},{default:a(()=>[t(e(O),{style:{"margin-right":"auto"},disabled:p.userIsLocked,loading:s.value},{default:a(()=>[o("上传图片")]),_:1},8,["disabled","loading"])]),_:1},512)):(S(),W(e(O),{key:1,style:{"margin-right":"auto"},disabled:p.userIsLocked,"data-target":"#content-input",id:"upload-button"},{default:a(()=>[o("上传图片")]),_:1},8,["disabled"]))}}),Jt=J({__name:"PingbiciModal",setup(B,{expose:U}){const R=te(),H=oe(),n=d(),{loading:C,send:$,onSuccess:L}=ce(p=>ft(p),{immediate:!1});function b(){if(!n.value){window.$message.error("请填写屏蔽词");return}const p={binggan:H.binggan,content_pingbici:n.value};$(p)}L(()=>{H.refreshUserData(),s.value=!1});const s=d(!1);function h(){s.value=!0}return U({show:h}),(p,x)=>(S(),W(e(re),{show:s.value,"onUpdate:show":x[3]||(x[3]=_=>s.value=_),"display-directive":"if"},{default:a(()=>[t(e(ie),{style:F({maxWidth:e(R).modalMaxWidth}),title:"追加屏蔽词",closable:"",onClose:x[2]||(x[2]=_=>s.value=!1),size:"small"},{action:a(()=>[t(e(j),{justify:"end"},{default:a(()=>[t(e(O),{type:"primary",onClick:b,loading:e(C),disabled:!n.value||e(C)},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"]),t(e(O),{onClick:x[1]||(x[1]=_=>s.value=!1)},{default:a(()=>[o("关闭")]),_:1})]),_:1})]),default:a(()=>[t(e(j),{vertical:""},{default:a(()=>[t(e(q),null,{default:a(()=>[o("暂时只做了“内容屏蔽词”的追加")]),_:1}),t(e(N),null,{default:a(()=>[t(e(E),{style:{width:"4.2rem"}},{default:a(()=>[o("屏蔽词")]),_:1}),t(e(ee),{value:n.value,"onUpdate:value":x[0]||(x[0]=_=>n.value=_),max:255,onKeyup:ve(b,["enter"])},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]))}}),na=J({__name:"PostInput",props:{mode:{},disabled:{type:Boolean},handling:{type:Boolean},forumId:{default:0},threadId:{default:0},randomHeadsGroup:{default:1}},emits:["contentCommit","refreshPostsList"],setup(B,{expose:U,emit:R}){const H=oe(),n=te(),C=d(null),$=d(null),L=d(null),b=d(null),s=d(null),h=d(null),p=d(null),x=B,_=X(()=>({fontSize:n.userCustom.fontSizeInput+"px",borderRadius:"10px"})),l=X(()=>{const c=(g.value.match(/\r?\n|\r/g)||[]).length+2;return c<5?5:c>10?10:c}),f=X(()=>H.userData.binggan.locked_ttl>0?`你的饼干封禁中，将于${Math.floor(H.userData.binggan.locked_ttl/3600)+1}小时后解封`:"正文内容"),y=X(()=>H.userData.binggan.locked_ttl>0),M=d(H.userData.binggan.nickname||"= ="),T=d(""),g=d(""),i=d(!1),v=d(!1);function k(){M.value=H.userData.binggan.nickname||"= =",T.value="",g.value="",i.value=!1,v.value=!1}const G=X(()=>({id:0,created_at:"预览模式",is_deleted:0,thread_id:0,battle_id:null,hongbao_id:null,floor:0,random_head:1,created_by_admin:0,content:g.value,nickname:M.value,is_your_post:!0,hongbao_data:null})),Q=X(()=>({class:{"nickname-input":!0,admin:v.value}})),K=d(!1),D=lt("emoji_auto_hide",!1);function P(){let c=[he(xe,{checked:K.value,"onUpdate:checked":m=>K.value=m,label:"实时预览"}),he(xe,{checked:D.value,"onUpdate:checked":m=>D.value=m,label:"表情包自动收起"})];return H.userData.binggan.admin!==0&&H.checkAdminForums(x.forumId)&&c.push(he(xe,{checked:v.value,"onUpdate:checked":m=>v.value=m,label:"管理员"})),he(j,{style:"padding:6px 8px",vertical:!0},()=>c)}const fe=[{key:"funcOption",type:"render",render:P}],ye=[{label:"涂鸦板",key:"draw",icon:je(vt,{size:"1.5rem"})},{label:"屏蔽词",key:"mute",icon:je(Tt,{size:"1.5rem"})}];function Ce(c){var m,z;switch(c){case"mute":(m=s.value)==null||m.show();break;case"draw":(z=p.value)==null||z.show();break}}He(v,c=>M.value=c?"管理员":"= =");function ke(c){return c.selectionStart!=null?c.selectionStart:0}function Me(c,m){const z=ke(c),Y=c.value,Ge=Y.substring(0,z)+m+Y.substring(z);g.value=Ge,setTimeout(()=>{c.selectionStart=z+m.length,c.selectionEnd=z+m.length},0)}function pe(c){const m=document.getElementById("content-input");Me(m,c),ge(),m.focus()}function $e(){pt({title:"要清空内容吗？",onPositiveClick:()=>g.value=""})}const ae=d([""]);function de(){ae.value.length>1&&(ae.value.pop(),g.value=ae.value.slice(-1)[0])}function ge(){var c;ae.value.push((c=g.value)!=null?c:""),ae.value.length>20&&ae.value.shift()}function u(c,m){pe(`<img src='${c}' class='${m?"custom-emoji-img":"emoji-img"}'>`)}function r(c){pe(c)}function w(c){pe(`<img src='${c}' />`)}function I(c){var m;g.value=c,ge(),(m=C.value)==null||m.focus()}const A=R;function Ie(c){if(!c.isTrusted){const z={title:"错误",closable:!1,content:"请不要用脚本回复喔，可能会被系统判断为脚本并碎饼干。",positiveText:"确定"};window.$dialog.warning(z);return}new Promise(function(z,Y){A("contentCommit",{contentInput:g.value,nicknameInput:M.value,postWithAdmin:v.value,titleInput:T.value,isDelay:i.value,ist:c.isTrusted},z)}).then(Fe)}function Fe(){T.value="",g.value="",i.value=!1}const ze=d(!1);return U({quoteHandle:I,isTyping:ze,resetInput:k}),(c,m)=>(S(),W(e(j),{vertical:""},{default:a(()=>[K.value?(S(),Z(me,{key:0},[c.mode==="thread"?(S(),W(e(ie),{class:"thread-title-container",size:"small",key:"title-card"},{default:a(()=>[V("span",{class:"thread-title",style:F({fontSize:e(n).userCustom.fontSizeThreadList+"px"})},ne(T.value||"标题预览")+" [0] ",5)]),_:1})):ue("",!0),t(yt,{"post-data":G.value,"forum-id":0,"preview-mode":!0},null,8,["post-data"])],64)):ue("",!0),t(e(j),{size:"small",wrap:!1,align:"center",style:F({paddingRight:e(n).isMobile?"24px":"0px"})},{default:a(()=>[t(e(N),{style:{"max-width":"300px"}},{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("昵称")]),_:1}),t(e(ee),{maxlength:30,value:M.value,"onUpdate:value":m[0]||(m[0]=z=>M.value=z),"show-count":"","input-props":Q.value},null,8,["value","input-props"])]),_:1}),t(e(Re),{trigger:e(n).isMobile?"click":"hover",options:fe,placement:"bottom-start"},{default:a(()=>[t(e(O),{size:"medium",style:{"flex-shrink":"0"},secondary:!1},{default:a(()=>[o("功能")]),_:1})]),_:1},8,["trigger"])]),_:1},8,["style"]),c.mode==="thread"?(S(),W(e(N),{key:1},{default:a(()=>[t(e(E),{style:{width:"3.2rem"}},{default:a(()=>[o("标题")]),_:1}),t(e(ee),{maxlength:100,value:T.value,"onUpdate:value":m[1]||(m[1]=z=>T.value=z),"show-count":"",placeholder:"标题内容"},null,8,["value"])]),_:1})):ue("",!0),t(Gt,{"auto-hide":e(D),"random-heads-group":c.randomHeadsGroup,onAppendEmoji:u},null,8,["auto-hide","random-heads-group"]),t(e(j),{size:e(n).isMobile?"small":"medium",justify:"end",align:"center",style:F({paddingRight:e(n).isMobile?"24px":"0px"})},{default:a(()=>[t(e(Re),{trigger:"click",options:ye,onSelect:Ce,size:e(n).isMobile?"medium":"large"},{default:a(()=>[t(e(le),{size:e(n).isMobile?20:24,style:{cursor:"pointer"}},{default:a(()=>[t(e(nt))]),_:1},8,["size"])]),_:1},8,["size"]),c.mode==="post"?(S(),W(e(se),{key:0,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(Lt),{style:{cursor:"pointer"},onClick:m[2]||(m[2]=z=>{var Y;return(Y=$.value)==null?void 0:Y.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 发红包 ")]),_:1},8,["trigger"])):ue("",!0),c.mode==="post"?(S(),W(e(se),{key:1,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(ot),{style:{cursor:"pointer"},onClick:m[3]||(m[3]=z=>{var Y;return(Y=L.value)==null?void 0:Y.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 大乱斗 ")]),_:1},8,["trigger"])):ue("",!0),c.mode==="post"?(S(),W(e(se),{key:2,placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(st),{style:{cursor:"pointer"},onClick:m[4]||(m[4]=z=>{var Y;return(Y=b.value)==null?void 0:Y.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" Roll点 ")]),_:1},8,["trigger"])):ue("",!0),t(e(se),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(ut),{style:{cursor:"pointer"},onClick:m[5]||(m[5]=z=>{var Y;return(Y=h.value)==null?void 0:Y.show()})})]),_:1},8,["size"])]),default:a(()=>[o(" 快捷代码 ")]),_:1},8,["trigger"]),t(e(it),{vertical:""}),t(e(se),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(rt),{style:{cursor:"pointer"},onClick:de})]),_:1},8,["size"])]),default:a(()=>[o(" 撤销 ")]),_:1},8,["trigger"]),t(e(se),{placement:"bottom-start",trigger:e(n).isMobile?"click":"hover"},{trigger:a(()=>[t(e(le),{size:e(n).isMobile?28:32},{default:a(()=>[t(e(dt),{style:{cursor:"pointer"},onClick:$e})]),_:1},8,["size"])]),default:a(()=>[o(" 清空 ")]),_:1},8,["trigger"])]),_:1},8,["size","style"]),t(e(ct),{value:g.value,"onUpdate:value":m[6]||(m[6]=z=>g.value=z),type:"textarea",placeholder:f.value,rows:l.value,ref_key:"contentInputDom",ref:C,style:F(_.value),"input-props":{id:"content-input"},disabled:y.value,onChange:ge,onKeyup:m[7]||(m[7]=ve(Se(z=>Ie(z),["ctrl"]),["enter"])),onBlur:m[8]||(m[8]=z=>ze.value=!1),onFocus:m[9]||(m[9]=z=>ze.value=!0)},null,8,["value","placeholder","rows","style","disabled"]),t(e(j),{justify:"end",align:"center"},{default:a(()=>[t(qt,{"user-is-locked":y.value,"forum-id":c.forumId,"thread-id":c.threadId,onInsertImage:w},null,8,["user-is-locked","forum-id","thread-id"]),c.mode==="thread"?(S(),W(e(se),{key:0,placement:"bottom-start",trigger:"hover",disabled:e(n).isMobile},{trigger:a(()=>[t(e(xe),{checked:i.value,"onUpdate:checked":m[10]||(m[10]=z=>i.value=z)},{default:a(()=>[o("延时发送")]),_:1},8,["checked"])]),default:a(()=>[o(" 第二天8点自动发出 ")]),_:1},8,["disabled"])):ue("",!0),t(e(se),{placement:"bottom-start",trigger:"hover",disabled:e(n).isMobile},{trigger:a(()=>[t(e(O),{type:"primary",onClick:m[11]||(m[11]=z=>Ie(z)),loading:c.handling,disabled:c.handling||y.value},{default:a(()=>[o("提交")]),_:1},8,["loading","disabled"])]),default:a(()=>[o(" 可以Ctrl+Enter ")]),_:1},8,["disabled"])]),_:1}),t(Kt,{ref_key:"HongbaoModalCom",ref:$,"thread-id":c.threadId,"forum-id":c.forumId,onRefreshPostsList:m[12]||(m[12]=z=>A("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(Pt,{ref_key:"BattleModalCom",ref:L,"thread-id":c.threadId,"forum-id":c.forumId,"random-heads-group":c.randomHeadsGroup,onRefreshPostsList:m[13]||(m[13]=z=>A("refreshPostsList"))},null,8,["thread-id","forum-id","random-heads-group"]),t(kt,{ref_key:"RollModalCom",ref:b,"thread-id":c.threadId,"forum-id":c.forumId,onRefreshPostsList:m[14]||(m[14]=z=>A("refreshPostsList"))},null,8,["thread-id","forum-id"]),t(Jt,{ref_key:"PingbiciModalCom",ref:s},null,512),t(At,{ref_key:"CodeModalCom",ref:h,onInsertCode:r},null,512),t(Yt,{ref_key:"DrawerModalCom",ref:p,onInsertImage:w,"user-is-locked":y.value,"forum-id":c.forumId,"thread-id":c.threadId},null,8,["user-is-locked","forum-id","thread-id"])]),_:1}))}});export{na as _,Bt as a};
