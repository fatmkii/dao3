var Y=Object.defineProperty;var H=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var q=(p,d,u)=>d in p?Y(p,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[d]=u,$=(p,d)=>{for(var u in d||(d={}))ee.call(d,u)&&q(p,u,d[u]);if(H)for(var u of H(d))ae.call(d,u)&&q(p,u,d[u]);return p};import{w as le,n as te,b as se,$ as h,d as A,c as L,c0 as re,c1 as ne,A as _,M as oe,f as l,H as a,a as e,i as U,bv as ue,F as w,C as k,k as v,v as f,z as o,h as b,Q as O,j as m,G as M,ar as j,B as R}from"./app-BfTmtkkR.js";import{c as ie}from"./copyToClipboard-BvCi2fuT.js";import{_ as D}from"./FInput.vue_vue_type_script_setup_true_lang-Bj8uTtER.js";import{N as de,a as z}from"./FormItem-DEaD97av.js";import{a as me,N as T}from"./Grid-B_kGa6lq.js";import{N as I}from"./Divider-BHB90_Ne.js";import{N as pe}from"./Switch-Q-g3II9Y.js";import{N as ve}from"./Select-BbGpypib.js";import{N as J}from"./Input-C5i_M3Sx.js";import"./use-locale-CFDb4tef.js";import"./Tag-COjQsRYJ.js";const fe={key:0},ge=m("span",{style:{"margin-left":"6px"}},"暂停使用后，大乱斗时不显示选项",-1),he=["src"],_e=m("h4",null,"骰子语句：",-1),be=m("p",null,"1~10指投出1~10点时候的语句，如此类推。",-1),ye=m("h4",null,"替换词会被自动替换为相应内容：",-1),xe=m("p",null,[o("%rand_num —— 骰子数字（必须有） "),m("br"),o(" %name —— 本角色名字 "),m("br"),o(" %opponent —— 对手名字")],-1),we=m("span",null,"将代码填入下述框就可以导入角色数据",-1),Ne=m("span",null,"可以将下面代码复制下来分享给别人",-1),Ee=le({__name:"TabChara",setup(p){const d=te(),u=se(),E=h(null),N=h(!1),g=h(!1),y=h(!1),C=h(),F=A(()=>JSON.stringify(r.value[i.value])),i=h(0),Q=A(()=>r.value.map((n,t)=>({value:t,label:n.name}))),W=[{label:"等待",varName:"wait"},{label:"参战",varName:"against"},{label:"攻击",varName:"attack"},{label:"胜利",varName:"win"},{label:"失败",varName:"lose"}],B=$($({name:{required:!0,message:"请输入角色名称",trigger:"blur"}},W.reduce((n,{label:t,varName:s})=>(n[`heads.${s}`]={required:!0,message:"请输入头像地址",trigger:"blur"},n),{})),Array.from({length:10},(n,t)=>t).reduce((n,t)=>(n[`messages.${t}`]={required:!0,validator:(s,x)=>{const S=/%rand_num/;return x===null?new Error("请输入战斗语音"):S.test(x)?!0:new Error("必须包含%rand_num（上面有使用说明）")},trigger:"blur"},n),{}));function P(){if(C.value===void 0){window.$message.error("请输入角色数据");return}try{r.value[i.value]=JSON.parse(C.value)}catch(n){window.$message.error("输入数据的格式有误，请重新尝试");return}window.$message.success("已导入角色数据"),g.value=!1}function Z(){ie(F.value),window.$message.success("已复制到剪贴板")}const{loading:c,data:r,send:K}=L(n=>re(n),{immediate:!1,initialData:[]});d.binggan!==null&&K({binggan:d.binggan});const{loading:G,send:V}=L(n=>ne(n),{immediate:!1});function X(){var n;(n=E.value)==null||n.validate(t=>{if(t)window.$message.error("请确认信息填写完整");else{const s=$({binggan:d.binggan,chara_id:i.value},r.value[i.value]);V(s)}})}return(n,t)=>(_(),oe(e(v),{vertical:""},{default:l(()=>[a(e(U),{title:"我的角色",size:"small"},ue({default:l(()=>[!e(c)&&e(r).length>0?(_(),w(k,{key:0},[a(e(v),{size:"small",justify:"end",align:"center"},{default:l(()=>[a(e(f),{onClick:t[1]||(t[1]=s=>g.value=!0)},{default:l(()=>[o("导入角色")]),_:1}),a(e(f),{onClick:t[2]||(t[2]=s=>y.value=!0)},{default:l(()=>[o("导出角色")]),_:1})]),_:1}),a(e(de),{ref_key:"formRef",ref:E,model:e(r)[i.value],"label-placement":"left","label-width":"auto",rules:B,size:e(u).isMobile?"small":"medium"},{default:l(()=>[a(e(me),{cols:"1 1000:2","x-gap":12},{default:l(()=>[a(e(T),{style:{"max-width":"500px"}},{default:l(()=>[a(e(I),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:l(()=>[a(e(b),{depth:"3",style:{"font-size":"0.875rem"}},{default:l(()=>[o(" 角色名 ")]),_:1})]),_:1}),a(e(z),{label:"角色名",path:"name"},{default:l(()=>[a(e(D),{value:e(r)[i.value].name,"onUpdate:value":t[3]||(t[3]=s=>e(r)[i.value].name=s),placeholder:"你的角色的名称"},null,8,["value"])]),_:1}),a(e(z),{label:"暂停使用",path:"not_use"},{default:l(()=>[a(e(pe),{value:e(r)[i.value].not_use,"onUpdate:value":t[4]||(t[4]=s=>e(r)[i.value].not_use=s)},null,8,["value"]),ge]),_:1}),a(e(I),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:l(()=>[a(e(b),{depth:"3",style:{"font-size":"0.875rem"}},{default:l(()=>[o(" 头像组 ")]),_:1})]),_:1}),(_(),w(k,null,O(W,(s,x)=>a(e(z),{label:s.label,path:`heads.${s.varName}`},{default:l(()=>[a(e(D),{value:e(r)[i.value].heads[s.varName],"onUpdate:value":S=>e(r)[i.value].heads[s.varName]=S},null,8,["value","onUpdate:value"]),m("img",{src:e(r)[i.value].heads[s.varName],style:{"max-height":"34px"}},null,8,he)]),_:2},1032,["label","path"])),64))]),_:1}),a(e(T),{style:{"max-width":"500px"}},{default:l(()=>[a(e(I),{dashed:"",style:{"margin-top":"8px","margin-bottom":"8px"}},{default:l(()=>[a(e(b),{depth:"3",style:{"font-size":"0.875rem",cursor:"pointer"},onClick:t[5]||(t[5]=s=>N.value=!0)},{default:l(()=>[o(" 战斗语音（使用说明？） ")]),_:1})]),_:1}),(_(),w(k,null,O(10,s=>a(e(z),{label:`骰子${s*10-9}~${s*10}`,path:`messages.${s-1}`},{default:l(()=>[a(e(D),{value:e(r)[i.value].messages[s-1],"onUpdate:value":x=>e(r)[i.value].messages[s-1]=x},null,8,["value","onUpdate:value"])]),_:2},1032,["label","path"])),64))]),_:1})]),_:1})]),_:1},8,["model","size"])],64)):M("",!0)]),_:2},[!e(c)&&e(r).length>0?{name:"header-extra",fn:l(()=>[a(e(b),{depth:3,style:{"flex-shrink":"0"}},{default:l(()=>[o(" 选择要编辑的角色 ")]),_:1}),a(e(ve),{value:i.value,"onUpdate:value":t[0]||(t[0]=s=>i.value=s),options:Q.value,"consistent-menu-width":!1},null,8,["value","options"])]),key:"0"}:void 0,!e(c)&&e(r).length===0?{name:"header-extra",fn:l(()=>[a(e(b),{depth:3},{default:l(()=>[o(" 你尚未拥有角色槽位，"),e(u).isMobile?(_(),w("br",fe)):M("",!0),o("请在“饼干升级”处购买 ")]),_:1})]),key:"1"}:void 0]),1024),!e(c)&&e(r).length>0?(_(),w(k,{key:0},[a(e(v),{size:"small",justify:"end",align:"center"},{default:l(()=>[a(e(b),{depth:3},{default:l(()=>[o(" 各个角色要分别点提交喔 ")]),_:1}),a(e(f),{type:"primary",loading:e(G),disabled:e(G),onClick:X},{default:l(()=>[o("提交当前角色")]),_:1},8,["loading","disabled"])]),_:1}),a(e(j),{show:N.value,"onUpdate:show":t[7]||(t[7]=s=>N.value=s),"display-directive":"if"},{default:l(()=>[a(e(U),{style:R({maxWidth:e(u).modalMaxWidth}),closable:"",onClose:t[6]||(t[6]=s=>N.value=!1),size:"small",title:"战斗语音使用说明"},{default:l(()=>[_e,be,ye,xe]),_:1},8,["style"])]),_:1},8,["show"]),a(e(j),{show:g.value,"onUpdate:show":t[11]||(t[11]=s=>g.value=s),"display-directive":"if"},{default:l(()=>[a(e(U),{style:R({maxWidth:e(u).modalMaxWidth}),closable:"",onClose:t[10]||(t[10]=s=>g.value=!1),size:"small",title:"导入角色数据"},{action:l(()=>[a(e(v),{justify:"end"},{default:l(()=>[a(e(f),{onClick:P,type:"primary"},{default:l(()=>[o("导入")]),_:1}),a(e(f),{onClick:t[9]||(t[9]=s=>g.value=!1)},{default:l(()=>[o("关闭")]),_:1})]),_:1})]),default:l(()=>[a(e(v),{vertical:""},{default:l(()=>[we,a(e(J),{value:C.value,"onUpdate:value":t[8]||(t[8]=s=>C.value=s),type:"textarea",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:8}},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"]),a(e(j),{show:y.value,"onUpdate:show":t[14]||(t[14]=s=>y.value=s),"display-directive":"if"},{default:l(()=>[a(e(U),{style:R({maxWidth:e(u).modalMaxWidth}),closable:"",onClose:t[13]||(t[13]=s=>y.value=!1),size:"small",title:"导出角色数据"},{action:l(()=>[a(e(v),{justify:"end"},{default:l(()=>[a(e(f),{onClick:Z},{default:l(()=>[o("复制")]),_:1}),a(e(f),{onClick:t[12]||(t[12]=s=>y.value=!1)},{default:l(()=>[o("关闭")]),_:1})]),_:1})]),default:l(()=>[a(e(v),{vertical:""},{default:l(()=>[Ne,a(e(J),{value:F.value,type:"textarea",readonly:"",style:{"border-radius":"10px","margin-top":"6px"},autosize:{minRows:3,maxRows:8}},null,8,["value"])]),_:1})]),_:1},8,["style"])]),_:1},8,["show"])],64)):M("",!0)]),_:1}))}});export{Ee as default};
